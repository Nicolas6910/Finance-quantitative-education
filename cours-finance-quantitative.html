<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Quantitative</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-dark: #0a0a0a;
            --bg-card: #111111;
            --bg-hover: #1a1a1a;
            --border: #222222;
            --text: #ffffff;
            --text-body: #e0e0e0;
            --text-muted: #999999;
            --accent-blue: #0066ff;
            --accent-green: #00cc66;
            --accent-red: #ff3333;
            --accent-orange: #ff9900;
            --accent-purple: #9933ff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            line-height: 1.8;
            font-size: 17px;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 260px;
            height: 100vh;
            background: var(--bg-card);
            border-right: 1px solid var(--border);
            overflow-y: auto;
            padding: 30px 0;
        }

        .sidebar-title {
            padding: 0 25px 20px;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--text-muted);
        }

        .sidebar ul {
            list-style: none;
        }

        .sidebar .partie {
            padding: 20px 25px 8px;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: var(--accent-blue);
        }

        .sidebar li a {
            display: block;
            padding: 10px 25px;
            color: var(--text-muted);
            text-decoration: none;
            font-size: 14px;
            border-left: 2px solid transparent;
            transition: all 0.2s;
        }

        .sidebar li a:hover {
            color: var(--text);
            background: var(--bg-hover);
        }

        .sidebar li a.active {
            color: var(--text);
            border-left-color: var(--accent-blue);
            background: var(--bg-hover);
        }

        .sidebar .submenu {
            display: none;
            margin: 0;
            padding: 0;
        }

        .sidebar .submenu.open {
            display: block;
        }

        .sidebar .submenu li {
            margin: 0;
        }

        .sidebar .submenu a {
            font-size: 13px;
            padding: 8px 25px 8px 38px;
            color: var(--text-muted);
            border-left: 2px solid transparent;
            display: block;
        }

        .sidebar .submenu a:hover {
            color: var(--accent-blue);
            background: var(--bg-hover);
        }

        .sidebar .has-submenu {
            margin-bottom: 0;
        }

        /* Interactive Exercises */
        .exercise-input {
            width: 100%;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            color: var(--text-body);
            padding: 12px 15px;
            font-size: 15px;
            font-family: inherit;
            margin: 8px 0 15px;
            resize: vertical;
        }

        .exercise-input:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .exercise-input::placeholder {
            color: var(--text-muted);
        }

        .exercise-number-input {
            width: 50px;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 8px 12px;
            font-size: 15px;
            text-align: center;
            margin-right: 10px;
        }

        .exercise-number-input:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .exercise-calc-input {
            width: 150px;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 10px 15px;
            font-size: 16px;
            font-family: monospace;
        }

        .exercise-calc-input:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .chronology-item {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
        }

        .chronology-item:last-child {
            border-bottom: none;
        }

        .check-btn {
            background: var(--accent-blue);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 15px;
            transition: background 0.2s;
        }

        .check-btn:hover {
            background: #0055dd;
        }

        .feedback {
            margin-top: 15px;
            padding: 15px 20px;
            display: none;
        }

        .feedback.correct {
            display: block;
            background: rgba(0, 204, 102, 0.1);
            border-left: 3px solid var(--accent-green);
            color: var(--accent-green);
        }

        .feedback.incorrect {
            display: block;
            background: rgba(255, 51, 51, 0.1);
            border-left: 3px solid var(--accent-red);
            color: var(--accent-red);
        }

        .matching-container {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 10px;
            align-items: center;
        }

        .matching-left, .matching-right {
            background: var(--bg-card);
            padding: 12px 15px;
        }

        .matching-select {
            background: var(--bg-dark);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 8px 12px;
            font-size: 14px;
            width: 60px;
            text-align: center;
        }

        .matching-select:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .calc-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
        }

        .calc-label {
            min-width: 200px;
            color: var(--text-body);
        }

        .calc-unit {
            color: var(--text-muted);
            font-size: 14px;
        }

        /* Main */
        .main-content {
            margin-left: 260px;
            padding: 50px 80px;
            max-width: none;
        }

        /* Module */
        .module {
            display: none;
        }

        .module.active {
            display: block;
        }

        /* Header */
        .module-header {
            margin-bottom: 50px;
            padding-bottom: 30px;
            border-bottom: 1px solid var(--border);
        }

        .module-header h1 {
            font-size: 48px;
            font-weight: 300;
            letter-spacing: -1px;
            margin-bottom: 15px;
        }

        .module-meta {
            display: flex;
            gap: 30px;
            font-size: 14px;
            color: var(--text-muted);
        }

        .module-meta span {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .meta-dot {
            width: 8px;
            height: 8px;
            background: var(--accent-green);
        }

        /* Typography */
        h2 {
            font-size: 32px;
            font-weight: 600;
            margin: 60px 0 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
            color: var(--text);
        }

        h3 {
            font-size: 24px;
            font-weight: 600;
            margin: 40px 0 20px;
            color: var(--accent-blue);
        }

        h4 {
            font-size: 14px;
            font-weight: 700;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin: 25px 0 12px;
            color: var(--text);
        }

        p {
            margin-bottom: 20px;
            color: var(--text-body);
        }

        strong {
            color: var(--text);
            font-weight: 600;
        }

        /* Images */
        .image-container {
            margin: 40px 0;
            text-align: center;
        }

        .image-container img {
            max-width: 100%;
            max-height: 500px;
            height: auto;
            object-fit: contain;
        }

        .image-container figcaption {
            margin-top: 15px;
            font-size: 14px;
            color: var(--text-muted);
        }

        /* Portrait placeholder avec initiales */
        .portrait-placeholder {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            font-size: 64px;
            font-weight: 700;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        /* Image placeholder rectangulaire */
        .image-placeholder {
            width: 100%;
            max-width: 600px;
            height: 300px;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .image-placeholder .icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.7;
        }

        .image-placeholder .label {
            font-size: 16px;
            color: var(--text-muted);
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
        }

        th {
            text-align: left;
            padding: 15px 20px;
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: var(--text-muted);
            border-bottom: 1px solid var(--border);
        }

        td {
            padding: 18px 20px;
            border-bottom: 1px solid var(--border);
            color: var(--text-body);
            font-size: 16px;
        }

        tr:hover td {
            background: var(--bg-card);
        }

        /* Boxes */
        .box {
            background: var(--bg-card);
            border-left: 3px solid var(--accent-blue);
            padding: 30px 35px;
            margin: 35px 0;
        }

        .box-red { border-left-color: var(--accent-red); }
        .box-green { border-left-color: var(--accent-green); }
        .box-orange { border-left-color: var(--accent-orange); }
        .box-purple { border-left-color: var(--accent-purple); }

        .box h4 {
            margin-top: 0;
            color: var(--text);
        }

        .box p:last-child {
            margin-bottom: 0;
        }

        /* Key concept */
        .concept {
            color: var(--accent-green);
            font-weight: 500;
        }

        /* Timeline */
        .timeline {
            margin: 40px 0;
            padding-left: 30px;
            border-left: 2px solid var(--border);
        }

        .timeline-item {
            position: relative;
            padding: 0 0 30px 35px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 8px;
            width: 10px;
            height: 10px;
            background: var(--accent-blue);
        }

        .timeline-date {
            font-size: 16px;
            font-weight: 600;
            color: var(--accent-blue);
            margin-bottom: 5px;
        }

        .timeline-text {
            color: var(--text-body);
            font-size: 17px;
        }

        /* Grid */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin: 35px 0;
        }

        .grid-item {
            background: var(--bg-card);
            padding: 25px 30px;
            border-left: 3px solid var(--border);
        }

        .grid-item h4 {
            margin-top: 0;
        }

        .grid-item.blue { border-left-color: var(--accent-blue); }
        .grid-item.green { border-left-color: var(--accent-green); }
        .grid-item.red { border-left-color: var(--accent-red); }
        .grid-item.orange { border-left-color: var(--accent-orange); }
        .grid-item.purple { border-left-color: var(--accent-purple); }

        /* Quote */
        blockquote {
            border-left: 3px solid var(--accent-orange);
            padding: 30px 35px;
            margin: 35px 0;
            background: var(--bg-card);
        }

        blockquote p {
            font-size: 20px;
            font-style: italic;
            color: var(--text);
            margin-bottom: 15px;
        }

        blockquote cité {
            font-size: 14px;
            color: var(--text-muted);
            font-style: normal;
        }

        /* Chart */
        .chart-container {
            background: var(--bg-card);
            padding: 30px;
            margin: 35px 0;
        }

        /* Flow diagram */
        .flow {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 35px 0;
            flex-wrap: wrap;
        }

        .flow-item {
            background: var(--bg-card);
            padding: 20px 25px;
            text-align: center;
            min-width: 140px;
        }

        .flow-item.blue { border-top: 3px solid var(--accent-blue); }
        .flow-item.green { border-top: 3px solid var(--accent-green); }
        .flow-item.red { border-top: 3px solid var(--accent-red); }
        .flow-item.orange { border-top: 3px solid var(--accent-orange); }

        .flow-item strong {
            display: block;
            margin-bottom: 5px;
            font-size: 16px;
        }

        .flow-item span {
            font-size: 14px;
            color: var(--text-muted);
        }

        .flow-arrow {
            color: var(--text-muted);
            font-size: 24px;
        }

        /* Summary */
        .summary {
            background: var(--bg-card);
            padding: 40px;
            margin: 50px 0;
            border-top: 3px solid var(--accent-blue);
        }

        .summary h3 {
            margin-top: 0;
            color: var(--text);
        }

        /* List */
        ul, ol {
            margin: 20px 0 20px 25px;
            color: var(--text-body);
        }

        li {
            margin-bottom: 12px;
        }

        li strong {
            color: var(--text);
            font-weight: 600;
        }

        a {
            color: var(--accent-blue);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        /* Exercices */
        détails {
            margin-top: 15px;
        }

        summary {
            cursor: pointer;
            color: var(--accent-blue);
            font-weight: 500;
            padding: 10px 0;
        }

        summary:hover {
            text-decoration: underline;
        }

        .solution {
            margin-top: 15px;
            padding: 20px;
            background: var(--bg-hover);
            border-left: 3px solid var(--accent-green);
        }

        .exercise-box {
            background: var(--bg-card);
            padding: 25px 30px;
            margin: 20px 0;
            border-left: 3px solid var(--border);
        }

        .exercise-box h4 {
            margin-top: 0;
            color: var(--accent-blue);
        }

        /* Flashcards */
        .flashcards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .flashcard {
            min-height: 160px;
            cursor: pointer;
            position: relative;
        }

        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }

        .flashcard-front,
        .flashcard-back {
            position: absolute;
            width: 100%;
            min-height: 160px;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 25px;
            text-align: center;
            background: var(--bg-card);
        }

        .flashcard-front {
            border-left: 3px solid var(--accent-blue);
        }

        .flashcard-front p {
            color: var(--text);
            font-weight: 500;
            margin: 0;
        }

        .flashcard-back {
            border-left: 3px solid var(--accent-green);
            transform: rotateY(180deg);
        }

        .flashcard-back p {
            color: var(--accent-green);
            margin: 0;
        }

        /* Navigation */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid var(--border);
        }

        .nav-btn {
            padding: 15px 30px;
            font-size: 15px;
            font-weight: 500;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text);
            cursor: pointer;
            transition: all 0.2s;
        }

        .nav-btn:hover {
            background: var(--bg-card);
            border-color: var(--accent-blue);
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        /* Accent text */
        .text-red { color: var(--accent-red); }
        .text-yellow { color: #ffcc00; }

        /* Highlight number */
        .big-number {
            font-size: 56px;
            font-weight: 300;
            color: var(--accent-blue);
            line-height: 1;
        }
    </style>
</head>
<body>

<nav class="sidebar">
    <div class="sidebar-title">Finance Quantitative</div>
    <ul>
        <li class="partie">I. Histoire</li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module1')" class="module-link active">01. Origines</a>
            <ul class="submenu open">
                <li><a href="#exercices" onclick="scrollToSection('module1', 'exercices')">Exercices</a></li>
                <li><a href="#flashcards" onclick="scrollToSection('module1', 'flashcards')">Flashcards</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module2')" class="module-link">02. Fondations Math</a>
            <ul class="submenu">
                <li><a href="#exercices-m2" onclick="scrollToSection('module2', 'exercices-m2')">Exercices</a></li>
                <li><a href="#flashcards-m2" onclick="scrollToSection('module2', 'flashcards-m2')">Flashcards</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module3')" class="module-link">03. Révolution Quant</a>
            <ul class="submenu">
                <li><a href="#exercices-m3" onclick="scrollToSection('module3', 'exercices-m3')">Exercices</a></li>
                <li><a href="#flashcards-m3" onclick="scrollToSection('module3', 'flashcards-m3')">Flashcards</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module4')" class="module-link">04. Ère Moderne</a>
            <ul class="submenu">
                <li><a href="#exercices-m4" onclick="scrollToSection('module4', 'exercices-m4')">Exercices</a></li>
                <li><a href="#flashcards-m4" onclick="scrollToSection('module4', 'flashcards-m4')">Flashcards</a></li>
            </ul>
        </li>

        <li class="partie">II. Mathématiques</li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module5')" class="module-link">05. Algèbre Linéaire</a>
            <ul class="submenu">
                <li><a href="#exercices-m5" onclick="scrollToSection('module5', 'exercices-m5')">Exercices</a></li>
                <li><a href="#flashcards-m5" onclick="scrollToSection('module5', 'flashcards-m5')">Flashcards</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module6')" class="module-link">06. Calcul Différentiel</a>
            <ul class="submenu">
                <li><a href="#exercices-m6" onclick="scrollToSection('module6', 'exercices-m6')">Exercices</a></li>
                <li><a href="#flashcards-m6" onclick="scrollToSection('module6', 'flashcards-m6')">Flashcards</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module7')" class="module-link">07. Probabilités</a>
            <ul class="submenu">
                <li><a href="#exercices-m7" onclick="scrollToSection('module7', 'exercices-m7')">Exercices</a></li>
                <li><a href="#flashcards-m7" onclick="scrollToSection('module7', 'flashcards-m7')">Flashcards</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module8')" class="module-link">08. Économétrie</a>
            <ul class="submenu">
                <li><a href="#exercices-m8" onclick="scrollToSection('module8', 'exercices-m8')">Exercices</a></li>
                <li><a href="#flashcards-m8" onclick="scrollToSection('module8', 'flashcards-m8')">Flashcards</a></li>
            </ul>
        </li>

        <li class="partie">III. Stochastique</li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module9')" class="module-link">09. Brownien</a>
            <ul class="submenu">
                <li><a href="#exercices-m9" onclick="scrollToSection('module9', 'exercices-m9')">Exercices</a></li>
                <li><a href="#flashcards-m9" onclick="scrollToSection('module9', 'flashcards-m9')">Flashcards</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module10')" class="module-link">10. Calcul Itô</a>
            <ul class="submenu">
                <li><a href="#exercices-m10" onclick="scrollToSection('module10', 'exercices-m10')">Exercices</a></li>
                <li><a href="#flashcards-m10" onclick="scrollToSection('module10', 'flashcards-m10')">Flashcards</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module11')" class="module-link">11. Martingales</a>
            <ul class="submenu">
                <li><a href="#exercices-m11" onclick="scrollToSection('module11', 'exercices-m11')">Exercices</a></li>
                <li><a href="#flashcards-m11" onclick="scrollToSection('module11', 'flashcards-m11')">Flashcards</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module12')" class="module-link">12. Applications</a>
            <ul class="submenu">
                <li><a href="#exercices-m12" onclick="scrollToSection('module12', 'exercices-m12')">Exercices</a></li>
                <li><a href="#flashcards-m12" onclick="scrollToSection('module12', 'flashcards-m12')">Flashcards</a></li>
            </ul>
        </li>

        <li class="partie">IV. Portefeuille</li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module13')" class="module-link">13. Risque</a>
            <ul class="submenu">
                <li><a href="#exercices-m13" onclick="scrollToSection('module13', 'exercices-m13')">Exercices</a></li>
                <li><a href="#flashcards-m13" onclick="scrollToSection('module13', 'flashcards-m13')">Flashcards</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module14')" class="module-link">14. Markowitz</a>
            <ul class="submenu">
                <li><a href="#exercices-m14" onclick="scrollToSection('module14', 'exercices-m14')">Exercices</a></li>
                <li><a href="#flashcards-m14" onclick="scrollToSection('module14', 'flashcards-m14')">Flashcards</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module15')" class="module-link">15. CAPM</a>
            <ul class="submenu">
                <li><a href="#exercices-m15" onclick="scrollToSection('module15', 'exercices-m15')">Exercices</a></li>
                <li><a href="#flashcards-m15" onclick="scrollToSection('module15', 'flashcards-m15')">Flashcards</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="#" onclick="toggleSubmenu(this, 'module16')" class="module-link">16. Performance</a>
            <ul class="submenu">
                <li><a href="#exercices-m16" onclick="scrollToSection('module16', 'exercices-m16')">Exercices</a></li>
                <li><a href="#flashcards-m16" onclick="scrollToSection('module16', 'flashcards-m16')">Flashcards</a></li>
            </ul>
        </li>
    </ul>
</nav>

<main class="main-content">

    <!-- MODULE 1 -->
    <section id="module1" class="module active">

        <header class="module-header">
            <h1>Origines de la Finance : Une Histoire Mondiale</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Fondamental</span>
                <span>90 minutes</span>
                <span>Aucun prerequis</span>
            </div>
        </header>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/b/bf/Emanuel_de_Witte_-_De_binnenplaats_van_de_beurs_te_Amsterdam.jpg" alt="Bourse Amsterdam">
            <figcaption>Emanuel de Witte - Interieur de la Bourse d'Amsterdam, 1653. Le premier marché boursier moderne du monde.</figcaption>
        </figure>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre comment les instruments financières ont émerge dans différentes civilisations</li>
            <li>Analyser le role de la Route de la Soie dans le développement de la finance internationale</li>
            <li>Comparer les systèmes financières antiques (Mésopotamie, Rome, Chine, Islam)</li>
            <li>Maîtriser les innovations majeures : prime de risque, responsabilité limitée, marché secondaire</li>
            <li>Expliquer pourquoi la VOC est considèree comme la première société par actions moderne</li>
            <li>Décrypter les mécanismes psychologiques des bulles spéculatives</li>
            <li>Établir des parallèles entre les crises historiques et contemporaines</li>
        </ul>

        <div class="box">
            <h4>Pourquoi étudier l'histoire de la finance ?</h4>
            <p>Comme l'a écrit Mark Twain : "L'histoire ne se répète pas, mais elle rime." Les mécanismes fondamentaux de la finance - la gestion du risque, le transfert de valeur dans le temps, la psychologie des marchés - sont remarquablement constants à travers les époques. Un quant qui comprend l'histoire peut mieux anticiper les crises futures car il reconnaît les patterns récurrents. Les régulateurs de 2008 auraient gagne a connaître la faillite des Bardi et Peruzzi en 1343, première crise bancaire systémique de l'histoire.</p>
        </div>

        <h2>Timeline : 4000 Ans de Finance Mondiale</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">2000 av. J.-C.</div>
                <div class="timeline-text"><strong>Mésopotamie</strong> - Premiers prêts a intérêt documentes sur tablettes d'argile</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1754 av. J.-C.</div>
                <div class="timeline-text">Code de Hammurabi - Premières lois régissant le crédit (taux max: argent 20%, grain 33%)</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">600 av. J.-C.</div>
                <div class="timeline-text"><strong>Lydie (Turquie)</strong> - Première monnaie métallique standardisée (electrum)</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">300 av. J.-C.</div>
                <div class="timeline-text"><strong>Rome</strong> - Argentarii (banquiers) et Sociétates Publicanorum (proto-sociétés)</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">622</div>
                <div class="timeline-text"><strong>Islam</strong> - Debut de la finance islamique (interdiction du riba, contrats mudaraba)</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">806</div>
                <div class="timeline-text"><strong>Chine Tang</strong> - Feiqi : premiers billets de dépôt (proto-papier-monnaie)</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1024</div>
                <div class="timeline-text"><strong>Chine Song</strong> - Jiaozi : premier papier-monnaie officiel au monde</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1200-1300</div>
                <div class="timeline-text"><strong>Foires de Champagne</strong> - Naissance de la lettre de change internationale</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1343</div>
                <div class="timeline-text"><strong>Florence</strong> - Faillite des Bardi et Peruzzi : première crise bancaire systémique</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1397-1494</div>
                <div class="timeline-text"><strong>Banque des Medicis</strong> - Comptabilité moderne et réseau de succursales</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1609</div>
                <div class="timeline-text"><strong>Wisselbank Amsterdam</strong> - Première banque centrale de réserve</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1602</div>
                <div class="timeline-text">VOC - Première société par actions avec marché secondaire</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1637</div>
                <div class="timeline-text">Tulipomanie - Première bulle spéculative documentee (crash de 90%)</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1688</div>
                <div class="timeline-text">Joseph de la Vega - "Confusion de Confusiones", premier livre de finance comportementale</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1694</div>
                <div class="timeline-text">Bank of England - Modele de banque centrale moderne</div>
            </div>
        </div>

        <h2>Partie I : Finance du Monde Antique</h2>

        <p>La finance est apparue indépendamment dans plusieurs civilisations, répondant a des besoins universels :</p>
        <ul>
            <li>Financer le commerce</li>
            <li>Gérer les récoltes incertaines</li>
            <li>Transférer de la valeur dans le temps</li>
        </ul>

        <h3>1.1 Mésopotamie : Le Berceau de la Finance (2000-500 av. J.-C.)</h3>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/6/64/P1050763_Louvre_code_Hammurabi_face_rwk.JPG" alt="Code Hammurabi">
            <figcaption>Stèle du Code de Hammurabi (1754 av. J.-C.) - Musée du Louvre, Paris</figcaption>
        </figure>

        <p>Les plus anciens documents financières connus datent de 2000 av. J.-C. en Mésopotamie (actuel Irak).</p>

        <p>Des milliers de tablettes d'argile contiennent :</p>
        <ul>
            <li><span class="text-red">Contrats de prêts</span></li>
            <li><span class="text-red">Reconnaissances de dette</span></li>
            <li><span class="text-red">Contrats à terme</span> sur les récoltes - les premiers "forwards" !</li>
        </ul>

        <div class="box">
            <h4>Les Temples = Premières Banques</h4>
            <p>Le temple de Shamash a Sippar fonctionnait comme une banque :</p>
            <ul>
                <li>Dépôts de grain et d'argent</li>
                <li>Prets aux caravanes commerciales</li>
                <li>Comptabilité sur tablettes d'argile</li>
            </ul>
            <p style="margin-top: 10px;">Le mot <em>mash</em> (intérêt en sumérien) signifie littéralement "la progéniture" - l'argent qui engendré de l'argent.</p>
        </div>

        <div class="box">
            <h4>Code de Hammurabi - 1754 av. J.-C.</h4>
            <p>Premières lois écrites régissant le crédit. Le roi Hammurabi de Babylone codifie les pratiques existantes :</p>
            <table>
                <tr>
                    <th>Type de pret</th>
                    <th>Taux maximum annuel</th>
                    <th>Justification économique</th>
                </tr>
                <tr>
                    <td>Argent (shekel)</td>
                    <td>20%</td>
                    <td>Actif stable, facile a stocker</td>
                </tr>
                <tr>
                    <td>Grain (orge)</td>
                    <td>33%</td>
                    <td>Perissable, couts de stockage</td>
                </tr>
            </table>
            <p style="margin-top: 15px; font-size: 14px; color: var(--text-muted);">Source : Tablettes cuneiformes, British Museum et Louvre. Voir aussi "Silver and Money in Mesopotamia" (Powell, 1996).</p>
        </div>

        <div class="box">
            <h4>Concept Fondamental : Prime de Risque</h4>
            <p>La différence de 13 points de pourcentage (33% - 20%) entre le grain et l'argent est la première <span class="text-red">prime de risque</span> documentee de l'histoire.</p>
            <p><strong>Définition :</strong> Un rendement supplémentaire exige par les preteurs pour compenser un risque plus élevé. Cette différence reflète :</p>
            <ul>
                <li><strong>Risque de périssabilité</strong> : le grain peut pourrir, être attaque par des insectes où des rongeurs</li>
                <li><strong>Cout de stockage</strong> : le grain nécessité des greniers secs et sécurisés</li>
                <li><strong>Risque de vol</strong> : plus facile a derober que les métaux precieux</li>
                <li><strong>Risque de qualité</strong> : la qualité du grain peut se degrader avec le temps</li>
            </ul>
            <p style="margin-top: 15px;">Ce concept est toujours central en finance moderne : les obligations "junk" (high yield) offrent 4-8% de plus que les obligations d'Etat, les actions de marchés émergents ont des rendements attendus supérieurs de 3-5% aux marchés développés. La prime de risque actions (ERP) historique aux Etats-Unis est d'environ 4-6% au-dessus des bons du Tresor.</p>
        </div>

        <h4>Comparaison Historique des Primes de Risque</h4>

        <div class="chart-container">
            <canvas id="primeRisqueChart"></canvas>
        </div>

        <p>Le graphique ci-dessus montre la remarquable constance des primes de risque à travers l'histoire. Meme si les actifs changent (grain, prêts maritimes, obligations), le mécanisme fondamental reste identique : plus de risque = plus de rendement exige.</p>

        <h3>1.2 Finance Greco-Romaine : Naissance des Institutions (600 av. J.-C. - 400 ap. J.-C.)</h3>

        <p>Les Grecs et les Romains ont hérité des pratiques mesopotamiennes via les routes commerciales, mais ils ont développé des innovations institutionnelles majeures qui préfigurent la finance moderne.</p>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/5/58/Imitation_of_Athenian_silver_tetradrachm_-_350-300_BC_-_head_of_Athena_-_owl_-_Berlin_MK_AM.jpg" alt="Tetradrachme athenien">
            <figcaption>Tetradrachme athenien (350-300 av. J.-C.) - La chouette d'Athènes etait la monnaie de référence en Mediterranee. Les trapezites (banquiers) changeaient ces pieces contre d'autrès devises.</figcaption>
        </figure>

        <h4>Grèce : Les Trapezites</h4>
        <p>Au Ve siècle av. J.-C., les <span class="text-red">trapezites</span> (du grec <em>trapeza</em> = table) étaient des banquiers professionnels opérant dans les agoras d'Athènes, de Corinthe et de Delos. Ils acceptaient les dépôts, changeaient les monnaies (chaque cité avait la sienne), et accordaient des prêts maritimes - les <span class="text-red">nautika daneia</span>.</p>

        <div class="box">
            <h4>Définition : Pret à la Grosse Aventure (Nautikon Daneion)</h4>
            <p>Pret maritime où le remboursement est conditionnel a l'arrivée du navire. Si le navire fait naufrage, le prêt est annulé - c'est une forme primitive d'<span class="text-red">assurance maritime</span>.</p>
            <p><strong>Taux typiques :</strong> 22-30% pour un voyage de quelques mois (Athènes-Égypte). Ces taux élevés reflètent le risque considérable : on estime qu'un navire sur dix ne revenait jamais.</p>
            <p><strong>Application moderne :</strong> Ce concept préfigure les Cat Bonds (obligations catastrophe) où le principal est perdu si un événement spécifique survient.</p>
        </div>

        <h4>Rome : Les Argentarii et les Sociétates</h4>
        <p>Rome a développé un système financière encore plus sophistiqué. Les <span class="text-red">argentarii</span> (banquiers) tenaient des comptes courants, effectuaient des virements scripturaux (<em>perscriptio</em>), et accordaient du crédit. Mais l'innovation la plus remarquable est la <span class="text-red">Societas Publicanorum</span> - la première "société par actions" de l'histoire.</p>

        <div class="box">
            <h4>Les Sociétates Publicanorum : Proto-Sociétés Romaines</h4>
            <p>Ces sociétés, formées pour collecter les impôts et exploiter les ressources publiques (mines, construction), avaient plusieurs caractéristiques modernes :</p>
            <ul>
                <li><span class="text-red">Partes (actions)</span> : les parts pouvaient être vendues a des tiers</li>
                <li><span class="text-red">Personnalité juridique</span> : la societas existait indépendamment de ses membres</li>
                <li><span class="text-red">Dividendes</span> : les profits étaient distribués aux détenteurs de partes</li>
            </ul>
            <p>Ciceron mentionne que les partes de la Societas qui exploitait les mines d'Espagne étaient activement échangees au Forum. On estime que jusqu'à 5% de la population romaine adulte détenait des partes dans une forme où une autre.</p>
            <p style="margin-top: 10px;"><strong>Différence avec la VOC :</strong> Les sociétates romaines n'avaient pas de responsabilité limitée complète et dépendaient de la survie de leurs membres fondateurs. La VOC résoudra ces deux problèmes 1600 ans plus tard.</p>
        </div>

        <h3>1.3 Finance Islamique : Innovation sous Contrainte (VIIe - XVe siècle)</h3>

        <p>L'expansion de l'Islam au VIIe siècle a créé un vaste espace économique de l'Espagne a l'Indonésie. Mais les juristes musulmans devaient réconcilier les pratiques commerciales avec l'interdiction coranique du <span class="text-red">riba</span> (usure/intérêt). Cette contrainte a engendré des innovations financières remarquables qui influencent encore la finance mondiale aujourd'hui.</p>

        <div class="box">
            <h4>L'Interdiction du Riba</h4>
            <p>Le Coran interdit explicitement le riba (sourate 2:275-280). Mais comment financer le commerce sans intérêt ? Les juristes ont développé des structures alternatives basées sur le <span class="text-red">partage des risques</span> plutôt que sur le transfert du risque :</p>
        </div>

        <div class="grid-2">
            <div class="grid-item">
                <h4><span class="text-red">Mudaraba</span> (Commandite)</h4>
                <p>Un investisseur (<em>rabb al-mal</em>) fournit le capital, un entrepreneur (<em>mudarib</em>) fournit le travail. Les profits sont partagés selon un ratio convenu, mais les pertes sont supportées uniquement par l'investisseur.</p>
                <p><strong>Équivalent moderne :</strong> Venture Capital, Private Equity (carried interest)</p>
            </div>
            <div class="grid-item">
                <h4><span class="text-red">Musharaka</span> (Partenariat)</h4>
                <p>Plusieurs partenaires contribuent capital et/ou travail. Profits et pertes sont partagés proportionnellement aux contributions.</p>
                <p><strong>Équivalent moderne :</strong> Joint Venture, Partnership</p>
            </div>
            <div class="grid-item">
                <h4><span class="text-red">Hawala</span> (Transfert)</h4>
                <p>Système de transfert de fonds sans déplacement physique d'argent. Un agent a Bagdad paie un marchand sur présentation d'un code, et se fait rembourser par l'agent de Cordoue.</p>
                <p><strong>Équivalent moderne :</strong> Western Union, SWIFT</p>
            </div>
            <div class="grid-item">
                <h4><span class="text-red">Sukuk</span> (Certificats)</h4>
                <p>Certificats représentant une part de propriété dans un actif tangible. Les rendements proviennent de l'utilisation de l'actif, non de l'intérêt.</p>
                <p><strong>Équivalent moderne :</strong> Asset-Backed Securities, Sukuk moderne (~800 milliards USD en 2024)</p>
            </div>
        </div>

        <h4>Croissance de la Finance Islamique</h4>

        <div class="chart-container">
            <canvas id="islamicFinanceChart"></canvas>
        </div>

        <p style="margin-top: 20px;">La finance islamique représente aujourd'hui environ 3 000 milliards USD d'actifs et croit de 10-12% par an. Les grandes banques occidentales (HSBC, Standard Chartered, Citi) ont toutes des divisions de finance islamique. Cette industrie demontre qu'il est possible de creer des instruments financières sophistiqués sous des contraintes ethiques strictes.</p>

        <h3>1.4 Finance Chinoise : Le Papier-Monnaie (VIIIe - XIVe siècle)</h3>

        <p>Pendant que l'Europe utilisait encore des pieces de métal, la Chine inventait le papier-monnaie - l'une des innovations financières les plus importantes de l'histoire humaine.</p>

        <p>Cette invention est indissociable de :</p>
        <ul>
            <li>L'invention du papier (IIe siècle)</li>
            <li>L'invention de l'imprimerie (VIIIe siècle)</li>
        </ul>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/d/d9/Jiao_zi.jpg" alt="Jiaozi chinois">
            <figcaption>Jiaozi de la dynastie Song (XIe siècle) - Premier papier-monnaie officiel de l'histoire, 600 ans avant l'Europe.</figcaption>
        </figure>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">806</div>
                <div class="timeline-text">Feiqi - "Monnaie volante" : certificats de dépôt émis par le gouvernement Tang pour eviter le transport de lourdes pieces de cuivre sur les routes</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1024</div>
                <div class="timeline-text">Jiaozi - Premier papier-monnaie officiel au monde, émis par le gouvernement Song dans la province du Sichuan</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1260</div>
                <div class="timeline-text">Chao - Monnaie fiduciaire de Kubilai Khan (dynastie Yuan), décrite par Marco Polo comme "l'alchimie du Grand Khan"</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1375</div>
                <div class="timeline-text"><strong>Hyperinflation Ming</strong> - Emission excèssive entrainant un effondrement de la valeur et l'abandon du papier-monnaie</div>
            </div>
        </div>

        <blockquote>
            <p>"De cette manière, le Grand Khan fait fabriquer en quantité telle cette monnaie qu'il pourrait acheter tout le trèsor du monde. Et avec cette monnaie, il fait faire tous les paiements et la fait accepter par toutes les provinces et royaumes."</p>
            <cite>Marco Polo, Le Devisement du monde, 1298</cite>
        </blockquote>

        <div class="box">
            <h4>Lecon : La Première Hyperinflation</h4>
            <p>L'experience chinoise illustre parfaitement les dangers de la monnaie fiduciaire sans discipline. Entre 1350 et 1450, les empereurs Ming ont imprime des quantités massives de billets pour financer les guerres et les constructions. Resultat : la valeur du papier-monnaie a chute de 99.9%.</p>
            <p>Cette lecon sera oubliee et reapprise de nombreuses fois : assignats francais (1789-1796), mark allemand (1922-1923), bolivar venezuelien (2016-present). La création monétaire excèssive sans contrépartie productive conduit inevitablement a l'inflation.</p>
        </div>

        <h3>1.5 La Route de la Soie : Finance du Commerce International</h3>

        <p>La Route de la Soie n'etait pas une route unique mais un réseau de routes commerciales reliant :</p>
        <ul>
            <li>La Chine à la Mediterranee</li>
            <li>Via l'Asie centrale, l'Inde et le Moyen-Orient</li>
        </ul>

        <p>Ce réseau a nécessité le développement d'instruments financières pour gérer :</p>
        <ul>
            <li>Distances : 3-4 ans pour un aller-retour complet</li>
            <li>Risques : brigands, maladies, naufrages</li>
            <li>Monnaies multiples : dizaines de devises différentes</li>
        </ul>

        <div class="box">
            <h4>Chiffres de la Route de la Soie</h4>
            <table>
                <tr>
                    <th>Metrique</th>
                    <th>Valeur</th>
                </tr>
                <tr>
                    <td>Distance Changan (Xi'an) - Constantinople</td>
                    <td>~8,000 km</td>
                </tr>
                <tr>
                    <td>Durée d'un voyage aller</td>
                    <td>12-18 mois</td>
                </tr>
                <tr>
                    <td>Taux de pertes (marchandises)</td>
                    <td>10-30%</td>
                </tr>
                <tr>
                    <td>Marge brute sur la soie</td>
                    <td>~300%</td>
                </tr>
                <tr>
                    <td>Periode d'activité maximale</td>
                    <td>100 av. J.-C. - 1450 ap. J.-C.</td>
                </tr>
            </table>
        </div>

        <p>Les marchands de la Route de la Soie ont développé des techniques pour mutualiser les risques : <strong>commenda</strong> (partenariat entre investisseur sedentaire et marchand itinerant), lettrès de crédit acceptees dans les caravanserails de Samarkand a Antioche, et réseaux familiaux ou ethniques (Sogdiens, Juifs Radhanites, Armeniens) servant de garantes informelles.</p>

        <h2>Partie II : La Renaissance Financiere Italienne (1300-1600)</h2>

        <p>Entre le XIIIe et le XVIe siècle, les cités-Etats italiennes ont transforme la finance europeenne :</p>
        <ul>
            <li>Florence, Venise, Genes et Milan étaient les centrès financières les plus avances du monde</li>
            <li>Developpement de techniques adoptees par Amsterdam, Londres et New York</li>
            <li>Innovations majeures, mais aussi première crise bancaire systémique</li>
        </ul>

        <h3>2.1 La Faillite des Bardi et Peruzzi (1343) : Première Crise Systemique</h3>

        <p>Avant les Medicis, les super-compagnies de Florence - les Bardi et les Peruzzi - dominaient la finance europeenne :</p>
        <ul>
            <li>Actifs combines supérieurs au budget annuel du royaume d'Angleterre</li>
            <li>Leur chute illustre un mécanisme qui se répètera à travers l'histoire</li>
        </ul>

        <div class="box">
            <h4>Anatomie de la Crise de 1343</h4>
            <table>
                <tr>
                    <th>Element</th>
                    <th>Detail</th>
                </tr>
                <tr>
                    <td>Debiteur principal</td>
                    <td>Edouard III d'Angleterre</td>
                </tr>
                <tr>
                    <td>Montant des prêts</td>
                    <td>~1.5 million de florins (Bardi: 900k, Peruzzi: 600k)</td>
                </tr>
                <tr>
                    <td>Usage des fonds</td>
                    <td>Financement de la Guerre de Cent Ans</td>
                </tr>
                <tr>
                    <td>Cause du défaut</td>
                    <td>Edouard III declare ne pas pouvoir rembourser (1340)</td>
                </tr>
                <tr>
                    <td>Conséquence</td>
                    <td>Faillite des Bardi (1343), Peruzzi (1343), puis 80% des banques florentines</td>
                </tr>
            </table>
            <p style="margin-top: 15px;"><strong>Lecon moderne :</strong> La concentration du risque sur un seul débiteur, même souverain, peut detruire une institution financière. Les régulateurs modernes imposent des limites de concentration pour eviter ce scenario.</p>
        </div>

        <h3>2.2 Les Medicis : La Banque Moderne (1397-1494)</h3>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Cosimo_di_Medici_%28Bronzino%29.jpg" alt="Cosimo de Medici">
            <figcaption>Cosimo de Medicis (1389-1464) par Bronzino. Sous sa direction, la banque atteint son apogee avec des succursales dans 9 villes europeennes.</figcaption>
        </figure>

        <p>Giovanni di Bicci de' Medici fonde le Banco Medici en 1397, cinquante ans après la faillite des Bardi.</p>

        <p>Il tire les lecons de leurs erreurs :</p>
        <ul>
            <li>Diversification geographique</li>
            <li>Structure decentralisee</li>
            <li>Prudence dans les prêts aux souverains</li>
        </ul>

        <p>Sous son fils Cosimo puis son petit-fils Lorenzo le Magnifique, la banque devient la plus puissante d'Europe.</p>

        <div class="box">
            <h4>Le Reseau Medicis à son Apogee (1458)</h4>
            <table>
                <tr>
                    <th>Ville</th>
                    <th>Fonction principale</th>
                    <th>Manager</th>
                </tr>
                <tr>
                    <td>Florence</td>
                    <td>Siege social, operations locales</td>
                    <td>Giovanni d'Amerigo Benci</td>
                </tr>
                <tr>
                    <td>Rome</td>
                    <td>Gestion des fonds du Vatican</td>
                    <td>Roberto Martelli</td>
                </tr>
                <tr>
                    <td>Venise</td>
                    <td>Commerce avec l'Orient</td>
                    <td>Alessandro Martelli</td>
                </tr>
                <tr>
                    <td>Milan</td>
                    <td>Commerce textile</td>
                    <td>Pigello Portinari</td>
                </tr>
                <tr>
                    <td>Bruges</td>
                    <td>Commerce laine anglaise</td>
                    <td>Tommaso Portinari</td>
                </tr>
                <tr>
                    <td>Londres</td>
                    <td>Achat de laine brute</td>
                    <td>Gerozzo de' Pigli</td>
                </tr>
                <tr>
                    <td>Avignon</td>
                    <td>Ancienne Curie papale</td>
                    <td>Francesco Sassetti</td>
                </tr>
                <tr>
                    <td>Geneve/Lyon</td>
                    <td>Foires de change</td>
                    <td>Francesco Sassetti</td>
                </tr>
            </table>
        </div>

        <h4>Les Innovations des Medicis</h4>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Structure en Holding</h4>
                <p>Chaque succursale est une entité juridique separee. Si Bruges fait faillite, Florence est protegee. C'est la première application du principe de <span class="text-red">responsabilité limitée</span> a une structure bancaire.</p>
            </div>
            <div class="grid-item">
                <h4>Diversification</h4>
                <p>Revenus provenant de multiples sources : change, dépôts, prêts commerciaux, commerce de laine, soie et epices, mines d'alun. Aucune source ne depasse 30% des profits.</p>
            </div>
            <div class="grid-item">
                <h4>Lettre de Change</h4>
                <p>Permet de transférer des fonds entre villes sans transport physique d'or. Integre egalement une operation de change qui contourne l'interdiction de l'intérêt.</p>
            </div>
            <div class="grid-item">
                <h4>Comptabilité Moderne</h4>
                <p>Utilisation systématique de la <span class="text-red">partie double</span>, bilans annuels, et reporting régulier au siege. Giovanni di Bicci exigeait des rapports trimestriels de chaque succursale.</p>
            </div>
        </div>

        <div class="box">
            <h4>Définition : Comptabilité en Partie Double</h4>
            <p>Système ou chaque transaction est enregistree simultanement dans <strong>deux comptes</strong> :</p>
            <ul>
                <li><strong>Debit</strong> : augmentation des actifs ou diminution des passifs</li>
                <li><strong>Credit</strong> : diminution des actifs ou augmentation des passifs</li>
            </ul>
            <p><strong>Equation fondamentale :</strong> Actifs = Passifs + Capitaux Propres</p>
            <p><strong>Verification :</strong> Total des debits = Total des crédits. Toute inégalité signale une erreur où une fraude.</p>
            <p style="margin-top: 15px;">Formalisee par Luca Pacioli en 1494 dans <em>Summa de arithmetica</em> (chapitre "De computis et scripturis"), ami de Leonard de Vinci. Cette méthode est utilisee par 100% des entreprises du monde depuis plus de 500 ans - c'est peut-être l'innovation organisationnelle la plus durable de l'histoire.</p>
        </div>

        <div class="box">
            <h4>La Lettre de Change : Contourner l'Interdiction de l'Usure</h4>
            <p>L'Eglise interdisait le prêt a intérêt aux chretiens (usure). Les banquiers italiens ont invente un système ingénieux :</p>
            <ol>
                <li>Un marchand florentin depose 100 florins a Florence</li>
                <li>Il recoit une lettre de change payable en ecus a Lyon dans 3 mois</li>
                <li>A Lyon, il recoit l'équivalent de 103 florins en ecus</li>
                <li>Le "profit" de 3% n'est pas de l'intérêt, mais le résultat de l'operation de change</li>
            </ol>
            <p>Ce mécanisme, appele <strong>cambium</strong>, permettait de facturer effectivement un intérêt (5-15% annualise) tout en respectant formellement l'interdiction de l'usure. Les theologiens debattront de sa licité pendant 300 ans.</p>
        </div>

        <h2>Partie III : Le Siecle d'Or Neerlandais (1580-1700)</h2>

        <p>Apres la chute d'Anvers (1585) sous la domination espagnole, Amsterdam hérité de son role de centre commercial.</p>

        <p>Les refugies protestants apportent :</p>
        <ul>
            <li>Capital accumule</li>
            <li>Expertise commerciale et bancaire</li>
            <li>Reseaux commerciaux internationaux</li>
        </ul>

        <p>En quelques décennies, les Provinces-Unies deviennent la première économie mondiale per capita et inventent les institutions du capitalisme moderne.</p>

        <h3>3.1 La Wisselbank (1609) : Première Banque Centrale</h3>

        <p>Avant d'aborder la VOC, il faut comprendre l'infrastructure financière qui l'a rendue possible. La Wisselbank (Banque d'échange) d'Amsterdam, fondee en 1609, est considèree comme la première banque centrale moderne.</p>

        <div class="box">
            <h4>Fonctions de la Wisselbank</h4>
            <ul>
                <li><strong>Standardisation monétaire</strong> : Creation du "florin banco", unite de compte stable</li>
                <li><strong>Dépôts sécurisés</strong> : Conservation des métaux precieux des marchands</li>
                <li><strong>Virements scripturaux</strong> : Transferts entre comptes sans mouvement physique d'especes</li>
                <li><strong>Clearing house</strong> : Compensation des lettrès de change entre banques</li>
            </ul>
            <p style="margin-top: 15px;">La Wisselbank a fonctionne pendant pres de 200 ans (1609-1820) sans crise majeure. Elle servira de modèle à la Bank of England (1694) et a toutes les banques centrales modernes.</p>
        </div>

        <h3>3.2 La VOC : Naissance de la Societe par Actions (1602)</h3>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/2/26/VOC_Amsterdam.jpg" alt="VOC Amsterdam">
            <figcaption>Navire de retour de la VOC (Vereenigde Oostindische Compagnie). A son apogee : 200 navires et 50,000 employes.</figcaption>
        </figure>

        <p>Le commerce des epices avec l'Asie etait extraordinairement lucratif :</p>
        <ul>
            <li>Poivre : achete 1 florin a Java, vendu 10 florins a Amsterdam</li>
            <li>Risque extreme : voyages de 18 mois, naufrages, pirates, maladies</li>
            <li>Estimation : 1 navire sur 3 ne revenait jamais</li>
        </ul>

        <p>Aucun marchand ne pouvait supporter seul ce risque. La solution ? Regrouper les capitaux de toute une nation.</p>

        <div class="box">
            <h4>20 mars 1602 - Une Date qui Change le Monde</h4>
            <p class="big-number" style="font-size: 48px; margin: 20px 0;">VOC</p>
            <p>Vereenigde Oostindische Compagnie (Compagnie unie des Indes orientales)</p>
            <p>Les États-Généraux des Provinces-Unies fusionnent 6 compagnies commerciales rivales en une seule entité avec monopole du commerce asiatique. Capital initial : 6.4 millions de florins, levé auprès de 1,800 investisseurs de toutes classes sociales.</p>
            <p style="margin-top: 15px;"><strong>Pourquoi c'est révolutionnaire :</strong> Pour la première fois dans l'histoire, des milliers de citoyens ordinaires peuvent devenir propriétaires d'une partie d'une grande entreprise.</p>
        </div>

        <h4>Les 4 Innovations Juridiques de la VOC</h4>

        <div class="grid-2">
            <div class="grid-item">
                <h4>1. Actions Transférables</h4>
                <p>Les parts (<em>aandelen</em>) peuvent être vendues a n'importe qui, n'importe quand, sans l'accord des fondateurs ni des autrès actionnaires. L'investisseur n'est jamais "piégé" : s'il a besoin de liquidités, il vend ses actions.</p>
                <p><strong>Différence avec Rome :</strong> Les partes des sociétates romaines nécessitaient souvent l'accord des autrès associés pour être transférées.</p>
            </div>
            <div class="grid-item">
                <h4>2. Responsabilité Limitée</h4>
                <p>L'actionnaire ne risque que sa mise initiale. Si la VOC fait faillite (elle finira par le faire en 1799), les créanciers ne peuvent pas saisir les biens personnels des actionnaires.</p>
                <p><strong>Impact :</strong> Encourage la prise de risque. Un marchand peut investir son épargne sans craindre de tout perdre.</p>
            </div>
            <div class="grid-item">
                <h4>3. Durée Indéfinie</h4>
                <p>Contrairement aux compagnies précédentes qui se dissolvaient après chaque expédition, la VOC est constituée pour 21 ans (renouvelable). Les investissements s'inscrivent dans le long terme.</p>
                <p><strong>Conséquence :</strong> La VOC peut planifier, construire des comptoirs permanents, négocier des traités.</p>
            </div>
            <div class="grid-item">
                <h4>4. Marche Secondaire</h4>
                <p>A partir de 1602, les actions s'échangent sur le Rokin (quai) puis dans la Bourse d'Amsterdam (1611). Les prix fluctuent en continu selon l'offre et la demande.</p>
                <p><strong>Innovation :</strong> Premier marché où les prix reflettent les anticipations collectives sur la valeur future de l'entreprise.</p>
            </div>
        </div>

        <h4>Chiffres de la VOC</h4>

        <table>
            <tr>
                <th>Metrique</th>
                <th>Valeur</th>
                <th>Contexte</th>
            </tr>
            <tr>
                <td>Capital initial (1602)</td>
                <td>6.4 millions de florins</td>
                <td>10x le capital de la Compagnie anglaise des Indes</td>
            </tr>
            <tr>
                <td>Équivalent moderne</td>
                <td>~300-500 millions EUR</td>
                <td>Ajuste pour l'inflation et le PIB</td>
            </tr>
            <tr>
                <td>Dividende moyen</td>
                <td>18% par an</td>
                <td>1602-1782 (180 ans)</td>
            </tr>
            <tr>
                <td>Capitalisation maximale</td>
                <td>78 millions de florins</td>
                <td>~7.9 trillion USD ajuste (estimation)</td>
            </tr>
            <tr>
                <td>Employes (apogee ~1700)</td>
                <td>50 000</td>
                <td>Plus grande entreprise privee du monde</td>
            </tr>
            <tr>
                <td>Navires (apogee)</td>
                <td>~200</td>
                <td>Plus grande flotte commerciale au monde</td>
            </tr>
            <tr>
                <td>Voyages totaux</td>
                <td>4,785</td>
                <td>1602-1795</td>
            </tr>
            <tr>
                <td>Nombre d'actionnaires (1602)</td>
                <td>1,800</td>
                <td>Toutes classes sociales confondues</td>
            </tr>
        </table>

        <h4>Repartition du Capital par Chambre (1602)</h4>

        <div class="chart-container">
            <canvas id="vocChart"></canvas>
        </div>

        <p>La VOC etait organisee en 6 "Chambres" regionales. Amsterdam dominait avec 57% du capital, refletant sa position de centre commercial. Chaque Chambre gérait ses propres operations mais partageait les benefices proportionnellement.</p>

        <h3>3.3 La Bourse d'Amsterdam : Naissance du Marche Moderne</h3>

        <p>La Bourse d'Amsterdam (Amsterdamse Beurs), construite en 1611 par Hendrick de Keyser, est le premier batiment dedie exclusivement aux transactions financières. C'est ici que naissent la plupart des pratiques boursieres modernes.</p>

        <div class="box">
            <h4>Innovations de la Bourse d'Amsterdam</h4>
            <table>
                <tr>
                    <th>Innovation</th>
                    <th>Date</th>
                    <th>Équivalent moderne</th>
                </tr>
                <tr>
                    <td>Cotation continue</td>
                    <td>1602</td>
                    <td>Prix en temps reel (NYSE, NASDAQ)</td>
                </tr>
                <tr>
                    <td>Vente a decouvert (short selling)</td>
                    <td>~1609</td>
                    <td>Short selling, prêts de titrès</td>
                </tr>
                <tr>
                    <td>Options d'achat et de vente</td>
                    <td>~1620</td>
                    <td>Calls et puts (CBOE, Eurex)</td>
                </tr>
                <tr>
                    <td>Contrats a terme (forwards)</td>
                    <td>~1610</td>
                    <td>Futures (CME, ICE)</td>
                </tr>
                <tr>
                    <td>Speculation sur marge</td>
                    <td>~1620</td>
                    <td>Margin trading</td>
                </tr>
                <tr>
                    <td>Corners et short squeezes</td>
                    <td>~1630</td>
                    <td>GameStop 2021</td>
                </tr>
            </table>
        </div>

        <blockquote>
            <p>"A la Bourse d'Amsterdam se retrouvent tous ceux qui veulent acheter ou vendre des actions... on y voit des fortunes se faire et se defaire en quelques heures. Le plus ruse n'est pas toujours le plus fortune, car les spéculateurs sont comme des moutons : ils suivent le troupeau sans reflexion."</p>
            <cite>Joseph de la Vega, Confusion de Confusiones, 1688</cite>
        </blockquote>

        <div class="box">
            <h4>Joseph de la Vega : Premier Analyste Comportemental (1688)</h4>
            <p>Confusion de Confusiones est le premier livre consacre aux marchés financières. Ecrit par un marchand juif portugais refugie a Amsterdam, il décrit les pratiques de la Bourse avec une finesse psychologique remarquable.</p>
            <p>Concepts anticipes par de la Vega :</p>
            <ul>
                <li><span class="text-red">Herding behavior</span> : "Les spéculateurs suivent le troupeau"</li>
                <li><span class="text-red">FOMO</span> : "La peur de manquer la hausse"</li>
                <li><span class="text-red">Overconfidence</span> : "Chacun croit être plus malin que les autres"</li>
                <li><span class="text-red">Mean reversion</span> : "Ce qui monte excèssivement doit redescendre"</li>
            </ul>
            <p style="margin-top: 15px;">Daniel Kahneman et Amos Tversky formaliseront mathématiquement ces biais 300 ans plus tard. De la Vega les avait observes empiriquement au XVIIe siècle.</p>
        </div>

        <h2>Partie IV : La Tulipomanie (1634-1637) - Anatomie d'une Bulle</h2>

        <p>Trente-cinq ans après la création de la VOC, les Pays-Bas connaissent leur première crise financière majeure.</p>

        <p>La Tulipomanie est la première bulle spéculative complètement documentee de l'histoire. Son étude est essentielle car elle illustre les mécanismes psychologiques qui se reproduiront dans toutes les bulles futures :</p>
        <ul>
            <li>Compagnie du Mississippi (1720)</li>
            <li>Bulle Internet (2000)</li>
            <li>Cryptomonnaies (2017, 2021)</li>
        </ul>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/c/cc/Semper_Augustus_Tulip_17th_century.jpg" alt="Semper Augustus">
            <figcaption>Semper Augustus - La tulipe la plus chere de l'histoire. Cette aquarelle du XVIIe siècle montre les motifs "flammes" causes par un virus qui rendaient chaque bulbe unique.</figcaption>
        </figure>

        <h3>4.1 Contexte : Pourquoi les Tulipes ?</h3>

        <p>Les tulipes (<em>Tulipa</em>) sont originaires des montagnes d'Asie centrale :</p>
        <ul>
            <li>Importees a Vienne en 1554 par l'ambassadeur Ogier de Busbecq</li>
            <li>Arrivee aux Pays-Bas en 1593 via le botaniste Carolus Clusius</li>
            <li>Deviennent immediatement un symbole de statut</li>
        </ul>

        <p>Ce qui rend certaines tulipes extraordinairement precieuses est un phénomène biologique : le virus de la mosaique de la tulipe.</p>

        <p>Ce virus, transmis par les pucerons :</p>
        <ul>
            <li>Provoque des motifs irréguliers de couleurs ("flammes", "plumes")</li>
            <li>Rend chaque bulbe unique</li>
            <li>Ces varietes "brisees" (<em>broken</em>) étaient impossibles a reproduire</li>
        </ul>

        <div class="box">
            <h4>Classification des Tulipes (XVIIe siècle)</h4>
            <table>
                <tr>
                    <th>Categorie</th>
                    <th>Caracteristiques</th>
                    <th>Prix relatif</th>
                </tr>
                <tr>
                    <td><strong>Couleren</strong></td>
                    <td>Tulipes unicolores (rouge, jaune)</td>
                    <td>1x (référence)</td>
                </tr>
                <tr>
                    <td><strong>Rosen</strong></td>
                    <td>Flammes rouges/roses sur fond blanc</td>
                    <td>10-50x</td>
                </tr>
                <tr>
                    <td><strong>Violetten</strong></td>
                    <td>Flammes violettes/pourpres sur blanc</td>
                    <td>50-100x</td>
                </tr>
                <tr>
                    <td><strong>Bizarden</strong></td>
                    <td>Flammes rouges/brunes sur jaune</td>
                    <td>100-500x</td>
                </tr>
                <tr>
                    <td>Semper Augustus</td>
                    <td>Flammes rouges sur blanc, très rare</td>
                    <td>1000x+</td>
                </tr>
            </table>
        </div>

        <h3>4.2 Mecanismes de la Bulle</h3>

        <p>Plusieurs facteurs ont créé les conditions de la bulle :</p>

        <div class="grid-2">
            <div class="grid-item">
                <h4>1. Prosperite générale</h4>
                <p>Le "Siecle d'Or" neerlandais : la VOC génère des fortunes, la classe moyenne s'enrichit. L'argent disponible cherche des placements.</p>
            </div>
            <div class="grid-item">
                <h4>2. Rarete artificielle</h4>
                <p>Les varietes "brisees" sont rares et imprevisibles. L'offre est rigide : un bulbe met 7-12 ans a se reproduire suffisamment.</p>
            </div>
            <div class="grid-item">
                <h4>3. Contrats a terme</h4>
                <p>Les bulbes se vendent de novembre a mai (période de dormance) via des contrats écrits. On peut spéculer sans possèder le bulbe physiquement.</p>
            </div>
            <div class="grid-item">
                <h4>4. Effet de levier</h4>
                <p>Les contrats se vendent avec un acompte de 10-20% seulement. Un spéculateur peut controler pour 1000 florins de bulbes avec 100 florins.</p>
            </div>
        </div>

        <h3>4.3 L'Explosion des Prix (1636-1637)</h3>

        <div class="box">
            <h4>Prix d'un bulbe Semper Augustus au sommet</h4>
            <p class="big-number">10 000</p>
            <p>florins (février 1637)</p>
            <table>
                <tr>
                    <td>Équivalent</td>
                    <td>10 ans de salaire d'un artisan qualifie</td>
                </tr>
                <tr>
                    <td>Équivalent</td>
                    <td>1 maison bourgeoise sur les canaux d'Amsterdam</td>
                </tr>
                <tr>
                    <td>Équivalent moderne</td>
                    <td>~500 000 EUR pour un bulbe de fleur</td>
                </tr>
            </table>
        </div>

        <h3>Evolution des prix</h3>

        <div class="chart-container">
            <canvas id="tulipChart"></canvas>
        </div>

        <p>Le graphique ci-dessus montre l'acceleration vertigineuse des prix fin 1636, suivie de l'effondrement brutal de fevrier 1637. En quelques jours, les prix ont chute de 90%. Le déclencheur ? Une vente aux encheres a Haarlem où aucun acheteur ne s'est présente. La panique s'est propagee instantanement.</p>

        <h3>Les 4 phases d'une bulle</h3>

        <p>L'economiste Hyman Minsky a formalise les phases typiques d'une bulle spéculative. La Tulipomanie les illustre parfaitement :</p>

        <div class="flow">
            <div class="flow-item">
                <strong>1. Naissance</strong>
                <span>Nouvel actif attrayant</span>
            </div>
            <div class="flow-arrow">—</div>
            <div class="flow-item">
                <strong>2. Euphorie</strong>
                <span>Prix montent, FOMO</span>
            </div>
            <div class="flow-arrow">—</div>
            <div class="flow-item">
                <strong>3. Manie</strong>
                <span>"Cette fois c'est diffèrent"</span>
            </div>
            <div class="flow-arrow">—</div>
            <div class="flow-item">
                <strong>4. Crash</strong>
                <span>Panique, -90%</span>
            </div>
        </div>

        <div class="box">
            <h4>Les 5 caractéristiques universelles d'une bulle</h4>
            <p>Ces éléments se retrouvent dans TOUTES les bulles de l'histoire, de 1637 a 2021 :</p>
            <ol>
                <li><strong>Nouvel actif ou technologie</strong> - tulipes, chemins de fer, internet, crypto... quelque chose de "révolutionnaire" et difficile a évaluer</li>
                <li><strong>Acces facile au crédit / levier</strong> - contrats a terme en 1637, margin trading en 2021</li>
                <li><strong>Marche liquide</strong> - facile d'acheter et vendre, ce qui accelere la spéculation</li>
                <li><strong>Croyance en la hausse perpetuelle</strong> - "les prix ne peuvent que monter"</li>
                <li><strong>Effondrement brutal</strong> - quand les acheteurs disparaissent, il n'y a plus de prix</li>
            </ol>
        </div>

        <h3>Comparaison avec les bulles modernes</h3>

        <h4>Amplitude des Crashes</h4>

        <div class="chart-container">
            <canvas id="bubbleCompareChart"></canvas>
        </div>

        <p>Le tableau suivant montré que malgre 400 ans d'ecart, les mécanismes des bulles n'ont pas change. Seuls les actifs sont différents :</p>

        <table>
            <tr>
                <th></th>
                <th>Tulipomanie</th>
                <th>Bulle Internet</th>
                <th>Bitcoin</th>
            </tr>
            <tr>
                <td>Annee</td>
                <td>1637</td>
                <td>2000</td>
                <td>2021-22</td>
            </tr>
            <tr>
                <td>Actif</td>
                <td>Bulbes de tulipes</td>
                <td>Actions technologiques</td>
                <td>Cryptomonnaies</td>
            </tr>
            <tr>
                <td>Promesse</td>
                <td>"Beaute eternelle"</td>
                <td>"Nouvelle économie"</td>
                <td>"Liberte financière"</td>
            </tr>
            <tr>
                <td>Chute maximale</td>
                <td><strong>-90%</strong></td>
                <td><strong>-78%</strong> (NASDAQ)</td>
                <td><strong>-77%</strong></td>
            </tr>
            <tr>
                <td>Durée de la chute</td>
                <td>Quelques jours</td>
                <td>2 ans</td>
                <td>1 an</td>
            </tr>
            <tr>
                <td>Mecanisme psychologique</td>
                <td colspan="3" style="text-align: center;"><strong>Identique : FOMO, herding, denial</strong></td>
            </tr>
        </table>

        <p>La phrase la plus dangereuse en finance : <em>"Cette fois, c'est diffèrent."</em> Elle a été prononcee avant chaque crash de l'histoire.</p>

        <h2>Partie V : Lecons pour le Quant Moderne</h2>

        <p>Que retenir de ce voyage de 4000 ans à travers l'histoire mondiale de la finance ? Six lecons fondamentales qui guideront notre comprehension tout au long de ce cours :</p>

        <div class="grid-2">
            <div class="grid-item">
                <h4>1. La Finance Resout des Problemes Reels</h4>
                <p>Chaque instrument financière répond a un besoin concret : le prêt a intérêt permet de financer les récoltes, les actions permettent de mutualiser le risque des expéditions, les derives permettent de se couvrir contre l'incertitude. Avant de modeliser un instrument, demandez-vous quel problème économique reel il resout.</p>
            </div>
            <div class="grid-item">
                <h4>2. L'Innovation a des Conséquences Imprevues</h4>
                <p>La VOC a invente les actions pour financer le commerce des epices. Conséquence imprevue : la spéculation boursiere. Les CDOs ont été crees pour diversifier le risque. Conséquence : la crise de 2008. Chaque innovation financière créé de nouveaux risques systémiques qu'il faut apprendre a gérer.</p>
            </div>
            <div class="grid-item">
                <h4>3. La Psychologie Humaine est Constante</h4>
                <p>Joseph de la Vega decrivait en 1688 les mêmes biais que Kahneman en 2002 : herding, FOMO, overconfidence, denial. Les modèles quantitatifs qui ignorent la psychologie humaine sont incomplets. Les bulles ne sont pas des "accidents" mais des caractéristiques structurelles des marchés.</p>
            </div>
            <div class="grid-item">
                <h4>4. La Diversification est Universelle</h4>
                <p>Des caravanes de la Route de la Soie aux portefeuilles modernes, la diversification a toujours été la première stratégie de gestion du risque. Les marchands sogdiens ne mettaient jamais toute leur marchandise sur un seul chameau. Les Bardi ont fait faillite en concentrant le risque sur Edouard III.</p>
            </div>
            <div class="grid-item">
                <h4>5. Les Contraintes Stimulent l'Innovation</h4>
                <p>L'interdiction de l'intérêt dans l'Islam et le Christianisme medieval a engendré des structures financières sophistiquées : mudaraba, hawala, lettre de change. La finance islamique moderne (3 000 milliards USD) demontre qu'on peut innover sous contraintes ethiques strictes.</p>
            </div>
            <div class="grid-item">
                <h4>6. La Regulation Suit les Crises</h4>
                <p>Les règles boursieres naissent toujours APRES les scandales : la SEC après 1929, Bale après les faillites bancaires, Dodd-Frank après 2008. Un quant doit anticiper que les règles changeront après chaque crise - et modeliser en conséquence.</p>
            </div>
        </div>

        <div class="box">
            <h4>Application pour l'Interview Quant</h4>
            <p>Ces lecons historiques sont souvent testees en entretien. Les recruteurs apprecient les candidats qui peuvent :</p>
            <ul>
                <li>Expliquer l'origine économique d'un instrument financière</li>
                <li>Identifier les parallèles historiques des crises actuelles</li>
                <li>Reconnaître les limites des modèles quantitatifs face à la psychologie humaine</li>
                <li>Discuter de l'evolution de la regulation et de son impact sur les stratégies</li>
            </ul>
        </div>

        <h2 id="exercices">Exercices</h2>

        <p>Testez votre comprehension avec ces exercices classes par niveau de difficulte.</p>

        <h3>Niveau 1 : Comprehension</h3>

        <div class="exercise-box">
            <h4>Exercice 1.1 - Définitions</h4>
            <p>Definissez chacun des termes suivants en une ou deux phrases :</p>

            <p><strong>a) Comptabilité en partie double :</strong></p>
            <textarea class="exercise-input" id="def1" rows="2" placeholder="Votre définition..."></textarea>

            <p><strong>b) Responsabilité limitée :</strong></p>
            <textarea class="exercise-input" id="def2" rows="2" placeholder="Votre définition..."></textarea>

            <p><strong>c) Marche secondaire :</strong></p>
            <textarea class="exercise-input" id="def3" rows="2" placeholder="Votre définition..."></textarea>

            <p><strong>d) Bulle spéculative :</strong></p>
            <textarea class="exercise-input" id="def4" rows="2" placeholder="Votre définition..."></textarea>

            <button class="check-btn" onclick="checkDéfinitions()">Verifier mes réponses</button>
            <div id="feedback-def" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>a) Comptabilité en partie double :</strong> Système comptable ou chaque transaction est enregistree deux fois, une fois au debit et une fois au crédit. Permet de verifier l'équilibre des comptes.</p>
                    <p><strong>b) Responsabilité limitée :</strong> Protection juridique limitant la perte d'un investisseur au montant de son investissement initial. Il ne peut pas être poursuivi pour les dettes de l'entreprise au-dela de sa mise.</p>
                    <p><strong>c) Marche secondaire :</strong> Marche où les titrès déjà émis s'échangent entre investisseurs, par opposition au marché primaire où les titrès sont émis pour la première fois.</p>
                    <p><strong>d) Bulle spéculative :</strong> Episode de marché où le prix d'un actif augmente de manière excèssive par rapport à sa valeur fondamentale, suivi d'un effondrement brutal lorsque les acheteurs disparaissent.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 1.2 - Chronologie</h4>
            <p>Numerotez ces événements dans l'ordre chronologique (1 = le plus ancien) :</p>

            <div class="chronology-item">
                <input type="number" class="exercise-number-input" id="chrono1" min="1" max="6" placeholder="?">
                <span>Creation de la Bourse d'Amsterdam</span>
            </div>
            <div class="chronology-item">
                <input type="number" class="exercise-number-input" id="chrono2" min="1" max="6" placeholder="?">
                <span>Code de Hammurabi</span>
            </div>
            <div class="chronology-item">
                <input type="number" class="exercise-number-input" id="chrono3" min="1" max="6" placeholder="?">
                <span>Tulipomanie</span>
            </div>
            <div class="chronology-item">
                <input type="number" class="exercise-number-input" id="chrono4" min="1" max="6" placeholder="?">
                <span>Banque des Medicis</span>
            </div>
            <div class="chronology-item">
                <input type="number" class="exercise-number-input" id="chrono5" min="1" max="6" placeholder="?">
                <span>Foires de Champagne</span>
            </div>
            <div class="chronology-item">
                <input type="number" class="exercise-number-input" id="chrono6" min="1" max="6" placeholder="?">
                <span>Publication de "Confusion de Confusiones"</span>
            </div>

            <button class="check-btn" onclick="checkChronology()">Verifier mes réponses</button>
            <div id="feedback-chrono" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <ol>
                        <li>Code de Hammurabi (~1754 av. J.-C.)</li>
                        <li>Foires de Champagne (XIIe-XIIIe siècles)</li>
                        <li>Banque des Medicis (1397-1494)</li>
                        <li>Creation de la Bourse d'Amsterdam (1602)</li>
                        <li>Tulipomanie (1637)</li>
                        <li>Publication de "Confusion de Confusiones" (1688)</li>
                    </ol>
                </div>
            </details>
        </div>

        <h3>Niveau 2 : Application</h3>

        <div class="exercise-box">
            <h4>Exercice 2.1 - Analyse de la VOC</h4>
            <p><strong>Donnees :</strong></p>
            <ul>
                <li>Capital initial VOC : 6.4 millions de florins (1602)</li>
                <li>Dividende moyen annuel : 18%</li>
                <li>Durée : 200 ans (1602-1799)</li>
            </ul>
            <p><strong>Question 1 :</strong> Si un investisseur avait place 1000 florins en 1602, quelle serait la valeur théorique en 1799 ?</p>
            <p><em>Formule : V = P(1+r)^n</em></p>

            <div class="calc-row">
                <span class="calc-label">Valeur finale V =</span>
                <input type="text" class="exercise-calc-input" id="voc-calc" placeholder="Ex: 2.4e38">
                <span class="calc-unit">florins</span>
            </div>

            <p><strong>Question 2 :</strong> Pourquoi ce calcul est-il irrealiste ? (Cochez les bonnes réponses)</p>
            <div style="margin: 15px 0;">
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="voc-reason1"> La VOC a fait faillite en 1799
                </label>
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="voc-reason2"> Les dividendes n'étaient pas reinvestissables facilement
                </label>
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="voc-reason3"> Le taux de 18% est trop faible
                </label>
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="voc-reason4"> L'inflation sur 200 ans change la valeur reelle
                </label>
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="voc-reason5"> Les guerres et crises ont interrompu le commerce
                </label>
            </div>

            <button class="check-btn" onclick="checkVOC()">Verifier mes réponses</button>
            <div id="feedback-voc" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>a) Calcul :</strong></p>
                    <p>V = P(1+r)^n = 1000 x (1.18)^200 = 1000 x 2.4 x 10^35</p>
                    <p>Resultat théorique : environ <strong>2.4 x 10^38 florins</strong> (un nombre astronomique !)</p>
                    <p><strong>b) Pourquoi irrealiste :</strong> Toutes les raisons sont valides SAUF "Le taux de 18% est trop faible".</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 2.2 - La Tulipomanie en chiffres</h4>
            <p><strong>Donnees du Semper Augustus :</strong></p>
            <ul>
                <li>Prix au sommet : 10,000 florins</li>
                <li>Salaire annuel artisan : 1,000 florins</li>
                <li>Prix après crash : ~1,000 florins</li>
            </ul>

            <p><strong>Question 1 :</strong> Calculez la perte en pourcentage pour un acheteur au sommet.</p>
            <div class="calc-row">
                <span class="calc-label">Perte =</span>
                <input type="number" class="exercise-calc-input" id="tulip-perte" placeholder="Ex: 90">
                <span class="calc-unit">%</span>
            </div>

            <p><strong>Question 2 :</strong> Un investisseur moderne (salaire 40,000 EUR/an) achete un actif équivalent a 10 ans de salaire. Apres une perte de 90%, quelle est sa perte en euros ?</p>
            <div class="calc-row">
                <span class="calc-label">Investissement initial =</span>
                <input type="number" class="exercise-calc-input" id="tulip-invest" placeholder="Ex: 400000">
                <span class="calc-unit">EUR</span>
            </div>
            <div class="calc-row">
                <span class="calc-label">Perte en euros =</span>
                <input type="number" class="exercise-calc-input" id="tulip-loss" placeholder="Ex: 360000">
                <span class="calc-unit">EUR</span>
            </div>

            <button class="check-btn" onclick="checkTulip()">Verifier mes réponses</button>
            <div id="feedback-tulip" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>a) Perte en pourcentage :</strong></p>
                    <p>Perte = (10000 - 1000) / 10000 x 100 = <strong>90%</strong></p>
                    <p><strong>b) Équivalent moderne :</strong></p>
                    <ul>
                        <li>Investissement : 40,000 x 10 = <strong>400,000 EUR</strong></li>
                        <li>Perte de 90% : 400,000 x 0.90 = <strong>360,000 EUR</strong></li>
                    </ul>
                </div>
            </details>
        </div>

        <h3>Niveau 3 : Analyse</h3>

        <div class="exercise-box">
            <h4>Exercice 3.1 - Joseph de la Vega, premier analyste comportemental</h4>
            <p><strong>Extrait de "Confusion de Confusiones" (1688) :</strong></p>
            <blockquote>
                <p>"Les spéculateurs sont comme des moutons : ils suivent le troupeau sans reflexion. Quand un achete, tous achetent. Quand un vend, tous vendent. Ils préfèreront perdre avec la foule que gagner seuls."</p>
            </blockquote>

            <p><strong>Question 1 :</strong> Quel biais cognitif moderne cet extrait décrit-il ? Donnez sa définition.</p>
            <textarea class="exercise-input" id="vega-q1" rows="3" placeholder="Nommez le biais et definissez-le..."></textarea>

            <p><strong>Question 2 :</strong> Daniel Kahneman (Prix Nobel 2002) a formalise ce type de comportement. Quelle théorie a-t-il développée ?</p>
            <input type="text" class="exercise-input" id="vega-q2" placeholder="Nom de la théorie..." style="height: auto;">

            <p><strong>Question 3 :</strong> Donnez un exemple recent (2020-2025) de comportement moutonne sur les marchés.</p>
            <textarea class="exercise-input" id="vega-q3" rows="3" placeholder="Decrivez un cas concret..."></textarea>

            <button class="check-btn" onclick="checkVega()">Verifier mes réponses</button>
            <div id="feedback-vega" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>a)</strong> Le <span class="text-red">comportement moutonné</span> (herding behavior) ou conformisme social. Définition : Tendance des individus a imiter les actions du groupe majoritaire plutôt qu'a prendre des decisions indépendantes basées sur leurs propres informations.</p>
                    <p><strong>b)</strong> La <strong>Theorie des Perspectives</strong> (Prospect Theory, 1979, avec Amos Tversky). Elle montré que les humains ne prennent pas de decisions rationnelles face au risque, mais sont influences par des biais cognitifs systématiques.</p>
                    <p><strong>c)</strong> Exemples recents :</p>
                    <ul>
                        <li><strong>GameStop (janvier 2021)</strong> : Des milliers d'investisseurs particulières ont achete l'action simultanement après des discussions sur Reddit (r/WallStreetBets), creant une "short squeeze" historique.</li>
                        <li><strong>Crypto 2021</strong> : FOMO (Fear Of Missing Out) sur Bitcoin, Ethereum, et les même coins comme Dogecoin et Shiba Inu.</li>
                    </ul>
                </div>
            </details>
        </div>

        <h3>Niveau 4 : Defi Quant (Style Entretien)</h3>

        <div class="box" style="margin-bottom: 30px;">
            <h4>A propos de ces exercices</h4>
            <p>Ces questions sont du niveau attendu en entretien quant (hedge funds, trading desks, asset management). Elles testent votre capacité a raisonner quantitativement sur des problèmes historiques.</p>
            <p style="font-size: 14px; color: var(--text-muted); margin-top: 10px;">Sources : Adaptes de "Heard on the Street" (Timothy Crack) et "A Practical Guide to Quantitative Finance Interviews" (Xinfeng Zhou)</p>
        </div>

        <div class="exercise-box">
            <h4>Exercice 4.1 - Prime de Risque Babylonienne</h4>
            <p><strong>Contexte :</strong> Le Code de Hammurabi fixait le taux maximum a 20% pour l'argent et 33% pour le grain.</p>
            <p><strong>Questions :</strong></p>

            <p><strong>a)</strong> Calculez la prime de risque implicité du grain par rapport à l'argent, en supposant que le taux sans risque est celui de l'argent.</p>
            <div class="calc-row">
                <span class="calc-label">Prime de risque =</span>
                <input type="number" class="exercise-calc-input" id="prime-q1" placeholder="Ex: 13">
                <span class="calc-unit">points de pourcentage</span>
            </div>

            <p><strong>b)</strong> Si cette prime compense une probabilité annuelle de perte totale du grain (incendie, vol, parasites), estimez cette probabilité de perte.</p>
            <p><em>Indication : Si vous pretez 100 avec 33% d'intérêt et qu'il y a une probabilité p de tout perdre, votre espérance de gain est (1-p) x 133 - 100 = ?</em></p>
            <div class="calc-row">
                <span class="calc-label">Probabilite de perte p =</span>
                <input type="number" class="exercise-calc-input" id="prime-q2" placeholder="Ex: 10" step="0.1">
                <span class="calc-unit">%</span>
            </div>

            <p><strong>c)</strong> Comparez avec le taux de défaut des obligations high yield modernes (~4-5% par an). Qu'en deduisez-vous sur le risque du grain a Babylone ?</p>
            <textarea class="exercise-input" id="prime-q3" rows="3" placeholder="Votre analyse..."></textarea>

            <button class="check-btn" onclick="checkPrimeRisque()">Verifier mes réponses</button>
            <div id="feedback-prime" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>a)</strong> Prime de risque = 33% - 20% = <strong>13 points de pourcentage</strong></p>
                    <p><strong>b)</strong> Pour que l'espérance soit egale au rendement sans risque (20%) :</p>
                    <p>(1-p) x 133 = 120 (100 + 20% d'intérêt)</p>
                    <p>1-p = 120/133 = 0.902</p>
                    <p>p = <strong>9.8%</strong> soit environ 10% de probabilité de perte totale par an</p>
                    <p><strong>c)</strong> Le taux de défaut des junk bonds modernes (4-5%) est deux fois inférieur a celui du grain babylonien (~10%). Cela suggère que le risque de perte physique du grain etait extremêment élevé - ce qui est coherent avec les conditions de stockage primitives (pas de refrigeration, rats, inondations du Tigre et de l'Euphrate).</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 4.2 - Valorisation de la VOC (Style CFA)</h4>
            <p><strong>Donnees de la VOC (1650) :</strong></p>
            <table>
                <tr><td>Dividende verse en 1650</td><td>D0 = 400,000 florins</td></tr>
                <tr><td>Croissance attendue des dividendes</td><td>g = 3% par an</td></tr>
                <tr><td>Taux sans risque (obligations d'Etat)</td><td>rf = 5%</td></tr>
                <tr><td>Prime de risque actions estimee</td><td>ERP = 4%</td></tr>
            </table>

            <p><strong>a)</strong> En utilisant le modèle de Gordon-Shapiro (DDM perpetuel), estimez la valeur théorique de la VOC.</p>
            <p><em>Formule : V = D1 / (r - g) ou D1 = D0 x (1+g) et r = rf + ERP</em></p>
            <div class="calc-row">
                <span class="calc-label">D1 =</span>
                <input type="number" class="exercise-calc-input" id="voc-d1" placeholder="Ex: 412000">
                <span class="calc-unit">florins</span>
            </div>
            <div class="calc-row">
                <span class="calc-label">r (taux requis) =</span>
                <input type="number" class="exercise-calc-input" id="voc-r" placeholder="Ex: 9" step="0.1">
                <span class="calc-unit">%</span>
            </div>
            <div class="calc-row">
                <span class="calc-label">V (valeur VOC) =</span>
                <input type="number" class="exercise-calc-input" id="voc-v" placeholder="Ex: 6866667">
                <span class="calc-unit">florins</span>
            </div>

            <p><strong>b)</strong> La capitalisation reelle de la VOC en 1650 etait d'environ 15 millions de florins. Quelles explications pouvez-vous donner pour cet ecart ?</p>
            <textarea class="exercise-input" id="voc-ecart" rows="3" placeholder="Analysez l'ecart..."></textarea>

            <button class="check-btn" onclick="checkVOCValuation()">Verifier mes réponses</button>
            <div id="feedback-voc-val" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>a)</strong></p>
                    <ul>
                        <li>D1 = 400,000 x (1 + 0.03) = <strong>412,000 florins</strong></li>
                        <li>r = 5% + 4% = <strong>9%</strong></li>
                        <li>V = 412,000 / (0.09 - 0.03) = 412,000 / 0.06 = <strong>6,866,667 florins</strong></li>
                    </ul>
                    <p><strong>b)</strong> La capitalisation reelle (15M) est supérieure à la valeur DDM (6.9M). Explications possibles :</p>
                    <ul>
                        <li><strong>Croissance attendue plus élevée</strong> : le marché anticipait peut-être g > 3%</li>
                        <li><strong>Prime de risque plus faible</strong> : les investisseurs percevaient la VOC comme moins risquee (monopole d'Etat)</li>
                        <li><strong>Options reelles</strong> : valeur des opportunites futures (nouveaux territoires, routes commerciales)</li>
                        <li><strong>Speculative premium</strong> : exuberance du marché, comme documente par de la Vega</li>
                    </ul>
                    <p>Cet exercice illustre que même les modèles fondamentaux (DDM) ont des limites et que la valorisation de marché incorpore des facteurs qualitatifs.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 4.3 - Finance Islamique vs Finance Conventionnelle</h4>
            <p><strong>Scenario :</strong> Une entreprise veut lever 10 millions EUR. Elle peut choisir entre :</p>
            <ul>
                <li><strong>Option A :</strong> Emprunt bancaire classique a 6% d'intérêt annuel sur 5 ans</li>
                <li><strong>Option B :</strong> Structure mudaraba avec partage des profits 70/30 (70% pour l'entreprise)</li>
            </ul>
            <p><strong>Hypotheses pour Option B :</strong> Profit annuel attendu = 2M EUR, ecart-type = 1M EUR</p>

            <p><strong>a)</strong> Calculez le cout annuel total de l'Option A pour l'entreprise.</p>
            <div class="calc-row">
                <span class="calc-label">Cout annuel Option A =</span>
                <input type="number" class="exercise-calc-input" id="islamic-a" placeholder="Ex: 600000">
                <span class="calc-unit">EUR</span>
            </div>

            <p><strong>b)</strong> Calculez le cout annuel esperE de l'Option B (part versee a l'investisseur).</p>
            <div class="calc-row">
                <span class="calc-label">Cout annuel espère Option B =</span>
                <input type="number" class="exercise-calc-input" id="islamic-b" placeholder="Ex: 600000">
                <span class="calc-unit">EUR</span>
            </div>

            <p><strong>c)</strong> Dans quel scenario l'Option B devient-elle plus couteuse que l'Option A ? (Indiquez le profit annuel minimum)</p>
            <div class="calc-row">
                <span class="calc-label">Profit seuil =</span>
                <input type="number" class="exercise-calc-input" id="islamic-c" placeholder="Ex: 2000000">
                <span class="calc-unit">EUR</span>
            </div>

            <p><strong>d)</strong> Quelle option est plus avantageuse en cas de pertes ? Pourquoi ?</p>
            <textarea class="exercise-input" id="islamic-d" rows="3" placeholder="Votre analyse..."></textarea>

            <button class="check-btn" onclick="checkIslamic()">Verifier mes réponses</button>
            <div id="feedback-islamic" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>a)</strong> Cout Option A = 10,000,000 x 6% = <strong>600,000 EUR/an</strong></p>
                    <p><strong>b)</strong> Cout espère Option B = 2,000,000 x 30% = <strong>600,000 EUR/an</strong></p>
                    <p>Les deux options ont le même cout espère !</p>
                    <p><strong>c)</strong> Option B > Option A quand : Profit x 30% > 600,000</p>
                    <p>Profit > 600,000 / 0.30 = <strong>2,000,000 EUR</strong></p>
                    <p>Donc si les profits depassent 2M EUR, la mudaraba coute plus cher.</p>
                    <p><strong>d)</strong> En cas de pertes :</p>
                    <ul>
                        <li><strong>Option A</strong> : L'entreprise doit toujours payer 600,000 EUR d'intérêts même si elle perd de l'argent</li>
                        <li><strong>Option B</strong> : L'investisseur ne recoit rien (car 30% de 0 = 0), et supporte seul la perte de capital</li>
                    </ul>
                    <p>La mudaraba est donc une forme d'assurance : l'entreprise paie plus en cas de succès, mais est protegee en cas d'échec. C'est le fondement de la finance islamique : partage du risque plutôt que transfert du risque.</p>
                </div>
            </details>
        </div>

        <h2 id="flashcards">Flashcards</h2>

        <p>Cliquez sur une carte pour voir la réponse. Revisez a J+1, J+3, J+7, J+14, J+30 pour une memorisation optimale.</p>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>En quelle année a été créée la VOC ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>1602 (20 mars)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>En quelle année a eu lieu le crash de la Tulipomanie ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Fevrier 1637</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que la comptabilité en partie double ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Système ou chaque transaction est enregistree dans deux comptes (debit + crédit). Total debits = Total crédits.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que la responsabilité limitée ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>L'investisseur ne peut perdre que sa mise initiale. Introduit par la VOC en 1602.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quelles sont les 4 innovations majeures de la VOC ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>1) Actions transférables 2) Responsabilité limitée 3) Dividendes réguliers 4) Marche secondaire</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Pourquoi le taux sur le grain etait-il plus élevé que sur l'argent a Babylone ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Prime de risque : le grain est périssable (insectes, humidite, vol). Taux grain 33% vs argent 20%.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qui a écrit le premier livre sur la psychologie des marchés ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Joseph de la Vega, "Confusion de Confusiones" (1688)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quel etait le prix d'un bulbe Semper Augustus au sommet ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>10,000 florins = 10 ans de salaire = prix d'une maison a Amsterdam</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quelles sont les 5 caractéristiques d'une bulle spéculative ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>1) Nouvel actif 2) Credit facile 3) Marche liquide 4) Croyance hausse perpetuelle 5) Effondrement brutal</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Date du Code de Hammurabi ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>1754 av. J.-C.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Formule de l'intérêt compose ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>V = P(1+r)^n<br>V = valeur finale, P = principal, r = taux, n = périodes</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>La VOC est-elle la première "entreprise" de l'histoire ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Non ! C'est la première SOCIETE PAR ACTIONS avec marché secondaire. Les entreprises existaient avant (sociétates romaines, guildes).</p>
                    </div>
                </div>
            </div>

            <!-- Nouvelles flashcards internationales -->
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce qu'une mudaraba en finance islamique ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Partenariat ou l'investisseur fournit le capital et l'entrepreneur le travail. Profits partagés, pertes supportées par l'investisseur uniquement. Équivalent : Venture Capital.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que le jiaozi chinois ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Premier papier-monnaie officiel de l'histoire (1024, dynastie Song). 600 ans avant l'Europe.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Pourquoi la faillite des Bardi/Peruzzi (1343) est importante ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Première crise bancaire systémique europeenne. Cause : concentration du risque sur un seul débiteur (Edouard III d'Angleterre). Lecon : diversification.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce qu'un nautikon daneion grec ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Pret à la grosse aventure : prêt maritime où le remboursement est conditionnel a l'arrivée du navire. Forme primitive d'assurance. Taux : 22-30%.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que la Wisselbank d'Amsterdam (1609) ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Première banque centrale de réserve. Fonctions : standardisation monétaire, dépôts, virements scripturaux, clearing. Modele pour Bank of England (1694).</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que le riba en finance islamique ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Usure / intérêt, interdit par le Coran. A conduit a l'invention de structures alternatives : mudaraba, musharaka, hawala, sukuk.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Pourquoi le virus de la mosaique rendait les tulipes si cheres ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Il creait des motifs uniques ("flammes") impossibles a reproduire. Chaque bulbe etait donc unique et rare - rarete artificielle qui a alimente la bulle.</p>
                    </div>
                </div>
            </div>
        </div>

        <h2>Ressources</h2>

        <div class="box">
            <h4>Documentaires recommandes</h4>
            <ul>
                <li><strong><a href="https://www.arte.tv/fr/videos/RC-014124/trois-villes-a-la-conquete-du-monde/" target="_blank" style="color: var(--accent-blue);">Trois villes à la conquete du monde</a></strong> - Arte (4x55min)<br>
                <span style="color: var(--text-muted);">Serie documentaire sur Amsterdam, Londres, New York. Episode 1 couvre la VOC et le Siecle d'Or neerlandais (1585-1650).</span></li>
                <li><strong><a href="https://www.pbs.org/wnet/ascentofmoney/" target="_blank" style="color: var(--accent-blue);">The Ascent of Money</a></strong> - PBS / Niall Ferguson (4h)<br>
                <span style="color: var(--text-muted);">Histoire financière du monde, des tablettes babyloniennes aux Medicis, d'Amsterdam a Wall Street. Emmy Award 2009.</span></li>
                <li><strong><a href="https://www.youtube.com/results?search_query=the+tulip+bubble+documentary" target="_blank" style="color: var(--accent-blue);">The Tulip Bubble</a></strong> - Terra Mater (54min)<br>
                <span style="color: var(--text-muted);">Documentaire sur la Tulipomanie de 1637: spéculation, derives, options et certificats d'investissement sur les bulbes.</span></li>
            </ul>
        </div>

        <div class="box">
            <h4>Lectures académiques</h4>
            <ul>
                <li><strong>The Rise and Decline of the Medici Bank</strong> - Raymond de Roover (1963) - Reference académique sur la banque medievale</li>
                <li>Confusion de Confusiones - Joseph de la Vega (1688) - Premier livre sur les marchés financières</li>
                <li><strong>The Ascent of Money</strong> - Niall Ferguson (2008) - Histoire financière du monde</li>
                <li><strong>Tulipmania</strong> - Anne Goldgar (2007) - Etude historique revisitee de la bulle</li>
                <li><strong>An Introduction to Islamic Finance</strong> - Taqi Usmani (1998) - Reference sur la finance islamique</li>
                <li><strong>Money and Banking in Medieval and Renaissance Venice</strong> - Frederic C. Lane (1937) - Finance venitienne</li>
            </ul>
        </div>

        <div class="box">
            <h4>Pour l'entretien quant</h4>
            <ul>
                <li><strong>Heard on the Street</strong> - Timothy Crack - Questions d'entretien quant classiques</li>
                <li><strong>A Practical Guide to Quantitative Finance Interviews</strong> - Xinfeng Zhou - Brain teasers et problèmes</li>
                <li><strong>Frequently Asked Questions in Quantitative Finance</strong> - Paul Wilmott - FAQ des quants</li>
            </ul>
        </div>

        <div class="summary">
            <h3>Resume - Origines de la Finance Mondiale</h3>
            <div class="grid-2">
                <div>
                    <h4>Dates cles</h4>
                    <ul>
                        <li>1754 av. J.-C. - Code de Hammurabi (prime de risque)</li>
                        <li>300 av. J.-C. - Sociétates Publicanorum (Rome)</li>
                        <li>1024 - Jiaozi, premier papier-monnaie (Chine)</li>
                        <li>1343 - Faillite Bardi/Peruzzi (1ere crise systémique)</li>
                        <li>1397 - Banque des Medicis (comptabilité moderne)</li>
                        <li>1602 - Creation VOC + Bourse Amsterdam</li>
                        <li>1609 - Wisselbank (1ere banque centrale)</li>
                        <li>1637 - Crash Tulipomanie (-90%)</li>
                        <li>1688 - Confusion de Confusiones</li>
                    </ul>
                </div>
                <div>
                    <h4>Concepts fondamentaux</h4>
                    <ul>
                        <li>Prime de risque (Babylone : grain vs argent)</li>
                        <li>Comptabilité en partie double (Medicis)</li>
                        <li>Responsabilité limitée (VOC)</li>
                        <li>Marche secondaire (Bourse Amsterdam)</li>
                        <li>Herding behavior (de la Vega)</li>
                        <li>Partage du risque (finance islamique)</li>
                        <li>Diversification (Route de la Soie)</li>
                        <li>Concentration du risque (Bardi)</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" disabled>Precedent</button>
            <button class="nav-btn" onclick="showModule('module2')">Suivant</button>
        </div>
    </section>

    <!-- MODULE 2 -->
    <section id="module2" class="module">
        <header class="module-header">
            <h1>Fondations Mathématiques de la Finance</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermediaire</span>
                <span>75 minutes</span>
                <span>Prerequis : Module 1</span>
            </div>
        </header>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/9/98/Blaise_Pascal_Versailles.JPG" alt="Blaise Pascal">
            <figcaption>Blaise Pascal (1623-1662) - Portrait anonyme, Chateau de Versailles</figcaption>
        </figure>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre comment les jeux de hasard ont donné naissance aux probabilités</li>
            <li>Maîtriser le concept d'espérance mathématique et son application financière</li>
            <li>Découvrir la théorie de l'utilité de Bernoulli et l'aversion au risque</li>
            <li>Analyser la thèse révolutionnaire de Louis Bachelier sur les marchés</li>
            <li>Faire le lien entre ces fondations et la finance quantitative moderne</li>
        </ul>

        <!-- TIMELINE -->
        <h2>Chronologie des Fondations (1654-1900)</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1654</div>
                <div class="timeline-content">
                    <strong>Correspondance Pascal-Fermat</strong><br>
                    Naissance du calcul des probabilités à travers le "problème des partis"
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1713</div>
                <div class="timeline-content">
                    <strong>Ars Conjectandi de Jakob Bernoulli</strong><br>
                    Premier traité systématique sur les probabilités, publié à titre posthume
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1738</div>
                <div class="timeline-content">
                    <strong>Specimen Theoriae Novae de Daniel Bernoulli</strong><br>
                    Introduction de l'utilité espérée et explication du paradoxe de Saint-Pétersbourg
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1812</div>
                <div class="timeline-content">
                    <strong>Théorie analytique des probabilités de Laplace</strong><br>
                    Formalisation mathématique complète et théorème central limite
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1900</div>
                <div class="timeline-content">
                    <strong>Théorie de la Spéculation de Louis Bachelier</strong><br>
                    Première modélisation mathématique des marchés financiers
                </div>
            </div>
        </div>

        <!-- SECTION 1: PASCAL-FERMAT -->
        <h2>Pascal et Fermat : Naissance des Probabilites (1654)</h2>

        <p>En 1654, un joueur professionnel nommé Antoine Gombaud, dit le Chevalier de Méré, pose une question apparemment simple à Blaise Pascal : comment répartir équitablement les mises d'un jeu interrompu avant sa fin ? Cette question, connue sous le nom de "problème des partis", va déclencher une correspondance historique entre Pascal et Pierre de Fermat qui fondera le calcul des probabilités.</p>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/f/f3/Pierre_de_Fermat.jpg" alt="Pierre de Fermat">
            <figcaption>Pierre de Fermat (1607-1665) - Magistrat et mathematicien francais</figcaption>
        </figure>

        <p>Le problème est le suivant : deux joueurs, A et B, jouent à un jeu de hasard équitable. Le premier à atteindre 3 victoires remporte la mise totale de 64 pistoles. La partie est interrompue alors que A a 2 victoires et B en a 1. Comment partager équitablement les 64 pistoles ?</p>

        <div class="box">
            <h4>Définition : <span class="text-red">Espérance Mathématique</span></h4>
            <p>L'espérance mathématique E(X) d'une variable aléatoire X est la moyenne pondérée de ses valeurs possibles par leurs probabilités respectives :</p>
            <p><strong>E(X) = sum(xi * P(xi))</strong></p>
            <p>C'est la valeur "moyenne" qu'on peut espérer obtenir si on répète l'expérience un grand nombre de fois.</p>
        </div>

        <h3>La Solution de Pascal</h3>

        <p>Pascal raisonne ainsi : si on joue une manche supplémentaire, A gagne avec probabilité 1/2 (et remporte tout), ou B gagne avec probabilité 1/2 (égalité 2-2). Dans ce dernier cas, une nouvelle manche donne 1/2 chance a chacun.</p>

        <p>En développant ce raisonnement récursif, Pascal calcule que A devrait recevoir <strong>48 pistoles</strong> (3/4 de la mise) et B <strong>16 pistoles</strong> (1/4). Cette méthode révolutionnaire permet de quantifier mathématiquement l'incertitude.</p>

        <div class="box">
            <h4>Concept : <span class="text-red">Triangle de Pascal</span></h4>
            <p>Pour résoudre ce problème, Pascal développa son célèbre triangle arithmétique, qui permet de calculer les <span class="text-red">coefficients binomiaux</span>. Ces coefficients sont fondamentaux pour calculer les probabilités dans les expériences répétées.</p>
            <p>Application financière : le modèle binomial d'evaluation des options (Cox-Ross-Rubinstein, 1979) utilise directement ce triangle.</p>
        </div>

        <blockquote>
            <p>"Le hasard a ses lois, que l'ignorance ne connaît pas, mais que la science decouvre."</p>
            <cite>Blaise Pascal, Pensees</cite>
        </blockquote>

        <!-- SECTION 2: BERNOULLI -->
        <h2>Daniel Bernoulli et l'Utilite Esperee (1738)</h2>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/f/fc/Daniel_Bernoulli_001.jpg" alt="Daniel Bernoulli">
            <figcaption>Daniel Bernoulli (1700-1782) - Mathematicien et physicien suisse</figcaption>
        </figure>

        <p>Quatre-vingts ans après Pascal, Daniel Bernoulli (neveu de Jakob) s'attaque à un paradoxe qui remet en question l'espérance mathématique comme critère de décision. Ce problème, posé par son cousin Nicolas, est connu sous le nom de <strong><span class="text-red">Paradoxe de Saint-Pétersbourg</span></strong>.</p>

        <h3>Le Paradoxe de Saint-Pétersbourg</h3>

        <p>Un casino propose le jeu suivant : on lance une pièce jusqu'à obtenir "face". Si "face" apparaît au n-ième lancer, le joueur gagne 2^n euros. Combien devrait-on payer pour participer à ce jeu ?</p>

        <div class="box">
            <h4>Calcul de l'Esperance</h4>
            <p>L'espérance de gain est :</p>
            <p>E = (1/2 x 2) + (1/4 x 4) + (1/8 x 8) + ... = 1 + 1 + 1 + ... = <strong>infini</strong></p>
            <p>Selon l'espérance mathématique, on devrait être prêt a payer n'importe quelle somme pour jouer ! Pourtant, personne ne paierait plus de quelques euros...</p>
        </div>

        <h3>La Solution de Bernoulli : L'Utilite</h3>

        <p>Bernoulli résout ce paradoxe en introduisant une idée révolutionnaire : ce n'est pas la valeur monétaire absolue qui compte, mais son <strong><span class="text-red">utilité</span></strong> pour l'individu. Un euro supplémentaire a plus de valeur pour un pauvre que pour un riche.</p>

        <div class="box">
            <h4>Définition : <span class="text-red">Fonction d'Utilité Logarithmique</span></h4>
            <p>Bernoulli propose que l'utilite soit proportionnelle au logarithme de la richesse :</p>
            <p><strong>U(W) = ln(W)</strong></p>
            <p>Cette fonction est concave : l'utilité marginale est décroissante. C'est la formalisation mathématique de l'<strong><span class="text-red">aversion au risque</span></strong>.</p>
        </div>

        <!-- Chart for utility function -->
        <div class="chart-container">
            <canvas id="utilityChart"></canvas>
        </div>

        <p>Avec cette fonction d'utilité, l'espérance d'utilité du jeu de Saint-Pétersbourg devient finie (environ 2 euros), ce qui correspond bien à l'intuition.</p>

        <div class="box">
            <h4>Concept : <span class="text-red">Aversion au Risque</span></h4>
            <p>L'aversion au risque explique pourquoi les investisseurs préfèrent un rendement certain de 5% à un rendement incertain de 10% en moyenne. C'est le fondement de la <strong><span class="text-red">prime de risque</span></strong> : les actifs risqués doivent offrir un rendement supérieur pour compenser le risque.</p>
        </div>

        <blockquote>
            <p>"La détermination de la valeur d'un objet ne doit pas être fondée sur son prix, mais plutôt sur l'utilité qu'il procure."</p>
            <cite>Daniel Bernoulli, Specimen Theoriae Novae de Mensura Sortis, 1738</cite>
        </blockquote>

        <!-- SECTION 3: LAPLACE -->
        <h2>Pierre-Simon de Laplace : La Théorie Analytique (1812)</h2>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/e/e3/Pierre-Simon_Laplace.jpg" alt="Pierre-Simon de Laplace">
            <figcaption>Pierre-Simon de Laplace (1749-1827) - Le "Newton français"</figcaption>
        </figure>

        <p>Pierre-Simon de Laplace a transformé les probabilités d'une collection de techniques en une théorie mathématique rigoureuse. Son œuvre monumentale, la <strong>"Théorie analytique des probabilités"</strong> (1812), unifie et généralise tous les travaux antérieurs de Pascal, Fermat et Bernoulli.</p>

        <p>Laplace était convaincu que les probabilités n'étaient pas seulement un outil pour les jeux de hasard, mais une méthode universelle pour raisonner sur l'incertitude dans tous les domaines : astronomie, physique, démographie, et bien sûr, économie.</p>

        <h3>Le Théorème Central Limite</h3>

        <p>La contribution la plus importante de Laplace pour la finance est le <span class="text-red">théorème central limite</span>. Ce théorème, démontré rigoureusement par Laplace, explique pourquoi la <span class="text-red">distribution normale</span> (courbe en cloche) apparaît partout dans la nature et les marchés.</p>

        <div class="box">
            <h4>Définition : <span class="text-red">Théorème Central Limite</span></h4>
            <p>Soit X₁, X₂, ..., Xₙ des variables aléatoires indépendantes de même loi, avec moyenne μ et variance σ². Alors la somme normalisée :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; margin: 15px 0;">
                (X₁ + X₂ + ... + Xₙ - nμ) / (σ√n) → N(0,1)
            </p>
            <p>converge vers une loi normale standard quand n → ∞, quelle que soit la distribution d'origine des Xᵢ.</p>
        </div>

        <h3>Applications en Finance</h3>

        <p>Le théorème central limite a des implications profondes pour la finance quantitative :</p>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Rendements de Portefeuille</h4>
                <p>Un portefeuille diversifié contient de nombreux actifs. Même si les rendements individuels ne sont pas normaux, le rendement total du portefeuille tend vers une distribution normale grâce au TCL.</p>
            </div>
            <div class="grid-item">
                <h4>Estimation des Risques</h4>
                <p>Le <span class="text-red">Value at Risk (VaR)</span> et de nombreuses mesures de risque supposent des rendements normaux. Cette hypothèse est justifiée par le TCL pour des portefeuilles suffisamment diversifiés.</p>
            </div>
        </div>

        <div class="box">
            <h4>Concept : <span class="text-red">Distribution Normale</span></h4>
            <p>La loi normale N(μ, σ²) est caractérisée par sa fonction de densité "en cloche" :</p>
            <ul>
                <li>68% des observations sont dans l'intervalle [μ - σ, μ + σ]</li>
                <li>95% sont dans [μ - 2σ, μ + 2σ]</li>
                <li>99.7% sont dans [μ - 3σ, μ + 3σ]</li>
            </ul>
            <p>Cette propriété permet de quantifier les risques "extrêmes" : un événement à 3 écarts-types n'a que 0.3% de chances de se produire... en théorie.</p>
        </div>

        <!-- Chart for normal distribution -->
        <div class="chart-container">
            <canvas id="normalDistChart"></canvas>
        </div>

        <h3>Les Limites : Les "Fat Tails"</h3>

        <p>Attention : le TCL suppose des variables indépendantes et identiquement distribuées (i.i.d.). Or, sur les marchés financiers :</p>

        <ul>
            <li>Les rendements ne sont pas vraiment indépendants (autocorrélation de la volatilité)</li>
            <li>Les distributions ont des <span class="text-red">queues épaisses</span> (fat tails) : les événements extrêmes sont plus fréquents que prévu</li>
            <li>Les crises créent des corrélations qui n'existaient pas en temps normal</li>
        </ul>

        <div class="box">
            <h4>Attention : Le Problème des Queues Épaisses</h4>
            <p>Benoit Mandelbrot a montré que les rendements financiers suivent des distributions à queues épaisses, pas des lois normales. Un krach de -20% en une journée (comme en 1987) devrait être un événement à 20 écarts-types, soit une probabilité de 10⁻⁸⁹. Pourtant, ces événements arrivent bien plus souvent que prévu par le modèle gaussien.</p>
            <p>Cette critique sera au cœur des débats après la crise de 2008.</p>
        </div>

        <blockquote>
            <p>"La théorie des probabilités n'est au fond que le bon sens réduit au calcul."</p>
            <cite>Pierre-Simon de Laplace, Essai philosophique sur les probabilités, 1814</cite>
        </blockquote>

        <!-- SECTION 4: BACHELIER -->
        <h2>Louis Bachelier : La Théorie de la Spéculation (1900)</h2>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/2/2d/Bachelier.jpg" alt="Louis Bachelier">
            <figcaption>Louis Bachelier (1870-1946) - Père de la finance mathématique</figcaption>
        </figure>

        <p>Le 29 mars 1900, Louis Bachelier soutient sa thèse de doctorat à la Sorbonne devant un jury présidé par Henri Poincaré. Cette thèse, intitulée "Théorie de la Spéculation", est la première application rigoureuse des mathématiques aux marchés financiers. Elle ne sera pleinement reconnue que 60 ans plus tard.</p>

        <p>Bachelier travaillait à la Bourse de Paris et observait quotidiennement les fluctuations des cours. Son intuition géniale fut de modéliser ces variations comme un processus aléatoire : ce qu'on appellera plus tard le <strong><span class="text-red">mouvement brownien</span></strong>.</p>

        <h3>L'Hypothèse de la Marche Aléatoire</h3>

        <p>Bachelier formule l'idée centrale : sur un marché efficient, les variations de prix sont indépendantes et suivent une loi de probabilité. Le prix futur ne peut être prédit à partir des prix passés, car toute l'information disponible est déjà incorporée dans le prix actuel.</p>

        <div class="box">
            <h4>Définition : <span class="text-red">Mouvement Brownien</span></h4>
            <p>Un mouvement brownien W(t) est un processus stochastique tel que :</p>
            <ul>
                <li>W(0) = 0</li>
                <li>Les increments W(t) - W(s) suivent une loi normale N(0, t-s)</li>
                <li>Les increments sur des intervalles disjoints sont indépendants</li>
                <li>Les trajectoires sont continues</li>
            </ul>
            <p>C'est le modèle mathématique fondamental de l'aléatoire en temps continu.</p>
        </div>

        <!-- Chart for random walk -->
        <div class="chart-container">
            <canvas id="randomWalkChart"></canvas>
        </div>

        <h3>La Reception de la These</h3>

        <p>Poincaré, impressionné par la rigueur mathématique mais perplexe devant l'application financière, accorda à Bachelier la mention "honorable" au lieu de "très honorable". Cette appréciation mitigée relégua Bachelier dans l'obscurité académique pendant des décennies.</p>

        <div class="box">
            <h4>Important : Redecouverte par Samuelson</h4>
            <p>En 1955, l'économiste Paul Samuelson (futur prix Nobel) découvre par hasard la thèse de Bachelier dans les archives. Il la fait traduire et diffuser, déclenchant la révolution de la finance quantitative. Samuelson écrira : "Bachelier mérite d'être considéré comme le père de la finance mathématique moderne."</p>
        </div>

        <blockquote>
            <p>"Le marché, a un instant donne, ne croit ni à la hausse ni à la baisse."</p>
            <cite>Louis Bachelier, Théorie de la Spéculation, 1900</cite>
        </blockquote>

        <h3>L'Heritage de Bachelier</h3>

        <p>Les idées de Bachelier sont à la base de :</p>

        <table>
            <thead>
                <tr>
                    <th>Concept de Bachelier</th>
                    <th>Application Moderne</th>
                    <th>Developpement</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="text-red">Marche aléatoire</span></td>
                    <td><span class="text-red">Hypothèse des marchés efficients</span></td>
                    <td>Eugene Fama, 1970</td>
                </tr>
                <tr>
                    <td><span class="text-red">Mouvement brownien</span></td>
                    <td><span class="text-red">Modèle Black-Scholes</span></td>
                    <td>Black, Scholes, Merton, 1973</td>
                </tr>
                <tr>
                    <td><span class="text-red">Distribution normale</span> des rendements</td>
                    <td><span class="text-red">Value at Risk (VaR)</span></td>
                    <td>J.P. Morgan, 1994</td>
                </tr>
                <tr>
                    <td><span class="text-red">Calcul stochastique</span></td>
                    <td>Pricing des <span class="text-red">dérivés</span></td>
                    <td>Industrie financière mondiale</td>
                </tr>
            </tbody>
        </table>

        <!-- SECTION 5: SYNTHESE -->
        <h2>Synthèse : De la Théorie aux Marchés</h2>

        <div class="lessons-grid">
            <div class="grid-item">
                <h4>1. Les probabilités quantifient l'incertitude</h4>
                <p>Pascal et Fermat ont montre qu'on peut raisonner mathématiquement sur l'aléatoire. L'espérance mathématique permet de comparer des loteries et de prendre des decisions rationnelles face a l'incertitude.</p>
            </div>
            <div class="grid-item">
                <h4>2. L'utilite explique l'aversion au risque</h4>
                <p>Bernoulli a montré que les humains n'évaluent pas les gains en termes absolus mais relatifs. La fonction d'utilite concave explique pourquoi les investisseurs exigent une prime pour prendre des risques.</p>
            </div>
            <div class="grid-item">
                <h4>3. Les marchés sont (partiellement) aléatoires</h4>
                <p>Bachelier a formalise l'idée que les prix suivent une marché aléatoire. Cette hypothèse, bien que simplificatrice, reste le point de départ de toute modelisation financière moderne.</p>
            </div>
            <div class="grid-item">
                <h4>4. Les limites des modèles</h4>
                <p>Ces fondations mathématiques supposent des marchés parfaits et des agents rationnels. Les crises financières rappellent régulièrement que la réalité est plus complexe que les modèles.</p>
            </div>
        </div>

        <!-- RESSOURCES -->
        <h2>Ressources</h2>

        <div class="box">
            <h4>Documentaires</h4>
            <ul>
                <li>
                    <strong><a href="https://www.youtube.com/watch?v=TaGcUCvNDyA" target="_blank">The Probability of Everything</a></strong> - PBS Infinite Series<br>
                    <span style="color: var(--text-muted);">Histoire des probabilités de Pascal a nos jours</span>
                </li>
                <li>
                    <strong><a href="https://www.youtube.com/watch?v=PNrqClfLrZ8" target="_blank">The Mathematics of Gambling</a></strong> - Numberphile<br>
                    <span style="color: var(--text-muted);">Applications des probabilités aux jeux de hasard</span>
                </li>
                <li>
                    <strong><a href="https://www.arte.tv/fr/videos/RC-014038/les-grands-duels-de-l-art/" target="_blank">Pascal vs Descartes</a></strong> - Arte<br>
                    <span style="color: var(--text-muted);">Rivalite intellectuelle entre deux génies francais</span>
                </li>
            </ul>
        </div>

        <div class="box">
            <h4>Lectures</h4>
            <ul>
                <li><strong>Théorie de la Spéculation</strong> - Louis Bachelier (1900) - These originale disponible en ligne</li>
                <li><strong>Against the Gods: The Remarkable Story of Risk</strong> - Peter Bernstein (1996) - Histoire de la gestion du risque</li>
                <li><strong>The (Mis)Behavior of Markets</strong> - Benoit Mandelbrot (2004) - Critique de l'hypothèse de normalite</li>
            </ul>
        </div>

        <!-- EXERCICES -->
        <h2 id="exercices-m2">Exercices</h2>

        <p>Testez votre comprehension avec ces exercices interactifs.</p>

        <h3>Niveau 1 : Comprehension</h3>

        <div class="exercise-box">
            <h4>Exercice 1.1 - Concepts cles</h4>
            <p>Reliez chaque concept à son auteur :</p>

            <div style="margin: 20px 0;">
                <div class="chronology-item">
                    <select class="matching-select" id="m2-match1">
                        <option value="">?</option>
                        <option value="1">Pascal</option>
                        <option value="2">Bernoulli</option>
                        <option value="3">Bachelier</option>
                    </select>
                    <span>Fonction d'utilite logarithmique</span>
                </div>
                <div class="chronology-item">
                    <select class="matching-select" id="m2-match2">
                        <option value="">?</option>
                        <option value="1">Pascal</option>
                        <option value="2">Bernoulli</option>
                        <option value="3">Bachelier</option>
                    </select>
                    <span>Mouvement brownien en finance</span>
                </div>
                <div class="chronology-item">
                    <select class="matching-select" id="m2-match3">
                        <option value="">?</option>
                        <option value="1">Pascal</option>
                        <option value="2">Bernoulli</option>
                        <option value="3">Bachelier</option>
                    </select>
                    <span>Triangle arithmétique pour les probabilités</span>
                </div>
            </div>

            <button class="check-btn" onclick="checkM2Match()">Verifier</button>
            <div id="feedback-m2-match" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Fonction d'utilite logarithmique : <strong>Bernoulli</strong> (1738)</p>
                    <p>Mouvement brownien en finance : <strong>Bachelier</strong> (1900)</p>
                    <p>Triangle arithmétique : <strong>Pascal</strong> (1654)</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 1.2 - Vrai ou Faux</h4>
            <p>Cochez les affirmations correctes :</p>

            <div style="margin: 15px 0;">
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="m2-vf1"> La these de Bachelier a été immediatement reconnue comme révolutionnaire
                </label>
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="m2-vf2"> L'espérance du jeu de Saint-Pétersbourg est infinie
                </label>
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="m2-vf3"> L'aversion au risque explique pourquoi les actifs risques ont une prime
                </label>
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="m2-vf4"> Le problème des partis concernait le partage d'un héritage
                </label>
            </div>

            <button class="check-btn" onclick="checkM2VF()">Verifier</button>
            <div id="feedback-m2-vf" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Faux</strong> : La these de Bachelier n'a recu que la mention "honorable" et fut oubliee pendant 55 ans.</p>
                    <p><strong>Vrai</strong> : L'espérance est 1+1+1+... = infini, c'est le paradoxe.</p>
                    <p><strong>Vrai</strong> : La prime de risque compense l'aversion naturelle des investisseurs.</p>
                    <p><strong>Faux</strong> : Il s'agissait du partage des mises d'un jeu de hasard interrompu.</p>
                </div>
            </details>
        </div>

        <h3>Niveau 2 : Application</h3>

        <div class="exercise-box">
            <h4>Exercice 2.1 - Calcul d'espérance</h4>
            <p><strong>Probleme :</strong> Un investissement a 60% de chances de rapporter 1000 EUR et 40% de chances de perdre 500 EUR. Calculez l'espérance de gain.</p>

            <div class="calc-row">
                <span class="calc-label">E(X) =</span>
                <input type="number" class="exercise-calc-input" id="m2-esp" placeholder="Ex: 400">
                <span class="calc-unit">EUR</span>
            </div>

            <button class="check-btn" onclick="checkM2Esperance()">Verifier</button>
            <div id="feedback-m2-esp" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>E(X) = 0.60 x 1000 + 0.40 x (-500)</p>
                    <p>E(X) = 600 - 200 = <strong>400 EUR</strong></p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 2.2 - Probleme des partis</h4>
            <p><strong>Situation :</strong> A et B jouent a pile ou face. Le premier a 3 victoires gagne 100 EUR. La partie est interrompue : A a 2 victoires, B a 1 victoire.</p>
            <p>Quelle somme devrait recevoir A ?</p>

            <div class="calc-row">
                <span class="calc-label">Part de A =</span>
                <input type="number" class="exercise-calc-input" id="m2-partis" placeholder="Ex: 75">
                <span class="calc-unit">EUR</span>
            </div>

            <button class="check-btn" onclick="checkM2Partis()">Verifier</button>
            <div id="feedback-m2-partis" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Si on joue une manche : A gagne tout (prob 1/2) ou égalité 2-2 (prob 1/2)</p>
                    <p>Si égalité 2-2 : chacun a 1/2 chance de gagner</p>
                    <p>Esperance de A = 1/2 x 100 + 1/2 x (1/2 x 100 + 1/2 x 0) = 50 + 25 = <strong>75 EUR</strong></p>
                </div>
            </details>
        </div>

        <h3>Niveau 3 : Analyse</h3>

        <div class="exercise-box">
            <h4>Exercice 3.1 - Reflexion sur l'utilite</h4>
            <p><strong>Question :</strong> Pourquoi un milliardaire et un salarie moyen ne prendraient-ils pas les mêmes decisions d'investissement face au même choix risque ? Utilisez la théorie de Bernoulli pour expliquer.</p>

            <textarea class="exercise-input" id="m2-analyse" rows="4" placeholder="Expliquez en utilisant les concepts d'utilite marginale et d'aversion au risque..."></textarea>

            <button class="check-btn" onclick="checkM2Analyse()">Verifier</button>
            <div id="feedback-m2-analyse" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Selon Bernoulli, l'utilite marginale de l'argent est décroissante (fonction logarithmique). Un euro supplémentaire a plus de valeur pour quelqu'un de pauvre que pour un riche.</p>
                    <p>Donc :</p>
                    <ul>
                        <li>Le salarie ressent plus intensement une perte potentielle (utilite marginale élevée)</li>
                        <li>Le milliardaire peut se permettre de perdre sans impact significatif sur son utilite</li>
                        <li>Le salarie sera plus <strong>averse au risque</strong> et préfèrera des placements surs</li>
                        <li>Le milliardaire pourra accepter plus de risque pour un même rendement espère</li>
                    </ul>
                </div>
            </details>
        </div>

        <!-- FLASHCARDS -->
        <h2 id="flashcards-m2">Flashcards</h2>

        <p>Cliquez sur une carte pour voir la réponse. Revisez a J+1, J+3, J+7, J+14, J+30.</p>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que l'espérance mathématique ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Moyenne pondérée des valeurs possibles par leurs probabilités : E(X) = sum(xi * P(xi))</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quel est le paradoxe de Saint-Pétersbourg ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Jeu avec espérance infinie mais valeur percue finie. Resolu par l'utilite de Bernoulli.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quelle fonction d'utilite propose Bernoulli ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>U(W) = ln(W) - Fonction logarithmique, concave, utilite marginale décroissante</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'a decouvert Bachelier en 1900 ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Les prix suivent un mouvement brownien (marché aléatoire). Base de la finance quantitative.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que l'aversion au risque ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Préférence pour un gain certain plutôt qu'un gain aléatoire de même espérance. Explique la prime de risque.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qui a redecouvert la these de Bachelier ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Paul Samuelson en 1955, 55 ans après sa publication</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que le problème des partis ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Comment répartir équitablement les mises d'un jeu interrompu. Resolu par Pascal-Fermat (1654).</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>A quoi sert le triangle de Pascal en finance ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Calcul des coefficients binomiaux pour le modèle d'options de Cox-Ross-Rubinstein</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quelle mention Bachelier a-t-il obtenue pour sa these ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>"Honorable" au lieu de "très honorable" - Poincare etait sceptique sur l'application financière</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce qu'un mouvement brownien ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Processus aléatoire continu avec increments indépendants et normalement distribués. W(0)=0.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quelle hypothèse centrale fait Bachelier sur les marchés ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Le marché ne croit ni à la hausse ni à la baisse - les variations sont imprevisibles</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Date de la correspondance Pascal-Fermat ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>1654 - Naissance du calcul des probabilités</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module1')">Precedent : Origines</button>
            <button class="nav-btn" onclick="showModule('module3')">Suivant : Revolution Quantitative</button>
        </div>
    </section>

    <!-- Placeholders -->
    <section id="module3" class="module">

        <header class="module-header">
            <h1>La Révolution Quantitative (1952-1973)</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermédiaire</span>
                <span>75 minutes</span>
                <span>Prérequis : Module 2</span>
            </div>
        </header>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/e/e1/Markowitz_frontier.jpg" alt="Frontière efficiente de Markowitz">
            <figcaption>Harry Markowitz (1927-2023) - Prix Nobel 1990, père de la théorie moderne du portefeuille et de la frontière efficiente</figcaption>
        </figure>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre la révolution initiée par Markowitz avec la théorie moderne du portefeuille</li>
            <li>Maîtriser les concepts de diversification, frontière efficiente et portefeuille optimal</li>
            <li>Analyser le CAPM de Sharpe et la notion de bêta</li>
            <li>Découvrir l'hypothèse des marchés efficients de Fama</li>
            <li>Comprendre la révolution Black-Scholes-Merton dans l'évaluation des options</li>
        </ul>

        <div class="box">
            <h4>Contexte : L'Âge d'Or de la Finance Académique</h4>
            <p>Entre 1952 et 1973, une poignée d'universitaires américains va transformer la finance d'un art en une science. Ces vingt années verront naître les concepts fondamentaux qui gouvernent encore aujourd'hui des milliers de milliards de dollars : la diversification optimale, le risque systématique, l'efficience des marchés et l'évaluation des produits dérivés. Six prix Nobel récompenseront ces travaux.</p>
        </div>

        <!-- TIMELINE -->
        <h2>Chronologie de la Révolution (1952-1973)</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1952</div>
                <div class="timeline-content">
                    <strong>Portfolio Selection - Harry Markowitz</strong><br>
                    Article fondateur de la théorie moderne du portefeuille dans le Journal of Finance
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1958</div>
                <div class="timeline-content">
                    <strong>Théorème de Modigliani-Miller</strong><br>
                    Démonstration que la structure du capital n'affecte pas la valeur de l'entreprise (en l'absence d'impôts)
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1961</div>
                <div class="timeline-content">
                    <strong>Efficient Capital Markets - Eugene Fama</strong><br>
                    Première formulation de l'hypothèse d'efficience des marchés (thèse de doctorat)
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1964</div>
                <div class="timeline-content">
                    <strong>Capital Asset Pricing Model - William Sharpe</strong><br>
                    Publication du CAPM, modèle d'équilibre des actifs financiers
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1965</div>
                <div class="timeline-content">
                    <strong>Random Walks in Stock Market Prices - Fama</strong><br>
                    Validation empirique de la marche aléatoire des prix
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1970</div>
                <div class="timeline-content">
                    <strong>Efficient Capital Markets: A Review - Fama</strong><br>
                    Formalisation des trois formes d'efficience (faible, semi-forte, forte)
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1973</div>
                <div class="timeline-content">
                    <strong>Option Pricing - Black, Scholes, Merton</strong><br>
                    Publication de la formule révolutionnaire d'évaluation des options
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1973</div>
                <div class="timeline-content">
                    <strong>Chicago Board Options Exchange (CBOE)</strong><br>
                    Création du premier marché organisé d'options, la théorie devient pratique
                </div>
            </div>
        </div>

        <!-- SECTION 1: MARKOWITZ -->
        <h2>Harry Markowitz : La Théorie Moderne du Portefeuille (1952)</h2>

        <p>En 1952, Harry Markowitz, alors étudiant en doctorat à l'Université de Chicago, publie un article de 14 pages qui va révolutionner la gestion d'actifs. Intitulé "Portfolio Selection", cet article introduit l'idée que le risque d'un portefeuille ne dépend pas seulement du risque de chaque actif, mais aussi de leurs <span class="text-red">corrélations</span>.</p>

        <p>Avant Markowitz, les investisseurs choisissaient les actifs un par un, cherchant les meilleurs rendements. Markowitz démontre qu'il faut penser en termes de <strong>portefeuille global</strong> : un actif "mauvais" individuellement peut améliorer le profil risque-rendement d'un portefeuille s'il est peu corrélé aux autres.</p>

        <h3>Le Concept Fondamental : La Diversification</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Diversification</span></h4>
            <p>La diversification consiste à répartir un investissement entre plusieurs actifs pour réduire le risque total. Le principe clé est que des actifs imparfaitement corrélés permettent de réduire la volatilité du portefeuille sans sacrifier le rendement espéré.</p>
            <p><strong>Formule clé :</strong> Pour deux actifs, la variance du portefeuille est :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; margin: 15px 0;">
                σ²_p = w₁²σ₁² + w₂²σ₂² + 2w₁w₂ρ₁₂σ₁σ₂
            </p>
            <p>où ρ₁₂ est la corrélation entre les deux actifs. Si ρ₁₂ < 1, le risque du portefeuille est inférieur à la moyenne pondérée des risques individuels.</p>
        </div>

        <h3>La Frontière Efficiente</h3>

        <p>Markowitz introduit le concept de <span class="text-red">frontière efficiente</span> : l'ensemble des portefeuilles qui offrent le meilleur rendement possible pour un niveau de risque donné, ou le risque minimal pour un rendement donné.</p>

        <div class="box">
            <h4>Définition : <span class="text-red">Frontière Efficiente</span></h4>
            <p>La frontière efficiente est la courbe dans l'espace risque-rendement représentant tous les portefeuilles optimaux. Tout portefeuille situé sous cette courbe est "dominé" : il existe un portefeuille avec le même risque mais un meilleur rendement, ou le même rendement mais moins de risque.</p>
            <p>Un investisseur rationnel ne devrait détenir que des portefeuilles sur la frontière efficiente.</p>
        </div>

        <!-- Chart for efficient frontier -->
        <div class="chart-container">
            <canvas id="efficientFrontierChart"></canvas>
        </div>

        <h3>Le Portefeuille à Variance Minimale</h3>

        <p>Le point le plus à gauche de la frontière efficiente est le <span class="text-red">portefeuille à variance minimale globale</span> (GMV - Global Minimum Variance). C'est le portefeuille le moins risqué possible avec les actifs disponibles, quelle que soit l'espérance de rendement.</p>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Risque Diversifiable</h4>
                <p>Aussi appelé <span class="text-red">risque spécifique</span> ou idiosyncratique. C'est le risque propre à chaque entreprise (mauvaise gestion, procès, etc.) qui peut être éliminé par diversification.</p>
            </div>
            <div class="grid-item">
                <h4>Risque Non-Diversifiable</h4>
                <p>Aussi appelé <span class="text-red">risque systématique</span> ou de marché. C'est le risque qui affecte tous les actifs (récession, inflation, guerre) et qui ne peut pas être éliminé.</p>
            </div>
        </div>

        <blockquote>
            <p>"La diversification est la seule stratégie gratuite en finance."</p>
            <cite>Harry Markowitz, conférence Nobel 1990</cite>
        </blockquote>

        <!-- SECTION 2: SHARPE CAPM -->
        <h2>William Sharpe : Le CAPM (1964)</h2>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/1/1a/William_sharpe_2007.jpg" alt="William Sharpe">
            <figcaption>William Sharpe (né en 1934) - Prix Nobel 1990, créateur du CAPM et du ratio de Sharpe</figcaption>
        </figure>

        <p>William Sharpe, élève de Markowitz, simplifie et étend la théorie du portefeuille avec le <span class="text-red">Capital Asset Pricing Model</span> (CAPM). Ce modèle répond à une question fondamentale : quel rendement devrait exiger un investisseur pour détenir un actif risqué ?</p>

        <h3>Les Hypothèses du CAPM</h3>

        <ul>
            <li>Les investisseurs sont rationnels et averses au risque</li>
            <li>Les marchés sont efficients et sans frictions (pas de taxes, pas de coûts de transaction)</li>
            <li>Tous les investisseurs ont accès aux mêmes informations</li>
            <li>Il existe un actif sans risque auquel on peut emprunter ou prêter</li>
            <li>Les investisseurs optimisent sur une seule période</li>
        </ul>

        <h3>L'Équation Fondamentale du CAPM</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Capital Asset Pricing Model (CAPM)</span></h4>
            <p>Le rendement espéré d'un actif est fonction linéaire de son risque systématique :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; margin: 15px 0;">
                E(Rᵢ) = Rᶠ + βᵢ × (E(Rₘ) - Rᶠ)
            </p>
            <p>où :</p>
            <ul>
                <li><strong>E(Rᵢ)</strong> = rendement espéré de l'actif i</li>
                <li><strong>Rᶠ</strong> = taux sans risque</li>
                <li><strong>βᵢ</strong> = bêta de l'actif (sensibilité au marché)</li>
                <li><strong>E(Rₘ) - Rᶠ</strong> = <span class="text-red">prime de risque du marché</span></li>
            </ul>
        </div>

        <h3>Le Bêta : Mesure du Risque Systématique</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Bêta (β)</span></h4>
            <p>Le bêta mesure la sensibilité d'un actif aux mouvements du marché :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; margin: 15px 0;">
                β = Cov(Rᵢ, Rₘ) / Var(Rₘ)
            </p>
            <ul>
                <li><strong>β = 1</strong> : l'actif suit le marché</li>
                <li><strong>β > 1</strong> : l'actif amplifie les mouvements du marché (plus risqué)</li>
                <li><strong>β < 1</strong> : l'actif atténue les mouvements (défensif)</li>
                <li><strong>β < 0</strong> : l'actif évolue à l'inverse du marché (rare)</li>
            </ul>
        </div>

        <h3>La Security Market Line (SML)</h3>

        <p>La <span class="text-red">Security Market Line</span> représente graphiquement la relation entre le bêta et le rendement espéré. Tous les actifs correctement évalués devraient se situer sur cette droite.</p>

        <!-- Chart for SML -->
        <div class="chart-container">
            <canvas id="smlChart"></canvas>
        </div>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Alpha Positif (α > 0)</h4>
                <p>Un actif au-dessus de la SML offre un rendement supérieur à ce que prédit le CAPM pour son niveau de risque. Il est <strong>sous-évalué</strong> et devrait être acheté.</p>
            </div>
            <div class="grid-item">
                <h4>Alpha Négatif (α < 0)</h4>
                <p>Un actif sous la SML offre un rendement inférieur à ce que prédit le CAPM. Il est <strong>surévalué</strong> et devrait être vendu.</p>
            </div>
        </div>

        <blockquote>
            <p>"Il ne sert à rien de prendre un risque qui peut être éliminé. Le marché ne récompense que le risque systématique."</p>
            <cite>William Sharpe</cite>
        </blockquote>

        <!-- SECTION 3: FAMA EMH -->
        <h2>Eugene Fama : L'Hypothèse des Marchés Efficients (1965-1970)</h2>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/f/f5/Eugene_Fama_at_Nobel_Prize%2C_2013.jpg" alt="Eugene Fama">
            <figcaption>Eugene Fama (né en 1939) - Prix Nobel 2013, père de l'hypothèse des marchés efficients</figcaption>
        </figure>

        <p>Eugene Fama, également de l'Université de Chicago, formalise une idée qui était dans l'air depuis Bachelier : sur un marché efficient, les prix reflètent toute l'information disponible. Cette <span class="text-red">Hypothèse des Marchés Efficients</span> (EMH - Efficient Market Hypothesis) a des implications profondes.</p>

        <h3>Les Trois Formes d'Efficience</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Efficience Faible</span></h4>
            <p>Les prix reflètent toute l'information contenue dans les <strong>prix passés</strong>. Implication : l'analyse technique (chartisme) ne peut pas générer de surperformance. Les patterns graphiques sont illusoires.</p>
        </div>

        <div class="box">
            <h4>Définition : <span class="text-red">Efficience Semi-Forte</span></h4>
            <p>Les prix reflètent toute l'<strong>information publique</strong> (rapports annuels, nouvelles, données macroéconomiques). Implication : l'analyse fondamentale ne peut pas générer de surperformance durable. Toute nouvelle information est instantanément incorporée dans les prix.</p>
        </div>

        <div class="box">
            <h4>Définition : <span class="text-red">Efficience Forte</span></h4>
            <p>Les prix reflètent <strong>toute l'information</strong>, y compris l'information privée (insider). Implication : même les initiés ne peuvent pas battre le marché. Cette forme est généralement rejetée empiriquement.</p>
        </div>

        <h3>Implications pour les Investisseurs</h3>

        <table>
            <thead>
                <tr>
                    <th>Forme d'efficience</th>
                    <th>Stratégie inutile</th>
                    <th>Stratégie possible</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Faible</td>
                    <td>Analyse technique</td>
                    <td>Analyse fondamentale</td>
                </tr>
                <tr>
                    <td>Semi-forte</td>
                    <td>Analyse technique + fondamentale</td>
                    <td>Information privilégiée (illégal)</td>
                </tr>
                <tr>
                    <td>Forte</td>
                    <td>Toutes les stratégies</td>
                    <td>Gestion passive uniquement</td>
                </tr>
            </tbody>
        </table>

        <div class="box">
            <h4>Conséquence : La Gestion Passive</h4>
            <p>Si les marchés sont efficients, la meilleure stratégie est la <span class="text-red">gestion passive</span> : détenir un portefeuille diversifié qui réplique le marché (index fund) plutôt que de chercher à battre le marché (gestion active). Cette idée donnera naissance à l'industrie des ETF (Exchange-Traded Funds).</p>
        </div>

        <blockquote>
            <p>"Je pense que les marchés sont efficients la plupart du temps, pour la plupart des actifs."</p>
            <cite>Eugene Fama, discours Nobel 2013</cite>
        </blockquote>

        <!-- SECTION 4: BLACK-SCHOLES -->
        <h2>Black, Scholes et Merton : La Révolution des Options (1973)</h2>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/c/cc/Myron_Scholes_2008_in_Lindau.png" alt="Myron Scholes">
            <figcaption>Myron Scholes (né en 1941) - Prix Nobel 1997, co-créateur de la formule Black-Scholes</figcaption>
        </figure>

        <p>En 1973, Fischer Black, Myron Scholes et Robert Merton publient des travaux qui vont créer une industrie entière : celle des produits dérivés. La <span class="text-red">formule de Black-Scholes</span> permet d'évaluer le prix "juste" d'une option européenne.</p>

        <p>La même année, le Chicago Board Options Exchange (CBOE) ouvre ses portes. Pour la première fois, les options sont négociées sur un marché organisé. La théorie et la pratique convergent.</p>

        <h3>Le Problème de l'Évaluation des Options</h3>

        <p>Une <span class="text-red">option d'achat</span> (call) donne le droit, mais pas l'obligation, d'acheter un actif à un prix fixé (strike) avant une date donnée (maturité). Comment déterminer sa valeur ?</p>

        <p>Avant Black-Scholes, il n'existait pas de méthode rigoureuse. Les traders utilisaient l'intuition et l'expérience. Black, Scholes et Merton démontrent qu'on peut éliminer tout risque en ajustant continuellement une position combinant l'option et l'actif sous-jacent.</p>

        <h3>La Formule de Black-Scholes</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Formule de Black-Scholes</span></h4>
            <p>Le prix d'un call européen est :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; margin: 15px 0;">
                C = S₀ × N(d₁) - K × e⁻ʳᵀ × N(d₂)
            </p>
            <p>où :</p>
            <ul>
                <li><strong>S₀</strong> = prix actuel de l'actif sous-jacent</li>
                <li><strong>K</strong> = prix d'exercice (strike)</li>
                <li><strong>r</strong> = taux sans risque</li>
                <li><strong>T</strong> = temps jusqu'à maturité</li>
                <li><strong>N(·)</strong> = fonction de répartition de la loi normale</li>
                <li><strong>d₁, d₂</strong> = termes dépendant de S₀, K, r, T et σ (volatilité)</li>
            </ul>
        </div>

        <h3>Les Cinq Paramètres</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Paramètres Observables</h4>
                <ul>
                    <li><strong>S₀</strong> - Prix spot du sous-jacent</li>
                    <li><strong>K</strong> - Prix d'exercice (dans le contrat)</li>
                    <li><strong>T</strong> - Temps à maturité</li>
                    <li><strong>r</strong> - Taux sans risque (bons du Trésor)</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Paramètre Non-Observable</h4>
                <ul>
                    <li><strong>σ</strong> - <span class="text-red">Volatilité</span> du sous-jacent</li>
                </ul>
                <p>C'est le seul paramètre qu'on ne peut pas observer directement. On peut l'estimer historiquement ou l'extraire des prix de marché (<span class="text-red">volatilité implicite</span>).</p>
            </div>
        </div>

        <h3>L'Évaluation Risque-Neutre</h3>

        <div class="box">
            <h4>Concept : <span class="text-red">Évaluation Risque-Neutre</span></h4>
            <p>La révolution conceptuelle de Black-Scholes-Merton est l'<span class="text-red">évaluation risque-neutre</span> : pour évaluer une option, on peut faire comme si tous les investisseurs étaient neutres au risque. Le prix d'un dérivé est l'espérance actualisée de son payoff sous la mesure risque-neutre.</p>
            <p>Cette idée puissante permet d'évaluer des instruments complexes sans connaître les préférences des investisseurs.</p>
        </div>

        <h3>L'Impact Révolutionnaire</h3>

        <table>
            <thead>
                <tr>
                    <th>Année</th>
                    <th>Événement</th>
                    <th>Impact</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1973</td>
                    <td>Publication de la formule</td>
                    <td>Fondation théorique du pricing</td>
                </tr>
                <tr>
                    <td>1973</td>
                    <td>Ouverture du CBOE</td>
                    <td>Premier marché d'options organisé</td>
                </tr>
                <tr>
                    <td>1983</td>
                    <td>Options sur indices (S&P 100)</td>
                    <td>Couverture de portefeuille possible</td>
                </tr>
                <tr>
                    <td>1997</td>
                    <td>Prix Nobel à Scholes et Merton</td>
                    <td>Reconnaissance académique (Black décédé en 1995)</td>
                </tr>
                <tr>
                    <td>2023</td>
                    <td>Marché des dérivés</td>
                    <td>600+ trillions de dollars de notionnel</td>
                </tr>
            </tbody>
        </table>

        <blockquote>
            <p>"L'idée clé est qu'on peut répliquer le payoff d'une option avec une stratégie de trading dynamique."</p>
            <cite>Robert Merton, discours Nobel 1997</cite>
        </blockquote>

        <!-- SECTION 5: SYNTHESE -->
        <h2>Synthèse : L'Héritage de la Révolution</h2>

        <p>Les vingt années de 1952 à 1973 ont fondé la finance moderne. Ces théories, bien que critiquées et affinées depuis, restent les piliers de l'enseignement et de la pratique financière.</p>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Markowitz (1952)</h4>
                <p>Diversification, frontière efficiente, optimisation moyenne-variance. Base de la gestion de portefeuille institutionnelle.</p>
            </div>
            <div class="grid-item">
                <h4>Sharpe (1964)</h4>
                <p>CAPM, bêta, distinction risque systématique/spécifique. Standard pour l'évaluation des fonds.</p>
            </div>
            <div class="grid-item">
                <h4>Fama (1970)</h4>
                <p>Efficience des marchés, gestion passive. Fondation de l'industrie des ETF.</p>
            </div>
            <div class="grid-item">
                <h4>Black-Scholes-Merton (1973)</h4>
                <p>Pricing des options, évaluation risque-neutre. Création de l'industrie des dérivés.</p>
            </div>
        </div>

        <div class="box">
            <h4>Les Prix Nobel de la Révolution</h4>
            <table>
                <tr>
                    <th>Année</th>
                    <th>Lauréats</th>
                    <th>Contribution</th>
                </tr>
                <tr>
                    <td>1990</td>
                    <td>Markowitz, Sharpe, Miller</td>
                    <td>Théorie du portefeuille et CAPM</td>
                </tr>
                <tr>
                    <td>1997</td>
                    <td>Scholes, Merton</td>
                    <td>Évaluation des options</td>
                </tr>
                <tr>
                    <td>2013</td>
                    <td>Fama, Hansen, Shiller</td>
                    <td>Efficience et pricing empirique</td>
                </tr>
            </table>
        </div>

        <!-- RESSOURCES -->
        <h2>Ressources</h2>

        <div class="box">
            <h4>Documentaires</h4>
            <ul>
                <li>
                    <strong><a href="https://www.youtube.com/watch?v=KvQVoovFs8g" target="_blank">Trillion Dollar Bet</a></strong> - PBS Nova (2000)<br>
                    <span style="color: var(--text-muted);">Histoire de Black-Scholes et la chute de LTCM</span>
                </li>
                <li>
                    <strong><a href="https://www.youtube.com/watch?v=A5w-dEgIU1M" target="_blank">The Quants</a></strong> - VPRO Documentary<br>
                    <span style="color: var(--text-muted);">L'essor de la finance quantitative à Wall Street</span>
                </li>
            </ul>
        </div>

        <div class="box">
            <h4>Lectures</h4>
            <ul>
                <li><strong>Portfolio Selection</strong> - Harry Markowitz (1952) - Article original de 14 pages</li>
                <li><strong>Capital Asset Prices</strong> - William Sharpe (1964) - Article fondateur du CAPM</li>
                <li><strong>The Pricing of Options and Corporate Liabilities</strong> - Black & Scholes (1973)</li>
                <li><strong>My Life as a Quant</strong> - Emanuel Derman (2004) - Mémoires d'un physicien devenu quant</li>
            </ul>
        </div>

        <!-- EXERCICES -->
        <h2 id="exercices-m3">Exercices</h2>

        <p>Testez votre compréhension avec ces exercices interactifs.</p>

        <h3>Niveau 1 : Compréhension</h3>

        <div class="exercise-box">
            <h4>Exercice 1.1 - Concepts clés</h4>
            <p>Reliez chaque concept à son auteur :</p>

            <div style="margin: 20px 0;">
                <div class="chronology-item">
                    <select class="matching-select" id="m3-match1">
                        <option value="">?</option>
                        <option value="1">Markowitz</option>
                        <option value="2">Sharpe</option>
                        <option value="3">Fama</option>
                        <option value="4">Black-Scholes</option>
                    </select>
                    <span>Bêta et risque systématique</span>
                </div>
                <div class="chronology-item">
                    <select class="matching-select" id="m3-match2">
                        <option value="">?</option>
                        <option value="1">Markowitz</option>
                        <option value="2">Sharpe</option>
                        <option value="3">Fama</option>
                        <option value="4">Black-Scholes</option>
                    </select>
                    <span>Frontière efficiente</span>
                </div>
                <div class="chronology-item">
                    <select class="matching-select" id="m3-match3">
                        <option value="">?</option>
                        <option value="1">Markowitz</option>
                        <option value="2">Sharpe</option>
                        <option value="3">Fama</option>
                        <option value="4">Black-Scholes</option>
                    </select>
                    <span>Efficience des marchés</span>
                </div>
                <div class="chronology-item">
                    <select class="matching-select" id="m3-match4">
                        <option value="">?</option>
                        <option value="1">Markowitz</option>
                        <option value="2">Sharpe</option>
                        <option value="3">Fama</option>
                        <option value="4">Black-Scholes</option>
                    </select>
                    <span>Évaluation risque-neutre des options</span>
                </div>
            </div>

            <button class="check-btn" onclick="checkM3Match()">Vérifier</button>
            <div id="feedback-m3-match" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Bêta et risque systématique : <strong>Sharpe</strong> (CAPM, 1964)</p>
                    <p>Frontière efficiente : <strong>Markowitz</strong> (1952)</p>
                    <p>Efficience des marchés : <strong>Fama</strong> (1970)</p>
                    <p>Évaluation risque-neutre : <strong>Black-Scholes</strong> (1973)</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 1.2 - Vrai ou Faux</h4>
            <p>Cochez les affirmations correctes :</p>

            <div style="margin: 15px 0;">
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="m3-vf1"> Un actif avec β > 1 est plus volatil que le marché
                </label>
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="m3-vf2"> La diversification élimine le risque systématique
                </label>
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="m3-vf3"> Dans un marché efficient semi-fort, l'analyse technique est inutile
                </label>
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="m3-vf4"> La formule Black-Scholes nécessite de connaître le rendement espéré de l'action
                </label>
            </div>

            <button class="check-btn" onclick="checkM3VF()">Vérifier</button>
            <div id="feedback-m3-vf" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Vrai</strong> : Un β > 1 amplifie les mouvements du marché.</p>
                    <p><strong>Faux</strong> : La diversification élimine le risque spécifique, pas systématique.</p>
                    <p><strong>Vrai</strong> : L'efficience semi-forte implique que les prix passés sont déjà intégrés.</p>
                    <p><strong>Faux</strong> : C'est la beauté de Black-Scholes - on n'a pas besoin du rendement espéré !</p>
                </div>
            </details>
        </div>

        <h3>Niveau 2 : Application</h3>

        <div class="exercise-box">
            <h4>Exercice 2.1 - Calcul du CAPM</h4>
            <p><strong>Données :</strong></p>
            <ul>
                <li>Taux sans risque : 3%</li>
                <li>Prime de risque du marché : 6%</li>
                <li>Bêta de l'action XYZ : 1.5</li>
            </ul>
            <p>Calculez le rendement espéré de l'action XYZ selon le CAPM.</p>

            <div class="calc-row">
                <span class="calc-label">E(R) =</span>
                <input type="number" class="exercise-calc-input" id="m3-capm" placeholder="Ex: 12" step="0.1">
                <span class="calc-unit">%</span>
            </div>

            <button class="check-btn" onclick="checkM3CAPM()">Vérifier</button>
            <div id="feedback-m3-capm" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>E(R) = Rf + β × (Rm - Rf)</p>
                    <p>E(R) = 3% + 1.5 × 6%</p>
                    <p>E(R) = 3% + 9% = <strong>12%</strong></p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 2.2 - Diversification</h4>
            <p><strong>Données :</strong> Deux actifs A et B avec σA = 20%, σB = 30%, et corrélation ρ = 0.2</p>
            <p>Portefeuille : 50% A + 50% B</p>
            <p>Calculez la volatilité du portefeuille.</p>

            <div class="calc-row">
                <span class="calc-label">σ portefeuille =</span>
                <input type="number" class="exercise-calc-input" id="m3-div" placeholder="Ex: 19.2" step="0.1">
                <span class="calc-unit">%</span>
            </div>

            <button class="check-btn" onclick="checkM3Div()">Vérifier</button>
            <div id="feedback-m3-div" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>σ²p = w₁²σ₁² + w₂²σ₂² + 2w₁w₂ρσ₁σ₂</p>
                    <p>σ²p = 0.25×0.04 + 0.25×0.09 + 2×0.25×0.2×0.2×0.3</p>
                    <p>σ²p = 0.01 + 0.0225 + 0.006 = 0.0385</p>
                    <p>σp = √0.0385 = <strong>19.6%</strong></p>
                    <p>Note : Sans diversification, la moyenne serait (20+30)/2 = 25%. La corrélation imparfaite réduit le risque.</p>
                </div>
            </details>
        </div>

        <h3>Niveau 3 : Analyse</h3>

        <div class="exercise-box">
            <h4>Exercice 3.1 - Critique de l'EMH</h4>
            <p><strong>Question :</strong> Si les marchés sont vraiment efficients, comment expliquer l'existence de hedge funds très performants comme Renaissance Technologies (33% de rendement annuel moyen) ? Proposez deux explications.</p>

            <textarea class="exercise-input" id="m3-analyse" rows="4" placeholder="Analysez les limites de l'hypothèse d'efficience..."></textarea>

            <button class="check-btn" onclick="checkM3Analyse()">Vérifier</button>
            <div id="feedback-m3-analyse" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Plusieurs explications possibles :</p>
                    <ul>
                        <li><strong>Anomalies temporaires</strong> : Les marchés ne sont pas parfaitement efficients à chaque instant. Des inefficiences peuvent exister brièvement avant d'être arbitrées.</li>
                        <li><strong>Prime de liquidité</strong> : Certains fonds exploitent des actifs illiquides où l'efficience est moindre.</li>
                        <li><strong>Information supérieure</strong> : Analyse de données alternatives (satellites, réseaux sociaux) non encore intégrées par le marché.</li>
                        <li><strong>Biais de survie</strong> : On ne parle que des fonds qui ont réussi. Des milliers ont échoué.</li>
                        <li><strong>Risques cachés</strong> : Les rendements élevés compensent peut-être des risques non mesurés (tail risk).</li>
                    </ul>
                </div>
            </details>
        </div>

        <!-- FLASHCARDS -->
        <h2 id="flashcards-m3">Flashcards</h2>

        <p>Cliquez sur une carte pour voir la réponse. Révisez à J+1, J+3, J+7, J+14, J+30.</p>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que la frontière efficiente ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Ensemble des portefeuilles offrant le meilleur rendement pour chaque niveau de risque (Markowitz, 1952)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Formule du CAPM ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>E(Ri) = Rf + βi × (E(Rm) - Rf)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Que mesure le bêta (β) ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>La sensibilité d'un actif aux mouvements du marché (risque systématique)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quelles sont les 3 formes d'efficience ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Faible (prix passés), Semi-forte (info publique), Forte (toute info)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>La diversification élimine quel type de risque ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Le risque spécifique (idiosyncratique). Le risque systématique reste.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quels sont les 5 paramètres de Black-Scholes ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>S (spot), K (strike), T (maturité), r (taux), σ (volatilité)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que l'alpha (α) ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Surperformance d'un actif par rapport à ce que prédit le CAPM pour son niveau de risque</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Année de création du CBOE ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>1973 - Premier marché d'options organisé</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qui a reçu le Nobel 1990 ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Markowitz, Sharpe et Miller (théorie du portefeuille et CAPM)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que la volatilité implicite ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>La volatilité déduite du prix de marché d'une option via la formule Black-Scholes</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module2')">Précédent : Fondations Mathématiques</button>
            <button class="nav-btn" onclick="showModule('module4')">Suivant : Ère Moderne et Crises</button>
        </div>
    </section>

    <section id="module4" class="module">

        <header class="module-header">
            <h1>L'Ère Moderne : Crises et Innovations (1987-2024)</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>90 minutes</span>
                <span>Prérequis : Modules 1-3</span>
            </div>
        </header>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/9/99/NYC_NYSE.jpg" alt="New York Stock Exchange">
            <figcaption>New York Stock Exchange - Épicentre des marchés financiers mondiaux</figcaption>
        </figure>

        <h4>Objectifs</h4>
        <ul>
            <li>Analyser les grandes crises financières et leurs causes (1987, LTCM, 2008, Flash Crash)</li>
            <li>Comprendre les limites des modèles quantitatifs révélées par ces crises</li>
            <li>Découvrir l'émergence des hedge funds quantitatifs (Renaissance, DE Shaw, Two Sigma)</li>
            <li>Explorer le trading haute fréquence (HFT) et son impact sur les marchés</li>
            <li>Comprendre l'application du Machine Learning en finance</li>
            <li>Analyser l'émergence des crypto-actifs et de la DeFi</li>
        </ul>

        <div class="box">
            <h4>Le Paradoxe de la Finance Moderne</h4>
            <p>Les décennies 1987-2024 illustrent un paradoxe : jamais les marchés n'ont été aussi sophistiqués mathématiquement, et pourtant les crises ont été parmi les plus violentes de l'histoire. Les modèles de Black-Scholes, CAPM et VaR, célébrés par des prix Nobel, ont montré leurs limites dans les moments de stress. Cette période a forgé une nouvelle sagesse : <em>"Tous les modèles sont faux, mais certains sont utiles"</em> (George Box).</p>
        </div>

        <!-- TIMELINE -->
        <h2>Chronologie des Crises et Innovations</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1987</div>
                <div class="timeline-content">
                    <strong>Black Monday - 19 octobre</strong><br>
                    Le Dow Jones chute de 22.6% en une journée. Pire krach depuis 1929.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1988</div>
                <div class="timeline-content">
                    <strong>Renaissance Technologies - Medallion Fund</strong><br>
                    Jim Simons lance le fonds quantitatif le plus performant de l'histoire.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1994</div>
                <div class="timeline-content">
                    <strong>J.P. Morgan lance RiskMetrics</strong><br>
                    Démocratisation du Value at Risk (VaR) comme mesure de risque standard.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1998</div>
                <div class="timeline-content">
                    <strong>Faillite de LTCM</strong><br>
                    Le hedge fund des Nobel (Scholes, Merton) perd 4.6 milliards et menace le système.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">2007-2008</div>
                <div class="timeline-content">
                    <strong>Crise des Subprimes</strong><br>
                    Effondrement de Lehman Brothers. Pire crise financière depuis 1929.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">2009</div>
                <div class="timeline-content">
                    <strong>Naissance du Bitcoin</strong><br>
                    Satoshi Nakamoto crée la première cryptomonnaie décentralisée.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">2010</div>
                <div class="timeline-content">
                    <strong>Flash Crash - 6 mai</strong><br>
                    Le Dow Jones perd 1000 points en 5 minutes avant de rebondir.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">2020</div>
                <div class="timeline-content">
                    <strong>COVID Crash - Mars</strong><br>
                    Chute de 34% du S&P 500 en 23 jours, puis reprise record.
                </div>
            </div>
        </div>

        <!-- SECTION 1: BLACK MONDAY 1987 -->
        <h2>Black Monday 1987 : Le Premier Krach Moderne</h2>

        <p>Le lundi 19 octobre 1987, le Dow Jones Industrial Average s'effondre de <strong>22.6%</strong> en une seule journée - la plus forte baisse quotidienne de son histoire. À Hong Kong, Londres, Sydney, les marchés s'effondrent en cascade. En deux jours, 1.7 trillion de dollars de capitalisation s'évaporent.</p>

        <h3>Les Causes : Portfolio Insurance et Feedback Loops</h3>

        <p>Une innovation financière est au cœur du krach : le <span class="text-red">portfolio insurance</span>. Cette stratégie, basée sur le modèle Black-Scholes, promettait de protéger les portefeuilles contre les baisses en vendant automatiquement des futures quand les marchés chutaient.</p>

        <div class="box">
            <h4>Concept : <span class="text-red">Portfolio Insurance</span></h4>
            <p>Stratégie de couverture dynamique qui réplique une option de vente (put) en ajustant continuellement la position en futures selon le delta. En théorie, elle limite les pertes sans sacrifier les gains.</p>
            <p><strong>Le problème :</strong> Quand tout le monde vend en même temps, la stratégie amplifie la baisse au lieu de protéger. C'est une <span class="text-red">boucle de rétroaction positive</span> (positive feedback loop).</p>
        </div>

        <h3>Les Leçons du Black Monday</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Risque de Modèle</h4>
                <p>Les modèles supposent que les marchés sont liquides et que les transactions n'affectent pas les prix. En période de stress, ces hypothèses s'effondrent.</p>
            </div>
            <div class="grid-item">
                <h4>Circuit Breakers</h4>
                <p>Après 1987, les bourses introduisent des <span class="text-red">coupe-circuits</span> (circuit breakers) qui suspendent les cotations lors de baisses extrêmes.</p>
            </div>
        </div>

        <div class="box">
            <h4>Le Smile de Volatilité</h4>
            <p>Avant 1987, la <span class="text-red">volatilité implicite</span> était relativement constante pour tous les strikes. Après le krach, les options hors de la monnaie (puts protecteurs) deviennent beaucoup plus chères, créant le fameux <span class="text-red">smile de volatilité</span> (ou skew). Les marchés ont "appris" que les queues de distribution sont plus épaisses que prévu par le modèle gaussien.</p>
        </div>

        <!-- SECTION 2: LTCM -->
        <h2>LTCM 1998 : Quand les Génies Échouent</h2>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/c/cc/Myron_Scholes_2008_in_Lindau.png" alt="Myron Scholes">
            <figcaption>Myron Scholes - Prix Nobel 1997, partenaire de LTCM</figcaption>
        </figure>

        <p>Long-Term Capital Management (LTCM) était le hedge fund le plus prestigieux de l'histoire. Fondé en 1994 par John Meriwether (star de Salomon Brothers), il comptait parmi ses partenaires deux prix Nobel : Myron Scholes et Robert Merton, les créateurs du modèle d'évaluation des options.</p>

        <p>Le fonds utilisait des stratégies d'<span class="text-red">arbitrage de convergence</span> : parier que des écarts de prix "anormaux" entre actifs similaires finiraient par se résorber. Pendant quatre ans, LTCM généra des rendements exceptionnels : +21%, +43%, +41%, +17%.</p>

        <h3>La Chute : Août-Septembre 1998</h3>

        <p>En août 1998, la Russie fait défaut sur sa dette. La panique gagne les marchés mondiaux. Les investisseurs fuient vers la qualité (flight to quality), achetant des bons du Trésor US et vendant tout le reste. Les spreads que LTCM pariait voir converger... <strong>divergent violemment</strong>.</p>

        <div class="box">
            <h4>Les Chiffres de la Catastrophe</h4>
            <table>
                <tr>
                    <th>Métrique</th>
                    <th>Valeur</th>
                </tr>
                <tr>
                    <td>Capital initial (1994)</td>
                    <td>1.25 milliard $</td>
                </tr>
                <tr>
                    <td>Capital au pic (1997)</td>
                    <td>7 milliards $</td>
                </tr>
                <tr>
                    <td>Positions notionnelles</td>
                    <td>1.25 trillion $ (!)</td>
                </tr>
                <tr>
                    <td>Levier</td>
                    <td>25:1 (voire 50:1 sur certaines positions)</td>
                </tr>
                <tr>
                    <td>Pertes en août-sept 1998</td>
                    <td>4.6 milliards $ (92% du capital)</td>
                </tr>
            </table>
        </div>

        <h3>Le Sauvetage et les Leçons</h3>

        <p>La Fed de New York organise un sauvetage par un consortium de 14 banques qui injectent 3.6 milliards pour éviter un effondrement systémique. Les positions de LTCM étaient si énormes qu'une liquidation désordonnée aurait déstabilisé le système financier mondial.</p>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Leçon 1 : Le Levier Tue</h4>
                <p>Même une stratégie "sûre" devient mortelle avec un levier excessif. LTCM avait raison sur le fond (les spreads ont convergé après), mais le timing était fatal.</p>
            </div>
            <div class="grid-item">
                <h4>Leçon 2 : Corrélations en Crise</h4>
                <p>En période de stress, toutes les corrélations tendent vers 1. La diversification cesse de fonctionner précisément quand on en a le plus besoin.</p>
            </div>
            <div class="grid-item">
                <h4>Leçon 3 : Risque de Liquidité</h4>
                <p>Les modèles de LTCM ignoraient le <span class="text-red">risque de liquidité</span> : l'impossibilité de déboucler des positions géantes sans faire bouger les prix.</p>
            </div>
            <div class="grid-item">
                <h4>Leçon 4 : Too Big To Fail</h4>
                <p>LTCM introduit le concept de <span class="text-red">risque systémique</span> : certaines entités sont si interconnectées que leur faillite menace tout le système.</p>
            </div>
        </div>

        <blockquote>
            <p>"Markets can remain irrational longer than you can remain solvent."</p>
            <cite>John Maynard Keynes (souvent cité après LTCM)</cite>
        </blockquote>

        <!-- SECTION 3: CRISE 2008 -->
        <h2>La Crise de 2008 : L'Échec Systémique</h2>

        <p>La crise financière de 2007-2008 est la plus grave depuis 1929. Elle révèle les failles de tout le système : des modèles de risque défaillants, des agences de notation complaisantes, des régulateurs dépassés, et une foi aveugle dans la sophistication mathématique.</p>

        <h3>Les Origines : Subprimes et Titrisation</h3>

        <p>Tout commence sur le marché immobilier américain. Les banques accordent des prêts hypothécaires à des emprunteurs peu solvables (subprimes), puis les "titrisent" : elles les regroupent en pools et émettent des obligations (<span class="text-red">MBS</span> - Mortgage-Backed Securities) dont les coupons sont payés par les mensualités des emprunteurs.</p>

        <div class="box">
            <h4>Définition : <span class="text-red">CDO (Collateralized Debt Obligation)</span></h4>
            <p>Produit structuré qui regroupe des créances (souvent des MBS) en tranches de risque différent :</p>
            <ul>
                <li><strong>Senior (AAA)</strong> : payée en premier, risque supposé minimal</li>
                <li><strong>Mezzanine (BBB)</strong> : payée ensuite, rendement plus élevé</li>
                <li><strong>Equity (non notée)</strong> : absorbe les premières pertes, rendement très élevé</li>
            </ul>
            <p>L'alchimie des CDO : transformer des prêts subprimes notés B en tranches notées AAA. Les modèles sous-estimaient les corrélations de défaut.</p>
        </div>

        <h3>L'Effondrement : Septembre 2008</h3>

        <p>Le 15 septembre 2008, Lehman Brothers fait faillite - la plus grande de l'histoire américaine avec 639 milliards de dettes. La panique se propage instantanément. Le crédit se gèle, les banques refusent de se prêter entre elles, le commerce mondial s'arrête.</p>

        <div class="box">
            <h4>Bilan de la Crise</h4>
            <table>
                <tr>
                    <th>Impact</th>
                    <th>Ampleur</th>
                </tr>
                <tr>
                    <td>Pertes des banques mondiales</td>
                    <td>2.8 trillions $</td>
                </tr>
                <tr>
                    <td>Destruction de richesse (actions)</td>
                    <td>30+ trillions $</td>
                </tr>
                <tr>
                    <td>Chute du S&P 500 (pic à creux)</td>
                    <td>-57%</td>
                </tr>
                <tr>
                    <td>Taux de chômage US (pic)</td>
                    <td>10%</td>
                </tr>
                <tr>
                    <td>Sauvetages gouvernementaux US</td>
                    <td>700+ milliards $ (TARP)</td>
                </tr>
            </table>
        </div>

        <h3>Les Failles des Modèles</h3>

        <div class="box">
            <h4>Le <span class="text-red">VaR</span> : Une Fausse Sécurité</h4>
            <p>Le Value at Risk, adopté par Bâle II comme mesure de risque réglementaire, suppose des distributions normales et des corrélations stables. En 2008, les événements "impossibles" (10+ écarts-types) se produisaient quotidiennement.</p>
            <p><strong>Critique de Nassim Taleb :</strong> "Le VaR est comme un airbag qui fonctionne à chaque fois, sauf quand vous avez un accident."</p>
        </div>

        <div class="box">
            <h4>La <span class="text-red">Formule de la Copule Gaussienne</span></h4>
            <p>David X. Li avait proposé en 2000 une formule élégante pour modéliser les corrélations de défaut dans les CDO. Cette formule, adoptée massivement par l'industrie, sous-estimait dramatiquement le risque de défauts simultanés.</p>
            <p><em>"La formule qui a tué Wall Street"</em> - titre de Wired Magazine, 2009</p>
        </div>

        <!-- SECTION 4: HEDGE FUNDS QUANT -->
        <h2>L'Ère des Hedge Funds Quantitatifs</h2>

        <p>Parallèlement aux crises, une révolution silencieuse transforme les marchés : l'essor des fonds quantitatifs. Ces fonds utilisent des modèles mathématiques, du machine learning et une puissance de calcul massive pour identifier et exploiter des inefficiences de marché.</p>

        <h3>Renaissance Technologies : Le Fonds Légendaire</h3>

        <p>Fondé par Jim Simons, mathématicien et ancien codebreaker de la NSA, Renaissance Technologies est le fonds le plus performant de l'histoire. Son fonds Medallion a généré des rendements annuels moyens de <strong>66% brut (39% net)</strong> de 1988 à 2018 - une performance inégalée.</p>

        <div class="box">
            <h4>Renaissance Technologies - Faits Clés</h4>
            <ul>
                <li><strong>Fondateur :</strong> Jim Simons (PhD mathématiques, professeur à Stony Brook)</li>
                <li><strong>Employés :</strong> ~300 PhDs en maths, physique, informatique (pas de traders traditionnels)</li>
                <li><strong>Méthode :</strong> Pattern recognition, machine learning, analyse de signaux</li>
                <li><strong>Medallion Fund :</strong> Fermé aux investisseurs externes depuis 1993</li>
                <li><strong>Fortune de Simons :</strong> ~25 milliards $ (top 25 mondial)</li>
            </ul>
        </div>

        <h3>Les Principaux Fonds Quant</h3>

        <table>
            <thead>
                <tr>
                    <th>Fonds</th>
                    <th>Fondateur</th>
                    <th>AUM</th>
                    <th>Spécialité</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Renaissance Technologies</strong></td>
                    <td>Jim Simons (1988)</td>
                    <td>~130 Mds $</td>
                    <td>Pattern recognition, ML</td>
                </tr>
                <tr>
                    <td><strong>Two Sigma</strong></td>
                    <td>Siegel & Overdeck (2001)</td>
                    <td>~60 Mds $</td>
                    <td>Data science, ML</td>
                </tr>
                <tr>
                    <td><strong>DE Shaw</strong></td>
                    <td>David Shaw (1988)</td>
                    <td>~55 Mds $</td>
                    <td>Statistical arbitrage</td>
                </tr>
                <tr>
                    <td><strong>Citadel</strong></td>
                    <td>Ken Griffin (1990)</td>
                    <td>~50 Mds $</td>
                    <td>Multi-strategy, market making</td>
                </tr>
                <tr>
                    <td><strong>AQR Capital</strong></td>
                    <td>Cliff Asness (1998)</td>
                    <td>~140 Mds $</td>
                    <td>Factor investing, smart beta</td>
                </tr>
            </tbody>
        </table>

        <!-- SECTION 5: HFT -->
        <h2>Le Trading Haute Fréquence (HFT)</h2>

        <p>Le <span class="text-red">High-Frequency Trading</span> représente aujourd'hui 50-70% du volume des marchés actions US. Ces algorithmes opèrent en microsecondes, exploitant des inefficiences invisibles à l'œil humain.</p>

        <h3>Le Flash Crash du 6 Mai 2010</h3>

        <p>À 14h42, le Dow Jones commence à chuter. En 5 minutes, il perd 1000 points (9%). Certaines actions (Accenture, P&G) tombent à 0.01$ avant de rebondir. À 15h07, les marchés sont revenus à la normale. C'est le <span class="text-red">Flash Crash</span>.</p>

        <div class="box">
            <h4>Cause : Boucle de Rétroaction HFT</h4>
            <p>Un algorithme de vente automatique (de Waddell & Reed) a déclenché une cascade : les HFT ont retiré leur liquidité, amplifiant la chute. Les market makers algorithmiques, programmés pour se protéger en cas de volatilité extrême, ont cessé de coter, créant un "vide de liquidité".</p>
        </div>

        <h3>Controverses sur le HFT</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Arguments Pour</h4>
                <ul>
                    <li>Réduit les spreads bid-ask</li>
                    <li>Améliore la liquidité en temps normal</li>
                    <li>Rend les prix plus efficients</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Arguments Contre</h4>
                <ul>
                    <li>Amplifie les crises (Flash Crash)</li>
                    <li>Avantage injuste (front-running)</li>
                    <li>Course aux armements technologique</li>
                </ul>
            </div>
        </div>

        <!-- SECTION 6: ML ET CRYPTO -->
        <h2>Machine Learning et Nouvelles Frontières</h2>

        <h3>L'IA en Finance</h3>

        <p>Le Machine Learning transforme progressivement la finance quantitative. Des techniques comme les <span class="text-red">réseaux de neurones</span>, le <span class="text-red">NLP</span> (analyse de texte), et le <span class="text-red">reinforcement learning</span> ouvrent de nouvelles possibilités.</p>

        <div class="box">
            <h4>Applications du ML en Finance</h4>
            <ul>
                <li><strong>Alternative Data :</strong> Images satellite, réseaux sociaux, transactions cartes</li>
                <li><strong>NLP :</strong> Analyse de sentiment sur news, earnings calls, filings SEC</li>
                <li><strong>Prédiction :</strong> Deep learning pour séries temporelles</li>
                <li><strong>Exécution :</strong> Algorithmes d'exécution optimale</li>
                <li><strong>Risk :</strong> Détection d'anomalies, stress testing</li>
            </ul>
        </div>

        <h3>Crypto-actifs et DeFi</h3>

        <p>Depuis le lancement du Bitcoin en 2009, les crypto-actifs sont devenus une classe d'actifs à part entière. La <span class="text-red">DeFi</span> (Finance Décentralisée) propose de recréer les services financiers traditionnels sur blockchain, sans intermédiaires.</p>

        <div class="box">
            <h4>Crypto : Faits et Chiffres (2024)</h4>
            <ul>
                <li><strong>Capitalisation totale :</strong> ~2.5 trillions $ (comparable à l'or)</li>
                <li><strong>Bitcoin :</strong> ~50% de la capitalisation</li>
                <li><strong>Ethereum :</strong> ~18% (plateforme smart contracts)</li>
                <li><strong>DeFi TVL :</strong> ~100 milliards $ verrouillés</li>
                <li><strong>ETF Bitcoin spot :</strong> Approuvés aux USA en janvier 2024</li>
            </ul>
        </div>

        <!-- SYNTHESE -->
        <h2>Synthèse : Les Leçons de l'Ère Moderne</h2>

        <div class="grid-2">
            <div class="grid-item">
                <h4>1. Les Modèles ont des Limites</h4>
                <p>Tous les modèles (VaR, Black-Scholes, copules) sont des approximations. Ils fonctionnent en temps normal mais échouent précisément quand on en a le plus besoin - en période de crise.</p>
            </div>
            <div class="grid-item">
                <h4>2. Le Risque de Queue est Réel</h4>
                <p>Les événements "impossibles" (6+ écarts-types) arrivent bien plus souvent que les distributions normales ne le prédisent. Les <span class="text-red">fat tails</span> sont la règle, pas l'exception.</p>
            </div>
            <div class="grid-item">
                <h4>3. La Liquidité est Fragile</h4>
                <p>La liquidité disparaît précisément quand tout le monde en a besoin. Le <span class="text-red">risque de liquidité</span> est souvent sous-estimé car il est invisible en temps normal.</p>
            </div>
            <div class="grid-item">
                <h4>4. Les Corrélations ne sont pas Constantes</h4>
                <p>En période de stress, les corrélations explosent vers 1. La diversification protège moins qu'on ne le pense quand les marchés paniquent.</p>
            </div>
        </div>

        <blockquote>
            <p>"In theory, there is no difference between theory and practice. In practice, there is."</p>
            <cite>Yogi Berra (souvent cité par les quants)</cite>
        </blockquote>

        <!-- RESSOURCES -->
        <h2>Ressources</h2>

        <div class="box">
            <h4>Documentaires</h4>
            <ul>
                <li>
                    <strong><a href="https://www.pbs.org/wgbh/nova/stockmarket/" target="_blank">Trillion Dollar Bet</a></strong> - PBS Nova (2000)<br>
                    <span style="color: var(--text-muted);">L'histoire de Black-Scholes et la chute de LTCM</span>
                </li>
                <li>
                    <strong><a href="https://www.imdb.com/title/tt1596363/" target="_blank">Inside Job</a></strong> - Oscar du meilleur documentaire (2010)<br>
                    <span style="color: var(--text-muted);">Analyse complète de la crise de 2008</span>
                </li>
                <li>
                    <strong><a href="https://www.imdb.com/title/tt1615147/" target="_blank">The Big Short</a></strong> - Adam McKay (2015)<br>
                    <span style="color: var(--text-muted);">Adaptation du livre de Michael Lewis sur 2008</span>
                </li>
            </ul>
        </div>

        <div class="box">
            <h4>Lectures Essentielles</h4>
            <ul>
                <li><strong>When Genius Failed</strong> - Roger Lowenstein (2000) - L'histoire complète de LTCM</li>
                <li><strong>The Big Short</strong> - Michael Lewis (2010) - La crise des subprimes</li>
                <li><strong>Flash Boys</strong> - Michael Lewis (2014) - Le monde du HFT</li>
                <li><strong>The Man Who Solved the Market</strong> - Gregory Zuckerman (2019) - Jim Simons et Renaissance</li>
                <li><strong>The Black Swan</strong> - Nassim Taleb (2007) - Critique des modèles de risque</li>
            </ul>
        </div>

        <!-- EXERCICES -->
        <h2 id="exercices-m4">Exercices</h2>

        <h3>Niveau 1 : Compréhension</h3>

        <div class="exercise-box">
            <h4>Exercice 1.1 - Chronologie des Crises</h4>
            <p>Numérotez ces événements du plus ancien (1) au plus récent (5) :</p>

            <div class="chronology-item">
                <input type="number" class="exercise-number-input" id="m4-chrono1" min="1" max="5" placeholder="?">
                <span>Faillite de Lehman Brothers</span>
            </div>
            <div class="chronology-item">
                <input type="number" class="exercise-number-input" id="m4-chrono2" min="1" max="5" placeholder="?">
                <span>Black Monday</span>
            </div>
            <div class="chronology-item">
                <input type="number" class="exercise-number-input" id="m4-chrono3" min="1" max="5" placeholder="?">
                <span>Flash Crash</span>
            </div>
            <div class="chronology-item">
                <input type="number" class="exercise-number-input" id="m4-chrono4" min="1" max="5" placeholder="?">
                <span>Faillite de LTCM</span>
            </div>
            <div class="chronology-item">
                <input type="number" class="exercise-number-input" id="m4-chrono5" min="1" max="5" placeholder="?">
                <span>Création du Bitcoin</span>
            </div>

            <button class="check-btn" onclick="checkM4Chrono()">Vérifier</button>
            <div id="feedback-m4-chrono" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>1. Black Monday (1987)</p>
                    <p>2. Faillite de LTCM (1998)</p>
                    <p>3. Faillite de Lehman Brothers (2008)</p>
                    <p>4. Création du Bitcoin (2009)</p>
                    <p>5. Flash Crash (2010)</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 1.2 - Vrai ou Faux</h4>
            <p>Cochez les affirmations correctes :</p>

            <div style="margin: 15px 0;">
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="m4-vf1"> LTCM a été sauvé par la Fed car il était "too big to fail"
                </label>
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="m4-vf2"> Le VaR a parfaitement prédit les pertes de 2008
                </label>
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="m4-vf3"> Le Flash Crash de 2010 a duré moins de 30 minutes
                </label>
                <label style="display: block; padding: 8px 0; cursor: pointer;">
                    <input type="checkbox" id="m4-vf4"> Renaissance Technologies emploie principalement des traders traditionnels
                </label>
            </div>

            <button class="check-btn" onclick="checkM4VF()">Vérifier</button>
            <div id="feedback-m4-vf" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Vrai</strong> : LTCM était systémiquement important, d'où le sauvetage coordonné par la Fed.</p>
                    <p><strong>Faux</strong> : Le VaR a dramatiquement sous-estimé les risques en 2008.</p>
                    <p><strong>Vrai</strong> : Le Flash Crash a duré environ 36 minutes (14h42 - 15h18).</p>
                    <p><strong>Faux</strong> : Renaissance emploie des PhDs en maths, physique, informatique - pas de traders traditionnels.</p>
                </div>
            </details>
        </div>

        <h3>Niveau 2 : Application</h3>

        <div class="exercise-box">
            <h4>Exercice 2.1 - Levier et Risque</h4>
            <p><strong>Données LTCM :</strong></p>
            <ul>
                <li>Capital : 5 milliards $</li>
                <li>Positions totales : 125 milliards $</li>
                <li>Perte de marché : 10% sur les positions</li>
            </ul>
            <p>Calculez : (a) le levier et (b) la perte en % du capital</p>

            <div class="calc-row">
                <span class="calc-label">Levier =</span>
                <input type="number" class="exercise-calc-input" id="m4-levier" placeholder="Ex: 25">
                <span class="calc-unit">:1</span>
            </div>
            <div class="calc-row">
                <span class="calc-label">Perte (% capital) =</span>
                <input type="number" class="exercise-calc-input" id="m4-perte" placeholder="Ex: 250">
                <span class="calc-unit">%</span>
            </div>

            <button class="check-btn" onclick="checkM4Levier()">Vérifier</button>
            <div id="feedback-m4-levier" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Levier = 125 / 5 = <strong>25:1</strong></p>
                    <p>Perte absolue = 125 × 10% = 12.5 milliards $</p>
                    <p>Perte en % du capital = 12.5 / 5 = <strong>250%</strong></p>
                    <p>Avec un levier de 25:1, une perte de 10% sur les actifs efface 250% du capital - d'où la faillite !</p>
                </div>
            </details>
        </div>

        <h3>Niveau 3 : Analyse</h3>

        <div class="exercise-box">
            <h4>Exercice 3.1 - Critique des Modèles</h4>
            <p><strong>Question :</strong> Pourquoi les modèles quantitatifs (VaR, copule gaussienne) ont-ils échoué en 2008 ? Identifiez au moins trois hypothèses incorrectes de ces modèles.</p>

            <textarea class="exercise-input" id="m4-analyse" rows="5" placeholder="Analysez les hypothèses des modèles et pourquoi elles ont échoué..."></textarea>

            <button class="check-btn" onclick="checkM4Analyse()">Vérifier</button>
            <div id="feedback-m4-analyse" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Hypothèses incorrectes :</strong></p>
                    <ul>
                        <li><strong>Distributions normales :</strong> Les rendements ont des queues épaisses (fat tails). Les événements "6 sigma" arrivent bien plus souvent que prévu.</li>
                        <li><strong>Corrélations stables :</strong> Les corrélations explosent en période de crise. La diversification cesse de fonctionner quand on en a le plus besoin.</li>
                        <li><strong>Liquidité constante :</strong> Les modèles supposent qu'on peut toujours vendre au prix du marché. En crise, la liquidité disparaît.</li>
                        <li><strong>Indépendance des défauts :</strong> La copule gaussienne sous-estimait la probabilité de défauts simultanés sur les subprimes.</li>
                        <li><strong>Données historiques pertinentes :</strong> Les modèles calibrés sur des données récentes n'avaient jamais vu de crise immobilière nationale.</li>
                    </ul>
                </div>
            </details>
        </div>

        <!-- FLASHCARDS -->
        <h2 id="flashcards-m4">Flashcards</h2>

        <p>Cliquez sur une carte pour voir la réponse.</p>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quelle a été la chute du Dow Jones le Black Monday 1987 ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>-22.6% en une journée (19 octobre 1987)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quels prix Nobel étaient partenaires de LTCM ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Myron Scholes et Robert Merton (Nobel 1997)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce qu'un CDO ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Collateralized Debt Obligation - produit structuré regroupant des créances en tranches de risque</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qui a fondé Renaissance Technologies ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Jim Simons (mathématicien, ex-NSA) en 1988</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que le Flash Crash ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Chute de 1000 points du Dow en 5 minutes le 6 mai 2010, suivie d'un rebond rapide</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quelle banque a fait faillite le 15 septembre 2008 ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Lehman Brothers (639 milliards $ de dettes)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Que signifie "fat tails" ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Queues de distribution plus épaisses que la normale : les événements extrêmes sont plus fréquents que prévu</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que le "smile de volatilité" ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Forme de la courbe de volatilité implicite par strike, apparue après 1987 (puts OTM plus chers)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quel % du volume actions US représente le HFT ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>50-70% du volume quotidien</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quand le Bitcoin a-t-il été créé ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>2009 par Satoshi Nakamoto (pseudonyme)</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module3')">Précédent : Révolution Quantitative</button>
            <button class="nav-btn" onclick="showModule('module5')">Suivant : Algèbre Linéaire</button>
        </div>
    </section>

    <section id="module5" class="module">

        <header class="module-header">
            <h1>Algèbre Linéaire pour la Finance Quantitative</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Fondamental</span>
                <span>120 minutes</span>
                <span>Prérequis : Mathématiques niveau Bac+1</span>
            </div>
        </header>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/2/2f/Linear_subspaces_with_shading.svg" alt="Sous-espaces linéaires">
            <figcaption>Représentation géométrique des sous-espaces vectoriels - les fondements mathématiques de l'optimisation de portefeuille</figcaption>
        </figure>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre pourquoi l'algèbre linéaire est le langage fondamental de la finance quantitative</li>
            <li>Maîtriser les opérations sur les vecteurs et matrices essentielles en finance</li>
            <li>Calculer et interpréter les matrices de covariance et de corrélation</li>
            <li>Comprendre les valeurs propres et leur rôle crucial dans l'analyse de portefeuille</li>
            <li>Appliquer les décompositions matricielles (Cholesky, SVD) aux simulations Monte Carlo</li>
            <li>Utiliser la PCA pour l'analyse factorielle des marchés</li>
        </ul>

        <div class="box">
            <h4>Pourquoi l'Algèbre Linéaire est Indispensable en Finance</h4>
            <p>L'algèbre linéaire n'est pas qu'un outil technique : c'est le <span class="text-red">langage natif</span> de la finance quantitative moderne. Quand Harry Markowitz a formalisé la théorie du portefeuille en 1952, il a traduit l'intuition de la diversification en équations matricielles. Aujourd'hui, chaque jour :</p>
            <ul>
                <li>Les gestionnaires de portefeuille optimisent des <span class="text-red">vecteurs de poids</span> de milliers d'actifs</li>
                <li>Les risk managers calculent des <span class="text-red">matrices de covariance</span> de dimension 500×500 ou plus</li>
                <li>Les quants utilisent la <span class="text-red">PCA</span> pour extraire les facteurs de risque dominants</li>
                <li>Les traders simulent des millions de scénarios avec la <span class="text-red">décomposition de Cholesky</span></li>
            </ul>
            <p>Sans algèbre linéaire, il serait impossible de gérer les interactions complexes entre des centaines d'actifs simultanément.</p>
        </div>

        <!-- SECTION 1: CONTEXTE HISTORIQUE -->
        <h2>Contexte Historique : Des Mathématiques Pures à Wall Street</h2>

        <p>L'algèbre linéaire moderne trouve ses racines au XIXe siècle avec les travaux de <strong>Arthur Cayley</strong> (1821-1895), qui formalise le calcul matriciel en 1858, et <strong>James Joseph Sylvester</strong> (1814-1897), qui invente le terme "matrice". Mais c'est au XXe siècle que ces outils abstraits deviennent essentiels en finance.</p>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1858</div>
                <div class="timeline-content">
                    <strong>Arthur Cayley - Calcul Matriciel</strong><br>
                    Formalisation des opérations sur les matrices, fondement de l'algèbre linéaire moderne
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1901</div>
                <div class="timeline-content">
                    <strong>Karl Pearson - Analyse en Composantes Principales</strong><br>
                    Invention de la PCA pour l'analyse statistique multidimensionnelle
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1924</div>
                <div class="timeline-content">
                    <strong>André-Louis Cholesky</strong><br>
                    Publication posthume de la décomposition de Cholesky, essentielle pour les simulations
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1952</div>
                <div class="timeline-content">
                    <strong>Harry Markowitz - Portfolio Selection</strong><br>
                    Application révolutionnaire de l'algèbre linéaire à l'optimisation de portefeuille
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1965</div>
                <div class="timeline-content">
                    <strong>Gene Golub & William Kahan - SVD</strong><br>
                    Algorithme moderne pour la décomposition en valeurs singulières
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1992</div>
                <div class="timeline-content">
                    <strong>RiskMetrics (JP Morgan)</strong><br>
                    Standardisation des matrices de covariance pour le calcul de la VaR
                </div>
            </div>
        </div>

        <blockquote>
            <p>"Le processus de sélection d'un portefeuille peut être divisé en deux étapes. La première consiste à observer et à former des croyances sur les performances futures des titres disponibles. La seconde commence avec les croyances pertinentes et se termine avec le choix du portefeuille."</p>
            <cite>Harry Markowitz, "Portfolio Selection", Journal of Finance (1952)</cite>
        </blockquote>

        <!-- SECTION 2: VECTEURS -->
        <h2>Vecteurs : Le Portefeuille comme Objet Mathématique</h2>

        <p>En finance quantitative, le <span class="text-red">vecteur</span> est l'objet mathématique qui représente un portefeuille. Comprendre les vecteurs, c'est comprendre comment manipuler et optimiser des portefeuilles de n'importe quelle taille.</p>

        <div class="box">
            <h4>Définition : <span class="text-red">Vecteur de Portefeuille</span></h4>
            <p>Un vecteur est une liste ordonnée de n nombres réels, notée :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; margin: 15px 0;">
                <strong>w</strong> = (w₁, w₂, ..., wₙ)ᵀ ∈ ℝⁿ
            </p>
            <p>En finance, si <strong>w</strong> représente un portefeuille de n actifs :</p>
            <ul>
                <li><strong>wᵢ</strong> = poids (proportion du capital) de l'actif i</li>
                <li><strong>Σᵢ wᵢ = 1</strong> : contrainte de budget (tout le capital est investi)</li>
                <li><strong>wᵢ ≥ 0</strong> : contrainte "long-only" (pas de vente à découvert)</li>
                <li><strong>wᵢ < 0</strong> : position courte (short) autorisée</li>
            </ul>
        </div>

        <h3>Exemple Concret : Un Portefeuille Actions</h3>

        <p>Considérons un portefeuille de 5 actions du CAC 40 :</p>

        <table>
            <thead>
                <tr>
                    <th>Actif</th>
                    <th>Symbole</th>
                    <th>Poids wᵢ</th>
                    <th>Rendement espéré μᵢ</th>
                    <th>Volatilité σᵢ</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>LVMH</td>
                    <td>MC.PA</td>
                    <td>30%</td>
                    <td>12%</td>
                    <td>25%</td>
                </tr>
                <tr>
                    <td>TotalEnergies</td>
                    <td>TTE.PA</td>
                    <td>25%</td>
                    <td>8%</td>
                    <td>22%</td>
                </tr>
                <tr>
                    <td>Sanofi</td>
                    <td>SAN.PA</td>
                    <td>20%</td>
                    <td>6%</td>
                    <td>18%</td>
                </tr>
                <tr>
                    <td>Air Liquide</td>
                    <td>AI.PA</td>
                    <td>15%</td>
                    <td>7%</td>
                    <td>16%</td>
                </tr>
                <tr>
                    <td>BNP Paribas</td>
                    <td>BNP.PA</td>
                    <td>10%</td>
                    <td>10%</td>
                    <td>28%</td>
                </tr>
            </tbody>
        </table>

        <p>Les vecteurs associés sont :</p>
        <ul>
            <li><strong>w</strong> = (0.30, 0.25, 0.20, 0.15, 0.10)ᵀ — vecteur des poids</li>
            <li><strong>μ</strong> = (0.12, 0.08, 0.06, 0.07, 0.10)ᵀ — vecteur des rendements espérés</li>
            <li><strong>σ</strong> = (0.25, 0.22, 0.18, 0.16, 0.28)ᵀ — vecteur des volatilités</li>
        </ul>

        <h3>Opérations Vectorielles Fondamentales</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4><span class="text-red">Produit Scalaire</span></h4>
                <p style="font-family: monospace; text-align: center; font-size: 16px;">⟨x, y⟩ = xᵀy = Σᵢ xᵢyᵢ</p>
                <p><strong>Application financière :</strong></p>
                <p>Le rendement espéré d'un portefeuille est le produit scalaire des poids et des rendements :</p>
                <p style="font-family: monospace; text-align: center;">μₚ = <strong>w</strong>ᵀ<strong>μ</strong> = Σᵢ wᵢμᵢ</p>
                <p><em>Exemple :</em> μₚ = 0.30×0.12 + 0.25×0.08 + 0.20×0.06 + 0.15×0.07 + 0.10×0.10 = <strong>8.65%</strong></p>
            </div>
            <div class="grid-item">
                <h4><span class="text-red">Norme Euclidienne</span></h4>
                <p style="font-family: monospace; text-align: center; font-size: 16px;">‖x‖₂ = √(xᵀx) = √(Σᵢ xᵢ²)</p>
                <p><strong>Applications financières :</strong></p>
                <ul>
                    <li><strong>Régularisation Ridge :</strong> Pénalise ‖w‖² pour éviter les poids extrêmes</li>
                    <li><strong>Tracking error :</strong> ‖w - wᵦ‖ mesure l'écart à un benchmark</li>
                    <li><strong>Distance entre portefeuilles :</strong> Comparer des allocations</li>
                </ul>
            </div>
        </div>

        <div class="box">
            <h4>Concept : <span class="text-red">Combinaison Linéaire</span></h4>
            <p>Tout portefeuille est une combinaison linéaire des actifs individuels :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; margin: 10px 0;">
                Portefeuille = w₁ × Actif₁ + w₂ × Actif₂ + ... + wₙ × Actifₙ
            </p>
            <p>Cette propriété de linéarité permet de calculer facilement le rendement du portefeuille à partir des rendements individuels. C'est la base de toute l'analyse de portefeuille.</p>
        </div>

        <!-- SECTION 3: MATRICES -->
        <h2>Matrices : Capturer les Interactions entre Actifs</h2>

        <p>Si les vecteurs représentent des portefeuilles, les <span class="text-red">matrices</span> capturent les <em>relations</em> entre actifs. La matrice de covariance est l'objet central de la théorie du portefeuille — elle contient toute l'information sur les risques et leurs interactions.</p>

        <div class="box">
            <h4>Définition : <span class="text-red">Matrice</span></h4>
            <p>Une matrice A de dimension m×n est un tableau rectangulaire de nombres :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">A = [aᵢⱼ] où i = 1,...,m (lignes) et j = 1,...,n (colonnes)</p>
            <p><strong>Types de matrices en finance :</strong></p>
            <table>
                <tr>
                    <th>Type</th>
                    <th>Dimension</th>
                    <th>Contenu</th>
                </tr>
                <tr>
                    <td>Rendements</td>
                    <td>T × n</td>
                    <td>T observations de n actifs</td>
                </tr>
                <tr>
                    <td>Covariance Σ</td>
                    <td>n × n</td>
                    <td>Co-mouvements des actifs</td>
                </tr>
                <tr>
                    <td>Corrélation ρ</td>
                    <td>n × n</td>
                    <td>Covariance normalisée</td>
                </tr>
                <tr>
                    <td>Facteurs</td>
                    <td>n × k</td>
                    <td>Expositions aux k facteurs</td>
                </tr>
            </table>
        </div>

        <h3>La Matrice de Covariance : Le Cœur de Markowitz</h3>

        <p>La <span class="text-red">matrice de covariance</span> Σ est l'objet le plus important en gestion de portefeuille. Pour n actifs, c'est une matrice n×n où chaque élément (i,j) mesure comment les rendements des actifs i et j varient ensemble.</p>

        <div class="box">
            <h4>Définition : <span class="text-red">Matrice de Covariance</span></h4>
            <p style="font-family: monospace; font-size: 16px; text-align: center; margin: 10px 0;">
                Σᵢⱼ = Cov(Rᵢ, Rⱼ) = E[(Rᵢ - μᵢ)(Rⱼ - μⱼ)]
            </p>
            <p><strong>Propriétés fondamentales :</strong></p>
            <ul>
                <li><strong>Symétrique :</strong> Σᵢⱼ = Σⱼᵢ (Cov(X,Y) = Cov(Y,X))</li>
                <li><strong>Semi-définie positive :</strong> <strong>x</strong>ᵀΣ<strong>x</strong> ≥ 0 pour tout vecteur <strong>x</strong></li>
                <li><strong>Diagonale :</strong> Σᵢᵢ = Var(Rᵢ) = σᵢ² (les variances sont sur la diagonale)</li>
                <li><strong>Dimension :</strong> n² éléments, mais seulement n(n+1)/2 uniques (symétrie)</li>
            </ul>
        </div>

        <h3>Exemple : Matrice de Covariance 3×3</h3>

        <p>Pour un portefeuille de 3 actifs (Actions, Obligations, Or) :</p>

        <div class="box">
            <h4>Matrice de Covariance Annuelle (en %²)</h4>
            <table style="font-family: monospace; text-align: center;">
                <tr>
                    <th></th>
                    <th>Actions</th>
                    <th>Obligations</th>
                    <th>Or</th>
                </tr>
                <tr>
                    <td><strong>Actions</strong></td>
                    <td style="background: rgba(255,51,51,0.2);">400</td>
                    <td>-20</td>
                    <td>10</td>
                </tr>
                <tr>
                    <td><strong>Obligations</strong></td>
                    <td>-20</td>
                    <td style="background: rgba(255,51,51,0.2);">64</td>
                    <td>5</td>
                </tr>
                <tr>
                    <td><strong>Or</strong></td>
                    <td>10</td>
                    <td>5</td>
                    <td style="background: rgba(255,51,51,0.2);">225</td>
                </tr>
            </table>
            <p style="margin-top: 15px;"><strong>Lecture :</strong></p>
            <ul>
                <li>Diagonale (rouge) = variances : σ²(Actions) = 400 → σ = 20%</li>
                <li>Hors diagonale = covariances : Cov(Actions, Obligations) = -20 (corrélation négative !)</li>
                <li>Cov négative → les deux actifs ont tendance à évoluer en sens inverse (diversification)</li>
            </ul>
        </div>

        <h3>La Formule Magique : Variance du Portefeuille</h3>

        <div class="box">
            <h4>Formule : <span class="text-red">Variance du Portefeuille</span></h4>
            <p style="text-align: center; font-family: monospace; font-size: 20px; margin: 15px 0;">
                σₚ² = <strong>w</strong>ᵀ Σ <strong>w</strong>
            </p>
            <p>Cette formule compacte contient toute la puissance de Markowitz. Elle montre que le risque d'un portefeuille dépend :</p>
            <ul>
                <li>Des poids <strong>w</strong> de chaque actif</li>
                <li>Des variances individuelles (diagonale de Σ)</li>
                <li>Des covariances entre actifs (hors-diagonale de Σ)</li>
            </ul>
            <p><strong>Développement pour 2 actifs :</strong></p>
            <p style="font-family: monospace; text-align: center;">
                σₚ² = w₁²σ₁² + w₂²σ₂² + 2w₁w₂Cov(R₁,R₂)
            </p>
            <p style="font-family: monospace; text-align: center;">
                σₚ² = w₁²σ₁² + w₂²σ₂² + 2w₁w₂ρ₁₂σ₁σ₂
            </p>
            <p>où ρ₁₂ = Cov(R₁,R₂)/(σ₁σ₂) est le coefficient de corrélation.</p>
        </div>

        <h3>Matrice de Corrélation</h3>

        <p>La <span class="text-red">matrice de corrélation</span> normalise la covariance pour faciliter l'interprétation :</p>

        <div class="box">
            <h4>Définition : <span class="text-red">Corrélation</span></h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; margin: 10px 0;">
                ρᵢⱼ = Cov(Rᵢ, Rⱼ) / (σᵢ × σⱼ) = Σᵢⱼ / √(Σᵢᵢ × Σⱼⱼ)
            </p>
            <p><strong>Propriétés :</strong></p>
            <ul>
                <li><strong>Borné :</strong> -1 ≤ ρᵢⱼ ≤ +1</li>
                <li><strong>Diagonale :</strong> ρᵢᵢ = 1 (un actif est parfaitement corrélé avec lui-même)</li>
                <li><strong>Interprétation :</strong>
                    <ul>
                        <li>ρ = +1 : parfaitement corrélés (bougent ensemble)</li>
                        <li>ρ = 0 : non corrélés (mouvements indépendants)</li>
                        <li>ρ = -1 : parfaitement anti-corrélés (diversification maximale)</li>
                    </ul>
                </li>
            </ul>
        </div>

        <!-- GRAPHIQUE -->
        <h3>Visualisation : Matrice de Corrélation des Secteurs</h3>

        <div class="chart-container">
            <canvas id="correlationHeatmap"></canvas>
        </div>

        <p style="margin-top: 15px;">Ce graphique montre les corrélations typiques entre secteurs boursiers. Les secteurs cycliques (Tech, Finance, Industrie) sont fortement corrélés entre eux. Les secteurs défensifs (Santé, Utilities) offrent une meilleure diversification.</p>

        <!-- SECTION 4: VALEURS PROPRES -->
        <h2>Valeurs Propres : Révéler la Structure Cachée du Risque</h2>

        <p>Les <span class="text-red">valeurs propres</span> et <span class="text-red">vecteurs propres</span> sont des concepts abstraits mais extraordinairement puissants. Ils permettent de décomposer le risque d'un portefeuille en facteurs indépendants et d'identifier les sources principales de volatilité.</p>

        <div class="box">
            <h4>Définition : <span class="text-red">Valeurs et Vecteurs Propres</span></h4>
            <p>Pour une matrice carrée A, un scalaire λ est une <strong>valeur propre</strong> et <strong>v</strong> un <strong>vecteur propre</strong> si :</p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; margin: 15px 0;">
                A<strong>v</strong> = λ<strong>v</strong>
            </p>
            <p><strong>Interprétation géométrique :</strong> Le vecteur <strong>v</strong> n'est pas "tourné" par la matrice A, seulement "étiré" (ou compressé) par le facteur λ.</p>
            <p><strong>Pour la matrice de covariance Σ :</strong></p>
            <ul>
                <li>Les <span class="text-red">valeurs propres λᵢ</span> représentent les variances dans les directions principales</li>
                <li>Les <span class="text-red">vecteurs propres vᵢ</span> représentent les directions principales de risque</li>
                <li>Toutes les λᵢ sont ≥ 0 (Σ est semi-définie positive)</li>
            </ul>
        </div>

        <h3>Théorème Spectral</h3>

        <div class="box">
            <h4>Théorème : <span class="text-red">Décomposition Spectrale</span></h4>
            <p>Toute matrice symétrique réelle (comme Σ) peut s'écrire :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; margin: 15px 0;">
                Σ = VΛVᵀ = Σᵢ λᵢ vᵢvᵢᵀ
            </p>
            <p>où :</p>
            <ul>
                <li><strong>V</strong> = [v₁, v₂, ..., vₙ] est la matrice des vecteurs propres (orthonormaux)</li>
                <li><strong>Λ</strong> = diag(λ₁, λ₂, ..., λₙ) est la matrice diagonale des valeurs propres</li>
                <li>Les vecteurs propres forment une base orthonormale de ℝⁿ</li>
            </ul>
            <p><strong>Signification :</strong> La covariance totale peut être décomposée en contributions indépendantes de chaque facteur.</p>
        </div>

        <h3>Application : Analyse en Composantes Principales (PCA)</h3>

        <p>La <span class="text-red">PCA</span> est l'application la plus importante des valeurs propres en finance. Elle permet de réduire la complexité des données tout en préservant l'essentiel de l'information.</p>

        <div class="box">
            <h4>Méthode : <span class="text-red">PCA en Finance</span></h4>
            <p><strong>Objectif :</strong> Identifier les k facteurs principaux qui expliquent la majorité de la variance des n actifs (avec k << n).</p>
            <p><strong>Algorithme :</strong></p>
            <ol>
                <li>Calculer la matrice de covariance Σ des rendements (ou corrélation pour standardiser)</li>
                <li>Calculer les valeurs propres λ₁ ≥ λ₂ ≥ ... ≥ λₙ ≥ 0 et vecteurs propres associés</li>
                <li>Sélectionner les k premiers facteurs qui expliquent suffisamment de variance (ex: 90%)</li>
                <li>Projeter les données sur ces k facteurs</li>
            </ol>
            <p><strong>Variance expliquée par le facteur i :</strong></p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; margin: 10px 0;">
                % variance = λᵢ / Σⱼ λⱼ × 100
            </p>
        </div>

        <h3>Exemple : PCA sur le S&P 500</h3>

        <p>Une étude classique de la PCA sur les actions du S&P 500 révèle :</p>

        <table>
            <thead>
                <tr>
                    <th>Facteur</th>
                    <th>Variance Expliquée</th>
                    <th>Cumul</th>
                    <th>Interprétation</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>PC1</strong></td>
                    <td>~40%</td>
                    <td>40%</td>
                    <td><span class="text-red">Facteur Marché</span> - toutes les actions bougent ensemble</td>
                </tr>
                <tr>
                    <td><strong>PC2</strong></td>
                    <td>~10%</td>
                    <td>50%</td>
                    <td>Facteur Sectoriel (Tech vs Value)</td>
                </tr>
                <tr>
                    <td><strong>PC3</strong></td>
                    <td>~5%</td>
                    <td>55%</td>
                    <td>Facteur Taille (Large vs Small)</td>
                </tr>
                <tr>
                    <td><strong>PC4-10</strong></td>
                    <td>~15%</td>
                    <td>70%</td>
                    <td>Facteurs sectoriels spécifiques</td>
                </tr>
                <tr>
                    <td><strong>PC11-500</strong></td>
                    <td>~30%</td>
                    <td>100%</td>
                    <td>Risque idiosyncratique (spécifique)</td>
                </tr>
            </tbody>
        </table>

        <blockquote>
            <p>"Empiriquement, 3 à 5 facteurs suffisent à expliquer 60-70% de la variance des rendements boursiers. Le premier facteur (marché) domine largement."</p>
            <cite>Connor & Korajczyk, "Risk and Return in an Equilibrium APT" (1988)</cite>
        </blockquote>

        <!-- SECTION 5: DECOMPOSITIONS -->
        <h2>Décompositions Matricielles : Outils Pratiques</h2>

        <h3>Décomposition de Cholesky : Générer des Variables Corrélées</h3>

        <p>La <span class="text-red">décomposition de Cholesky</span> est l'outil indispensable pour les simulations Monte Carlo. Elle permet de générer des variables aléatoires avec une structure de corrélation donnée.</p>

        <div class="box">
            <h4>Théorème : <span class="text-red">Décomposition de Cholesky</span></h4>
            <p>Pour toute matrice symétrique définie positive Σ, il existe une unique matrice triangulaire inférieure L telle que :</p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; margin: 15px 0;">
                Σ = LLᵀ
            </p>
            <p>La matrice L est appelée <strong>facteur de Cholesky</strong> ou <strong>racine carrée</strong> de Σ.</p>
        </div>

        <div class="box">
            <h4>Application : <span class="text-red">Simulation Monte Carlo</span></h4>
            <p><strong>Problème :</strong> Générer n variables aléatoires corrélées selon Σ.</p>
            <p><strong>Solution :</strong></p>
            <ol>
                <li>Calculer L tel que Σ = LLᵀ</li>
                <li>Générer un vecteur <strong>z</strong> de n variables N(0,1) <em>indépendantes</em></li>
                <li>Calculer <strong>x</strong> = L<strong>z</strong></li>
            </ol>
            <p><strong>Vérification :</strong> Cov(<strong>x</strong>) = E[<strong>xx</strong>ᵀ] = E[L<strong>zz</strong>ᵀLᵀ] = L E[<strong>zz</strong>ᵀ] Lᵀ = L I Lᵀ = LLᵀ = Σ ✓</p>
        </div>

        <h3>Exemple Numérique</h3>

        <p>Pour simuler des rendements d'actions et obligations avec corrélation ρ = -0.3 :</p>

        <div class="box">
            <p><strong>Matrice de covariance :</strong></p>
            <p style="font-family: monospace; text-align: center;">
                Σ = | 0.04  -0.012 |  (σ₁=20%, σ₂=20%, ρ=-0.3)<br>
                    | -0.012  0.04  |
            </p>
            <p><strong>Facteur de Cholesky :</strong></p>
            <p style="font-family: monospace; text-align: center;">
                L = | 0.20    0    |<br>
                    | -0.06  0.19 |
            </p>
            <p><strong>Simulation :</strong> Si z = (1.2, -0.8)ᵀ (deux tirages N(0,1))</p>
            <p style="font-family: monospace; text-align: center;">
                x = Lz = | 0.20×1.2 + 0×(-0.8)    | = | 0.24  | = rendements<br>
                         | -0.06×1.2 + 0.19×(-0.8) |   | -0.22 |   simulés
            </p>
        </div>

        <h3>Décomposition en Valeurs Singulières (SVD)</h3>

        <div class="box">
            <h4>Théorème : <span class="text-red">SVD</span></h4>
            <p>Toute matrice A (m×n) peut s'écrire :</p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; margin: 15px 0;">
                A = UΣVᵀ
            </p>
            <p>où :</p>
            <ul>
                <li><strong>U</strong> (m×m) : matrice orthogonale des vecteurs singuliers gauches</li>
                <li><strong>Σ</strong> (m×n) : matrice diagonale des valeurs singulières σ₁ ≥ σ₂ ≥ ... ≥ 0</li>
                <li><strong>V</strong> (n×n) : matrice orthogonale des vecteurs singuliers droits</li>
            </ul>
            <p><strong>Différence avec valeurs propres :</strong> La SVD s'applique à TOUTE matrice (pas seulement carrées/symétriques).</p>
        </div>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Applications de la SVD</h4>
                <ul>
                    <li><strong>Pseudo-inverse :</strong> Résoudre des systèmes sur/sous-déterminés</li>
                    <li><strong>Compression :</strong> Approximation de rang faible</li>
                    <li><strong>Régression Ridge :</strong> Régularisation numérique</li>
                    <li><strong>Recommandation :</strong> Factorisation matricielle</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Lien avec PCA</h4>
                <p>Si X est la matrice centrée des rendements (T×n) :</p>
                <ul>
                    <li>Σ = (1/T) XᵀX (covariance empirique)</li>
                    <li>Si X = UΣVᵀ, alors les colonnes de V sont les vecteurs propres de XᵀX</li>
                    <li>Les valeurs singulières sont liées aux valeurs propres : λᵢ = σᵢ²/T</li>
                </ul>
            </div>
        </div>

        <!-- SECTION 6: APPLICATIONS PRATIQUES -->
        <h2>Applications Pratiques en Finance</h2>

        <div class="grid-2">
            <div class="grid-item">
                <h4><span class="text-red">Optimisation de Markowitz</span></h4>
                <p>Minimiser <strong>w</strong>ᵀΣ<strong>w</strong> (variance) sous contraintes :</p>
                <ul>
                    <li><strong>1</strong>ᵀ<strong>w</strong> = 1 (budget)</li>
                    <li><strong>μ</strong>ᵀ<strong>w</strong> = μ_cible (rendement)</li>
                    <li><strong>w</strong> ≥ 0 (long-only)</li>
                </ul>
                <p>Solution via multiplicateurs de Lagrange ou programmation quadratique.</p>
            </div>
            <div class="grid-item">
                <h4><span class="text-red">Modèles Factoriels</span></h4>
                <p>Décomposer les rendements :</p>
                <p style="font-family: monospace; text-align: center;">R = Bf + ε</p>
                <p>où B est la matrice des expositions aux k facteurs f.</p>
                <p>Permet de réduire Σ (n×n) à B (n×k) avec k << n.</p>
            </div>
            <div class="grid-item">
                <h4><span class="text-red">Risk Parity</span></h4>
                <p>Égaliser les contributions au risque :</p>
                <p style="font-family: monospace; text-align: center;">wᵢ × (Σw)ᵢ = constante</p>
                <p>Utilise les gradients de la variance par rapport aux poids.</p>
            </div>
            <div class="grid-item">
                <h4><span class="text-red">Stress Testing</span></h4>
                <p>Simuler des scénarios extrêmes :</p>
                <ul>
                    <li>Cholesky pour scénarios corrélés</li>
                    <li>PCA pour identifier les chocs principaux</li>
                    <li>SVD pour compression/approximation</li>
                </ul>
            </div>
        </div>

        <!-- RESSOURCES -->
        <h2>Ressources</h2>

        <div class="box">
            <h4>Lectures Recommandées</h4>
            <ul>
                <li><strong>Gilbert Strang</strong> - "Linear Algebra and Its Applications" — Le classique pour les fondamentaux</li>
                <li><strong>Carol Alexander</strong> - "Market Risk Analysis Vol. I: Quantitative Methods" — Application finance</li>
                <li><strong>Attilio Meucci</strong> - "Risk and Asset Allocation" — PCA et gestion de portefeuille</li>
                <li><strong>Dan Stefanica</strong> - "A Primer for the Mathematics of Financial Engineering" — Exercices pratiques</li>
            </ul>
        </div>

        <div class="box">
            <h4>Ressources en Ligne</h4>
            <ul>
                <li><a href="https://www.youtube.com/playlist?list=PLE7DDD91010BC51F8" target="_blank"><strong>MIT 18.06 - Linear Algebra (Gilbert Strang)</strong></a> — Cours complet gratuit</li>
                <li><a href="https://www.3blue1brown.com/topics/linear-algebra" target="_blank"><strong>3Blue1Brown - Essence of Linear Algebra</strong></a> — Visualisations exceptionnelles</li>
            </ul>
        </div>

        <!-- EXERCICES -->
        <h2 id="exercices-m5">Exercices</h2>

        <p>Testez votre compréhension avec ces exercices progressifs.</p>

        <h3>Niveau 1 : Compréhension</h3>

        <div class="exercise-box">
            <h4>Exercice 1.1 - Variance de Portefeuille</h4>
            <p>Un portefeuille contient deux actifs :</p>
            <ul>
                <li>Actif A : σ₁ = 20%, poids w₁ = 60%</li>
                <li>Actif B : σ₂ = 30%, poids w₂ = 40%</li>
                <li>Corrélation : ρ = 0.5</li>
            </ul>
            <p><strong>Question :</strong> Calculez la volatilité du portefeuille σₚ.</p>
            <p style="font-family: monospace; font-size: 14px; color: var(--text-muted);">
                Formule : σₚ² = w₁²σ₁² + w₂²σ₂² + 2w₁w₂ρσ₁σ₂
            </p>

            <input type="text" class="exercise-calc-input" id="m5-variance" placeholder="Entrez σₚ en % (ex: 18.5)">
            <button class="check-btn" onclick="checkM5Variance()">Vérifier</button>
            <div id="feedback-m5-var" class="feedback"></div>

            <details>
                <summary>Voir la solution détaillée</summary>
                <div class="solution">
                    <p><strong>Étape 1 :</strong> Calculer chaque terme</p>
                    <ul>
                        <li>w₁²σ₁² = 0.6² × 0.20² = 0.36 × 0.04 = 0.0144</li>
                        <li>w₂²σ₂² = 0.4² × 0.30² = 0.16 × 0.09 = 0.0144</li>
                        <li>2w₁w₂ρσ₁σ₂ = 2 × 0.6 × 0.4 × 0.5 × 0.20 × 0.30 = 0.0144</li>
                    </ul>
                    <p><strong>Étape 2 :</strong> Sommer</p>
                    <p>σₚ² = 0.0144 + 0.0144 + 0.0144 = 0.0432</p>
                    <p><strong>Étape 3 :</strong> Racine carrée</p>
                    <p>σₚ = √0.0432 = <strong>20.78%</strong> ≈ 20.8%</p>
                    <p><strong>Remarque :</strong> La volatilité du portefeuille (20.8%) est inférieure à la moyenne pondérée des volatilités (0.6×20% + 0.4×30% = 24%). C'est l'effet de la diversification !</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 1.2 - PCA et Variance Expliquée</h4>
            <p>La matrice de covariance d'un portefeuille de 3 actifs a les valeurs propres suivantes :</p>
            <ul>
                <li>λ₁ = 0.040 (facteur marché)</li>
                <li>λ₂ = 0.010 (facteur sectoriel)</li>
                <li>λ₃ = 0.005 (résiduel)</li>
            </ul>
            <p><strong>Question :</strong> Quel pourcentage de la variance totale est expliqué par le premier facteur (PC1) ?</p>

            <input type="text" class="exercise-calc-input" id="m5-pca" placeholder="Entrez le % (ex: 65.5)">
            <button class="check-btn" onclick="checkM5PCA()">Vérifier</button>
            <div id="feedback-m5-pca" class="feedback"></div>

            <details>
                <summary>Voir la solution détaillée</summary>
                <div class="solution">
                    <p><strong>Étape 1 :</strong> Variance totale = somme des valeurs propres</p>
                    <p>Variance totale = λ₁ + λ₂ + λ₃ = 0.040 + 0.010 + 0.005 = 0.055</p>
                    <p><strong>Étape 2 :</strong> Ratio de variance expliquée</p>
                    <p>% PC1 = λ₁ / (λ₁ + λ₂ + λ₃) = 0.040 / 0.055 = <strong>72.73%</strong></p>
                    <p><strong>Interprétation :</strong> Le premier facteur (typiquement le "facteur marché") explique près de 73% du risque total. C'est cohérent avec l'observation empirique que les actions sont fortement corrélées au marché global.</p>
                </div>
            </details>
        </div>

        <h3>Niveau 2 : Application</h3>

        <div class="exercise-box">
            <h4>Exercice 2.1 - Matrice de Covariance</h4>
            <p>Soit la matrice de corrélation et les volatilités suivantes :</p>
            <table style="font-family: monospace; text-align: center; margin: 15px 0;">
                <tr>
                    <th>Corrélation</th>
                    <th>A</th>
                    <th>B</th>
                </tr>
                <tr>
                    <td><strong>A</strong></td>
                    <td>1</td>
                    <td>0.6</td>
                </tr>
                <tr>
                    <td><strong>B</strong></td>
                    <td>0.6</td>
                    <td>1</td>
                </tr>
            </table>
            <p>Volatilités : σ_A = 25%, σ_B = 15%</p>
            <p><strong>Question :</strong> Calculez Cov(A, B) = ρ × σ_A × σ_B</p>

            <input type="text" class="exercise-calc-input" id="m5-cov" placeholder="Entrez la covariance (ex: 0.0225)">
            <button class="check-btn" onclick="checkM5Cov()">Vérifier</button>
            <div id="feedback-m5-cov" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Cov(A, B) = ρ × σ_A × σ_B = 0.6 × 0.25 × 0.15 = <strong>0.0225</strong></p>
                    <p>La matrice de covariance complète est :</p>
                    <p style="font-family: monospace; text-align: center;">
                        Σ = | 0.0625  0.0225 |<br>
                            | 0.0225  0.0225 |
                    </p>
                </div>
            </details>
        </div>

        <h3>Niveau 3 : Analyse</h3>

        <div class="exercise-box">
            <h4>Exercice 3.1 - Effet de la Corrélation</h4>
            <p>Deux actifs ont chacun une volatilité de 20%. Vous investissez 50% dans chaque.</p>
            <p><strong>Question :</strong> Calculez la volatilité du portefeuille pour ρ = -1, ρ = 0, et ρ = +1. Que constatez-vous ?</p>

            <textarea class="exercise-input" id="m5-analyse" rows="4" placeholder="Décrivez l'effet de la corrélation sur le risque du portefeuille..."></textarea>

            <button class="check-btn" onclick="checkM5Analyse()">Vérifier</button>
            <div id="feedback-m5-analyse" class="feedback"></div>

            <details>
                <summary>Voir la solution complète</summary>
                <div class="solution">
                    <p><strong>Formule :</strong> σₚ² = 0.5² × 0.2² + 0.5² × 0.2² + 2 × 0.5 × 0.5 × ρ × 0.2 × 0.2</p>
                    <p>σₚ² = 0.02 + 0.02ρ = 0.02(1 + ρ)</p>
                    <ul>
                        <li><strong>ρ = -1 :</strong> σₚ² = 0 → σₚ = <strong>0%</strong> (risque totalement éliminé !)</li>
                        <li><strong>ρ = 0 :</strong> σₚ² = 0.02 → σₚ = <strong>14.14%</strong></li>
                        <li><strong>ρ = +1 :</strong> σₚ² = 0.04 → σₚ = <strong>20%</strong> (pas de diversification)</li>
                    </ul>
                    <p><strong>Conclusion :</strong> La corrélation négative permet une diversification maximale. Quand ρ = -1, les pertes d'un actif sont exactement compensées par les gains de l'autre. C'est pourquoi les investisseurs recherchent des actifs décorrélés ou anti-corrélés.</p>
                </div>
            </details>
        </div>

        <!-- FLASHCARDS -->
        <h2 id="flashcards-m5">Flashcards</h2>

        <p>Cliquez sur une carte pour révéler la réponse. Révisez régulièrement (J+1, J+3, J+7, J+14, J+30).</p>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Comment calcule-t-on le rendement espéré d'un portefeuille ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>μₚ = <strong>w</strong>ᵀ<strong>μ</strong> = Σᵢ wᵢμᵢ<br><br>Produit scalaire des poids et rendements</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Formule de la variance d'un portefeuille ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>σₚ² = <strong>w</strong>ᵀΣ<strong>w</strong><br><br>Forme quadratique avec la matrice de covariance</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce qu'une matrice semi-définie positive ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Une matrice Σ telle que <strong>x</strong>ᵀΣ<strong>x</strong> ≥ 0 pour tout vecteur <strong>x</strong>.<br><br>Les matrices de covariance sont toujours SDP.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Définition de valeur propre et vecteur propre ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>A<strong>v</strong> = λ<strong>v</strong><br><br>La matrice A ne fait qu'"étirer" le vecteur <strong>v</strong> par le facteur λ.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>À quoi sert la décomposition de Cholesky ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Générer des variables aléatoires corrélées pour Monte Carlo.<br><br>Σ = LLᵀ, puis <strong>x</strong> = L<strong>z</strong> où <strong>z</strong> ~ N(0,I)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Que représente le premier vecteur propre de Σ ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>La direction de variance maximale dans l'espace des rendements.<br><br>En finance, c'est souvent le "facteur marché".</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Formule de la corrélation à partir de la covariance ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>ρᵢⱼ = Cov(Rᵢ, Rⱼ) / (σᵢ × σⱼ)<br><br>Toujours entre -1 et +1</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Variance expliquée en PCA ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>% variance(PCᵢ) = λᵢ / Σⱼ λⱼ<br><br>La valeur propre divisée par la somme de toutes les valeurs propres</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quelle est la SVD d'une matrice A ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>A = UΣVᵀ<br><br>U, V orthogonales, Σ diagonale (valeurs singulières)</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Combien de paramètres uniques dans une matrice de covariance n×n ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>n(n+1)/2<br><br>La matrice est symétrique, donc seule la moitié supérieure (ou inférieure) + diagonale est unique.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module4')">Précédent : Ère Moderne et Crises</button>
            <button class="nav-btn" onclick="showModule('module6')">Suivant : Calcul Différentiel</button>
        </div>
    </section>

    <section id="module6" class="module">

        <header class="module-header">
            <h1>Calcul Différentiel et Intégral pour la Finance</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Fondamental</span>
                <span>120 minutes</span>
                <span>Prérequis : Module 5 (Algèbre Linéaire)</span>
            </div>
        </header>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/9/9f/Integral_example.svg" alt="Intégrale">
            <figcaption>L'intégrale comme aire sous la courbe — concept fondamental pour le pricing des options et le calcul des espérances</figcaption>
        </figure>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre le rôle central du calcul différentiel en finance quantitative</li>
            <li>Maîtriser les dérivées partielles et leur interprétation comme sensibilités (Greeks)</li>
            <li>Appliquer les techniques d'optimisation aux problèmes de portefeuille</li>
            <li>Utiliser les multiplicateurs de Lagrange et les conditions KKT</li>
            <li>Comprendre les intégrales et leur application au pricing et aux probabilités</li>
            <li>Préparer les bases pour le calcul stochastique (Module 10)</li>
        </ul>

        <div class="box">
            <h4>Le Calcul : Langage de la Dynamique Financière</h4>
            <p>Si l'algèbre linéaire capture les <em>relations statiques</em> entre actifs, le calcul différentiel capture leur <em>dynamique</em>. Chaque concept a une traduction directe en finance :</p>
            <ul>
                <li><span class="text-red">Dérivée</span> → Sensibilité (comment le prix change quand un paramètre bouge)</li>
                <li><span class="text-red">Gradient</span> → Direction de plus forte pente (pour optimiser)</li>
                <li><span class="text-red">Intégrale</span> → Espérance, probabilité cumulative, prix d'option</li>
                <li><span class="text-red">Optimisation</span> → Trouver le meilleur portefeuille sous contraintes</li>
            </ul>
            <p>Les <span class="text-red">Greeks</span> — Delta, Gamma, Theta, Vega, Rho — ne sont rien d'autre que des dérivées partielles. Maîtriser le calcul, c'est comprendre les risques.</p>
        </div>

        <!-- SECTION 1: CONTEXTE HISTORIQUE -->
        <h2>Contexte Historique : De Newton à Black-Scholes</h2>

        <p>Le calcul différentiel et intégral a été développé indépendamment par <strong>Isaac Newton</strong> (1643-1727) et <strong>Gottfried Wilhelm Leibniz</strong> (1646-1716) à la fin du XVIIe siècle. Leur invention a révolutionné les sciences et, trois siècles plus tard, la finance.</p>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1684</div>
                <div class="timeline-content">
                    <strong>Leibniz publie le calcul différentiel</strong><br>
                    Introduction de la notation dx, dy, ∫ encore utilisée aujourd'hui
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1788</div>
                <div class="timeline-content">
                    <strong>Lagrange - Mécanique Analytique</strong><br>
                    Développement des multiplicateurs de Lagrange pour l'optimisation sous contraintes
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1951</div>
                <div class="timeline-content">
                    <strong>Kuhn & Tucker - Conditions KKT</strong><br>
                    Extension aux contraintes d'inégalité, fondamental pour l'optimisation moderne
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1952</div>
                <div class="timeline-content">
                    <strong>Markowitz - Optimisation de portefeuille</strong><br>
                    Application des multiplicateurs de Lagrange à la finance
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1973</div>
                <div class="timeline-content">
                    <strong>Black-Scholes-Merton</strong><br>
                    EDP (équation aux dérivées partielles) pour le pricing des options
                </div>
            </div>
        </div>

        <blockquote>
            <p>"La nature ne fait rien en vain, et c'est faire une chose en vain que d'employer plus de moyens qu'il n'en faut pour arriver à une fin."</p>
            <cite>Isaac Newton — Principe qui guide l'optimisation</cite>
        </blockquote>

        <!-- SECTION 2: DERIVEES -->
        <h2>Dérivées : Mesurer les Sensibilités</h2>

        <div class="box">
            <h4>Définition : <span class="text-red">Dérivée</span></h4>
            <p>La dérivée de f en x mesure le <strong>taux de variation instantané</strong> :</p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; margin: 15px 0;">
                f'(x) = df/dx = lim[h→0] (f(x+h) - f(x)) / h
            </p>
            <p><strong>Interprétation géométrique :</strong> Pente de la tangente à la courbe au point x.</p>
            <p><strong>Interprétation financière :</strong> Si f(S) = prix d'option et S = prix du sous-jacent, alors f'(S) mesure de combien le prix de l'option change pour un mouvement unitaire du sous-jacent.</p>
        </div>

        <h3>Règles de Dérivation Essentielles</h3>

        <table>
            <thead>
                <tr>
                    <th>Règle</th>
                    <th>Formule</th>
                    <th>Application Finance</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Puissance</td>
                    <td>(xⁿ)' = n·xⁿ⁻¹</td>
                    <td>Dérivée de la variance σ² par rapport aux poids</td>
                </tr>
                <tr>
                    <td>Exponentielle</td>
                    <td>(eˣ)' = eˣ</td>
                    <td>Facteur d'actualisation e⁻ʳᵗ</td>
                </tr>
                <tr>
                    <td>Logarithme</td>
                    <td>(ln x)' = 1/x</td>
                    <td>Rendements log-normaux</td>
                </tr>
                <tr>
                    <td>Chaîne</td>
                    <td>(f∘g)' = f'(g)·g'</td>
                    <td>Dérivée de fonctions composées</td>
                </tr>
                <tr>
                    <td>Produit</td>
                    <td>(fg)' = f'g + fg'</td>
                    <td>Prix × quantité</td>
                </tr>
            </tbody>
        </table>

        <h3>Dérivées Partielles et Gradient</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Dérivée Partielle</span></h4>
            <p>Pour une fonction de plusieurs variables f(x₁, x₂, ..., xₙ), la dérivée partielle par rapport à xᵢ mesure la variation de f quand seul xᵢ change :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; margin: 10px 0;">
                ∂f/∂xᵢ = lim[h→0] (f(x₁,...,xᵢ+h,...,xₙ) - f(x₁,...,xᵢ,...,xₙ)) / h
            </p>
            <p><strong>Le Gradient</strong> rassemble toutes les dérivées partielles en un vecteur :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                ∇f = (∂f/∂x₁, ∂f/∂x₂, ..., ∂f/∂xₙ)ᵀ
            </p>
            <p>Le gradient pointe vers la <span class="text-red">direction de plus forte augmentation</span> de f.</p>
        </div>

        <!-- SECTION 3: GREEKS -->
        <h2>Les Greeks : Dérivées Partielles du Prix d'Option</h2>

        <p>Les <span class="text-red">Greeks</span> sont les sensibilités du prix d'une option aux différents paramètres du marché. Ce sont des dérivées partielles, et ils sont essentiels pour la gestion des risques.</p>

        <div class="box">
            <h4>Le Prix d'une Option Dépend de 5 Variables</h4>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                C = C(S, K, T, r, σ)
            </p>
            <ul>
                <li><strong>S</strong> = Prix spot du sous-jacent</li>
                <li><strong>K</strong> = Strike (prix d'exercice)</li>
                <li><strong>T</strong> = Temps jusqu'à maturité</li>
                <li><strong>r</strong> = Taux sans risque</li>
                <li><strong>σ</strong> = Volatilité implicite</li>
            </ul>
            <p>Chaque Greek mesure la sensibilité à l'un de ces paramètres.</p>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Greek</th>
                    <th>Symbole</th>
                    <th>Définition</th>
                    <th>Interprétation</th>
                    <th>Valeur typique (Call ATM)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="text-red">Delta</span></td>
                    <td>Δ</td>
                    <td>∂C/∂S</td>
                    <td>Sensibilité au spot</td>
                    <td>≈ 0.50</td>
                </tr>
                <tr>
                    <td><span class="text-red">Gamma</span></td>
                    <td>Γ</td>
                    <td>∂²C/∂S²</td>
                    <td>Convexité, variation du Delta</td>
                    <td>Maximum ATM</td>
                </tr>
                <tr>
                    <td><span class="text-red">Theta</span></td>
                    <td>Θ</td>
                    <td>∂C/∂T</td>
                    <td>Decay temporel (perte de valeur/jour)</td>
                    <td>< 0 (négatif)</td>
                </tr>
                <tr>
                    <td><span class="text-red">Vega</span></td>
                    <td>ν</td>
                    <td>∂C/∂σ</td>
                    <td>Sensibilité à la volatilité</td>
                    <td>> 0, max ATM</td>
                </tr>
                <tr>
                    <td><span class="text-red">Rho</span></td>
                    <td>ρ</td>
                    <td>∂C/∂r</td>
                    <td>Sensibilité aux taux</td>
                    <td>> 0 (call), < 0 (put)</td>
                </tr>
            </tbody>
        </table>

        <div class="box">
            <h4>Exemple Numérique : Calcul du P&L avec les Greeks</h4>
            <p>Un trader détient un call avec :</p>
            <ul>
                <li>Δ = 0.55</li>
                <li>Γ = 0.02</li>
                <li>Θ = -0.05 (perd 5 centimes par jour)</li>
                <li>ν = 0.15</li>
            </ul>
            <p><strong>Scénario :</strong> Le sous-jacent monte de 2€, la volatilité augmente de 1%, et 1 jour passe.</p>
            <p><strong>P&L approximatif :</strong></p>
            <p style="font-family: monospace; text-align: center;">
                ΔP ≈ Δ·ΔS + ½Γ·(ΔS)² + Θ·Δt + ν·Δσ
            </p>
            <p style="font-family: monospace; text-align: center;">
                ΔP ≈ 0.55×2 + ½×0.02×4 + (-0.05)×1 + 0.15×1 = 1.10 + 0.04 - 0.05 + 0.15 = <strong>+1.24€</strong>
            </p>
        </div>

        <!-- Graphique Delta -->
        <h3>Visualisation : Delta en Fonction du Prix Spot</h3>
        <div class="chart-container">
            <canvas id="deltaChart"></canvas>
        </div>

        <!-- SECTION 4: OPTIMISATION -->
        <h2>Optimisation : Trouver le Meilleur</h2>

        <p>L'<span class="text-red">optimisation</span> est au cœur de la finance quantitative : maximiser le rendement, minimiser le risque, trouver le portefeuille optimal, calibrer des modèles...</p>

        <h3>Optimisation sans Contrainte</h3>

        <div class="box">
            <h4>Conditions du Premier Ordre (CPO)</h4>
            <p>Pour trouver un extremum (minimum ou maximum) de f(x), on cherche les points où le gradient s'annule :</p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; margin: 15px 0;">
                ∇f(x*) = 0
            </p>
            <p>En une dimension : f'(x*) = 0</p>
            <p>En plusieurs dimensions : ∂f/∂xᵢ = 0 pour tout i = 1, ..., n</p>
        </div>

        <div class="box">
            <h4>Conditions du Second Ordre (CSO)</h4>
            <p>Les CPO trouvent les points <em>stationnaires</em> mais ne distinguent pas minimum, maximum et point-selle. On utilise la <span class="text-red">dérivée seconde</span> (ou matrice Hessienne) :</p>
            <p><strong>En une dimension :</strong></p>
            <ul>
                <li>f''(x*) > 0 ⟹ <strong>minimum local</strong></li>
                <li>f''(x*) < 0 ⟹ <strong>maximum local</strong></li>
                <li>f''(x*) = 0 ⟹ test non concluant</li>
            </ul>
            <p><strong>En plusieurs dimensions :</strong> On examine la matrice Hessienne H = [∂²f/∂xᵢ∂xⱼ]</p>
            <ul>
                <li>H définie positive ⟹ minimum local</li>
                <li>H définie négative ⟹ maximum local</li>
                <li>H indéfinie ⟹ point-selle</li>
            </ul>
        </div>

        <h3>Exemple : Optimisation Simple</h3>

        <div class="box">
            <h4>Problème</h4>
            <p>Trouver le minimum de f(x) = x² - 4x + 7</p>
            <p><strong>Solution :</strong></p>
            <ol>
                <li><strong>CPO :</strong> f'(x) = 2x - 4 = 0 ⟹ x* = 2</li>
                <li><strong>CSO :</strong> f''(x) = 2 > 0 ⟹ c'est bien un minimum</li>
                <li><strong>Valeur minimale :</strong> f(2) = 4 - 8 + 7 = 3</li>
            </ol>
        </div>

        <!-- SECTION 5: LAGRANGE -->
        <h2>Optimisation sous Contraintes : Multiplicateurs de Lagrange</h2>

        <p>En finance, on n'optimise jamais "librement" — il y a toujours des <span class="text-red">contraintes</span> : budget limité, pas de vente à découvert, limites réglementaires...</p>

        <div class="box">
            <h4>Méthode : <span class="text-red">Multiplicateurs de Lagrange</span></h4>
            <p><strong>Problème :</strong> Optimiser f(x) sous la contrainte g(x) = 0</p>
            <p><strong>Solution :</strong> Former le Lagrangien et annuler ses dérivées</p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; margin: 15px 0;">
                L(x, λ) = f(x) - λ · g(x)
            </p>
            <p><strong>Conditions d'optimalité :</strong></p>
            <ul>
                <li>∂L/∂x = ∇f - λ∇g = 0 (stationnarité)</li>
                <li>∂L/∂λ = -g(x) = 0 (contrainte satisfaite)</li>
            </ul>
            <p><strong>Interprétation de λ :</strong> Le multiplicateur λ mesure le <span class="text-red">"prix fantôme"</span> de la contrainte — combien la fonction objectif changerait si on relâchait légèrement la contrainte.</p>
        </div>

        <h3>Application : Portefeuille à Variance Minimale</h3>

        <div class="box">
            <h4>Problème de Markowitz Simplifié</h4>
            <p><strong>Objectif :</strong> Minimiser le risque σₚ² = <strong>w</strong>ᵀΣ<strong>w</strong></p>
            <p><strong>Contrainte :</strong> Budget pleinement investi : <strong>1</strong>ᵀ<strong>w</strong> = 1</p>
            <p><strong>Lagrangien :</strong></p>
            <p style="font-family: monospace; text-align: center;">
                L(<strong>w</strong>, λ) = <strong>w</strong>ᵀΣ<strong>w</strong> - λ(<strong>1</strong>ᵀ<strong>w</strong> - 1)
            </p>
            <p><strong>CPO :</strong></p>
            <ul>
                <li>∂L/∂<strong>w</strong> = 2Σ<strong>w</strong> - λ<strong>1</strong> = 0 ⟹ <strong>w</strong> = (λ/2)Σ⁻¹<strong>1</strong></li>
                <li>∂L/∂λ = <strong>1</strong>ᵀ<strong>w</strong> - 1 = 0</li>
            </ul>
            <p><strong>Solution :</strong></p>
            <p style="font-family: monospace; text-align: center; font-size: 18px;">
                <strong>w</strong>* = Σ⁻¹<strong>1</strong> / (<strong>1</strong>ᵀΣ⁻¹<strong>1</strong>)
            </p>
            <p>Les poids optimaux sont proportionnels à Σ⁻¹<strong>1</strong>, normalisés pour sommer à 1.</p>
        </div>

        <h3>Conditions KKT : Extension aux Inégalités</h3>

        <div class="box">
            <h4>Conditions de <span class="text-red">Karush-Kuhn-Tucker (KKT)</span></h4>
            <p>Quand on a des contraintes d'<em>inégalité</em> gᵢ(x) ≤ 0 (ex: wᵢ ≥ 0, pas de vente à découvert) :</p>
            <p><strong>Lagrangien généralisé :</strong></p>
            <p style="font-family: monospace; text-align: center;">
                L(x, λ, μ) = f(x) - Σλⱼhⱼ(x) - Σμᵢgᵢ(x)
            </p>
            <p><strong>Conditions KKT (nécessaires pour un minimum) :</strong></p>
            <ol>
                <li><strong>Stationnarité :</strong> ∇ₓL = 0</li>
                <li><strong>Faisabilité primale :</strong> hⱼ(x) = 0, gᵢ(x) ≤ 0</li>
                <li><strong>Faisabilité duale :</strong> μᵢ ≥ 0</li>
                <li><strong>Complémentarité :</strong> μᵢ · gᵢ(x) = 0 pour tout i</li>
            </ol>
            <p><strong>Complémentarité expliquée :</strong> Soit la contrainte est <em>active</em> (gᵢ = 0, elle mord), soit son multiplicateur est nul (μᵢ = 0, elle n'affecte pas la solution). Jamais les deux simultanément non nuls.</p>
        </div>

        <!-- SECTION 6: INTEGRALES -->
        <h2>Intégrales : Sommes Continues</h2>

        <div class="box">
            <h4>Définition : <span class="text-red">Intégrale</span></h4>
            <p>L'intégrale de f sur [a, b] est la limite des sommes de Riemann :</p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; margin: 15px 0;">
                ∫ₐᵇ f(x)dx = lim[n→∞] Σᵢ₌₁ⁿ f(xᵢ) · Δx
            </p>
            <p><strong>Interprétation géométrique :</strong> Aire sous la courbe y = f(x) entre a et b.</p>
            <p><strong>Théorème fondamental :</strong> Si F'(x) = f(x), alors ∫ₐᵇ f(x)dx = F(b) - F(a)</p>
        </div>

        <h3>Applications Financières des Intégrales</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4><span class="text-red">Espérance</span></h4>
                <p>Pour une variable continue X avec densité f(x) :</p>
                <p style="font-family: monospace; text-align: center;">E[X] = ∫₋∞^∞ x · f(x) dx</p>
                <p><em>Moyenne pondérée continue</em></p>
            </div>
            <div class="grid-item">
                <h4><span class="text-red">Probabilité</span></h4>
                <p>Probabilité que X ∈ [a, b] :</p>
                <p style="font-family: monospace; text-align: center;">P(a ≤ X ≤ b) = ∫ₐᵇ f(x) dx</p>
                <p><em>Aire sous la densité</em></p>
            </div>
            <div class="grid-item">
                <h4><span class="text-red">Prix d'Option</span></h4>
                <p>Call européen (formule intégrale) :</p>
                <p style="font-family: monospace; text-align: center;">C = e⁻ʳᵀ ∫ max(S-K, 0) · φ(S) dS</p>
                <p><em>Espérance actualisée du payoff</em></p>
            </div>
            <div class="grid-item">
                <h4><span class="text-red">Valeur Présente</span></h4>
                <p>Flux continu c(t) actualisé :</p>
                <p style="font-family: monospace; text-align: center;">PV = ∫₀^T c(t) · e⁻ʳᵗ dt</p>
                <p><em>Version continue de la VAN</em></p>
            </div>
        </div>

        <h3>Intégrales Importantes</h3>

        <table>
            <thead>
                <tr>
                    <th>Fonction</th>
                    <th>Intégrale (primitive)</th>
                    <th>Application</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>xⁿ</td>
                    <td>xⁿ⁺¹/(n+1) + C</td>
                    <td>Moments</td>
                </tr>
                <tr>
                    <td>eˣ</td>
                    <td>eˣ + C</td>
                    <td>Actualisation continue</td>
                </tr>
                <tr>
                    <td>e⁻ˣ²</td>
                    <td>√π · Φ(x) (fonction erreur)</td>
                    <td>Loi normale</td>
                </tr>
                <tr>
                    <td>1/x</td>
                    <td>ln|x| + C</td>
                    <td>Rendements log</td>
                </tr>
            </tbody>
        </table>

        <!-- RESSOURCES -->
        <h2>Ressources</h2>

        <div class="box">
            <h4>Lectures Recommandées</h4>
            <ul>
                <li><strong>James Stewart</strong> - "Calculus" — Le manuel de référence pour le calcul</li>
                <li><strong>Dan Stefanica</strong> - "A Primer for the Mathematics of Financial Engineering" — Chapitres 1-3</li>
                <li><strong>John Hull</strong> - "Options, Futures, and Other Derivatives" — Chapitres sur les Greeks</li>
                <li><strong>Stephen Boyd</strong> - "Convex Optimization" — Pour aller plus loin en optimisation</li>
            </ul>
        </div>

        <div class="box">
            <h4>Ressources en Ligne</h4>
            <ul>
                <li><a href="https://www.khanacademy.org/math/calculus-1" target="_blank"><strong>Khan Academy - Calculus</strong></a> — Cours gratuit avec exercices</li>
                <li><a href="https://www.3blue1brown.com/topics/calculus" target="_blank"><strong>3Blue1Brown - Essence of Calculus</strong></a> — Visualisations exceptionnelles</li>
            </ul>
        </div>

        <!-- EXERCICES -->
        <h2 id="exercices-m6">Exercices</h2>

        <p>Testez votre compréhension avec ces exercices progressifs.</p>

        <h3>Niveau 1 : Compréhension</h3>

        <div class="exercise-box">
            <h4>Exercice 1.1 - Optimisation Simple</h4>
            <p>Trouvez le minimum de la fonction f(x) = x² - 4x + 7.</p>
            <p><strong>Question :</strong> À quelle valeur de x le minimum est-il atteint ?</p>

            <input type="text" class="exercise-calc-input" id="m6-optim" placeholder="x* = ?">
            <button class="check-btn" onclick="checkM6Optim()">Vérifier</button>
            <div id="feedback-m6-optim" class="feedback"></div>

            <details>
                <summary>Voir la solution détaillée</summary>
                <div class="solution">
                    <p><strong>Étape 1 - CPO :</strong> f'(x) = 2x - 4 = 0</p>
                    <p>Résolution : 2x = 4 ⟹ x* = 2</p>
                    <p><strong>Étape 2 - CSO :</strong> f''(x) = 2 > 0</p>
                    <p>La dérivée seconde est positive, donc c'est bien un minimum.</p>
                    <p><strong>Valeur minimale :</strong> f(2) = 4 - 8 + 7 = 3</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 1.2 - Multiplicateur de Lagrange</h4>
            <p>Maximisez f(x, y) = xy sous la contrainte x + y = 10.</p>
            <p><strong>Question :</strong> Quelle est la valeur optimale de x (et y par symétrie) ?</p>

            <input type="text" class="exercise-calc-input" id="m6-lagrange" placeholder="x* = ?">
            <button class="check-btn" onclick="checkM6Lagrange()">Vérifier</button>
            <div id="feedback-m6-lagrange" class="feedback"></div>

            <details>
                <summary>Voir la solution détaillée</summary>
                <div class="solution">
                    <p><strong>Lagrangien :</strong> L(x, y, λ) = xy - λ(x + y - 10)</p>
                    <p><strong>CPO :</strong></p>
                    <ul>
                        <li>∂L/∂x = y - λ = 0 ⟹ y = λ</li>
                        <li>∂L/∂y = x - λ = 0 ⟹ x = λ</li>
                        <li>∂L/∂λ = -(x + y - 10) = 0 ⟹ x + y = 10</li>
                    </ul>
                    <p>Des deux premières équations : x = y = λ</p>
                    <p>En substituant dans la contrainte : 2x = 10 ⟹ <strong>x* = y* = 5</strong></p>
                    <p>Maximum : f(5, 5) = 25</p>
                </div>
            </details>
        </div>

        <h3>Niveau 2 : Application</h3>

        <div class="exercise-box">
            <h4>Exercice 2.1 - Greeks</h4>
            <p>Un call a les Greeks suivants : Δ = 0.60, Γ = 0.03, Θ = -0.08.</p>
            <p>Le sous-jacent monte de 3€ et 2 jours passent.</p>
            <p><strong>Question :</strong> Quel est le P&L approximatif de l'option ?</p>
            <p style="font-family: monospace; font-size: 14px; color: var(--text-muted);">
                ΔP ≈ Δ·ΔS + ½Γ·(ΔS)² + Θ·Δt
            </p>

            <input type="text" class="exercise-calc-input" id="m6-greek" placeholder="P&L = ?">
            <button class="check-btn" onclick="checkM6Greek()">Vérifier</button>
            <div id="feedback-m6-greek" class="feedback"></div>

            <details>
                <summary>Voir la solution détaillée</summary>
                <div class="solution">
                    <p>ΔP ≈ Δ·ΔS + ½Γ·(ΔS)² + Θ·Δt</p>
                    <ul>
                        <li>Effet Delta : 0.60 × 3 = 1.80</li>
                        <li>Effet Gamma : ½ × 0.03 × 9 = 0.135</li>
                        <li>Effet Theta : -0.08 × 2 = -0.16</li>
                    </ul>
                    <p>Total : 1.80 + 0.135 - 0.16 = <strong>+1.775€</strong> ≈ 1.78€</p>
                </div>
            </details>
        </div>

        <h3>Niveau 3 : Analyse</h3>

        <div class="exercise-box">
            <h4>Exercice 3.1 - Interprétation du Multiplicateur</h4>
            <p>Dans un problème d'optimisation de portefeuille, le multiplicateur de Lagrange associé à la contrainte de budget est λ = 0.08.</p>
            <p><strong>Question :</strong> Que signifie cette valeur ? Que se passerait-il si vous aviez 1€ de plus à investir ?</p>

            <textarea class="exercise-input" id="m6-analyse" rows="3" placeholder="Interprétez le multiplicateur λ..."></textarea>

            <button class="check-btn" onclick="checkM6Analyse()">Vérifier</button>
            <div id="feedback-m6-analyse" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Le multiplicateur λ = 0.08 représente le <strong>"prix fantôme"</strong> ou <strong>utilité marginale</strong> de la contrainte de budget.</p>
                    <p><strong>Interprétation :</strong> Si vous aviez 1€ de plus à investir (relâchement marginal de la contrainte), la fonction objectif s'améliorerait d'environ 0.08.</p>
                    <p>Dans le contexte d'un problème rendement-risque, cela peut signifier que chaque euro supplémentaire permettrait d'améliorer le ratio rendement/risque de 8%.</p>
                </div>
            </details>
        </div>

        <!-- FLASHCARDS -->
        <h2 id="flashcards-m6">Flashcards</h2>

        <p>Cliquez sur une carte pour révéler la réponse.</p>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que le Delta (Δ) d'une option ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Δ = ∂C/∂S<br><br>Sensibilité du prix de l'option aux mouvements du sous-jacent. Pour un call ATM, Δ ≈ 0.50.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que le Gamma (Γ) ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Γ = ∂²C/∂S² = ∂Δ/∂S<br><br>Mesure la convexité, c'est-à-dire comment le Delta change quand S bouge. Maximum ATM.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Quelle est la condition du premier ordre (CPO) ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>∇f(x*) = 0<br><br>À un extremum, le gradient (toutes les dérivées partielles) s'annule.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>À quoi sert le multiplicateur de Lagrange λ ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Il mesure le "prix fantôme" de la contrainte : ∂f*/∂b où b est le niveau de la contrainte.<br><br>Combien la fonction objectif changerait si on relâchait la contrainte.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Qu'est-ce que la matrice Hessienne ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>H = [∂²f/∂xᵢ∂xⱼ]<br><br>Matrice des dérivées secondes. Si H > 0 (définie positive) → minimum. Si H < 0 → maximum.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Que dit la condition de complémentarité KKT ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>μᵢ · gᵢ(x*) = 0 pour tout i<br><br>Soit la contrainte est active (gᵢ = 0), soit son multiplicateur est nul (μᵢ = 0).</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Formule du portefeuille à variance minimale ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p><strong>w</strong>* = Σ⁻¹<strong>1</strong> / (<strong>1</strong>ᵀΣ⁻¹<strong>1</strong>)<br><br>Poids proportionnels à l'inverse de la covariance, normalisés.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Comment calcule-t-on l'espérance E[X] d'une variable continue ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>E[X] = ∫ x · f(x) dx<br><br>où f(x) est la fonction de densité de probabilité.</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Le Theta est-il généralement positif ou négatif ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Θ < 0 (négatif)<br><br>Les options perdent de la valeur avec le temps qui passe ("time decay").</p>
                    </div>
                </div>
            </div>

            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <p>Dans quelle direction pointe le gradient ∇f ?</p>
                    </div>
                    <div class="flashcard-back">
                        <p>Le gradient pointe vers la direction de plus forte augmentation de f.<br><br>Pour minimiser, on descend dans la direction -∇f (gradient descent).</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module5')">Précédent : Algèbre Linéaire</button>
            <button class="nav-btn" onclick="showModule('module7')">Suivant : Probabilités</button>
        </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════════════════
         MODULE 7 : PROBABILITÉS
         De Pascal et Fermat (1654) à la modélisation financière moderne
         ═══════════════════════════════════════════════════════════════════════════ -->
    <section id="module7" class="module">
        <header class="module-header">
            <h1>Probabilités : Le Langage de l'Incertitude</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Fondamental</span>
                <span>120 minutes</span>
                <span>Prérequis : Modules 5-6</span>
            </div>
        </header>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/8/8c/Standard_deviation_diagram.svg" alt="Distribution normale">
            <figcaption>La distribution normale et ses écarts-types - fondement de la modélisation financière</figcaption>
        </figure>

        <h4>Objectifs du Module</h4>
        <ul>
            <li>Maîtriser les axiomes de Kolmogorov et l'espace de probabilité (Ω, F, P)</li>
            <li>Comprendre les distributions essentielles : normale, log-normale, Student-t, chi-carré</li>
            <li>Calculer espérances, variances, skewness et kurtosis</li>
            <li>Appliquer le théorème de Bayes à la mise à jour des croyances</li>
            <li>Maîtriser les concepts de corrélation et d'indépendance</li>
        </ul>

        <div class="box">
            <h4>Pourquoi les Probabilités sont Essentielles en Finance</h4>
            <p>La finance quantitative repose entièrement sur la modélisation probabiliste de l'incertitude. Les rendements sont des <span class="text-red">variables aléatoires</span>, les prix suivent des <span class="text-red">processus stochastiques</span>, et l'évaluation des actifs utilise des <span class="text-red">espérances</span> sous différentes mesures de probabilité. Sans probabilités, pas de Black-Scholes, pas de VaR, pas de gestion de portefeuille moderne.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             TIMELINE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>Chronologie : L'Histoire des Probabilités</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1654</div>
                <div class="timeline-content">
                    <strong>Pascal et Fermat</strong><br>
                    Correspondance fondatrice sur le "problème des partis". Naissance officielle du calcul des probabilités. Comment partager équitablement les enjeux d'un jeu interrompu ?
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1713</div>
                <div class="timeline-content">
                    <strong>Jacob Bernoulli - Ars Conjectandi</strong><br>
                    Première formulation rigoureuse de la loi des grands nombres. Introduction de la distribution binomiale. Œuvre posthume fondatrice.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1738</div>
                <div class="timeline-content">
                    <strong>Daniel Bernoulli - Utilité Espérée</strong><br>
                    Résolution du "paradoxe de Saint-Pétersbourg". Introduction de l'utilité logarithmique et de l'aversion au risque. Fondement de la théorie de la décision.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1763</div>
                <div class="timeline-content">
                    <strong>Thomas Bayes - Théorème de Bayes</strong><br>
                    "Essay Towards Solving a Problem in the Doctrine of Chances". Publié posthumément par Richard Price. Révolution dans l'inférence statistique.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1812</div>
                <div class="timeline-content">
                    <strong>Pierre-Simon Laplace</strong><br>
                    "Théorie analytique des probabilités". Formalisation complète du calcul des probabilités. Théorème central limite (forme préliminaire).
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1900</div>
                <div class="timeline-content">
                    <strong>Louis Bachelier - Théorie de la Spéculation</strong><br>
                    Première application des probabilités à la finance. Mouvement brownien et marche aléatoire des prix. 70 ans d'avance sur son temps.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1933</div>
                <div class="timeline-content">
                    <strong>Andrei Kolmogorov - Axiomatisation</strong><br>
                    "Grundbegriffe der Wahrscheinlichkeitsrechnung". Axiomes fondamentaux basés sur la théorie de la mesure. Fondement mathématique moderne.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1963</div>
                <div class="timeline-content">
                    <strong>Benoît Mandelbrot - Fat Tails</strong><br>
                    "The Variation of Certain Speculative Prices". Démonstration que les rendements ne suivent pas une loi normale. Distributions à queues épaisses.
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 1: FONDEMENTS AXIOMATIQUES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>1. Fondements Axiomatiques (Kolmogorov, 1933)</h2>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/43/Andrej_Nikolajewitsch_Kolmogorov.jpg/440px-Andrej_Nikolajewitsch_Kolmogorov.jpg" alt="Andrei Kolmogorov">
            <figcaption>Andrei Kolmogorov (1903-1987) - Le père de la théorie moderne des probabilités</figcaption>
        </figure>

        <div class="box">
            <h4>Définition : <span class="text-red">Espace de Probabilité</span> (Ω, F, P)</h4>
            <p>Un espace de probabilité est un triplet mathématique fondamental :</p>
            <table>
                <thead>
                    <tr><th>Composante</th><th>Notation</th><th>Description</th><th>Exemple (Marché)</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Univers</strong></td>
                        <td>Ω</td>
                        <td>Ensemble de tous les états possibles</td>
                        <td>{hausse, baisse, stable}</td>
                    </tr>
                    <tr>
                        <td><strong>Tribu</strong></td>
                        <td>F</td>
                        <td>σ-algèbre des événements mesurables</td>
                        <td>Tous les sous-ensembles de Ω</td>
                    </tr>
                    <tr>
                        <td><strong>Mesure</strong></td>
                        <td>P</td>
                        <td>Fonction de probabilité F → [0,1]</td>
                        <td>P(hausse) = 0.5, P(baisse) = 0.3, P(stable) = 0.2</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3>Les Trois Axiomes de Kolmogorov</h3>

        <div class="box">
            <h4>Axiomes Fondamentaux</h4>
            <p>Toute théorie des probabilités repose sur ces trois axiomes :</p>
            <ol>
                <li><strong>Non-négativité</strong> : P(A) ≥ 0 pour tout événement A ∈ F</li>
                <li><strong>Normalisation</strong> : P(Ω) = 1 (l'univers a probabilité 1)</li>
                <li><strong>σ-additivité</strong> : Pour des événements disjoints (Aᵢ)ᵢ∈ℕ :
                    <p style="text-align: center; font-family: monospace; font-size: 18px; margin: 15px 0;">
                        P(∪ᵢAᵢ) = Σᵢ P(Aᵢ)
                    </p>
                </li>
            </ol>
            <p><strong>Conséquences importantes :</strong></p>
            <ul>
                <li>P(∅) = 0 (l'événement impossible a probabilité 0)</li>
                <li>P(Aᶜ) = 1 - P(A) (complémentaire)</li>
                <li>P(A ∪ B) = P(A) + P(B) - P(A ∩ B) (formule d'inclusion-exclusion)</li>
                <li>Si A ⊆ B alors P(A) ≤ P(B) (monotonie)</li>
            </ul>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #00d4aa;">
            <h4>Exemple Concret : Modélisation d'un Portefeuille</h4>
            <p>Considérons un portefeuille avec 2 actions A et B. Chaque jour :</p>
            <ul>
                <li>Ω = {(↑,↑), (↑,↓), (↓,↑), (↓,↓)} où ↑ = hausse, ↓ = baisse</li>
                <li>F contient 16 événements (toutes les parties de Ω)</li>
                <li>Mesure historique : P(↑,↑) = 0.30, P(↑,↓) = 0.25, P(↓,↑) = 0.20, P(↓,↓) = 0.25</li>
            </ul>
            <p><strong>Question :</strong> Quelle est P(au moins une hausse) ?</p>
            <p><strong>Réponse :</strong> P(au moins une ↑) = 1 - P(↓,↓) = 1 - 0.25 = <span class="text-red">0.75</span></p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 2: VARIABLES ALÉATOIRES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>2. Variables Aléatoires</h2>

        <div class="box">
            <h4>Définition : <span class="text-red">Variable Aléatoire</span></h4>
            <p>Une variable aléatoire X est une fonction mesurable X: Ω → ℝ qui associe un nombre réel à chaque état du monde ω ∈ Ω.</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; margin: 15px 0;">
                X : Ω → ℝ, ω ↦ X(ω)
            </p>
            <p><strong>Exemples financiers cruciaux :</strong></p>
            <table>
                <thead>
                    <tr><th>Variable</th><th>Ω</th><th>X(ω)</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Rendement journalier</td>
                        <td>États du marché</td>
                        <td>(Sₜ₊₁ - Sₜ)/Sₜ</td>
                    </tr>
                    <tr>
                        <td>Prix à maturité</td>
                        <td>Trajectoires possibles</td>
                        <td>Sₜ</td>
                    </tr>
                    <tr>
                        <td>Payoff d'option</td>
                        <td>Prix finaux</td>
                        <td>max(Sₜ - K, 0)</td>
                    </tr>
                    <tr>
                        <td>Défaut de crédit</td>
                        <td>{défaut, pas défaut}</td>
                        <td>1 si défaut, 0 sinon</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3>Distributions Discrètes vs Continues</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Variable Discrète</h4>
                <p>Prend un nombre fini ou dénombrable de valeurs {x₁, x₂, x₃, ...}</p>
                <p><span class="text-red">Fonction de masse (PMF)</span> :</p>
                <p style="text-align: center; font-family: monospace;">p(xᵢ) = P(X = xᵢ)</p>
                <p><strong>Propriété :</strong> Σᵢ p(xᵢ) = 1</p>
                <p><strong>Distributions clés :</strong></p>
                <ul>
                    <li><strong>Bernoulli</strong> : X ∈ {0, 1}, P(X=1) = p</li>
                    <li><strong>Binomiale</strong> : B(n,p), nombre de succès en n essais</li>
                    <li><strong>Poisson</strong> : λ événements rares par unité de temps</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Variable Continue</h4>
                <p>Prend des valeurs dans un intervalle [a, b] ou ℝ</p>
                <p><span class="text-red">Fonction de densité (PDF)</span> :</p>
                <p style="text-align: center; font-family: monospace;">P(a ≤ X ≤ b) = ∫ₐᵇ f(x)dx</p>
                <p><strong>Propriété :</strong> ∫₋∞^∞ f(x)dx = 1</p>
                <p><strong>Distributions clés :</strong></p>
                <ul>
                    <li><strong>Normale</strong> : N(μ, σ²), la "courbe en cloche"</li>
                    <li><strong>Log-normale</strong> : prix d'actifs (toujours > 0)</li>
                    <li><strong>Student-t</strong> : queues épaisses, ν degrés</li>
                </ul>
            </div>
        </div>

        <div class="box">
            <h4>Fonction de Répartition (CDF)</h4>
            <p>La <span class="text-red">fonction de répartition</span> F(x) donne la probabilité cumulée :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">F(x) = P(X ≤ x)</p>
            <p><strong>Propriétés :</strong></p>
            <ul>
                <li>F est croissante : x₁ < x₂ ⟹ F(x₁) ≤ F(x₂)</li>
                <li>lim(x→-∞) F(x) = 0 et lim(x→+∞) F(x) = 1</li>
                <li>P(a < X ≤ b) = F(b) - F(a)</li>
            </ul>
            <p><strong>En finance :</strong> La VaR (Value at Risk) est définie via la CDF : VaRₐ = F⁻¹(α)</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 3: DISTRIBUTIONS IMPORTANTES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>3. Distributions Essentielles en Finance</h2>

        <!-- Graphique des distributions -->
        <div class="chart-container" style="max-width: 800px; margin: 30px auto;">
            <canvas id="distributionsChart"></canvas>
        </div>

        <h3>3.1 Distribution Normale (Gaussienne)</h3>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Carl_Friedrich_Gauss_1840_by_Jensen.jpg/440px-Carl_Friedrich_Gauss_1840_by_Jensen.jpg" alt="Carl Friedrich Gauss">
            <figcaption>Carl Friedrich Gauss (1777-1855) - "Le prince des mathématiciens"</figcaption>
        </figure>

        <div class="box">
            <h4>Définition : <span class="text-red">Loi Normale</span> N(μ, σ²)</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                f(x) = (1 / √(2πσ²)) × exp(-(x-μ)² / (2σ²))
            </p>
            <p><strong>Paramètres :</strong></p>
            <ul>
                <li><strong>μ</strong> (mu) : moyenne, centre de la distribution</li>
                <li><strong>σ²</strong> (sigma carré) : variance, dispersion autour de μ</li>
            </ul>
            <p><strong>Règle empirique (68-95-99.7) :</strong></p>
            <table>
                <thead>
                    <tr><th>Intervalle</th><th>Probabilité</th><th>En finance</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>[μ - σ, μ + σ]</td>
                        <td>68.27%</td>
                        <td>Fluctuation "normale"</td>
                    </tr>
                    <tr>
                        <td>[μ - 2σ, μ + 2σ]</td>
                        <td>95.45%</td>
                        <td>Intervalle de confiance usuel</td>
                    </tr>
                    <tr>
                        <td>[μ - 3σ, μ + 3σ]</td>
                        <td>99.73%</td>
                        <td>Événements "extrêmes"</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #ff6b6b;">
            <h4>Loi Normale Standardisée N(0,1)</h4>
            <p>La <span class="text-red">loi normale centrée réduite</span> Z ~ N(0,1) est la référence :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; margin: 15px 0;">
                Z = (X - μ) / σ
            </p>
            <p><strong>Valeurs critiques importantes :</strong></p>
            <table>
                <thead>
                    <tr><th>z</th><th>P(Z ≤ z)</th><th>Utilisation</th></tr>
                </thead>
                <tbody>
                    <tr><td>-2.326</td><td>1%</td><td>VaR 99%</td></tr>
                    <tr><td>-1.645</td><td>5%</td><td>VaR 95%</td></tr>
                    <tr><td>-1.282</td><td>10%</td><td>VaR 90%</td></tr>
                    <tr><td>0</td><td>50%</td><td>Médiane</td></tr>
                    <tr><td>1.96</td><td>97.5%</td><td>IC bilatéral 95%</td></tr>
                </tbody>
            </table>
        </div>

        <h3>3.2 Distribution Log-Normale</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Loi Log-Normale</span></h4>
            <p>X suit une loi log-normale LN(μ, σ²) si et seulement si ln(X) ~ N(μ, σ²).</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                f(x) = (1 / (x × σ√(2π))) × exp(-(ln(x) - μ)² / (2σ²)) pour x > 0
            </p>
            <p><strong>Propriété fondamentale :</strong> X > 0 <strong>toujours</strong> (pas de valeurs négatives)</p>
            <p><strong>Pourquoi en finance ?</strong></p>
            <ul>
                <li>Les prix d'actifs ne peuvent pas être négatifs</li>
                <li>Si Sₜ suit dS = μSdt + σSdW (mouvement brownien géométrique), alors Sₜ est log-normal</li>
                <li>C'est l'hypothèse du modèle de Black-Scholes</li>
            </ul>
            <p><strong>Moments :</strong></p>
            <ul>
                <li>E[X] = exp(μ + σ²/2)</li>
                <li>Var(X) = (exp(σ²) - 1) × exp(2μ + σ²)</li>
            </ul>
        </div>

        <h3>3.3 Distribution de Student-t</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Loi de Student</span> t(ν)</h4>
            <p>Distribution à <span class="text-red">queues épaisses</span> (fat tails), paramétrée par ν (degrés de liberté).</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                f(x) = Γ((ν+1)/2) / (√(νπ) × Γ(ν/2)) × (1 + x²/ν)^(-(ν+1)/2)
            </p>
            <p><strong>Comportement selon ν :</strong></p>
            <table>
                <thead>
                    <tr><th>ν</th><th>Queues</th><th>Ressemblance à N(0,1)</th></tr>
                </thead>
                <tbody>
                    <tr><td>ν = 1</td><td>Très épaisses (Cauchy)</td><td>Très différent</td></tr>
                    <tr><td>ν = 3-5</td><td>Épaisses</td><td>Réaliste pour rendements</td></tr>
                    <tr><td>ν = 30</td><td>Modérées</td><td>Proche de normale</td></tr>
                    <tr><td>ν → ∞</td><td>Fines</td><td>Converge vers N(0,1)</td></tr>
                </tbody>
            </table>
            <p><strong>Usage crucial :</strong> Les rendements financiers réels ont un kurtosis > 3, la Student-t capture mieux les événements extrêmes (krachs, rallyes).</p>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #ffd700;">
            <h4>Fait Empirique : Mandelbrot (1963)</h4>
            <p>Benoît Mandelbrot a démontré que les rendements du coton ne suivent pas une loi normale. Les événements "impossibles" selon la normale (±4σ, ±5σ) arrivent <strong>beaucoup plus souvent</strong> que prévu.</p>
            <p><strong>Exemple :</strong> Le krach du 19 octobre 1987 (-22.6% en un jour) correspond à un événement à ~25 écarts-types. Sous l'hypothèse normale, cela ne devrait arriver qu'une fois tous les 10⁵⁰ années !</p>
        </div>

        <h3>3.4 Autres Distributions Importantes</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Chi-Carré χ²(k)</h4>
                <p>Somme de k variables N(0,1)² indépendantes.</p>
                <p><strong>Usage :</strong> Test de variance, intervalles de confiance pour σ².</p>
                <p>E[χ²] = k, Var(χ²) = 2k</p>
            </div>
            <div class="grid-item">
                <h4>F de Fisher F(d₁, d₂)</h4>
                <p>Ratio de deux χ² indépendants normalisés.</p>
                <p><strong>Usage :</strong> Test d'égalité de variances, ANOVA, tests de restrictions.</p>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 4: MOMENTS STATISTIQUES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>4. Moments et Mesures de Risque</h2>

        <h3>4.1 Espérance (Premier Moment)</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Espérance</span> E[X]</h4>
            <p>Moyenne pondérée par les probabilités :</p>
            <div style="display: flex; gap: 30px; flex-wrap: wrap; margin: 15px 0;">
                <div style="flex: 1; min-width: 200px; background: #1a1a2e; padding: 15px; border-radius: 8px;">
                    <strong>Cas discret :</strong>
                    <p style="font-family: monospace; text-align: center;">E[X] = Σᵢ xᵢ × P(X = xᵢ)</p>
                </div>
                <div style="flex: 1; min-width: 200px; background: #1a1a2e; padding: 15px; border-radius: 8px;">
                    <strong>Cas continu :</strong>
                    <p style="font-family: monospace; text-align: center;">E[X] = ∫₋∞^∞ x × f(x)dx</p>
                </div>
            </div>
            <p><strong>Propriétés fondamentales (linéarité) :</strong></p>
            <ul>
                <li>E[aX + b] = a × E[X] + b</li>
                <li>E[X + Y] = E[X] + E[Y] (toujours vrai, même si dépendants)</li>
                <li>E[XY] = E[X] × E[Y] <strong>seulement si X et Y indépendants</strong></li>
            </ul>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #00d4aa;">
            <h4>Exemple : Espérance d'un Portefeuille</h4>
            <p>Portefeuille avec poids w₁ = 60% sur A et w₂ = 40% sur B :</p>
            <ul>
                <li>E[Rₐ] = 12% (rendement espéré de A)</li>
                <li>E[Rᵦ] = 8% (rendement espéré de B)</li>
            </ul>
            <p><strong>Rendement espéré du portefeuille :</strong></p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                E[Rₚ] = w₁ × E[Rₐ] + w₂ × E[Rᵦ] = 0.6 × 12% + 0.4 × 8% = <span class="text-red">10.4%</span>
            </p>
        </div>

        <h3>4.2 Variance et Écart-Type (Second Moment)</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Variance</span> Var(X) = σ²</h4>
            <p>Mesure de dispersion autour de la moyenne :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                Var(X) = E[(X - E[X])²] = E[X²] - (E[X])²
            </p>
            <p><strong>Écart-type :</strong> σ = √Var(X) (même unité que X)</p>
            <p><strong>Propriétés :</strong></p>
            <ul>
                <li>Var(aX + b) = a² × Var(X)</li>
                <li>Var(X + Y) = Var(X) + Var(Y) + 2×Cov(X,Y)</li>
                <li>Si X ⊥ Y : Var(X + Y) = Var(X) + Var(Y)</li>
            </ul>
        </div>

        <h3>4.3 Moments d'Ordre Supérieur</h3>

        <table>
            <thead>
                <tr><th>Moment</th><th>Ordre</th><th>Formule</th><th>Interprétation Finance</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="text-red">Espérance</span></td>
                    <td>1</td>
                    <td>E[X]</td>
                    <td>Rendement moyen anticipé</td>
                </tr>
                <tr>
                    <td><span class="text-red">Variance</span></td>
                    <td>2</td>
                    <td>E[(X-μ)²]</td>
                    <td>Risque total (volatilité²)</td>
                </tr>
                <tr>
                    <td><span class="text-red">Skewness</span></td>
                    <td>3</td>
                    <td>E[(X-μ)³] / σ³</td>
                    <td>Asymétrie des rendements</td>
                </tr>
                <tr>
                    <td><span class="text-red">Kurtosis</span></td>
                    <td>4</td>
                    <td>E[(X-μ)⁴] / σ⁴</td>
                    <td>Épaisseur des queues</td>
                </tr>
            </tbody>
        </table>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Skewness (Asymétrie)</h4>
                <ul>
                    <li><strong>Skew = 0</strong> : Distribution symétrique (normale)</li>
                    <li><strong>Skew < 0</strong> : Queue gauche plus longue (risque de crash)</li>
                    <li><strong>Skew > 0</strong> : Queue droite plus longue (potentiel de gains)</li>
                </ul>
                <p><strong>Actions :</strong> Souvent skew < 0 (les krachs sont plus violents que les rallyes)</p>
            </div>
            <div class="grid-item">
                <h4>Kurtosis (Queues)</h4>
                <ul>
                    <li><strong>Kurt = 3</strong> : Normale (mésokurtique)</li>
                    <li><strong>Kurt > 3</strong> : Queues épaisses (leptokurtique)</li>
                    <li><strong>Kurt < 3</strong> : Queues fines (platykurtique)</li>
                </ul>
                <p><strong>Rendements réels :</strong> Kurt ≈ 5-10 (beaucoup d'événements extrêmes)</p>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 5: DISTRIBUTIONS JOINTES ET DÉPENDANCE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>5. Distributions Jointes et Dépendance</h2>

        <h3>5.1 Covariance</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Covariance</span></h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                Cov(X,Y) = E[(X - E[X])(Y - E[Y])] = E[XY] - E[X]E[Y]
            </p>
            <p><strong>Interprétation :</strong></p>
            <ul>
                <li>Cov(X,Y) > 0 : X et Y varient dans le même sens</li>
                <li>Cov(X,Y) < 0 : X et Y varient en sens opposé</li>
                <li>Cov(X,Y) = 0 : Pas de relation linéaire (mais pas forcément indépendants !)</li>
            </ul>
        </div>

        <h3>5.2 Corrélation</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Coefficient de Corrélation</span> ρ</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                ρ(X,Y) = Cov(X,Y) / (σₓ × σᵧ) ∈ [-1, +1]
            </p>
            <p><strong>Interprétation :</strong></p>
            <table>
                <thead>
                    <tr><th>ρ</th><th>Relation</th><th>Exemple</th></tr>
                </thead>
                <tbody>
                    <tr><td>ρ = +1</td><td>Parfaitement corrélés positivement</td><td>Action et son ETF</td></tr>
                    <tr><td>ρ = 0</td><td>Non corrélés (linéairement)</td><td>Actions secteurs différents</td></tr>
                    <tr><td>ρ = -1</td><td>Parfaitement corrélés négativement</td><td>Long/short parfait</td></tr>
                </tbody>
            </table>
            <p><strong>Attention :</strong> ρ = 0 n'implique PAS l'indépendance ! Contre-exemple : X ~ N(0,1) et Y = X². Alors ρ(X,Y) = 0 mais Y dépend totalement de X.</p>
        </div>

        <h3>5.3 Indépendance</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Indépendance</span></h4>
            <p>X et Y sont indépendants si et seulement si :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                P(X ∈ A, Y ∈ B) = P(X ∈ A) × P(Y ∈ B) pour tous A, B
            </p>
            <p>Équivalent : f(x,y) = fₓ(x) × fᵧ(y) (la densité jointe se factorise)</p>
            <p><strong>Implications de l'indépendance :</strong></p>
            <ul>
                <li>E[XY] = E[X] × E[Y]</li>
                <li>Var(X + Y) = Var(X) + Var(Y)</li>
                <li>Cov(X,Y) = 0 (mais la réciproque est fausse !)</li>
            </ul>
            <p><strong>En finance :</strong> Les rendements ne sont généralement PAS indépendants dans le temps (autocorrélation de la volatilité).</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 6: THÉORÈME DE BAYES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>6. Théorème de Bayes</h2>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/d/d4/Thomas_Bayes.gif" alt="Thomas Bayes">
            <figcaption>Thomas Bayes (1701-1761) - Révolutionnaire de l'inférence statistique</figcaption>
        </figure>

        <div class="box">
            <h4>Définition : <span class="text-red">Théorème de Bayes</span></h4>
            <p style="text-align: center; font-family: monospace; font-size: 22px; background: #1a1a2e; padding: 20px; border-radius: 8px; margin: 15px 0;">
                P(A|B) = P(B|A) × P(A) / P(B)
            </p>
            <p><strong>Terminologie :</strong></p>
            <table>
                <thead>
                    <tr><th>Terme</th><th>Notation</th><th>Signification</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Prior (a priori)</td>
                        <td>P(A)</td>
                        <td>Croyance initiale avant observation</td>
                    </tr>
                    <tr>
                        <td>Likelihood (vraisemblance)</td>
                        <td>P(B|A)</td>
                        <td>Probabilité d'observer B si A est vrai</td>
                    </tr>
                    <tr>
                        <td>Evidence</td>
                        <td>P(B)</td>
                        <td>Probabilité totale d'observer B</td>
                    </tr>
                    <tr>
                        <td>Posterior (a posteriori)</td>
                        <td>P(A|B)</td>
                        <td>Croyance mise à jour après observation</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #00d4aa;">
            <h4>Exemple : Détection de Fraude</h4>
            <p>Un algorithme détecte les transactions frauduleuses :</p>
            <ul>
                <li>P(Fraude) = 0.1% (1 transaction sur 1000 est frauduleuse)</li>
                <li>P(Alerte | Fraude) = 99% (détecte 99% des fraudes)</li>
                <li>P(Alerte | Non-Fraude) = 2% (faux positifs)</li>
            </ul>
            <p><strong>Question :</strong> Si l'algorithme donne une alerte, quelle est la probabilité de vraie fraude ?</p>
            <p><strong>Solution par Bayes :</strong></p>
            <p style="font-family: monospace;">
                P(Alerte) = P(A|F)P(F) + P(A|¬F)P(¬F) = 0.99×0.001 + 0.02×0.999 = 0.02097
            </p>
            <p style="font-family: monospace;">
                P(Fraude|Alerte) = P(A|F)×P(F) / P(A) = (0.99×0.001) / 0.02097 = <span class="text-red">4.7%</span>
            </p>
            <p><strong>Insight :</strong> Malgré un détecteur à 99%, la plupart des alertes sont de faux positifs car les fraudes sont rares !</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 7: THÉORÈMES FONDAMENTAUX
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>7. Théorèmes Fondamentaux</h2>

        <h3>7.1 Loi des Grands Nombres</h3>

        <div class="box">
            <h4>Théorème : <span class="text-red">Loi Forte des Grands Nombres</span></h4>
            <p>Soit (Xᵢ) une suite i.i.d. avec E[X] = μ. Alors :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                X̄ₙ = (1/n) Σᵢ Xᵢ → μ presque sûrement quand n → ∞
            </p>
            <p><strong>En finance :</strong> La moyenne empirique des rendements converge vers l'espérance vraie quand on a suffisamment d'observations.</p>
        </div>

        <h3>7.2 Théorème Central Limite</h3>

        <div class="box">
            <h4>Théorème : <span class="text-red">Théorème Central Limite</span> (TCL)</h4>
            <p>Soit (Xᵢ) i.i.d. avec E[X] = μ et Var(X) = σ². Alors :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                √n × (X̄ₙ - μ) / σ →ᵈ N(0,1) quand n → ∞
            </p>
            <p>Ou de façon équivalente : X̄ₙ ≈ N(μ, σ²/n) pour n grand.</p>
            <p><strong>Puissance du TCL :</strong> La somme de n variables i.i.d. (quelle que soit leur distribution) tend vers une normale !</p>
            <p><strong>Application :</strong> Justifie l'utilisation de la loi normale pour des portefeuilles diversifiés (somme de nombreux rendements individuels).</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             EXERCICES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="exercices-m7">Exercices</h2>

        <div class="exercise-box">
            <h4>Exercice 1 : Loi Normale et VaR</h4>
            <p>Un rendement mensuel suit N(1%, 4%) (moyenne 1%, écart-type 2%).</p>
            <p><strong>Question :</strong> Quelle est la probabilité d'un rendement négatif ?</p>
            <p><em>Indice : Standardisez avec Z = (X - μ)/σ, puis utilisez P(Z < z).</em></p>

            <input type="text" class="exercise-calc-input" id="m7-normal" placeholder="Probabilité en %">
            <button class="check-btn" onclick="checkM7Normal()">Vérifier</button>
            <div id="feedback-m7-normal" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Étape 1 :</strong> Standardisation</p>
                    <p>Z = (0 - 1%) / 2% = -0.5</p>

                    <p><strong>Étape 2 :</strong> Calcul de probabilité</p>
                    <p>P(R < 0) = P(Z < -0.5) = Φ(-0.5) ≈ 0.3085</p>

                    <p><strong>Réponse :</strong> <span class="text-red">30.85%</span> de probabilité de rendement négatif.</p>

                    <p><strong>Interprétation :</strong> Environ 1 mois sur 3, ce portefeuille perd de l'argent.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 2 : Espérance de Portefeuille</h4>
            <p>Un portefeuille a les caractéristiques suivantes :</p>
            <ul>
                <li>60% de chances de gagner +15%</li>
                <li>30% de chances de gagner +5%</li>
                <li>10% de chances de perdre -20%</li>
            </ul>
            <p><strong>Question :</strong> Quelle est l'espérance de rendement ?</p>

            <input type="text" class="exercise-calc-input" id="m7-esperance" placeholder="E[R] en %">
            <button class="check-btn" onclick="checkM7Esperance()">Vérifier</button>
            <div id="feedback-m7-esperance" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Formule :</strong> E[R] = Σ pᵢ × Rᵢ</p>

                    <p><strong>Calcul :</strong></p>
                    <p>E[R] = 0.60 × 15% + 0.30 × 5% + 0.10 × (-20%)</p>
                    <p>E[R] = 9% + 1.5% - 2% = <span class="text-red">8.5%</span></p>

                    <p><strong>Interprétation :</strong> En moyenne, on s'attend à un rendement de 8.5%.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 3 : Variance de Portefeuille</h4>
            <p>Deux actifs A et B ont les caractéristiques suivantes :</p>
            <ul>
                <li>σₐ = 20%, σᵦ = 30%, ρ(A,B) = 0.4</li>
                <li>Poids : wₐ = 70%, wᵦ = 30%</li>
            </ul>
            <p><strong>Question :</strong> Calculez l'écart-type du portefeuille σₚ.</p>

            <input type="text" class="exercise-calc-input" id="m7-variance" placeholder="σₚ en %">
            <button class="check-btn" onclick="checkM7Variance()">Vérifier</button>
            <div id="feedback-m7-variance" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Formule de la variance du portefeuille :</strong></p>
                    <p style="font-family: monospace;">σₚ² = wₐ²σₐ² + wᵦ²σᵦ² + 2wₐwᵦρσₐσᵦ</p>

                    <p><strong>Calcul :</strong></p>
                    <p>σₚ² = 0.7² × 0.20² + 0.3² × 0.30² + 2 × 0.7 × 0.3 × 0.4 × 0.20 × 0.30</p>
                    <p>σₚ² = 0.49 × 0.04 + 0.09 × 0.09 + 0.42 × 0.024</p>
                    <p>σₚ² = 0.0196 + 0.0081 + 0.01008 = 0.03778</p>
                    <p>σₚ = √0.03778 ≈ <span class="text-red">19.4%</span></p>

                    <p><strong>Insight :</strong> La diversification réduit le risque ! σₚ < wₐσₐ + wᵦσᵦ = 23%</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 4 : Théorème de Bayes</h4>
            <p>Un gestionnaire a 70% de chances de battre le marché s'il est "talentueux" et 30% s'il est "chanceux".</p>
            <p>A priori, 20% des gestionnaires sont talentueux.</p>
            <p><strong>Question :</strong> Un gestionnaire bat le marché 3 années de suite. Quelle est la probabilité qu'il soit talentueux ?</p>
            <p><em>Indice : Utilisez Bayes avec P(3 succès | T) = 0.7³ et P(3 succès | C) = 0.3³</em></p>

            <input type="text" class="exercise-calc-input" id="m7-bayes" placeholder="P(Talentueux) en %">
            <button class="check-btn" onclick="checkM7Bayes()">Vérifier</button>
            <div id="feedback-m7-bayes" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Données :</strong></p>
                    <ul>
                        <li>P(T) = 0.20, P(C) = 0.80</li>
                        <li>P(3S | T) = 0.7³ = 0.343</li>
                        <li>P(3S | C) = 0.3³ = 0.027</li>
                    </ul>

                    <p><strong>Probabilité totale :</strong></p>
                    <p>P(3S) = P(3S|T)×P(T) + P(3S|C)×P(C)</p>
                    <p>P(3S) = 0.343 × 0.20 + 0.027 × 0.80 = 0.0686 + 0.0216 = 0.0902</p>

                    <p><strong>Théorème de Bayes :</strong></p>
                    <p>P(T | 3S) = P(3S|T) × P(T) / P(3S)</p>
                    <p>P(T | 3S) = 0.0686 / 0.0902 ≈ <span class="text-red">76%</span></p>

                    <p><strong>Insight :</strong> Trois années de surperformance augmente significativement notre croyance (de 20% à 76%), mais ne prouve pas le talent !</p>
                </div>
            </details>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             FLASHCARDS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="flashcards-m7">Flashcards</h2>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quels sont les 3 axiomes de Kolmogorov ?</p></div>
                    <div class="flashcard-back"><p>1. P(A) ≥ 0 (non-négativité)<br>2. P(Ω) = 1 (normalisation)<br>3. P(∪Aᵢ) = ΣP(Aᵢ) pour Aᵢ disjoints (σ-additivité)</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi utiliser la loi log-normale pour les prix d'actifs ?</p></div>
                    <div class="flashcard-back"><p>Parce que les prix ne peuvent pas être négatifs. Si ln(S) ~ N, alors S > 0 toujours. C'est l'hypothèse du modèle Black-Scholes.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Que signifie un kurtosis > 3 ?</p></div>
                    <div class="flashcard-back"><p>Distribution leptokurtique : queues plus épaisses que la normale. Les événements extrêmes (krachs, rallyes) sont plus probables que prévu par N(μ,σ²).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la différence entre covariance et corrélation ?</p></div>
                    <div class="flashcard-back"><p>Cov(X,Y) dépend des unités de X et Y.<br>ρ(X,Y) = Cov(X,Y)/(σₓσᵧ) est sans dimension et ∈ [-1,+1]. Plus facile à interpréter.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>ρ = 0 implique-t-il l'indépendance ?</p></div>
                    <div class="flashcard-back"><p>NON ! ρ = 0 signifie pas de relation linéaire, mais il peut y avoir une relation non-linéaire. Exemple : X ~ N(0,1) et Y = X². On a ρ = 0 mais Y dépend de X.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Énoncer le théorème de Bayes</p></div>
                    <div class="flashcard-back"><p>P(A|B) = P(B|A) × P(A) / P(B)<br><br>Prior × Likelihood / Evidence = Posterior</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Que dit le Théorème Central Limite ?</p></div>
                    <div class="flashcard-back"><p>La moyenne de n v.a. i.i.d. converge en loi vers une normale quand n→∞ :<br>√n(X̄ₙ - μ)/σ →ᵈ N(0,1)<br>Quelle que soit la distribution initiale !</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que la skewness négative en finance ?</p></div>
                    <div class="flashcard-back"><p>Queue gauche plus longue : les grandes pertes sont plus probables que les grands gains de même amplitude. Typique des rendements actions (les krachs sont plus violents que les rallyes).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Règle 68-95-99.7 pour N(μ,σ²) ?</p></div>
                    <div class="flashcard-back"><p>68% des valeurs dans [μ-σ, μ+σ]<br>95% dans [μ-2σ, μ+2σ]<br>99.7% dans [μ-3σ, μ+3σ]</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi la Student-t est-elle préférée à la normale pour les rendements ?</p></div>
                    <div class="flashcard-back"><p>Les rendements réels ont un kurtosis > 3 (queues épaisses). La Student-t avec ν petit capture mieux les événements extrêmes. Mandelbrot (1963) l'a démontré empiriquement.</p></div>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             RESSOURCES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>Ressources et Références</h2>

        <div class="box">
            <h4>Lectures Recommandées</h4>
            <ul>
                <li><strong>Shreve</strong> - "Stochastic Calculus for Finance I" - Chapitres 1-2 (probabilités de base)</li>
                <li><strong>Williams</strong> - "Probability with Martingales" - Référence mathématique rigoureuse</li>
                <li><strong>Ross</strong> - "A First Course in Probability" - Introduction accessible</li>
                <li><strong>Mandelbrot & Hudson</strong> - "The Misbehavior of Markets" - Pourquoi la normale échoue</li>
            </ul>
            <h4>Articles Fondateurs</h4>
            <ul>
                <li>Kolmogorov (1933) - "Grundbegriffe der Wahrscheinlichkeitsrechnung"</li>
                <li>Mandelbrot (1963) - "The Variation of Certain Speculative Prices"</li>
                <li>Fama (1965) - "The Behavior of Stock Market Prices"</li>
            </ul>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module6')">← Précédent : Calcul Différentiel</button>
            <button class="nav-btn" onclick="showModule('module8')">Suivant : Statistiques →</button>
        </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════════════════
         MODULE 8 : STATISTIQUES ET ÉCONOMÉTRIE FINANCIÈRE
         De Galton et Fisher aux modèles modernes de finance empirique
         ═══════════════════════════════════════════════════════════════════════════ -->
    <section id="module8" class="module">
        <header class="module-header">
            <h1>Statistiques et Économétrie Financière</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Fondamental</span>
                <span>180 minutes</span>
                <span>Prérequis : Module 7</span>
            </div>
        </header>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/3/3a/Linear_regression.svg" alt="Régression linéaire">
            <figcaption>Régression linéaire - l'outil fondamental pour analyser les relations entre variables financières</figcaption>
        </figure>

        <h4>Objectifs du Module</h4>
        <ul>
            <li>Maîtriser les méthodes d'estimation : MLE, GMM, OLS et leurs propriétés</li>
            <li>Comprendre et appliquer les tests d'hypothèses (t-test, F-test, Wald, LM, LR)</li>
            <li>Construire et interpréter des modèles de régression linéaire</li>
            <li>Diagnostiquer et corriger les problèmes économétriques : hétéroscédasticité, autocorrélation, endogénéité</li>
            <li>Appliquer ces outils à l'estimation du CAPM et des modèles factoriels</li>
            <li>Introduire les concepts de séries temporelles : stationnarité, ARMA, tests de racine unitaire</li>
        </ul>

        <div class="box">
            <h4>L'Économétrie : Le Pont entre Théorie et Données</h4>
            <p>L'économétrie financière est l'art de confronter les modèles théoriques aux données réelles. Elle permet d'<span class="text-red">estimer</span> les paramètres des modèles (volatilité, bêta, prime de risque), de <span class="text-red">tester</span> les hypothèses (efficience des marchés, validité du CAPM), et de <span class="text-red">prévoir</span> les variables financières. Les spécificités des données financières (non-normalité, hétéroscédasticité, autocorrélation, queues épaisses) exigent des méthodes adaptées.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             TIMELINE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>Chronologie : L'Histoire de l'Économétrie</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1805</div>
                <div class="timeline-content">
                    <strong>Adrien-Marie Legendre - Moindres Carrés</strong><br>
                    Invention de la méthode des moindres carrés pour l'astronomie. Gauss revendiquera l'avoir utilisée dès 1795. Fondement de toute la régression moderne.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1885</div>
                <div class="timeline-content">
                    <strong>Francis Galton - Régression vers la Moyenne</strong><br>
                    "Regression towards mediocrity in hereditary stature". Invention du terme "régression" et du concept de corrélation. Père de la statistique moderne.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1908</div>
                <div class="timeline-content">
                    <strong>William Gosset (Student) - Distribution t</strong><br>
                    Publication sous pseudonyme "Student" pour Guinness Brewery. La distribution t permet l'inférence avec petits échantillons.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1921</div>
                <div class="timeline-content">
                    <strong>Ronald Fisher - Maximum de Vraisemblance</strong><br>
                    Formalisation du MLE et des propriétés des estimateurs. Fisher transforme la statistique en science rigoureuse.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1943</div>
                <div class="timeline-content">
                    <strong>Cowles Commission</strong><br>
                    Fondation de l'économétrie moderne à Chicago. Koopmans, Haavelmo, Klein développent les méthodes d'équations simultanées et l'identification.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1958</div>
                <div class="timeline-content">
                    <strong>Durbin-Watson Test</strong><br>
                    Test fondamental pour détecter l'autocorrélation des résidus. Indispensable en économétrie des séries temporelles.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1980</div>
                <div class="timeline-content">
                    <strong>Halbert White - Écarts-types Robustes</strong><br>
                    "A Heteroskedasticity-Consistent Covariance Matrix Estimator". Révolutionne la pratique en permettant l'inférence sans supposer l'homoscédasticité.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1982</div>
                <div class="timeline-content">
                    <strong>Lars Hansen - GMM</strong><br>
                    "Generalized Method of Moments". Prix Nobel 2013. Méthode universelle d'estimation basée sur les conditions de moments.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1986</div>
                <div class="timeline-content">
                    <strong>Tim Bollerslev - GARCH</strong><br>
                    Generalized ARCH. Extension du modèle d'Engle pour capturer la persistance de la volatilité. Standard en finance.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1987</div>
                <div class="timeline-content">
                    <strong>Newey-West</strong><br>
                    Écarts-types robustes à l'hétéroscédasticité ET à l'autocorrélation (HAC). Essentiel pour les données de séries temporelles.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1992</div>
                <div class="timeline-content">
                    <strong>Fama-French - Modèle 3 Facteurs</strong><br>
                    Extension empirique du CAPM avec facteurs SMB et HML. Révolution dans la finance empirique.
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 1: ESTIMATION - FONDEMENTS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>1. Théorie de l'Estimation</h2>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/aa/Youngronaldfisher2.JPG/440px-Youngronaldfisher2.JPG" alt="Ronald Fisher">
            <figcaption>Ronald A. Fisher (1890-1962) - Le fondateur de la statistique moderne</figcaption>
        </figure>

        <div class="box">
            <h4>Qu'est-ce qu'un Estimateur ?</h4>
            <p>Un <span class="text-red">estimateur</span> θ̂ est une fonction des données (X₁, ..., Xₙ) utilisée pour approximer un paramètre inconnu θ de la population.</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                θ̂ = θ̂(X₁, X₂, ..., Xₙ)
            </p>
            <p><strong>Exemples :</strong></p>
            <ul>
                <li>Moyenne empirique X̄ = (1/n)ΣXᵢ estime μ = E[X]</li>
                <li>Variance empirique s² = (1/(n-1))Σ(Xᵢ - X̄)² estime σ²</li>
                <li>Coefficient de régression β̂ estime le vrai β</li>
            </ul>
        </div>

        <h3>1.1 Propriétés des Estimateurs</h3>

        <div class="box">
            <h4>Propriétés en Échantillon Fini</h4>
            <table>
                <thead>
                    <tr><th>Propriété</th><th>Définition</th><th>Signification</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">Sans biais</span></td>
                        <td>E[θ̂] = θ</td>
                        <td>En moyenne, l'estimateur vise juste</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Efficace</span></td>
                        <td>Var(θ̂) minimale parmi les sans biais</td>
                        <td>Précision maximale</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">MSE optimal</span></td>
                        <td>MSE = Var + Biais² minimal</td>
                        <td>Compromis biais-variance</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box">
            <h4>Propriétés Asymptotiques (n → ∞)</h4>
            <table>
                <thead>
                    <tr><th>Propriété</th><th>Définition</th><th>Signification</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">Convergent</span></td>
                        <td>θ̂ →ᵖ θ (en probabilité)</td>
                        <td>θ̂ se rapproche de θ quand n augmente</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Asympt. normal</span></td>
                        <td>√n(θ̂ - θ) →ᵈ N(0, V)</td>
                        <td>Distribution normale pour grands n</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Asympt. efficace</span></td>
                        <td>Atteint la borne de Cramér-Rao</td>
                        <td>Variance minimale possible</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #ff6b6b;">
            <h4>La Borne de Cramér-Rao</h4>
            <p>Pour tout estimateur sans biais θ̂ de θ :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; margin: 15px 0;">
                Var(θ̂) ≥ 1 / I(θ)
            </p>
            <p>où I(θ) = E[(∂ ln f(X|θ)/∂θ)²] est l'<span class="text-red">information de Fisher</span>.</p>
            <p><strong>Interprétation :</strong> Plus l'information de Fisher est grande, plus on peut estimer θ précisément. Un estimateur qui atteint cette borne est dit <span class="text-red">efficace</span>.</p>
        </div>

        <h3>1.2 Maximum de Vraisemblance (MLE)</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Maximum de Vraisemblance</span></h4>
            <p>Étant données n observations i.i.d. x₁, ..., xₙ avec densité f(x|θ), l'estimateur MLE maximise la <span class="text-red">fonction de vraisemblance</span> :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                L(θ) = ∏ᵢ₌₁ⁿ f(xᵢ|θ)
            </p>
            <p><strong>Intuition :</strong> On choisit θ qui rend les données observées les plus "probables".</p>
        </div>

        <div class="box">
            <h4>Log-vraisemblance</h4>
            <p>En pratique, on maximise la <span class="text-red">log-vraisemblance</span> (plus facile numériquement) :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                ℓ(θ) = ln L(θ) = Σᵢ₌₁ⁿ ln f(xᵢ|θ)
            </p>
            <p><strong>Condition du premier ordre :</strong></p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                ∂ℓ/∂θ = Σᵢ ∂ ln f(xᵢ|θ)/∂θ = 0
            </p>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #00d4aa;">
            <h4>Exemple : MLE pour la Loi Normale</h4>
            <p>Soit X₁, ..., Xₙ ~ N(μ, σ²) i.i.d. La log-vraisemblance est :</p>
            <p style="font-family: monospace; font-size: 14px;">
                ℓ(μ, σ²) = -n/2 ln(2π) - n/2 ln(σ²) - (1/2σ²) Σᵢ(xᵢ - μ)²
            </p>
            <p><strong>Conditions du premier ordre :</strong></p>
            <ul>
                <li>∂ℓ/∂μ = (1/σ²) Σᵢ(xᵢ - μ) = 0 ⟹ <span class="text-red">μ̂ = X̄</span></li>
                <li>∂ℓ/∂σ² = -n/(2σ²) + (1/2σ⁴) Σᵢ(xᵢ - μ)² = 0 ⟹ <span class="text-red">σ̂² = (1/n)Σ(Xᵢ - X̄)²</span></li>
            </ul>
            <p><strong>Note :</strong> σ̂²_MLE est biaisé (divisé par n, pas n-1), mais asymptotiquement sans biais.</p>
        </div>

        <div class="box">
            <h4>Propriétés du MLE</h4>
            <p>Sous des conditions de régularité :</p>
            <ol>
                <li><strong>Convergence :</strong> θ̂_MLE →ᵖ θ₀ (le vrai paramètre)</li>
                <li><strong>Normalité asymptotique :</strong>
                    <p style="text-align: center; font-family: monospace; font-size: 16px; margin: 10px 0;">
                        √n(θ̂_MLE - θ₀) →ᵈ N(0, I(θ₀)⁻¹)
                    </p>
                </li>
                <li><strong>Efficacité asymptotique :</strong> Atteint la borne de Cramér-Rao</li>
                <li><strong>Invariance :</strong> Si θ̂ est le MLE de θ, alors g(θ̂) est le MLE de g(θ)</li>
            </ol>
        </div>

        <h3>1.3 Méthode des Moments (MM) et GMM</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Méthode des Moments</span></h4>
            <p>Égaliser les moments théoriques aux moments empiriques :</p>
            <ul>
                <li>Moment théorique d'ordre k : μₖ(θ) = E[Xᵏ]</li>
                <li>Moment empirique : m̂ₖ = (1/n)ΣXᵢᵏ</li>
            </ul>
            <p><strong>Résoudre :</strong> μₖ(θ̂) = m̂ₖ pour k = 1, ..., p (p = nombre de paramètres)</p>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #00d4aa;">
            <h4>Exemple : MM pour la Loi Normale</h4>
            <p>Pour X ~ N(μ, σ²) :</p>
            <ul>
                <li>μ₁ = E[X] = μ ⟹ μ̂ = X̄</li>
                <li>μ₂ = E[X²] = σ² + μ² ⟹ σ̂² = (1/n)ΣXᵢ² - X̄²</li>
            </ul>
            <p>Ici, MM donne le même résultat que MLE.</p>
        </div>

        <div class="box">
            <h4>Définition : <span class="text-red">GMM</span> (Hansen, 1982)</h4>
            <p>Généralisation puissante de la méthode des moments. On dispose de <span class="text-red">conditions de moments</span> :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                E[g(Xᵢ, θ₀)] = 0 (vecteur de dimension q)
            </p>
            <p>Avec plus de conditions que de paramètres (q > p), on minimise :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                Q(θ) = ĝ(θ)ᵀ W ĝ(θ) où ĝ(θ) = (1/n)Σᵢg(Xᵢ, θ)
            </p>
            <p><strong>W optimal :</strong> W = [Var(√n ĝ)]⁻¹ → estimateur le plus efficace</p>
        </div>

        <div class="box">
            <h4>Applications GMM en Finance</h4>
            <table>
                <thead>
                    <tr><th>Application</th><th>Conditions de Moments</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Test du CAPM</td>
                        <td>E[εᵢ] = 0, E[εᵢ × (Rₘ - Rᶠ)] = 0</td>
                    </tr>
                    <tr>
                        <td>Modèles factoriels</td>
                        <td>E[Rᵢ - α - β'F] = 0, E[(Rᵢ - α - β'F) × F] = 0</td>
                    </tr>
                    <tr>
                        <td>Euler equation</td>
                        <td>E[m × R - 1] = 0 (pricing kernel)</td>
                    </tr>
                    <tr>
                        <td>Hansen-Jagannathan</td>
                        <td>Tests de bornes sur le SDF</td>
                    </tr>
                </tbody>
            </table>
            <p><strong>Avantage majeur :</strong> Pas besoin de spécifier la distribution complète des données.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 2: RÉGRESSION LINÉAIRE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>2. Régression Linéaire</h2>

        <h3>2.1 Le Modèle de Régression</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Modèle de Régression Linéaire</span></h4>
            <p>Relation entre une variable dépendante Y et des variables explicatives X :</p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; background: #1a1a2e; padding: 20px; border-radius: 8px; margin: 15px 0;">
                Yᵢ = β₀ + β₁X₁ᵢ + β₂X₂ᵢ + ... + βₖXₖᵢ + εᵢ
            </p>
            <p>Ou en notation matricielle :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                Y = Xβ + ε
            </p>
            <p>où Y est n×1, X est n×(k+1), β est (k+1)×1, ε est n×1</p>
        </div>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Variables</h4>
                <ul>
                    <li><strong>Y</strong> : variable dépendante (endogène)</li>
                    <li><strong>X</strong> : variables explicatives (exogènes)</li>
                    <li><strong>β</strong> : coefficients à estimer</li>
                    <li><strong>ε</strong> : terme d'erreur (résidu)</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Exemples en Finance</h4>
                <ul>
                    <li>Y = rendement action, X = rendement marché</li>
                    <li>Y = prix option, X = (S, K, T, σ, r)</li>
                    <li>Y = spread crédit, X = (leverage, rating, ...)</li>
                    <li>Y = volume, X = (volatilité, news, ...)</li>
                </ul>
            </div>
        </div>

        <h3>2.2 Moindres Carrés Ordinaires (OLS)</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Estimateur OLS</span></h4>
            <p>L'OLS minimise la <span class="text-red">somme des carrés des résidus</span> (SSR) :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                min_β Σᵢ(Yᵢ - Xᵢβ)² = min_β (Y - Xβ)ᵀ(Y - Xβ)
            </p>
            <p><strong>Solution analytique :</strong></p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                β̂_OLS = (XᵀX)⁻¹XᵀY
            </p>
        </div>

        <div class="box">
            <h4>Dérivation de l'Estimateur OLS</h4>
            <p>Minimisons S(β) = (Y - Xβ)ᵀ(Y - Xβ) :</p>
            <ol>
                <li><strong>Développer :</strong> S(β) = YᵀY - 2βᵀXᵀY + βᵀXᵀXβ</li>
                <li><strong>Dériver :</strong> ∂S/∂β = -2XᵀY + 2XᵀXβ = 0</li>
                <li><strong>Résoudre :</strong> XᵀXβ = XᵀY ⟹ β̂ = (XᵀX)⁻¹XᵀY</li>
            </ol>
            <p><strong>Condition :</strong> XᵀX doit être inversible (pas de multicolinéarité parfaite).</p>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #ffd700;">
            <h4>Interprétation Géométrique</h4>
            <p>L'OLS projette Y sur l'espace engendré par les colonnes de X.</p>
            <ul>
                <li><strong>Ŷ = Xβ̂ = X(XᵀX)⁻¹XᵀY = PY</strong> est la projection de Y sur Col(X)</li>
                <li><strong>P = X(XᵀX)⁻¹Xᵀ</strong> est la matrice de projection ("hat matrix")</li>
                <li><strong>ε̂ = Y - Ŷ = (I - P)Y</strong> est orthogonal à Col(X)</li>
            </ul>
            <p>Propriété clé : Xᵀε̂ = 0 (les résidus sont orthogonaux aux régresseurs)</p>
        </div>

        <h3>2.3 Hypothèses de Gauss-Markov</h3>

        <div class="box">
            <h4>Les Hypothèses Classiques</h4>
            <table>
                <thead>
                    <tr><th>#</th><th>Hypothèse</th><th>Formulation</th><th>Violation</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>A1</td>
                        <td>Linéarité</td>
                        <td>Y = Xβ + ε</td>
                        <td>Mauvaise spécification</td>
                    </tr>
                    <tr>
                        <td>A2</td>
                        <td>Exogénéité stricte</td>
                        <td>E[ε|X] = 0</td>
                        <td>Endogénéité</td>
                    </tr>
                    <tr>
                        <td>A3</td>
                        <td>Pas de multicolinéarité parfaite</td>
                        <td>rang(X) = k+1</td>
                        <td>XᵀX non inversible</td>
                    </tr>
                    <tr>
                        <td>A4</td>
                        <td>Homoscédasticité</td>
                        <td>Var(ε|X) = σ²I</td>
                        <td>Hétéroscédasticité</td>
                    </tr>
                    <tr>
                        <td>A5</td>
                        <td>Pas d'autocorrélation</td>
                        <td>Cov(εᵢ, εⱼ) = 0 pour i≠j</td>
                        <td>Autocorrélation</td>
                    </tr>
                    <tr>
                        <td>A6</td>
                        <td>Normalité</td>
                        <td>ε ~ N(0, σ²I)</td>
                        <td>Non-normalité</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #00d4aa;">
            <h4>Théorème de Gauss-Markov</h4>
            <p>Sous les hypothèses A1-A5, l'estimateur OLS est <span class="text-red">BLUE</span> :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; margin: 15px 0;">
                <strong>B</strong>est <strong>L</strong>inear <strong>U</strong>nbiased <strong>E</strong>stimator
            </p>
            <ul>
                <li><strong>Best :</strong> Variance minimale parmi les estimateurs linéaires sans biais</li>
                <li><strong>Linear :</strong> β̂ = AY où A ne dépend pas de Y</li>
                <li><strong>Unbiased :</strong> E[β̂] = β</li>
            </ul>
            <p><strong>Important :</strong> BLUE ne dit pas que OLS est le meilleur estimateur possible, juste le meilleur parmi les linéaires sans biais !</p>
        </div>

        <h3>2.4 Propriétés de l'Estimateur OLS</h3>

        <div class="box">
            <h4>Espérance et Variance de β̂</h4>
            <p><strong>Espérance (sous A1-A2) :</strong></p>
            <p style="font-family: monospace; margin: 10px 0;">
                E[β̂|X] = E[(XᵀX)⁻¹XᵀY|X] = (XᵀX)⁻¹XᵀE[Y|X] = (XᵀX)⁻¹XᵀXβ = <span class="text-red">β</span>
            </p>
            <p>⟹ OLS est <span class="text-red">sans biais</span>.</p>

            <p><strong>Variance (sous A1-A4) :</strong></p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                Var(β̂|X) = σ²(XᵀX)⁻¹
            </p>
            <p><strong>Estimation de σ² :</strong></p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                s² = SSR/(n - k - 1) = ε̂ᵀε̂/(n - k - 1)
            </p>
            <p>où n - k - 1 = degrés de liberté (correction pour les paramètres estimés).</p>
        </div>

        <h3>2.5 Mesures de Qualité d'Ajustement</h3>

        <div class="box">
            <h4>Décomposition de la Variance</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                SST = SSE + SSR
            </p>
            <table>
                <thead>
                    <tr><th>Terme</th><th>Formule</th><th>Signification</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">SST</span></td>
                        <td>Σ(Yᵢ - Ȳ)²</td>
                        <td>Total Sum of Squares (variance totale)</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">SSE</span></td>
                        <td>Σ(Ŷᵢ - Ȳ)²</td>
                        <td>Explained Sum of Squares (variance expliquée)</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">SSR</span></td>
                        <td>Σ(Yᵢ - Ŷᵢ)² = Σε̂ᵢ²</td>
                        <td>Residual Sum of Squares (variance résiduelle)</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box">
            <h4>Coefficient de Détermination R²</h4>
            <p style="text-align: center; font-family: monospace; font-size: 20px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                R² = SSE/SST = 1 - SSR/SST ∈ [0, 1]
            </p>
            <p><strong>Interprétation :</strong> Proportion de la variance de Y expliquée par le modèle.</p>
            <ul>
                <li>R² = 0 : Le modèle n'explique rien (Ŷ = Ȳ)</li>
                <li>R² = 1 : Ajustement parfait (Ŷ = Y)</li>
                <li>R² = 0.7 : 70% de la variance est expliquée</li>
            </ul>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #ff6b6b;">
            <h4>Attention : Les Pièges du R²</h4>
            <ul>
                <li><strong>R² augmente mécaniquement</strong> quand on ajoute des variables (même inutiles)</li>
                <li><strong>Corrélation ≠ Causalité :</strong> Un R² élevé ne prouve pas une relation causale</li>
                <li><strong>Overfitting :</strong> Un R² élevé peut indiquer un sur-ajustement aux données</li>
                <li><strong>Régressions "spurieuses" :</strong> Deux séries non-stationnaires peuvent avoir R² → 1 sans vraie relation</li>
            </ul>
            <p><strong>Solution :</strong> Utiliser le R² ajusté qui pénalise l'ajout de variables :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; margin: 10px 0;">
                R²ₐ = 1 - (1-R²)(n-1)/(n-k-1)
            </p>
        </div>

        <div class="box">
            <h4>Critères d'Information</h4>
            <p>Pour la sélection de modèles, préférer AIC ou BIC au R² :</p>
            <table>
                <thead>
                    <tr><th>Critère</th><th>Formule</th><th>Pénalité</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">AIC</span></td>
                        <td>-2ℓ + 2k</td>
                        <td>2 par paramètre</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">BIC</span></td>
                        <td>-2ℓ + k×ln(n)</td>
                        <td>ln(n) par paramètre</td>
                    </tr>
                </tbody>
            </table>
            <p><strong>Règle :</strong> Choisir le modèle avec le plus petit AIC/BIC. BIC pénalise davantage la complexité.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 3: TESTS D'HYPOTHÈSES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>3. Tests d'Hypothèses en Régression</h2>

        <h3>3.1 Test de Student (t-test)</h3>

        <div class="box">
            <h4>Test de Significativité Individuelle</h4>
            <p>Pour tester H₀ : βⱼ = β⁰ⱼ contre H₁ : βⱼ ≠ β⁰ⱼ :</p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                t = (β̂ⱼ - β⁰ⱼ) / se(β̂ⱼ) ~ t(n-k-1)
            </p>
            <p><strong>Règle de décision (niveau α = 5%) :</strong></p>
            <ul>
                <li>Rejeter H₀ si |t| > t₀.₀₂₅(n-k-1) ≈ 1.96 (pour n grand)</li>
                <li>Ou si p-value < 0.05</li>
            </ul>
        </div>

        <div class="box">
            <h4>Écart-type de β̂ⱼ</h4>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                se(β̂ⱼ) = s × √[(XᵀX)⁻¹ⱼⱼ]
            </p>
            <p>où s = √(SSR/(n-k-1)) et (XᵀX)⁻¹ⱼⱼ est l'élément diagonal j de (XᵀX)⁻¹.</p>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #00d4aa;">
            <h4>Exemple : Test du Bêta = 1</h4>
            <p>Régression CAPM pour l'action Apple :</p>
            <ul>
                <li>β̂ = 1.25, se(β̂) = 0.08</li>
            </ul>
            <p><strong>Test H₀ : β = 1 (risque moyen du marché)</strong></p>
            <p style="font-family: monospace;">
                t = (1.25 - 1) / 0.08 = 0.25 / 0.08 = <span class="text-red">3.125</span>
            </p>
            <p>|t| = 3.125 > 1.96 ⟹ <strong>Rejeter H₀</strong> : Apple a un bêta significativement supérieur à 1.</p>
            <p><strong>Interprétation :</strong> Apple est plus volatile que le marché (plus risqué).</p>
        </div>

        <h3>3.2 Intervalle de Confiance</h3>

        <div class="box">
            <h4>Intervalle de Confiance à (1-α)%</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                IC₁₋ₐ(βⱼ) = [β̂ⱼ - tₐ/₂ × se(β̂ⱼ), β̂ⱼ + tₐ/₂ × se(β̂ⱼ)]
            </p>
            <p><strong>Pour α = 5% et n grand :</strong> tₐ/₂ ≈ 1.96</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                IC₉₅%(βⱼ) ≈ β̂ⱼ ± 1.96 × se(β̂ⱼ)
            </p>
            <p><strong>Interprétation :</strong> Si on répète l'échantillonnage 100 fois, 95 des intervalles contiendront le vrai β.</p>
        </div>

        <h3>3.3 Test de Fisher (F-test)</h3>

        <div class="box">
            <h4>Test de Significativité Globale</h4>
            <p>Pour tester H₀ : β₁ = β₂ = ... = βₖ = 0 (aucune variable n'est significative) :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                F = (SSE/k) / (SSR/(n-k-1)) = (R²/k) / ((1-R²)/(n-k-1)) ~ F(k, n-k-1)
            </p>
            <p><strong>Règle :</strong> Rejeter H₀ si F > F_critique ou p-value < α</p>
        </div>

        <div class="box">
            <h4>Test de Restrictions Linéaires (F-test général)</h4>
            <p>Pour tester q restrictions linéaires Rβ = r :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                F = ((SSR_contraint - SSR_non-contraint)/q) / (SSR_non-contraint/(n-k-1)) ~ F(q, n-k-1)
            </p>
            <p><strong>Application :</strong> Tester si plusieurs coefficients sont simultanément nuls, ou égaux entre eux.</p>
        </div>

        <h3>3.4 Tests de Wald, LM et LR</h3>

        <div class="box">
            <h4>Trois Tests Asymptotiquement Équivalents</h4>
            <table>
                <thead>
                    <tr><th>Test</th><th>Basé sur</th><th>Estimation requise</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">Wald</span></td>
                        <td>Distance θ̂ - θ₀</td>
                        <td>Modèle non-contraint uniquement</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">LM</span> (Lagrange Multiplier)</td>
                        <td>Score au point contraint</td>
                        <td>Modèle contraint uniquement</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">LR</span> (Likelihood Ratio)</td>
                        <td>Ratio des vraisemblances</td>
                        <td>Les deux modèles</td>
                    </tr>
                </tbody>
            </table>
            <p>Sous H₀ : Wald, LM, LR ~ χ²(q) asymptotiquement (q = nombre de restrictions)</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 4: APPLICATION - CAPM ET MODÈLES FACTORIELS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>4. Application : CAPM et Modèles Factoriels</h2>

        <!-- Graphique de régression CAPM -->
        <div class="chart-container" style="max-width: 800px; margin: 30px auto;">
            <canvas id="capmRegressionChart"></canvas>
        </div>

        <h3>4.1 Estimation du Bêta (CAPM)</h3>

        <div class="box">
            <h4>Régression du CAPM</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                Rᵢₜ - Rᶠₜ = αᵢ + βᵢ(Rₘₜ - Rᶠₜ) + εᵢₜ
            </p>
            <p><strong>Variables :</strong></p>
            <ul>
                <li>Rᵢₜ - Rᶠₜ : excès de rendement de l'actif i</li>
                <li>Rₘₜ - Rᶠₜ : excès de rendement du marché (prime de risque)</li>
                <li>αᵢ : alpha de Jensen (rendement anormal)</li>
                <li>βᵢ : sensibilité au marché (bêta)</li>
            </ul>
        </div>

        <div class="box">
            <h4>Interprétation du Bêta</h4>
            <table>
                <thead>
                    <tr><th>Valeur de β</th><th>Interprétation</th><th>Exemple</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>β = 0</td>
                        <td>Insensible au marché</td>
                        <td>Or, bons du Trésor</td>
                    </tr>
                    <tr>
                        <td>0 < β < 1</td>
                        <td>Défensif (moins volatile que le marché)</td>
                        <td>Utilities, pharma</td>
                    </tr>
                    <tr>
                        <td>β = 1</td>
                        <td>Risque moyen du marché</td>
                        <td>ETF S&P 500</td>
                    </tr>
                    <tr>
                        <td>β > 1</td>
                        <td>Agressif (plus volatile)</td>
                        <td>Tech, biotech, small caps</td>
                    </tr>
                    <tr>
                        <td>β < 0</td>
                        <td>Corrélé négativement</td>
                        <td>Inverse ETFs, certains hedges</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #00d4aa;">
            <h4>Exemple Numérique : Estimation du Bêta d'Apple</h4>
            <p>Données mensuelles sur 60 mois (5 ans) :</p>
            <table>
                <thead>
                    <tr><th>Statistique</th><th>Valeur</th><th>Interprétation</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>α̂</td>
                        <td>0.008 (0.004)</td>
                        <td>Alpha = +0.8%/mois, p-value = 0.05</td>
                    </tr>
                    <tr>
                        <td>β̂</td>
                        <td>1.25 (0.08)</td>
                        <td>Bêta significativement > 1</td>
                    </tr>
                    <tr>
                        <td>R²</td>
                        <td>0.68</td>
                        <td>68% de variance expliquée par le marché</td>
                    </tr>
                    <tr>
                        <td>n</td>
                        <td>60</td>
                        <td>60 observations mensuelles</td>
                    </tr>
                </tbody>
            </table>
            <p><strong>Conclusion :</strong> Apple a un alpha positif significatif (surperformance) et un bêta élevé (plus risqué que le marché).</p>
        </div>

        <h3>4.2 Test du CAPM</h3>

        <div class="box">
            <h4>Hypothèse Testable du CAPM</h4>
            <p>Si le CAPM est valide, alors <span class="text-red">α = 0</span> pour tous les actifs.</p>
            <p><strong>Test individuel :</strong> t = α̂/se(α̂). Rejeter si |t| > 1.96.</p>
            <p><strong>Test joint (Gibbons-Ross-Shanken, 1989) :</strong></p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                GRS = (T-N-1)/(N) × (1 + μ̂'Σ̂⁻¹μ̂)⁻¹ × α̂'Σ̂⁻¹α̂ ~ F(N, T-N-1)
            </p>
            <p>où T = nombre de périodes, N = nombre d'actifs, α̂ = vecteur des alphas.</p>
        </div>

        <h3>4.3 Modèle Fama-French à 3 Facteurs</h3>

        <div class="box">
            <h4>Extension du CAPM (Fama & French, 1992)</h4>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                Rᵢₜ - Rᶠₜ = αᵢ + βᵢ,ₘ(Rₘₜ - Rᶠₜ) + βᵢ,ₛₘᵦ × SMBₜ + βᵢ,ₕₘₗ × HMLₜ + εᵢₜ
            </p>
            <p><strong>Facteurs :</strong></p>
            <table>
                <thead>
                    <tr><th>Facteur</th><th>Construction</th><th>Capture</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">MKT</span></td>
                        <td>Rₘ - Rᶠ</td>
                        <td>Prime de risque du marché</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">SMB</span></td>
                        <td>Small Minus Big</td>
                        <td>Prime de taille (small caps)</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">HML</span></td>
                        <td>High Minus Low (B/M)</td>
                        <td>Prime de value (book-to-market)</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box">
            <h4>Modèle à 5 Facteurs (Fama & French, 2015)</h4>
            <p>Ajout de deux facteurs supplémentaires :</p>
            <table>
                <thead>
                    <tr><th>Facteur</th><th>Construction</th><th>Capture</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">RMW</span></td>
                        <td>Robust Minus Weak</td>
                        <td>Profitabilité (rentabilité opérationnelle)</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">CMA</span></td>
                        <td>Conservative Minus Aggressive</td>
                        <td>Investissement (croissance des actifs)</td>
                    </tr>
                </tbody>
            </table>
            <p><strong>Le modèle complet :</strong></p>
            <p style="font-family: monospace; font-size: 14px;">
                Rᵢ - Rᶠ = α + β₁MKT + β₂SMB + β₃HML + β₄RMW + β₅CMA + ε
            </p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 5: PROBLÈMES ÉCONOMÉTRIQUES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>5. Problèmes Économétriques et Solutions</h2>

        <h3>5.1 Hétéroscédasticité</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Hétéroscédasticité</span></h4>
            <p>La variance des erreurs n'est pas constante :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                Var(εᵢ|Xᵢ) = σᵢ² ≠ σ² (varie avec i)
            </p>
            <p><strong>Très courante en finance :</strong></p>
            <ul>
                <li>La volatilité varie dans le temps (clustering de volatilité)</li>
                <li>La variance dépend de la taille de l'entreprise</li>
                <li>Les rendements extrêmes sont plus volatils</li>
            </ul>
        </div>

        <div class="box">
            <h4>Conséquences de l'Hétéroscédasticité</h4>
            <ul>
                <li><strong>OLS reste sans biais</strong> : E[β̂] = β (pas affecté)</li>
                <li><strong>OLS n'est plus BLUE</strong> : pas efficace</li>
                <li><strong>Écarts-types OLS incorrects</strong> : les t-stats et p-values sont fausses !</li>
                <li><strong>Inférence invalide</strong> : risque de conclure à tort</li>
            </ul>
        </div>

        <div class="box">
            <h4>Détection de l'Hétéroscédasticité</h4>
            <table>
                <thead>
                    <tr><th>Test</th><th>Hypothèse nulle</th><th>Méthode</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">Breusch-Pagan</span></td>
                        <td>Homoscédasticité</td>
                        <td>Régression ε̂² sur X</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">White</span></td>
                        <td>Homoscédasticité</td>
                        <td>Régression ε̂² sur X, X², X×X'</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Goldfeld-Quandt</span></td>
                        <td>Homoscédasticité</td>
                        <td>Comparer variances de sous-échantillons</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #00d4aa;">
            <h4>Solution 1 : Écarts-types Robustes de White (1980)</h4>
            <p>Au lieu de Var(β̂) = σ²(XᵀX)⁻¹, utiliser :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                V̂_White = (XᵀX)⁻¹ (Σᵢ ε̂ᵢ² XᵢXᵢᵀ) (XᵀX)⁻¹
            </p>
            <p><strong>Avantage :</strong> Valide même si on ne connaît pas la forme de l'hétéroscédasticité.</p>
            <p><strong>En Python :</strong> <code>statsmodels.regression.linear_model.OLS().fit(cov_type='HC3')</code></p>
        </div>

        <div class="box">
            <h4>Solution 2 : Moindres Carrés Pondérés (WLS)</h4>
            <p>Si on connaît la forme de l'hétéroscédasticité Var(εᵢ) = σ²wᵢ :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                β̂_WLS = (XᵀW⁻¹X)⁻¹XᵀW⁻¹Y où W = diag(w₁, ..., wₙ)
            </p>
            <p>Équivalent : transformer le modèle en divisant par √wᵢ puis appliquer OLS.</p>
        </div>

        <h3>5.2 Autocorrélation</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Autocorrélation</span></h4>
            <p>Les erreurs sont corrélées dans le temps :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                Cov(εₜ, εₜ₋ₖ) ≠ 0 pour k ≠ 0
            </p>
            <p><strong>Causes en finance :</strong></p>
            <ul>
                <li>Omission de variables pertinentes retardées</li>
                <li>Mauvaise spécification du modèle</li>
                <li>Momentum/Mean-reversion dans les rendements</li>
                <li>Données à fréquence différente (agrégation temporelle)</li>
            </ul>
        </div>

        <div class="box">
            <h4>Détection de l'Autocorrélation</h4>
            <table>
                <thead>
                    <tr><th>Test</th><th>Hypothèse nulle</th><th>Ordre testé</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">Durbin-Watson</span></td>
                        <td>Pas d'autocorrélation AR(1)</td>
                        <td>1</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Breusch-Godfrey</span></td>
                        <td>Pas d'autocorrélation AR(p)</td>
                        <td>1, 2, ..., p</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Ljung-Box</span></td>
                        <td>Pas d'autocorrélation</td>
                        <td>Multiple</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box">
            <h4>Test de Durbin-Watson</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                DW = Σₜ₌₂ⁿ(ε̂ₜ - ε̂ₜ₋₁)² / Σₜ₌₁ⁿ ε̂ₜ² ≈ 2(1 - ρ̂)
            </p>
            <p><strong>Interprétation :</strong></p>
            <ul>
                <li>DW ≈ 2 : pas d'autocorrélation (ρ ≈ 0)</li>
                <li>DW < 2 : autocorrélation positive (ρ > 0)</li>
                <li>DW > 2 : autocorrélation négative (ρ < 0)</li>
                <li>DW ≈ 0 : forte autocorrélation positive (ρ ≈ 1)</li>
            </ul>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #00d4aa;">
            <h4>Solution : Écarts-types Newey-West (HAC)</h4>
            <p>Robustes à l'hétéroscédasticité ET à l'autocorrélation :</p>
            <p style="text-align: center; font-family: monospace; font-size: 14px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                V̂_NW = (XᵀX)⁻¹ Ŝ (XᵀX)⁻¹ où Ŝ = Σⱼ₌₋ₗᴸ w(j/L) × Γ̂ⱼ
            </p>
            <p>où Γ̂ⱼ = Σₜ ε̂ₜε̂ₜ₋ⱼXₜXₜ₋ⱼᵀ et w est un kernel (Bartlett, Parzen, etc.).</p>
            <p><strong>En Python :</strong> <code>OLS().fit(cov_type='HAC', cov_kwds={'maxlags': 4})</code></p>
        </div>

        <h3>5.3 Multicolinéarité</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Multicolinéarité</span></h4>
            <p>Forte corrélation entre variables explicatives :</p>
            <ul>
                <li><strong>Parfaite :</strong> Xⱼ = combinaison linéaire des autres X → XᵀX non inversible</li>
                <li><strong>Imparfaite :</strong> Forte corrélation → XᵀX presque singulière</li>
            </ul>
            <p><strong>Conséquences :</strong></p>
            <ul>
                <li>OLS toujours sans biais</li>
                <li>Mais variance très grande : se(β̂) élevés</li>
                <li>Coefficients instables (sensibles aux données)</li>
                <li>Difficile d'interpréter les effets individuels</li>
            </ul>
        </div>

        <div class="box">
            <h4>Détection : Variance Inflation Factor (VIF)</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                VIFⱼ = 1 / (1 - R²ⱼ)
            </p>
            <p>où R²ⱼ = R² de la régression de Xⱼ sur les autres X.</p>
            <ul>
                <li>VIF = 1 : pas de multicolinéarité</li>
                <li>VIF > 5 : problème modéré</li>
                <li>VIF > 10 : problème sérieux</li>
            </ul>
        </div>

        <h3>5.4 Endogénéité</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Endogénéité</span></h4>
            <p>Le régresseur X est corrélé avec le terme d'erreur :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                E[ε|X] ≠ 0 ou Cov(X, ε) ≠ 0
            </p>
            <p><strong>Sources :</strong></p>
            <ul>
                <li><strong>Variable omise :</strong> Une variable Z affecte Y et est corrélée avec X</li>
                <li><strong>Causalité inverse :</strong> Y affecte aussi X (simultanéité)</li>
                <li><strong>Erreur de mesure :</strong> X mesuré avec bruit</li>
            </ul>
            <p><strong>Conséquence grave :</strong> OLS est <span class="text-red">biaisé et inconsistant</span> !</p>
        </div>

        <div class="box">
            <h4>Solution : Variables Instrumentales (IV)</h4>
            <p>Utiliser un instrument Z tel que :</p>
            <ul>
                <li><strong>Pertinence :</strong> Cov(Z, X) ≠ 0 (Z corrélé avec X)</li>
                <li><strong>Exogénéité :</strong> Cov(Z, ε) = 0 (Z non corrélé avec l'erreur)</li>
            </ul>
            <p><strong>Estimateur 2SLS (Two-Stage Least Squares) :</strong></p>
            <ol>
                <li>Étape 1 : Régresser X sur Z, obtenir X̂</li>
                <li>Étape 2 : Régresser Y sur X̂</li>
            </ol>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 6: INTRODUCTION AUX SÉRIES TEMPORELLES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>6. Introduction aux Séries Temporelles</h2>

        <h3>6.1 Stationnarité</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Stationnarité Faible</span></h4>
            <p>Un processus {Yₜ} est stationnaire au sens faible si :</p>
            <ol>
                <li>E[Yₜ] = μ (constante, indépendante de t)</li>
                <li>Var(Yₜ) = σ² (constante, indépendante de t)</li>
                <li>Cov(Yₜ, Yₜ₋ₖ) = γₖ (dépend seulement du décalage k, pas de t)</li>
            </ol>
            <p><strong>Intuition :</strong> Les propriétés statistiques ne changent pas avec le temps.</p>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #ff6b6b;">
            <h4>Pourquoi la Stationnarité est Cruciale</h4>
            <p><strong>Problème des régressions spurieuses :</strong></p>
            <p>Si deux séries Yₜ et Xₜ sont non-stationnaires (ont une racine unitaire), la régression Y sur X peut montrer :</p>
            <ul>
                <li>R² très élevé (proche de 1)</li>
                <li>t-stats très significatifs</li>
                <li>... alors qu'il n'y a AUCUNE vraie relation !</li>
            </ul>
            <p><strong>Exemple célèbre :</strong> Régression du PIB US sur le nombre de pirates dans le monde donne R² = 0.99 !</p>
        </div>

        <h3>6.2 Processus Autorégressif AR(p)</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Processus AR(p)</span></h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                Yₜ = c + φ₁Yₜ₋₁ + φ₂Yₜ₋₂ + ... + φₚYₜ₋ₚ + εₜ
            </p>
            <p>où εₜ ~ WN(0, σ²) (bruit blanc).</p>
            <p><strong>AR(1) :</strong> Yₜ = c + φYₜ₋₁ + εₜ</p>
            <ul>
                <li>|φ| < 1 : stationnaire, mean-reverting</li>
                <li>φ = 1 : marche aléatoire (racine unitaire)</li>
                <li>|φ| > 1 : explosif</li>
            </ul>
        </div>

        <h3>6.3 Tests de Racine Unitaire</h3>

        <div class="box">
            <h4>Test de Dickey-Fuller Augmenté (ADF)</h4>
            <p>Tester H₀ : φ = 1 (racine unitaire, non-stationnaire) contre H₁ : |φ| < 1 (stationnaire)</p>
            <p><strong>Régression auxiliaire :</strong></p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                ΔYₜ = α + γYₜ₋₁ + Σᵢ δᵢΔYₜ₋ᵢ + εₜ
            </p>
            <p>où γ = φ - 1. H₀ : γ = 0.</p>
            <p><strong>Attention :</strong> La statistique t ne suit PAS une distribution t standard ! Utiliser les tables de Dickey-Fuller.</p>
        </div>

        <div class="box">
            <h4>Stratégie pour Données Financières</h4>
            <ol>
                <li><strong>Tester la stationnarité</strong> des séries (ADF, KPSS)</li>
                <li><strong>Si non-stationnaire :</strong> différencier (ΔYₜ = Yₜ - Yₜ₋₁)</li>
                <li><strong>Les rendements</strong> sont généralement stationnaires (log-différences des prix)</li>
                <li><strong>Les prix</strong> sont généralement non-stationnaires (suivent une marche aléatoire)</li>
            </ol>
        </div>

        <h3>6.4 Modèles ARMA</h3>

        <div class="box">
            <h4>Définition : <span class="text-red">Processus ARMA(p,q)</span></h4>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                Yₜ = c + Σᵢ₌₁ᵖ φᵢYₜ₋ᵢ + Σⱼ₌₁ᵍ θⱼεₜ₋ⱼ + εₜ
            </p>
            <ul>
                <li><strong>AR(p) :</strong> Dépendance sur les valeurs passées de Y</li>
                <li><strong>MA(q) :</strong> Dépendance sur les chocs passés ε</li>
            </ul>
            <p><strong>Sélection du modèle :</strong> Utiliser AIC/BIC pour choisir p et q.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             EXERCICES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="exercices-m8">Exercices</h2>

        <div class="exercise-box">
            <h4>Exercice 1 : Test du Bêta</h4>
            <p>Une régression du CAPM pour l'action Tesla donne :</p>
            <ul>
                <li>β̂ = 1.85, se(β̂) = 0.25, n = 60</li>
            </ul>
            <p><strong>Question :</strong> Le bêta est-il significativement différent de 1 au niveau 5% ?</p>
            <p><em>Calculez t = (β̂ - 1) / se(β̂) et comparez à 1.96.</em></p>

            <input type="text" class="exercise-calc-input" id="m8-tstat" placeholder="t = ?">
            <button class="check-btn" onclick="checkM8Tstat()">Vérifier</button>
            <div id="feedback-m8-tstat" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Calcul de la statistique t :</strong></p>
                    <p>t = (β̂ - β₀) / se(β̂) = (1.85 - 1) / 0.25 = 0.85 / 0.25 = <span class="text-red">3.4</span></p>

                    <p><strong>Comparaison :</strong></p>
                    <p>|t| = 3.4 > 1.96</p>

                    <p><strong>Conclusion :</strong> Rejeter H₀. Le bêta de Tesla est significativement supérieur à 1 au niveau 5%.</p>

                    <p><strong>Interprétation :</strong> Tesla est significativement plus volatile que le marché. Une hausse de 1% du marché entraîne en moyenne une hausse de 1.85% pour Tesla.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 2 : Intervalle de Confiance</h4>
            <p>Avec β̂ = 1.85 et se(β̂) = 0.25 :</p>
            <p><strong>Question :</strong> Calculez l'intervalle de confiance à 95% pour β.</p>

            <input type="text" class="exercise-calc-input" id="m8-ic-lower" placeholder="Borne inférieure">
            <input type="text" class="exercise-calc-input" id="m8-ic-upper" placeholder="Borne supérieure">
            <button class="check-btn" onclick="checkM8IC()">Vérifier</button>
            <div id="feedback-m8-ic" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Formule :</strong> IC₉₅% = β̂ ± 1.96 × se(β̂)</p>

                    <p><strong>Calcul :</strong></p>
                    <ul>
                        <li>Borne inférieure : 1.85 - 1.96 × 0.25 = 1.85 - 0.49 = <span class="text-red">1.36</span></li>
                        <li>Borne supérieure : 1.85 + 1.96 × 0.25 = 1.85 + 0.49 = <span class="text-red">2.34</span></li>
                    </ul>

                    <p><strong>Interprétation :</strong> Avec 95% de confiance, le vrai bêta de Tesla se situe entre 1.36 et 2.34.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 3 : R² et Variance Expliquée</h4>
            <p>Une régression Fama-French 3 facteurs pour un fonds donne :</p>
            <ul>
                <li>R² = 0.82</li>
                <li>Variance totale des rendements : σ²_total = 0.0025 (variance mensuelle)</li>
            </ul>
            <p><strong>Question :</strong> Quelle est la variance résiduelle (non expliquée par les facteurs) ?</p>

            <input type="text" class="exercise-calc-input" id="m8-resid" placeholder="Variance résiduelle">
            <button class="check-btn" onclick="checkM8Resid()">Vérifier</button>
            <div id="feedback-m8-resid" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Relation :</strong> R² = 1 - σ²_résiduelle / σ²_totale</p>

                    <p><strong>Calcul :</strong></p>
                    <p>σ²_résiduelle = σ²_totale × (1 - R²)</p>
                    <p>σ²_résiduelle = 0.0025 × (1 - 0.82) = 0.0025 × 0.18 = <span class="text-red">0.00045</span></p>

                    <p><strong>En écart-type :</strong> σ_résiduel = √0.00045 ≈ 2.1% par mois</p>

                    <p><strong>Interprétation :</strong> 82% de la variance du fonds est expliquée par les 3 facteurs Fama-French. Le risque idiosyncratique représente 18% de la variance totale.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 4 : Test Durbin-Watson</h4>
            <p>Une régression de rendements mensuels donne DW = 1.45.</p>
            <p><strong>Question :</strong> Que pouvez-vous conclure sur l'autocorrélation des résidus ?</p>

            <textarea class="exercise-calc-input" id="m8-dw" placeholder="Votre analyse..." rows="3" style="width: 100%;"></textarea>
            <button class="check-btn" onclick="checkM8DW()">Vérifier</button>
            <div id="feedback-m8-dw" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Interprétation du Durbin-Watson :</strong></p>
                    <p>DW ≈ 2(1 - ρ̂) où ρ̂ est l'autocorrélation des résidus.</p>

                    <p><strong>Calcul de ρ̂ :</strong></p>
                    <p>1.45 ≈ 2(1 - ρ̂) ⟹ ρ̂ ≈ 1 - 1.45/2 = 1 - 0.725 = <span class="text-red">0.275</span></p>

                    <p><strong>Conclusion :</strong></p>
                    <ul>
                        <li>DW = 1.45 < 2 suggère une autocorrélation positive des résidus</li>
                        <li>ρ̂ ≈ 0.275 : autocorrélation modérée</li>
                        <li>Les écarts-types OLS standard sont probablement sous-estimés</li>
                        <li><strong>Recommandation :</strong> Utiliser les écarts-types Newey-West (HAC)</li>
                    </ul>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 5 : MLE pour la Moyenne</h4>
            <p>On observe 5 rendements : {2%, 4%, 3%, 5%, 1%}.</p>
            <p>On suppose que les rendements suivent une loi N(μ, σ²).</p>
            <p><strong>Question :</strong> Quel est l'estimateur MLE de μ ?</p>

            <input type="text" class="exercise-calc-input" id="m8-mle" placeholder="μ̂ en %">
            <button class="check-btn" onclick="checkM8MLE()">Vérifier</button>
            <div id="feedback-m8-mle" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Résultat théorique :</strong> Pour une loi normale, le MLE de μ est la moyenne empirique.</p>

                    <p><strong>Calcul :</strong></p>
                    <p>μ̂_MLE = X̄ = (2 + 4 + 3 + 5 + 1) / 5 = 15 / 5 = <span class="text-red">3%</span></p>

                    <p><strong>Démonstration :</strong> La log-vraisemblance est maximisée quand ∂ℓ/∂μ = 0, ce qui donne Σ(Xᵢ - μ) = 0, soit μ̂ = X̄.</p>
                </div>
            </details>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             FLASHCARDS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="flashcards-m8">Flashcards</h2>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Que signifie BLUE ?</p></div>
                    <div class="flashcard-back"><p><strong>B</strong>est <strong>L</strong>inear <strong>U</strong>nbiased <strong>E</strong>stimator.<br><br>Sous Gauss-Markov, OLS a la plus petite variance parmi les estimateurs linéaires sans biais.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Formule de l'estimateur OLS ?</p></div>
                    <div class="flashcard-back"><p>β̂ = (XᵀX)⁻¹XᵀY<br><br>Minimise la somme des carrés des résidus (Y - Xβ)ᵀ(Y - Xβ).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que l'hétéroscédasticité ?</p></div>
                    <div class="flashcard-back"><p>Variance des erreurs non constante : Var(εᵢ) = σᵢ² ≠ σ².<br><br>OLS reste sans biais mais les écarts-types sont incorrects. Solution : écarts-types robustes de White.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>À quoi servent les écarts-types Newey-West ?</p></div>
                    <div class="flashcard-back"><p>Écarts-types HAC : robustes à l'<strong>H</strong>étéroscédasticité ET à l'<strong>A</strong>uto<strong>C</strong>orrélation.<br><br>Indispensables pour les données de séries temporelles financières.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Comment interpréter le R² ?</p></div>
                    <div class="flashcard-back"><p>R² = proportion de variance expliquée = SSE/SST = 1 - SSR/SST.<br><br>⚠️ Un R² élevé ne prouve pas la causalité ni un bon modèle (overfitting, spurious regression).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Comment interpréter Durbin-Watson ?</p></div>
                    <div class="flashcard-back"><p>DW ≈ 2(1 - ρ)<br><br>DW ≈ 2 → pas d'autocorrélation<br>DW < 2 → autocorrélation positive<br>DW > 2 → autocorrélation négative</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que l'endogénéité ?</p></div>
                    <div class="flashcard-back"><p>Cov(X, ε) ≠ 0 : le régresseur est corrélé avec l'erreur.<br><br>Causes : variable omise, causalité inverse, erreur de mesure.<br>Solution : variables instrumentales (2SLS).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le MLE ?</p></div>
                    <div class="flashcard-back"><p>Maximum Likelihood Estimation : choisir θ qui maximise la probabilité d'observer les données.<br><br>θ̂_MLE = argmax L(θ) = argmax Π f(xᵢ|θ)<br><br>Propriétés : convergent, asympt. normal, efficace.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que la stationnarité ?</p></div>
                    <div class="flashcard-back"><p>Les propriétés statistiques ne changent pas avec le temps :<br>• E[Yₜ] = μ (constant)<br>• Var(Yₜ) = σ² (constant)<br>• Cov(Yₜ, Yₜ₋ₖ) = γₖ (dépend de k, pas de t)</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quels sont les 3 facteurs Fama-French ?</p></div>
                    <div class="flashcard-back"><p><strong>MKT</strong> : Rₘ - Rᶠ (marché)<br><strong>SMB</strong> : Small Minus Big (taille)<br><strong>HML</strong> : High Minus Low B/M (value)<br><br>Le modèle à 5 facteurs ajoute RMW (profitabilité) et CMA (investissement).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Comment tester si β ≠ β₀ ?</p></div>
                    <div class="flashcard-back"><p>Test de Student :<br><br>t = (β̂ - β₀) / se(β̂)<br><br>Rejeter H₀ si |t| > 1.96 (niveau 5%, grands échantillons).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le GMM ?</p></div>
                    <div class="flashcard-back"><p>Generalized Method of Moments (Hansen, 1982).<br><br>Estimation basée sur E[g(X, θ)] = 0.<br><br>Avantage : pas besoin de spécifier la distribution complète. Très utilisé en finance (CAPM, facteurs).</p></div>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             RESSOURCES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>Ressources et Références</h2>

        <div class="box">
            <h4>Lectures Recommandées</h4>
            <ul>
                <li><strong>Wooldridge</strong> - "Introductory Econometrics: A Modern Approach" (référence standard)</li>
                <li><strong>Greene</strong> - "Econometric Analysis" (niveau avancé)</li>
                <li><strong>Hamilton</strong> - "Time Series Analysis" (séries temporelles)</li>
                <li><strong>Campbell, Lo, MacKinlay</strong> - "The Econometrics of Financial Markets" (finance empirique)</li>
                <li><strong>Cochrane</strong> - "Asset Pricing" (GMM et tests d'actifs)</li>
            </ul>
            <h4>Articles Fondateurs</h4>
            <ul>
                <li>White (1980) - "A Heteroskedasticity-Consistent Covariance Matrix Estimator"</li>
                <li>Hansen (1982) - "Large Sample Properties of Generalized Method of Moments Estimators"</li>
                <li>Newey & West (1987) - "A Simple, Positive Semi-Definite, Heteroskedasticity and Autocorrelation Consistent Covariance Matrix"</li>
                <li>Fama & French (1992) - "The Cross-Section of Expected Stock Returns"</li>
                <li>Gibbons, Ross & Shanken (1989) - "A Test of the Efficiency of a Given Portfolio"</li>
            </ul>
            <h4>Outils Python</h4>
            <ul>
                <li><code>statsmodels</code> : OLS, écarts-types robustes, tests</li>
                <li><code>linearmodels</code> : panel data, variables instrumentales</li>
                <li><code>arch</code> : modèles GARCH, tests de racine unitaire</li>
            </ul>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module7')">← Précédent : Probabilités</button>
            <button class="nav-btn" onclick="showModule('module9')">Suivant : Mouvement Brownien →</button>
        </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════════════════
         MODULE 9 : MARCHES ALÉATOIRES ET MOUVEMENT BROWNIEN
         De Robert Brown (1827) à la modélisation financière moderne
         ═══════════════════════════════════════════════════════════════════════════ -->
    <section id="module9" class="module">
        <header class="module-header">
            <h1>Marches Aléatoires et Mouvement Brownien</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Fondamental</span>
                <span>150 minutes</span>
                <span>Prérequis : Modules 7-8</span>
            </div>
        </header>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/c/c2/Brownian_motion_large.gif" alt="Mouvement Brownien">
            <figcaption>Simulation de mouvement brownien en 2D - le mouvement erratique des particules</figcaption>
        </figure>

        <h4>Objectifs du Module</h4>
        <ul>
            <li>Comprendre l'histoire fascinante du mouvement brownien : de la botanique à la finance</li>
            <li>Maîtriser la marche aléatoire discrète et sa convergence vers le brownien</li>
            <li>Connaître la définition rigoureuse et les propriétés du mouvement brownien standard</li>
            <li>Comprendre les propriétés surprenantes des trajectoires (continuité, non-dérivabilité)</li>
            <li>Appliquer le mouvement brownien géométrique (GBM) à la modélisation des prix</li>
            <li>Simuler des trajectoires de prix et comprendre les limites du modèle</li>
        </ul>

        <div class="box">
            <h4>Le Mouvement Brownien : Pierre Angulaire de la Finance Quantitative</h4>
            <p>Le <span class="text-red">mouvement brownien</span> est sans doute le concept mathématique le plus important en finance quantitative. Il modélise l'évolution aléatoire des prix d'actifs et constitue le fondement du modèle de <span class="text-red">Black-Scholes</span>. Comprendre ce processus est absolument essentiel pour le pricing des dérivés, la gestion des risques, et toute modélisation financière sérieuse.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             TIMELINE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>Chronologie : L'Histoire Fascinante du Mouvement Brownien</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1827</div>
                <div class="timeline-content">
                    <strong>Robert Brown - Observation Botanique</strong><br>
                    Le botaniste écossais observe au microscope le mouvement erratique de grains de pollen dans l'eau. Il pense d'abord que c'est un signe de vie, mais observe le même phénomène avec des particules inorganiques.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1880</div>
                <div class="timeline-content">
                    <strong>Thorvald Thiele</strong><br>
                    Premier traitement mathématique du mouvement brownien dans le contexte des erreurs d'observation astronomiques. Travaux peu connus à l'époque.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1900</div>
                <div class="timeline-content">
                    <strong>Louis Bachelier - Théorie de la Spéculation</strong><br>
                    Thèse révolutionnaire à la Sorbonne. Premier à utiliser le mouvement brownien pour modéliser les prix boursiers. 5 ans avant Einstein ! Ignoré pendant 60 ans.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1905</div>
                <div class="timeline-content">
                    <strong>Albert Einstein - Explication Physique</strong><br>
                    "Über die von der molekularkinetischen Theorie der Wärme geforderte Bewegung". Explique le mouvement brownien par les collisions avec les molécules. Preuve de l'existence des atomes.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1908</div>
                <div class="timeline-content">
                    <strong>Jean Perrin - Vérification Expérimentale</strong><br>
                    Confirme expérimentalement la théorie d'Einstein. Prix Nobel de Physique en 1926 pour ce travail prouvant définitivement l'existence des atomes.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1923</div>
                <div class="timeline-content">
                    <strong>Norbert Wiener - Construction Rigoureuse</strong><br>
                    Première construction mathématiquement rigoureuse du mouvement brownien. Prouve l'existence d'un processus satisfaisant toutes les propriétés. D'où le nom "processus de Wiener".
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1944</div>
                <div class="timeline-content">
                    <strong>Kiyosi Itô - Calcul Stochastique</strong><br>
                    Développe l'intégrale stochastique et le lemme d'Itô. Permet de "calculer" avec le mouvement brownien malgré sa non-dérivabilité. Révolution mathématique.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1965</div>
                <div class="timeline-content">
                    <strong>Paul Samuelson - Redécouverte de Bachelier</strong><br>
                    Redécouvre les travaux de Bachelier et introduit le mouvement brownien géométrique pour corriger le problème des prix négatifs.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1973</div>
                <div class="timeline-content">
                    <strong>Black-Scholes-Merton</strong><br>
                    Formule de pricing des options basée sur le GBM. Prix Nobel 1997. Le mouvement brownien devient le standard de l'industrie financière.
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 1: MARCHE ALÉATOIRE DISCRÈTE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>1. La Marche Aléatoire Discrète</h2>

        <div class="box">
            <h4>Définition : <span class="text-red">Marche Aléatoire Simple</span></h4>
            <p>Une marche aléatoire simple (symmetric random walk) est définie par :</p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                Sₙ = S₀ + X₁ + X₂ + ... + Xₙ = S₀ + Σᵢ₌₁ⁿ Xᵢ
            </p>
            <p>où les Xᵢ sont des variables aléatoires i.i.d. (indépendantes et identiquement distribuées) avec :</p>
            <p style="text-align: center; font-family: monospace;">
                P(Xᵢ = +1) = P(Xᵢ = -1) = 1/2
            </p>
            <p><strong>Interprétation :</strong> À chaque pas de temps, on fait un pas vers le haut (+1) ou vers le bas (-1) avec probabilité égale.</p>
        </div>

        <div class="box">
            <h4>Propriétés de la Marche Aléatoire</h4>
            <table>
                <thead>
                    <tr><th>Propriété</th><th>Formule</th><th>Démonstration</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">Espérance</span></td>
                        <td>E[Sₙ] = S₀</td>
                        <td>E[Xᵢ] = 0.5×(+1) + 0.5×(-1) = 0</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Variance</span></td>
                        <td>Var(Sₙ) = n</td>
                        <td>Var(Xᵢ) = E[Xᵢ²] = 1, et indépendance</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Écart-type</span></td>
                        <td>σ(Sₙ) = √n</td>
                        <td>Croît comme √n (pas comme n !)</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Incréments indép.</span></td>
                        <td>Sₙ - Sₘ ⊥ Sₘ - Sₖ</td>
                        <td>Par construction (Xᵢ indépendants)</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #00d4aa;">
            <h4>Propriété Clé : Martingale</h4>
            <p>La marche aléatoire est une <span class="text-red">martingale</span> : la meilleure prévision de Sₙ₊₁ sachant le passé est Sₙ.</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; margin: 15px 0;">
                E[Sₙ₊₁ | S₀, S₁, ..., Sₙ] = Sₙ
            </p>
            <p><strong>En finance :</strong> Si les prix suivent une martingale, il est impossible de prédire systématiquement la direction future. C'est l'essence de l'<span class="text-red">hypothèse des marchés efficients</span>.</p>
        </div>

        <h3>1.1 Marche Aléatoire et Efficience des Marchés</h3>

        <div class="box">
            <h4>L'Hypothèse des Marchés Efficients (EMH)</h4>
            <p>Formulée par Eugene Fama (1965, 1970), l'EMH stipule que les prix reflètent toute l'information disponible.</p>
            <table>
                <thead>
                    <tr><th>Forme</th><th>Information reflétée</th><th>Implication</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">Faible</span></td>
                        <td>Prix passés</td>
                        <td>Analyse technique inutile</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Semi-forte</span></td>
                        <td>Toute info publique</td>
                        <td>Analyse fondamentale inutile</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Forte</span></td>
                        <td>Toute info (y compris privée)</td>
                        <td>Même les insiders ne battent pas le marché</td>
                    </tr>
                </tbody>
            </table>
            <p><strong>Conséquence mathématique :</strong> Sous EMH (forme faible), les variations de prix sont imprévisibles → marche aléatoire.</p>
        </div>

        <h3>1.2 Passage à la Limite : Du Discret au Continu</h3>

        <div class="box">
            <h4>Théorème de Donsker (Invariance Principle)</h4>
            <p>Soit Sₙ une marche aléatoire. Définissons le processus renormalisé :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                Wₙ(t) = (1/√n) × S_{⌊nt⌋} pour t ∈ [0, 1]
            </p>
            <p>Alors quand n → ∞ :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                Wₙ(t) →ᵈ W(t) (mouvement brownien standard)
            </p>
            <p><strong>Intuition :</strong> En faisant des pas de plus en plus petits (1/√n) de plus en plus rapidement (n fois), on obtient à la limite le mouvement brownien continu.</p>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #ffd700;">
            <h4>Pourquoi √n et pas n ?</h4>
            <p>Si on divise par n, la limite serait 0 (loi des grands nombres).</p>
            <p>Si on ne divise pas, la limite serait ∞.</p>
            <p>La renormalisation par <span class="text-red">√n</span> est exactement ce qu'il faut pour obtenir une limite non-triviale.</p>
            <p><strong>Lien avec le TCL :</strong> Le théorème central limite dit que (Sₙ - nμ)/(σ√n) → N(0,1). Ici μ = 0 et σ = 1.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 2: MOUVEMENT BROWNIEN STANDARD
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>2. Le Mouvement Brownien Standard (Processus de Wiener)</h2>

        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Norbert_wiener.jpg/440px-Norbert_wiener.jpg" alt="Norbert Wiener">
            <figcaption>Norbert Wiener (1894-1964) - Le père de la cybernétique et de la construction rigoureuse du mouvement brownien</figcaption>
        </figure>

        <div class="box">
            <h4>Définition Rigoureuse : <span class="text-red">Mouvement Brownien Standard</span></h4>
            <p>Un processus stochastique {Wₜ, t ≥ 0} est un mouvement brownien standard (ou processus de Wiener) si et seulement si :</p>
            <ol>
                <li><strong>Condition initiale :</strong> W₀ = 0 presque sûrement</li>
                <li><strong>Incréments indépendants :</strong> Pour tous 0 ≤ t₁ < t₂ < ... < tₙ, les incréments Wₜ₂ - Wₜ₁, Wₜ₃ - Wₜ₂, ..., Wₜₙ - Wₜₙ₋₁ sont mutuellement indépendants</li>
                <li><strong>Incréments stationnaires gaussiens :</strong> Pour tous s < t, l'incrément Wₜ - Wₛ suit une loi normale :
                    <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        Wₜ - Wₛ ~ N(0, t - s)
                    </p>
                </li>
                <li><strong>Trajectoires continues :</strong> La fonction t ↦ Wₜ(ω) est continue pour presque tout ω</li>
            </ol>
        </div>

        <h3>2.1 Propriétés Statistiques</h3>

        <div class="box">
            <h4>Moments du Mouvement Brownien</h4>
            <table>
                <thead>
                    <tr><th>Propriété</th><th>Formule</th><th>Démonstration</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">Espérance</span></td>
                        <td>E[Wₜ] = 0</td>
                        <td>Wₜ = Wₜ - W₀ ~ N(0, t), donc E = 0</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Variance</span></td>
                        <td>Var(Wₜ) = t</td>
                        <td>Wₜ ~ N(0, t), donc Var = t</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Distribution</span></td>
                        <td>Wₜ ~ N(0, t)</td>
                        <td>Par définition des incréments</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Covariance</span></td>
                        <td>Cov(Wₛ, Wₜ) = min(s, t)</td>
                        <td>Voir démonstration ci-dessous</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #00d4aa;">
            <h4>Démonstration : Cov(Wₛ, Wₜ) = min(s, t)</h4>
            <p>Supposons s ≤ t. Alors :</p>
            <p style="font-family: monospace; font-size: 14px;">
                Cov(Wₛ, Wₜ) = Cov(Wₛ, Wₛ + (Wₜ - Wₛ))<br>
                = Cov(Wₛ, Wₛ) + Cov(Wₛ, Wₜ - Wₛ)<br>
                = Var(Wₛ) + 0 (car Wₛ et Wₜ - Wₛ sont indépendants)<br>
                = <span class="text-red">s = min(s, t)</span>
            </p>
        </div>

        <h3>2.2 Propriétés des Trajectoires</h3>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #ff6b6b;">
            <h4>Propriété Surprenante : Continuité mais Non-Dérivabilité</h4>
            <p>Les trajectoires du mouvement brownien sont :</p>
            <ul>
                <li>✅ <strong>Continues partout</strong> : t ↦ Wₜ est une fonction continue</li>
                <li>❌ <strong>Dérivables nulle part</strong> : La limite lim_{h→0} (Wₜ₊ₕ - Wₜ)/h n'existe pour aucun t !</li>
            </ul>
            <p><strong>Intuition :</strong> Les trajectoires sont extrêmement "rugueuses". Elles oscillent infiniment rapidement à toutes les échelles.</p>
            <p><strong>Conséquence majeure :</strong> On ne peut PAS définir l'intégrale ∫W dW comme une intégrale de Riemann-Stieltjes classique. Il faut le <span class="text-red">calcul d'Itô</span> (Module 10).</p>
        </div>

        <div class="box">
            <h4>Variation Quadratique</h4>
            <p>Une propriété fondamentale qui distingue le mouvement brownien des fonctions classiques :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                [W, W]ₜ = lim_{n→∞} Σᵢ (W_{tᵢ} - W_{tᵢ₋₁})² = t
            </p>
            <p><strong>Formule mnémotechnique :</strong></p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; color: #ff6b6b;">
                (dWₜ)² = dt
            </p>
            <p>Cette propriété est la clé du lemme d'Itô et explique la correction σ²/2 dans le GBM.</p>
        </div>

        <div class="box">
            <h4>Autres Propriétés Remarquables</h4>
            <ul>
                <li><strong>Auto-similarité :</strong> Pour tout a > 0, le processus (1/√a)W_{at} a la même loi que Wₜ
                    <p style="font-family: monospace; text-align: center;">W_{at} ~ √a × Wₜ en loi</p>
                </li>
                <li><strong>Symétrie temporelle :</strong> -Wₜ est aussi un mouvement brownien</li>
                <li><strong>Récurrence :</strong> En dimension 1 et 2, le brownien revient infiniment souvent au voisinage de tout point. En dimension ≥ 3, il s'échappe à l'infini (théorème de Pólya).</li>
                <li><strong>Loi du logarithme itéré :</strong>
                    <p style="font-family: monospace; text-align: center;">lim sup_{t→∞} Wₜ/√(2t ln ln t) = 1 p.s.</p>
                </li>
            </ul>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 3: MOUVEMENT BROWNIEN GÉOMÉTRIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>3. Le Mouvement Brownien Géométrique (GBM)</h2>

        <h3>3.1 Pourquoi le GBM et pas le Brownien Simple ?</h3>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #ff6b6b;">
            <h4>Problème du Mouvement Brownien Arithmétique</h4>
            <p>Bachelier (1900) proposait : dSₜ = μdt + σdWₜ</p>
            <p>La solution est : Sₜ = S₀ + μt + σWₜ</p>
            <p><strong>Problème fatal :</strong> Wₜ ~ N(0, t), donc Sₜ peut devenir <span class="text-red">négatif</span> !</p>
            <p>Exemple : S₀ = 100, σ = 20, après 1 an : P(Sₜ < 0) > 0</p>
            <p>Un prix d'action négatif n'a aucun sens économique.</p>
        </div>

        <div class="box">
            <h4>Solution de Samuelson (1965) : Le GBM</h4>
            <p>Modéliser les <strong>rendements relatifs</strong> (en %) plutôt que les variations absolues :</p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; background: #1a1a2e; padding: 20px; border-radius: 8px; margin: 15px 0;">
                dSₜ / Sₜ = μdt + σdWₜ
            </p>
            <p>Ou de façon équivalente :</p>
            <p style="text-align: center; font-family: monospace; font-size: 20px;">
                dSₜ = μSₜdt + σSₜdWₜ
            </p>
            <p><strong>Avantage :</strong> La solution Sₜ est toujours <span class="text-red">positive</span> (exponentielle d'une variable réelle).</p>
        </div>

        <h3>3.2 Solution du GBM</h3>

        <div class="box">
            <h4>Théorème : Solution Explicite du GBM</h4>
            <p>L'équation différentielle stochastique dSₜ = μSₜdt + σSₜdWₜ admet la solution unique :</p>
            <p style="text-align: center; font-family: monospace; font-size: 22px; background: #1a1a2e; padding: 20px; border-radius: 8px; margin: 15px 0;">
                Sₜ = S₀ × exp((μ - σ²/2)t + σWₜ)
            </p>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #00d4aa;">
            <h4>Démonstration par le Lemme d'Itô</h4>
            <p>Posons Xₜ = ln(Sₜ). Par le lemme d'Itô (Module 10) avec f(S) = ln(S) :</p>
            <p style="font-family: monospace; font-size: 14px;">
                dXₜ = f'(Sₜ)dSₜ + ½f''(Sₜ)(dSₜ)²<br>
                = (1/Sₜ)(μSₜdt + σSₜdWₜ) + ½(-1/Sₜ²)(σ²Sₜ²dt)<br>
                = μdt + σdWₜ - σ²/2 dt<br>
                = <span class="text-red">(μ - σ²/2)dt + σdWₜ</span>
            </p>
            <p>C'est une EDS linéaire ! La solution est :</p>
            <p style="font-family: monospace;">
                Xₜ = X₀ + (μ - σ²/2)t + σWₜ<br>
                ln(Sₜ) = ln(S₀) + (μ - σ²/2)t + σWₜ<br>
                Sₜ = S₀ exp((μ - σ²/2)t + σWₜ)
            </p>
        </div>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #ffd700;">
            <h4>La Correction d'Itô : σ²/2</h4>
            <p>Le terme <span class="text-red">-σ²/2</span> dans l'exposant est crucial. Il apparaît car (dW)² = dt ≠ 0.</p>
            <p><strong>Sans cette correction :</strong></p>
            <ul>
                <li>Si on écrivait naïvement Sₜ = S₀ exp(μt + σWₜ), on aurait :</li>
                <li>E[Sₜ] = S₀ × E[exp(μt + σWₜ)] = S₀ × exp(μt) × exp(σ²t/2) ≠ S₀e^{μt}</li>
            </ul>
            <p><strong>Avec la correction :</strong></p>
            <ul>
                <li>E[Sₜ] = S₀ × E[exp((μ - σ²/2)t + σWₜ)] = S₀ × exp(μt) ✓</li>
            </ul>
            <p>La correction assure que μ est bien le rendement espéré instantané.</p>
        </div>

        <h3>3.3 Distribution du Prix</h3>

        <div class="box">
            <h4>Distribution Log-Normale de Sₜ</h4>
            <p>Puisque ln(Sₜ) = ln(S₀) + (μ - σ²/2)t + σWₜ et Wₜ ~ N(0, t) :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                ln(Sₜ/S₀) ~ N((μ - σ²/2)t, σ²t)
            </p>
            <p>Donc Sₜ suit une <span class="text-red">distribution log-normale</span>.</p>
        </div>

        <div class="box">
            <h4>Moments du GBM</h4>
            <table>
                <thead>
                    <tr><th>Moment</th><th>Formule</th><th>Avec μ = 10%, σ = 20%, t = 1, S₀ = 100</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">Espérance</span></td>
                        <td>E[Sₜ] = S₀ exp(μt)</td>
                        <td>100 × e^0.1 = 110.52</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Variance</span></td>
                        <td>Var(Sₜ) = S₀² e^{2μt}(e^{σ²t} - 1)</td>
                        <td>100² × e^0.2 × (e^0.04 - 1) ≈ 498</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Médiane</span></td>
                        <td>S₀ exp((μ - σ²/2)t)</td>
                        <td>100 × e^0.08 = 108.33</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Mode</span></td>
                        <td>S₀ exp((μ - 3σ²/2)t)</td>
                        <td>100 × e^0.04 = 104.08</td>
                    </tr>
                </tbody>
            </table>
            <p><strong>Note :</strong> Moyenne > Médiane > Mode car la log-normale est asymétrique à droite.</p>
        </div>

        <!-- Graphique de simulation GBM -->
        <div class="chart-container" style="max-width: 900px; margin: 30px auto;">
            <canvas id="gbmSimulationChart"></canvas>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 4: SIMULATION DE TRAJECTOIRES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>4. Simulation de Trajectoires</h2>

        <h3>4.1 Algorithme de Simulation du GBM</h3>

        <div class="box">
            <h4>Méthode de Discrétisation Exacte</h4>
            <p>Pour simuler Sₜ sur [0, T] avec n pas de temps :</p>
            <ol>
                <li><strong>Définir le pas de temps :</strong> Δt = T/n</li>
                <li><strong>Générer des chocs :</strong> Z₁, Z₂, ..., Zₙ ~ N(0, 1) i.i.d.</li>
                <li><strong>Itérer :</strong> Pour i = 1, ..., n :
                    <p style="text-align: center; font-family: monospace; font-size: 16px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        Sᵢ = Sᵢ₋₁ × exp((μ - σ²/2)Δt + σ√Δt × Zᵢ)
                    </p>
                </li>
            </ol>
            <p><strong>Avantage :</strong> Cette méthode est <span class="text-red">exacte</span> (pas d'erreur de discrétisation) car on utilise la solution analytique.</p>
        </div>

        <div class="box">
            <h4>Pseudo-code Python</h4>
            <pre style="background: #1a1a2e; padding: 20px; border-radius: 8px; overflow-x: auto; font-size: 14px;">
<code>import numpy as np

def simulate_gbm(S0, mu, sigma, T, n, num_paths=1):
    """
    Simule des trajectoires de GBM.

    Params:
        S0: prix initial
        mu: drift (rendement espéré annualisé)
        sigma: volatilité annualisée
        T: horizon en années
        n: nombre de pas de temps
        num_paths: nombre de trajectoires

    Returns:
        S: matrice (num_paths, n+1) des prix simulés
    """
    dt = T / n

    # Générer les chocs gaussiens
    Z = np.random.standard_normal((num_paths, n))

    # Calculer les incréments log-prix
    log_returns = (mu - 0.5 * sigma**2) * dt + sigma * np.sqrt(dt) * Z

    # Reconstituer les prix
    log_S = np.zeros((num_paths, n + 1))
    log_S[:, 0] = np.log(S0)
    log_S[:, 1:] = np.log(S0) + np.cumsum(log_returns, axis=1)

    return np.exp(log_S)</code>
            </pre>
        </div>

        <h3>4.2 Méthode d'Euler-Maruyama (Alternative)</h3>

        <div class="box">
            <h4>Discrétisation d'Euler-Maruyama</h4>
            <p>Une alternative plus générale (mais approximative pour le GBM) :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                Sᵢ₊₁ = Sᵢ + μSᵢΔt + σSᵢ√Δt × Zᵢ₊₁
            </p>
            <p><strong>Avantage :</strong> S'applique à toute EDS (pas seulement GBM).</p>
            <p><strong>Inconvénient :</strong> Erreur de discrétisation O(√Δt). Peut donner des prix négatifs si Δt est grand.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 5: LIMITES DU MODÈLE GBM
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>5. Limites du Modèle GBM</h2>

        <div class="box" style="background: linear-gradient(135deg, #1a1a2e, #16213e); border-left: 4px solid #ff6b6b;">
            <h4>Les Limites du GBM en Pratique</h4>
            <p>Le GBM est le modèle standard, mais il a des limitations importantes :</p>
            <table>
                <thead>
                    <tr><th>Hypothèse GBM</th><th>Réalité des Marchés</th><th>Conséquence</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Rendements normaux</td>
                        <td><span class="text-red">Queues épaisses</span> (fat tails)</td>
                        <td>Sous-estime les événements extrêmes</td>
                    </tr>
                    <tr>
                        <td>Volatilité constante σ</td>
                        <td><span class="text-red">Volatilité stochastique</span></td>
                        <td>Smile de volatilité non capturé</td>
                    </tr>
                    <tr>
                        <td>Trajectoires continues</td>
                        <td><span class="text-red">Sauts</span> (jumps)</td>
                        <td>Krachs instantanés impossibles</td>
                    </tr>
                    <tr>
                        <td>Rendements i.i.d.</td>
                        <td><span class="text-red">Clustering de volatilité</span></td>
                        <td>Autocorrélation de |rₜ| ignorée</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box">
            <h4>Extensions du GBM</h4>
            <ul>
                <li><strong>Modèles à volatilité stochastique :</strong> Heston, SABR (Module 12)</li>
                <li><strong>Modèles à sauts :</strong> Merton jump-diffusion, Kou</li>
                <li><strong>Modèles à volatilité locale :</strong> Dupire (1994)</li>
                <li><strong>Modèles GARCH :</strong> Pour le clustering de volatilité</li>
            </ul>
            <p><strong>En pratique :</strong> On utilise souvent le GBM comme benchmark, puis on ajoute des corrections (smile fitting, ajustement pour fat tails).</p>
        </div>

        <blockquote>
            <p>"All models are wrong, but some are useful."</p>
            <cite>George Box</cite>
        </blockquote>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             EXERCICES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="exercices-m9">Exercices</h2>

        <div class="exercise-box">
            <h4>Exercice 1 : Variance du Mouvement Brownien</h4>
            <p>Soit W un mouvement brownien standard.</p>
            <p><strong>Question :</strong> Quelle est la variance de W₃ - W₁ ?</p>

            <input type="text" class="exercise-calc-input" id="m9-var" placeholder="Var = ?">
            <button class="check-btn" onclick="checkM9Var()">Vérifier</button>
            <div id="feedback-m9-var" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Propriété :</strong> Pour un mouvement brownien, Wₜ - Wₛ ~ N(0, t - s).</p>
                    <p><strong>Application :</strong></p>
                    <p>W₃ - W₁ ~ N(0, 3 - 1) = N(0, 2)</p>
                    <p>Donc Var(W₃ - W₁) = <span class="text-red">2</span></p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 2 : Espérance du GBM</h4>
            <p>Un actif a un prix initial S₀ = 100€ et suit un GBM avec μ = 10% et σ = 20%.</p>
            <p><strong>Question :</strong> Quel est le prix espéré E[S₁] après 1 an ?</p>
            <p><em>Rappel : E[Sₜ] = S₀e^{μt}</em></p>

            <input type="text" class="exercise-calc-input" id="m9-esp" placeholder="E[S₁] = ?">
            <button class="check-btn" onclick="checkM9Esp()">Vérifier</button>
            <div id="feedback-m9-esp" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Formule :</strong> E[Sₜ] = S₀ × exp(μt)</p>
                    <p><strong>Calcul :</strong></p>
                    <p>E[S₁] = 100 × exp(0.10 × 1) = 100 × e^0.1 = 100 × 1.1052 ≈ <span class="text-red">110.52€</span></p>
                    <p><strong>Note :</strong> Le σ n'affecte pas l'espérance grâce à la correction d'Itô.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 3 : Covariance du Brownien</h4>
            <p>Soit W un mouvement brownien standard.</p>
            <p><strong>Question :</strong> Calculez Cov(W₂, W₅).</p>

            <input type="text" class="exercise-calc-input" id="m9-cov" placeholder="Cov = ?">
            <button class="check-btn" onclick="checkM9Cov()">Vérifier</button>
            <div id="feedback-m9-cov" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Formule :</strong> Cov(Wₛ, Wₜ) = min(s, t)</p>
                    <p><strong>Application :</strong></p>
                    <p>Cov(W₂, W₅) = min(2, 5) = <span class="text-red">2</span></p>
                    <p><strong>Démonstration :</strong> Cov(W₂, W₅) = Cov(W₂, W₂ + (W₅-W₂)) = Var(W₂) + 0 = 2</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 4 : Distribution du Log-Rendement</h4>
            <p>Un actif suit un GBM avec S₀ = 50, μ = 8%, σ = 25%.</p>
            <p><strong>Question :</strong> Quelle est la probabilité que le prix soit supérieur à 60€ après 1 an ?</p>
            <p><em>Indication : ln(Sₜ/S₀) ~ N((μ - σ²/2)t, σ²t). Utilisez P(Z > z) avec les tables.</em></p>

            <input type="text" class="exercise-calc-input" id="m9-prob" placeholder="P(S₁ > 60) en %">
            <button class="check-btn" onclick="checkM9Prob()">Vérifier</button>
            <div id="feedback-m9-prob" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Étape 1 :</strong> Distribution du log-rendement</p>
                    <p>ln(S₁/S₀) ~ N((0.08 - 0.25²/2)×1, 0.25²×1) = N(0.04875, 0.0625)</p>
                    <p>σ = √0.0625 = 0.25</p>

                    <p><strong>Étape 2 :</strong> Standardisation</p>
                    <p>P(S₁ > 60) = P(ln(S₁/50) > ln(60/50)) = P(ln(S₁/S₀) > ln(1.2))</p>
                    <p>ln(1.2) ≈ 0.1823</p>
                    <p>Z = (0.1823 - 0.04875) / 0.25 = 0.1336 / 0.25 ≈ 0.53</p>

                    <p><strong>Étape 3 :</strong> Calcul de probabilité</p>
                    <p>P(S₁ > 60) = P(Z > 0.53) = 1 - Φ(0.53) ≈ 1 - 0.702 ≈ <span class="text-red">29.8%</span></p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 5 : Simulation</h4>
            <p>Vous voulez simuler 252 jours de trading (1 an) pour un actif avec S₀ = 100, μ = 12%, σ = 30%.</p>
            <p><strong>Question :</strong> Quelle est la valeur de Δt (en années) et de σ√Δt ?</p>

            <input type="text" class="exercise-calc-input" id="m9-dt" placeholder="Δt = ?">
            <input type="text" class="exercise-calc-input" id="m9-sigmasqrt" placeholder="σ√Δt = ? (en %)">
            <button class="check-btn" onclick="checkM9Sim()">Vérifier</button>
            <div id="feedback-m9-sim" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Calcul de Δt :</strong></p>
                    <p>Δt = T/n = 1/252 ≈ <span class="text-red">0.00397</span> années (≈ 1 jour de trading)</p>

                    <p><strong>Calcul de σ√Δt :</strong></p>
                    <p>σ√Δt = 0.30 × √(1/252) = 0.30 × 0.063 ≈ <span class="text-red">1.89%</span></p>

                    <p><strong>Interprétation :</strong> Chaque jour, le prix varie typiquement de ±1.89% (1 écart-type).</p>
                </div>
            </details>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             FLASHCARDS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="flashcards-m9">Flashcards</h2>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qui a inventé le mouvement brownien en finance ?</p></div>
                    <div class="flashcard-back"><p><strong>Louis Bachelier</strong> en 1900, dans sa thèse "Théorie de la Spéculation".<br><br>5 ans avant Einstein ! Ignoré pendant 60 ans, puis redécouvert par Samuelson.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelles sont les 4 propriétés du mouvement brownien standard ?</p></div>
                    <div class="flashcard-back"><p>1. W₀ = 0<br>2. Incréments indépendants<br>3. Wₜ - Wₛ ~ N(0, t-s)<br>4. Trajectoires continues</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la distribution de Wₜ ?</p></div>
                    <div class="flashcard-back"><p>Wₜ ~ N(0, t)<br><br>Moyenne 0, variance t. La variance croît linéairement avec le temps.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Formule de Cov(Wₛ, Wₜ) ?</p></div>
                    <div class="flashcard-back"><p>Cov(Wₛ, Wₜ) = min(s, t)<br><br>Exemple : Cov(W₂, W₅) = 2</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi le GBM au lieu du brownien simple ?</p></div>
                    <div class="flashcard-back"><p>Le GBM garantit des prix <strong>toujours positifs</strong> (Sₜ > 0).<br><br>Le brownien arithmétique peut donner des prix négatifs, ce qui n'a pas de sens économique.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est l'EDS du GBM ?</p></div>
                    <div class="flashcard-back"><p>dSₜ = μSₜdt + σSₜdWₜ<br><br>μ = drift (rendement espéré)<br>σ = volatilité</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la solution du GBM ?</p></div>
                    <div class="flashcard-back"><p>Sₜ = S₀ exp((μ - σ²/2)t + σWₜ)<br><br>Le terme -σ²/2 est la <strong>correction d'Itô</strong>.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que la correction d'Itô σ²/2 ?</p></div>
                    <div class="flashcard-back"><p>Un ajustement nécessaire car (dW)² = dt ≠ 0.<br><br>Sans elle, E[Sₜ] ≠ S₀e^{μt}. Elle assure que μ est bien le rendement espéré.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la distribution de Sₜ dans le GBM ?</p></div>
                    <div class="flashcard-back"><p>Sₜ suit une loi <strong>log-normale</strong>.<br><br>ln(Sₜ/S₀) ~ N((μ-σ²/2)t, σ²t)</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Formule pour E[Sₜ] dans le GBM ?</p></div>
                    <div class="flashcard-back"><p>E[Sₜ] = S₀ × exp(μt)<br><br>L'espérance ne dépend pas de σ !</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Les trajectoires du brownien sont-elles dérivables ?</p></div>
                    <div class="flashcard-back"><p><strong>Non !</strong> Les trajectoires sont continues mais <strong>nulle part dérivables</strong>.<br><br>C'est pourquoi on a besoin du calcul d'Itô.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelles sont les limites du GBM ?</p></div>
                    <div class="flashcard-back"><p>• Queues fines (pas de fat tails)<br>• Volatilité constante (pas de smile)<br>• Pas de sauts<br>• Pas de clustering de volatilité<br><br>Extensions : Heston, SABR, jump-diffusion.</p></div>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             RESSOURCES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>Ressources et Références</h2>

        <div class="box">
            <h4>Lectures Recommandées</h4>
            <ul>
                <li><strong>Shreve</strong> - "Stochastic Calculus for Finance II" - Chapitres 3-4 (référence)</li>
                <li><strong>Hull</strong> - "Options, Futures, and Other Derivatives" - Chapitre 14</li>
                <li><strong>Björk</strong> - "Arbitrage Theory in Continuous Time" - Chapitres 4-5</li>
                <li><strong>Mörters & Peres</strong> - "Brownian Motion" (mathématiques pures)</li>
            </ul>
            <h4>Articles Historiques</h4>
            <ul>
                <li>Bachelier (1900) - "Théorie de la Spéculation" (thèse originale)</li>
                <li>Einstein (1905) - "Über die von der molekularkinetischen Theorie..."</li>
                <li>Wiener (1923) - "Differential Space"</li>
                <li>Black & Scholes (1973) - "The Pricing of Options and Corporate Liabilities"</li>
            </ul>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module8')">← Précédent : Économétrie</button>
            <button class="nav-btn" onclick="showModule('module10')">Suivant : Calcul d'Itô →</button>
        </div>
    </section>

    <section id="module10" class="module">
        <header class="module-header">
            <h1>Module 10 : Calcul Stochastique - Fondements</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>180 minutes</span>
                <span>Prérequis : Modules 6, 7, 9</span>
            </div>
        </header>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             INTRODUCTION ET CONTEXTE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/c/c1/Kiyosi_Ito.jpg" alt="Kiyoshi Itô">
            <figcaption>Kiyoshi Itô (1915-2008) - Mathématicien japonais, père du calcul stochastique moderne et prix Gauss 2006</figcaption>
        </figure>

        <h4>Objectifs du Module</h4>
        <ul>
            <li>Comprendre pourquoi le calcul classique ne s'applique pas aux processus stochastiques</li>
            <li>Maîtriser l'intégrale d'Itô et ses propriétés fondamentales</li>
            <li>Appliquer le lemme d'Itô (formule centrale du calcul stochastique)</li>
            <li>Résoudre des équations différentielles stochastiques (EDS) analytiquement</li>
            <li>Comprendre les conditions d'existence et unicité des solutions</li>
            <li>Appliquer ces outils à la dérivation rigoureuse de Black-Scholes</li>
        </ul>

        <div class="box">
            <h4>Le Calcul d'Itô : Une Révolution Mathématique</h4>
            <p>Le calcul stochastique représente l'une des avancées mathématiques majeures du XXe siècle. Il résout un problème fondamental : comment faire du calcul différentiel sur des trajectoires <span class="text-red">nulle part dérivables</span> comme le mouvement brownien ?</p>
            <p>La réponse de Kiyoshi Itô, développée dans les années 1940, bouleverse les règles du calcul classique. La formule df = f'(x)dx devient obsolète et doit être remplacée par le <span class="text-red">lemme d'Itô</span>, qui ajoute un terme de correction crucial : <span class="text-red">½f''(x)(dx)²</span>.</p>
            <p>Ce terme, négligeable en calcul ordinaire, devient essentiel car pour le mouvement brownien, <span class="text-red">(dW)² = dt</span>. Cette identité surprenante est au cœur de toute la finance quantitative moderne.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             TIMELINE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>Chronologie du Calcul Stochastique</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1900</div>
                <div class="timeline-content">
                    <h4>Louis Bachelier - Thèse de la Spéculation</h4>
                    <p>Première utilisation du mouvement brownien en finance. Bachelier anticipe le besoin d'un calcul différentiel adapté aux processus aléatoires, mais les outils mathématiques manquent.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1923</div>
                <div class="timeline-content">
                    <h4>Norbert Wiener - Construction rigoureuse</h4>
                    <p>Construction mathématique rigoureuse du mouvement brownien (processus de Wiener). Wiener montre que les trajectoires sont continues mais nulle part dérivables avec probabilité 1.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1944</div>
                <div class="timeline-content">
                    <h4>Kiyoshi Itô - Intégrale stochastique</h4>
                    <p>Itô définit rigoureusement l'intégrale ∫f(t)dWₜ et prouve ses propriétés fondamentales. C'est la naissance du calcul stochastique moderne.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1951</div>
                <div class="timeline-content">
                    <h4>Kiyoshi Itô - Le Lemme d'Itô</h4>
                    <p>Publication de la formule de changement de variable pour les processus stochastiques. Cette formule sera la clé de voûte de la finance quantitative.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1966</div>
                <div class="timeline-content">
                    <h4>Ruslan Stratonovich - Intégrale alternative</h4>
                    <p>Stratonovich propose une définition alternative de l'intégrale stochastique, qui préserve les règles du calcul classique mais perd la propriété de martingale.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1973</div>
                <div class="timeline-content">
                    <h4>Black, Scholes, Merton - Application en finance</h4>
                    <p>Le lemme d'Itô est appliqué pour dériver l'équation de Black-Scholes. Robert Merton explicite l'utilisation du calcul stochastique en finance. Prix Nobel 1997.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">2006</div>
                <div class="timeline-content">
                    <h4>Prix Carl Friedrich Gauss pour Kiyoshi Itô</h4>
                    <p>À 90 ans, Itô reçoit le premier prix Gauss pour "l'immense impact de ses travaux sur les applications des mathématiques stochastiques dans le monde moderne".</p>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 1: LE PROBLÈME FONDAMENTAL
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>1. Le Problème Fondamental : Pourquoi le Calcul Classique Échoue</h2>

        <h3>1.1 Rappel : Le Mouvement Brownien n'est pas Dérivable</h3>

        <div class="box">
            <h4>Théorème : Non-Dérivabilité du Mouvement Brownien</h4>
            <p>Soit {Wₜ}ₜ≥₀ un mouvement brownien standard. Alors avec probabilité 1 :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                lim (Wₜ₊ₕ - Wₜ) / h n'existe pas pour tout t
                    h→0
            </p>
            <p>Autrement dit, les trajectoires browniennes sont <span class="text-red">continues mais nulle part dérivables</span>.</p>
        </div>

        <h3>1.2 La Variation Quadratique : Clé du Calcul Stochastique</h3>

        <p>En calcul ordinaire, pour une fonction dérivable f(t), la variation quadratique est nulle :</p>
        <p style="text-align: center; font-family: monospace; font-size: 16px;">
            Σᵢ (f(tᵢ₊₁) - f(tᵢ))² → 0 quand max(tᵢ₊₁ - tᵢ) → 0
        </p>

        <p>Pour le mouvement brownien, c'est radicalement différent :</p>

        <div class="box">
            <h4>Théorème : Variation Quadratique du Mouvement Brownien</h4>
            <p>Pour une partition 0 = t₀ < t₁ < ... < tₙ = T de [0,T] :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Σᵢ (Wₜᵢ₊₁ - Wₜᵢ)² → T   (convergence en probabilité)
            </p>
            <p>On écrit symboliquement : <span class="text-red">(dW)² = dt</span></p>
            <p><strong>Conséquence :</strong> Le terme (dW)² n'est <span class="text-red">pas</span> négligeable dans les développements de Taylor !</p>
        </div>

        <h3>1.3 Démonstration Intuitive de (dW)² = dt</h3>

        <div class="box">
            <h4>Preuve (idée)</h4>
            <p>Pour chaque incrément ΔWᵢ = Wₜᵢ₊₁ - Wₜᵢ, on a :</p>
            <ul>
                <li>E[(ΔWᵢ)²] = Var(ΔWᵢ) = tᵢ₊₁ - tᵢ = Δtᵢ</li>
                <li>Var((ΔWᵢ)²) = E[(ΔWᵢ)⁴] - E[(ΔWᵢ)²]² = 3(Δtᵢ)² - (Δtᵢ)² = 2(Δtᵢ)²</li>
            </ul>
            <p>Donc :</p>
            <ul>
                <li>E[Σᵢ(ΔWᵢ)²] = Σᵢ Δtᵢ = T</li>
                <li>Var[Σᵢ(ΔWᵢ)²] = Σᵢ 2(Δtᵢ)² ≤ 2T × max(Δtᵢ) → 0</li>
            </ul>
            <p>Par la loi des grands nombres, Σᵢ(ΔWᵢ)² converge vers son espérance T.</p>
        </div>

        <h3>1.4 Les Règles du Calcul d'Itô</h3>

        <p>Les produits différentiels suivent des règles spécifiques :</p>

        <table>
            <thead>
                <tr><th>Produit</th><th>Résultat</th><th>Justification</th></tr>
            </thead>
            <tbody>
                <tr><td>(dt)²</td><td><span class="text-red">0</span></td><td>Ordre o(dt) négligeable</td></tr>
                <tr><td>dt × dW</td><td><span class="text-red">0</span></td><td>Ordre o(√dt) négligeable</td></tr>
                <tr><td><span class="text-red">(dW)²</span></td><td><span class="text-red">dt</span></td><td>Variation quadratique !</td></tr>
            </tbody>
        </table>

        <div class="box">
            <h4>Mnémotechnique</h4>
            <p>Pensez en termes d'ordres de grandeur :</p>
            <ul>
                <li>dt est d'ordre Δt</li>
                <li>dW est d'ordre √Δt (car Var(ΔW) = Δt)</li>
            </ul>
            <p>Donc (dW)² ~ Δt est du même ordre que dt, tandis que dt×dW ~ Δt^(3/2) et (dt)² ~ Δt² sont négligeables.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 2: L'INTÉGRALE D'ITÔ
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>2. L'Intégrale Stochastique d'Itô</h2>

        <h3>2.1 Construction de l'Intégrale</h3>

        <div class="box">
            <h4>Définition : Intégrale d'Itô</h4>
            <p>Soit f(t,ω) un processus <span class="text-red">adapté</span> (ne dépend que de l'information passée). L'intégrale d'Itô est définie comme la limite :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                ∫₀ᵀ f(t)dWₜ = lim Σᵢ f(tᵢ)(Wₜᵢ₊₁ - Wₜᵢ)
                              n→∞
            </p>
            <p><strong>Point crucial :</strong> On évalue f au point <span class="text-red">gauche</span> tᵢ de chaque intervalle [tᵢ, tᵢ₊₁]. C'est la convention d'Itô, qui garantit la propriété de non-anticipation.</p>
        </div>

        <h3>2.2 Comparaison Itô vs Stratonovich</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Intégrale d'Itô</h4>
                <p style="font-family: monospace; text-align: center;">Σᵢ f(tᵢ)(Wₜᵢ₊₁ - Wₜᵢ)</p>
                <ul>
                    <li>Évaluation au point gauche</li>
                    <li><span class="text-green">Non-anticipatif</span></li>
                    <li><span class="text-green">Martingale</span></li>
                    <li><span class="text-red">Règles modifiées</span> ((dW)² = dt)</li>
                    <li><span class="text-green">Standard en finance</span></li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Intégrale de Stratonovich</h4>
                <p style="font-family: monospace; text-align: center;">Σᵢ f((tᵢ+tᵢ₊₁)/2)(Wₜᵢ₊₁ - Wₜᵢ)</p>
                <ul>
                    <li>Évaluation au point milieu</li>
                    <li><span class="text-red">Anticipatif</span></li>
                    <li><span class="text-red">Pas une martingale</span></li>
                    <li><span class="text-green">Règles classiques</span></li>
                    <li>Utilisée en physique</li>
                </ul>
            </div>
        </div>

        <div class="box">
            <h4>Relation entre les deux intégrales</h4>
            <p>Pour dX = σdW :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                ∫f(X)○dX = ∫f(X)dX + ½∫f'(X)σ²dt
            </p>
            <p>où ○ désigne l'intégrale de Stratonovich. Le terme de correction est le fameux "terme d'Itô".</p>
        </div>

        <h3>2.3 Propriétés Fondamentales de l'Intégrale d'Itô</h3>

        <div class="box">
            <h4>Théorème : Propriétés de l'intégrale ∫₀ᵀ f(t)dWₜ</h4>
            <ol>
                <li><strong>Linéarité :</strong> ∫(αf + βg)dW = α∫fdW + β∫gdW</li>
                <li><strong>Espérance nulle :</strong> <span class="text-red">E[∫₀ᵀ f(t)dWₜ] = 0</span></li>
                <li><strong>Isométrie d'Itô :</strong> <span class="text-red">E[(∫₀ᵀ f(t)dWₜ)²] = E[∫₀ᵀ f(t)²dt]</span></li>
                <li><strong>Martingale :</strong> Iₜ = ∫₀ᵗ f(s)dWₛ est une martingale</li>
                <li><strong>Continuité :</strong> Les trajectoires t ↦ Iₜ sont continues</li>
            </ol>
        </div>

        <h3>2.4 Exemples de Calcul</h3>

        <div class="box">
            <h4>Exemple 1 : ∫₀ᵀ dWₜ</h4>
            <p>C'est simplement :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">∫₀ᵀ dWₜ = Wᵀ - W₀ = Wᵀ</p>
        </div>

        <div class="box">
            <h4>Exemple 2 : ∫₀ᵀ Wₜ dWₜ (Intégrale cruciale !)</h4>
            <p><strong>En calcul classique :</strong> ∫x dx = x²/2</p>
            <p><strong>En calcul d'Itô :</strong> Le résultat est différent !</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                ∫₀ᵀ Wₜ dWₜ = ½Wᵀ² - ½T
            </p>
            <p>Le terme <span class="text-red">-½T</span> est la "correction d'Itô" due à (dW)² = dt.</p>
        </div>

        <div class="box">
            <h4>Démonstration de ∫₀ᵀ Wₜ dWₜ = ½Wᵀ² - ½T</h4>
            <p>Méthode 1 (par sommation télescopique) :</p>
            <p style="font-family: monospace; font-size: 14px;">
                Σᵢ Wₜᵢ(Wₜᵢ₊₁ - Wₜᵢ) = Σᵢ [½(Wₜᵢ₊₁² - Wₜᵢ²) - ½(Wₜᵢ₊₁ - Wₜᵢ)²]<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ½Wᵀ² - ½Σᵢ(ΔWᵢ)²<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ ½Wᵀ² - ½T
            </p>
            <p>Méthode 2 (par le lemme d'Itô avec f(W) = W²) :</p>
            <p style="font-family: monospace; font-size: 14px;">
                d(W²) = 2WdW + (dW)² = 2WdW + dt<br>
                ⟹ W² = 2∫WdW + t<br>
                ⟹ ∫WdW = ½W² - ½t
            </p>
        </div>

        <div class="box">
            <h4>Exemple 3 : ∫₀ᵀ t dWₜ</h4>
            <p>Ici f(t) = t est déterministe. Par l'isométrie d'Itô :</p>
            <ul>
                <li>E[∫₀ᵀ t dWₜ] = 0</li>
                <li>Var[∫₀ᵀ t dWₜ] = ∫₀ᵀ t² dt = T³/3</li>
            </ul>
            <p>Donc ∫₀ᵀ t dWₜ ~ N(0, T³/3)</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 3: LE LEMME D'ITÔ
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>3. Le Lemme d'Itô : La Formule Centrale</h2>

        <h3>3.1 Énoncé du Lemme d'Itô</h3>

        <div class="box">
            <h4>Théorème : Lemme d'Itô (version simple)</h4>
            <p>Soit Xₜ un processus d'Itô satisfaisant :</p>
            <p style="text-align: center; font-family: monospace;">dXₜ = μₜdt + σₜdWₜ</p>
            <p>Soit f(t,x) une fonction C¹ en t et C² en x. Alors Y = f(t,Xₜ) satisfait :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                df = (∂f/∂t + μ∂f/∂x + <span class="text-red">½σ²∂²f/∂x²</span>)dt + σ(∂f/∂x)dW
            </p>
            <p><strong>Le terme ½σ²∂²f/∂x²</strong> est le terme de correction d'Itô, absent du calcul classique.</p>
        </div>

        <div class="box">
            <h4>Théorème : Lemme d'Itô (version générale multidimensionnelle)</h4>
            <p>Soit X = (X₁,...,Xₙ) où dXᵢ = μᵢdt + Σⱼσᵢⱼ dWⱼ. Pour f(t,x₁,...,xₙ) ∈ C¹'² :</p>
            <p style="text-align: center; font-family: monospace; font-size: 14px; background: var(--bg-hover); padding: 10px; border-radius: 8px;">
                df = ∂f/∂t dt + Σᵢ ∂f/∂xᵢ dXᵢ + ½ΣᵢΣⱼ ∂²f/∂xᵢ∂xⱼ d⟨Xᵢ,Xⱼ⟩
            </p>
            <p>où d⟨Xᵢ,Xⱼ⟩ = Σₖ σᵢₖσⱼₖ dt est la covariation quadratique.</p>
        </div>

        <h3>3.2 Démonstration (idée)</h3>

        <div class="box">
            <h4>Preuve par développement de Taylor</h4>
            <p>On développe f(t+dt, X+dX) à l'ordre 2 :</p>
            <p style="font-family: monospace; font-size: 14px;">
                df = f(t+dt, X+dX) - f(t,X)<br>
                &nbsp;&nbsp;&nbsp;= ∂f/∂t dt + ∂f/∂x dX + ½∂²f/∂t² (dt)² + ∂²f/∂t∂x (dt)(dX) + ½∂²f/∂x² (dX)²
            </p>
            <p>En utilisant dX = μdt + σdW :</p>
            <ul>
                <li>(dt)² = 0</li>
                <li>(dt)(dX) = μ(dt)² + σ(dt)(dW) = 0</li>
                <li>(dX)² = μ²(dt)² + 2μσ(dt)(dW) + σ²(dW)² = σ²dt</li>
            </ul>
            <p>D'où le résultat avec le terme ½σ²(∂²f/∂x²)dt.</p>
        </div>

        <h3>3.3 Applications Fondamentales</h3>

        <div class="box">
            <h4>Application 1 : Solution du GBM</h4>
            <p><strong>Problème :</strong> Résoudre dS = μSdt + σSdW avec S(0) = S₀</p>
            <p><strong>Méthode :</strong> Posons Y = ln(S), donc f(S) = ln(S), f'(S) = 1/S, f''(S) = -1/S²</p>
            <p style="font-family: monospace; font-size: 14px;">
                d(ln S) = f'(S)dS + ½f''(S)(σS)²dt<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (1/S)(μSdt + σSdW) + ½(-1/S²)(σS)²dt<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (μ - ½σ²)dt + σdW
            </p>
            <p>En intégrant de 0 à t :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                ln(Sₜ) - ln(S₀) = (μ - ½σ²)t + σWₜ
            </p>
            <p><strong>Solution :</strong></p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                <span class="text-red">Sₜ = S₀ exp((μ - σ²/2)t + σWₜ)</span>
            </p>
        </div>

        <div class="box">
            <h4>Application 2 : d(S²) pour le GBM</h4>
            <p>Avec f(S) = S², f'(S) = 2S, f''(S) = 2 :</p>
            <p style="font-family: monospace; font-size: 14px;">
                d(S²) = 2S dS + ½ × 2 × (σS)² dt<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 2S(μSdt + σSdW) + σ²S²dt<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (2μ + σ²)S²dt + 2σS²dW
            </p>
            <p><strong>Interprétation :</strong> Le drift de S² n'est pas 2μ mais <span class="text-red">2μ + σ²</span> à cause du terme d'Itô.</p>
        </div>

        <div class="box">
            <h4>Application 3 : d(1/S) pour le GBM</h4>
            <p>Avec f(S) = 1/S, f'(S) = -1/S², f''(S) = 2/S³ :</p>
            <p style="font-family: monospace; font-size: 14px;">
                d(1/S) = (-1/S²) dS + ½(2/S³)(σS)² dt<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (-1/S²)(μSdt + σSdW) + σ²/S dt<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (-μ/S + σ²/S)dt - σ/S dW<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (σ² - μ)(1/S)dt - σ(1/S)dW
            </p>
        </div>

        <div class="box">
            <h4>Application 4 : d(eˢ) pour dS = σdW</h4>
            <p>Soit S un mouvement brownien avec drift nul. Avec f(S) = eˢ, f'(S) = f''(S) = eˢ :</p>
            <p style="font-family: monospace; font-size: 14px;">
                d(eˢ) = eˢ dS + ½eˢ(dS)²<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= eˢ σdW + ½eˢ σ² dt<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= eˢ(½σ²dt + σdW)
            </p>
            <p>Donc eˢ suit elle-même une EDS avec drift ½σ²eˢ.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 4: ÉQUATIONS DIFFÉRENTIELLES STOCHASTIQUES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>4. Équations Différentielles Stochastiques (EDS)</h2>

        <h3>4.1 Définition Générale</h3>

        <div class="box">
            <h4>Définition : Équation Différentielle Stochastique</h4>
            <p>Une EDS est une équation de la forme :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                dXₜ = μ(t, Xₜ)dt + σ(t, Xₜ)dWₜ
            </p>
            <p>avec condition initiale X₀ = x₀, où :</p>
            <ul>
                <li><span class="text-red">μ(t,x)</span> est le coefficient de <strong>drift</strong> (tendance déterministe)</li>
                <li><span class="text-red">σ(t,x)</span> est le coefficient de <strong>diffusion</strong> (volatilité)</li>
            </ul>
            <p>Forme intégrale équivalente :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                Xₜ = x₀ + ∫₀ᵗ μ(s, Xₛ)ds + ∫₀ᵗ σ(s, Xₛ)dWₛ
            </p>
        </div>

        <h3>4.2 Existence et Unicité des Solutions</h3>

        <div class="box">
            <h4>Théorème d'existence et unicité</h4>
            <p>Sous les conditions de <span class="text-red">Lipschitz</span> :</p>
            <ol>
                <li><strong>Lipschitz en x :</strong> |μ(t,x) - μ(t,y)| + |σ(t,x) - σ(t,y)| ≤ K|x - y|</li>
                <li><strong>Croissance linéaire :</strong> |μ(t,x)|² + |σ(t,x)|² ≤ C(1 + |x|²)</li>
            </ol>
            <p>alors l'EDS admet une <span class="text-red">solution forte unique</span>, continue en t.</p>
        </div>

        <h3>4.3 Classification des EDS par Type de Solution</h3>

        <table>
            <thead>
                <tr><th>Type d'EDS</th><th>Méthode de résolution</th><th>Exemple</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Linéaire</strong></td>
                    <td>Variation de la constante</td>
                    <td>dX = (aX + b)dt + (cX + d)dW</td>
                </tr>
                <tr>
                    <td><strong>Séparable</strong></td>
                    <td>Changement de variable</td>
                    <td>dS = μSdt + σSdW (GBM)</td>
                </tr>
                <tr>
                    <td><strong>Ornstein-Uhlenbeck</strong></td>
                    <td>Formule explicite</td>
                    <td>dX = κ(θ-X)dt + σdW</td>
                </tr>
                <tr>
                    <td><strong>Générale</strong></td>
                    <td>Numérique (Euler-Maruyama)</td>
                    <td>dX = μ(X)dt + σ(X)dW</td>
                </tr>
            </tbody>
        </table>

        <h3>4.4 EDS Fondamentales en Finance</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Mouvement Brownien Géométrique (GBM)</h4>
                <p style="font-family: monospace; text-align: center;">dS = μSdt + σSdW</p>
                <p><strong>Solution :</strong> Sₜ = S₀e^((μ-σ²/2)t + σWₜ)</p>
                <p><strong>Usage :</strong> Modèle de Black-Scholes pour les actions</p>
                <p><strong>Propriété :</strong> S reste toujours positif</p>
            </div>
            <div class="grid-item">
                <h4>Processus d'Ornstein-Uhlenbeck</h4>
                <p style="font-family: monospace; text-align: center;">dX = κ(θ - X)dt + σdW</p>
                <p><strong>Solution :</strong> Xₜ = θ + (X₀-θ)e^(-κt) + σ∫₀ᵗe^(-κ(t-s))dWₛ</p>
                <p><strong>Usage :</strong> Modélisation du mean-reversion</p>
                <p><strong>Propriété :</strong> Retour à la moyenne θ</p>
            </div>
        </div>

        <div class="box">
            <h4>Modèle de Vasicek (1977)</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                dr = κ(θ - r)dt + σdW
            </p>
            <p>C'est un Ornstein-Uhlenbeck appliqué aux taux d'intérêt :</p>
            <ul>
                <li><strong>κ</strong> : vitesse de retour à la moyenne</li>
                <li><strong>θ</strong> : taux long terme</li>
                <li><strong>σ</strong> : volatilité des taux</li>
            </ul>
            <p><strong>Solution :</strong> rₜ = θ + (r₀ - θ)e^(-κt) + σ∫₀ᵗe^(-κ(t-s))dWₛ</p>
            <p><strong>Distribution :</strong> rₜ | r₀ ~ N(θ + (r₀-θ)e^(-κt), σ²(1-e^(-2κt))/(2κ))</p>
            <p><strong>Limite :</strong> Le taux peut devenir négatif.</p>
        </div>

        <div class="box">
            <h4>Modèle CIR - Cox-Ingersoll-Ross (1985)</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                dr = κ(θ - r)dt + σ√r dW
            </p>
            <p>Amélioration de Vasicek où la diffusion est σ√r :</p>
            <ul>
                <li>La volatilité <span class="text-red">diminue quand r diminue</span></li>
                <li><strong>Condition de Feller :</strong> Si 2κθ ≥ σ², alors r reste <span class="text-green">strictement positif</span></li>
            </ul>
            <p><strong>Distribution :</strong> rₜ | r₀ suit une loi du χ² non-centrée</p>
            <p><strong>Usage :</strong> Modélisation des taux d'intérêt, volatilité stochastique</p>
        </div>

        <div class="box">
            <h4>Modèle de Heston (1993)</h4>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                dS = μSdt + √v S dW₁<br>
                dv = κ(θ - v)dt + ξ√v dW₂<br>
                d⟨W₁, W₂⟩ = ρdt
            </p>
            <p>Modèle à volatilité stochastique :</p>
            <ul>
                <li><strong>S</strong> : prix de l'actif</li>
                <li><strong>v</strong> : variance (suit un processus CIR)</li>
                <li><strong>ρ</strong> : corrélation entre les deux browniens (typiquement ρ < 0)</li>
                <li><strong>ξ</strong> : "volatilité de la volatilité"</li>
            </ul>
            <p><strong>Avantages :</strong> Capture le smile de volatilité, formule semi-analytique pour les options européennes.</p>
        </div>

        <h3>4.5 Résolution de l'EDS d'Ornstein-Uhlenbeck</h3>

        <div class="box">
            <h4>Démonstration complète</h4>
            <p>Résolvons dXₜ = κ(θ - Xₜ)dt + σdWₜ avec X₀ = x₀</p>
            <p><strong>Étape 1 :</strong> Posons Yₜ = e^(κt)(Xₜ - θ)</p>
            <p>Par le lemme d'Itô (f(t,x) = e^(κt)(x-θ)) :</p>
            <p style="font-family: monospace; font-size: 14px;">
                dYₜ = κe^(κt)(Xₜ - θ)dt + e^(κt)dXₜ<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= κe^(κt)(Xₜ - θ)dt + e^(κt)[κ(θ - Xₜ)dt + σdWₜ]<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= κe^(κt)(Xₜ - θ)dt - κe^(κt)(Xₜ - θ)dt + σe^(κt)dWₜ<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= σe^(κt)dWₜ
            </p>
            <p><strong>Étape 2 :</strong> Intégration</p>
            <p style="font-family: monospace; font-size: 14px;">
                Yₜ - Y₀ = σ∫₀ᵗ e^(κs)dWₛ<br>
                e^(κt)(Xₜ - θ) - (x₀ - θ) = σ∫₀ᵗ e^(κs)dWₛ
            </p>
            <p><strong>Étape 3 :</strong> Solution finale</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Xₜ = θ + (x₀ - θ)e^(-κt) + σe^(-κt)∫₀ᵗ e^(κs)dWₛ
            </p>
            <p>ou de manière équivalente :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                Xₜ = θ + (x₀ - θ)e^(-κt) + σ∫₀ᵗ e^(-κ(t-s))dWₛ
            </p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 5: SCHÉMAS NUMÉRIQUES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>5. Simulation Numérique des EDS</h2>

        <h3>5.1 Schéma d'Euler-Maruyama</h3>

        <div class="box">
            <h4>Algorithme d'Euler-Maruyama</h4>
            <p>Pour dXₜ = μ(t,Xₜ)dt + σ(t,Xₜ)dWₜ :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Xₜ₊Δₜ = Xₜ + μ(t,Xₜ)Δt + σ(t,Xₜ)√Δt × Z
            </p>
            <p>où Z ~ N(0,1) est une variable normale standard.</p>
            <p><strong>Erreur de convergence :</strong> O(√Δt) (convergence faible), O(Δt) (convergence forte)</p>
        </div>

        <div class="box">
            <h4>Implémentation pour le GBM</h4>
            <p>Pour dS = μSdt + σSdW :</p>
            <p style="font-family: monospace; font-size: 14px; background: var(--bg-hover); padding: 10px; border-radius: 8px;">
                # Schéma d'Euler (forme naïve)<br>
                S[i+1] = S[i] * (1 + μ*dt + σ*√dt*Z[i])<br><br>
                # Schéma log-Euler (plus précis, préserve positivité)<br>
                S[i+1] = S[i] * exp((μ - σ²/2)*dt + σ*√dt*Z[i])
            </p>
            <p>Le schéma log-Euler correspond à la discrétisation de la solution exacte.</p>
        </div>

        <h3>5.2 Schéma de Milstein (ordre supérieur)</h3>

        <div class="box">
            <h4>Algorithme de Milstein</h4>
            <p>Pour améliorer la précision (convergence forte d'ordre 1) :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Xₜ₊Δₜ = Xₜ + μΔt + σ√Δt×Z + ½σ(∂σ/∂x)(Z² - 1)Δt
            </p>
            <p>Pour le GBM où σ(X) = σX, donc ∂σ/∂x = σ :</p>
            <p style="font-family: monospace; font-size: 14px;">
                S[i+1] = S[i] + μS[i]Δt + σS[i]√Δt×Z + ½σ²S[i](Z² - 1)Δt
            </p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             GRAPHIQUE : COMPARAISON DES SCHÉMAS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h3>Visualisation : Comparaison des Schémas de Simulation</h3>
        <div class="chart-container">
            <canvas id="itoSchemasChart"></canvas>
        </div>
        <p class="caption">Comparaison des schémas d'Euler et Milstein pour la simulation du GBM. Le schéma exact (analytique) sert de référence.</p>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             EXERCICES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="exercices-m10">Exercices</h2>

        <div class="exercise-box">
            <h4>Exercice 1 : Lemme d'Itô sur S²</h4>
            <p>Un actif suit le GBM : dS = 0.1Sdt + 0.2SdW</p>
            <p><strong>Question :</strong> En utilisant le lemme d'Itô avec f(S) = S², trouvez le coefficient de dt dans d(S²).</p>
            <p><em>Indication : f'(S) = 2S, f''(S) = 2. Utilisez df = f'dS + ½f''(σS)²dt</em></p>

            <input type="text" class="exercise-calc-input" id="m10-ito" placeholder="Coefficient = ?">
            <button class="check-btn" onclick="checkM10Ito()">Vérifier</button>
            <div id="feedback-m10-ito" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Application du lemme d'Itô :</strong></p>
                    <p>d(S²) = f'(S)dS + ½f''(S)(dS)²</p>
                    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 2S(μSdt + σSdW) + ½ × 2 × (σS)²dt</p>
                    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 2μS²dt + 2σS²dW + σ²S²dt</p>
                    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="text-red">(2μ + σ²)</span>S²dt + 2σS²dW</p>
                    <p><strong>Calcul numérique :</strong></p>
                    <p>Coefficient = 2 × 0.1 + (0.2)² = 0.2 + 0.04 = <span class="text-red">0.24</span></p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 2 : Intégrale d'Itô</h4>
            <p>Calculez E[(∫₀¹ t dWₜ)²] en utilisant l'isométrie d'Itô.</p>

            <input type="text" class="exercise-calc-input" id="m10-iso" placeholder="E[I²] = ?">
            <button class="check-btn" onclick="checkM10Iso()">Vérifier</button>
            <div id="feedback-m10-iso" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Isométrie d'Itô :</strong> E[(∫₀ᵀ f(t)dWₜ)²] = E[∫₀ᵀ f(t)²dt]</p>
                    <p>Ici f(t) = t est déterministe, donc :</p>
                    <p>E[(∫₀¹ t dWₜ)²] = ∫₀¹ t² dt = [t³/3]₀¹ = <span class="text-red">1/3 ≈ 0.333</span></p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 3 : Solution d'Ornstein-Uhlenbeck</h4>
            <p>Un processus suit dX = 0.5(2 - X)dt + 0.3dW avec X₀ = 1.</p>
            <p><strong>Question :</strong> Quelle est l'espérance E[X₁] au temps t = 1 ?</p>

            <input type="text" class="exercise-calc-input" id="m10-ou" placeholder="E[X₁] = ?">
            <button class="check-btn" onclick="checkM10OU()">Vérifier</button>
            <div id="feedback-m10-ou" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Formule de la solution OU :</strong></p>
                    <p>Xₜ = θ + (X₀ - θ)e^(-κt) + σ∫₀ᵗe^(-κ(t-s))dWₛ</p>
                    <p>Avec κ = 0.5, θ = 2, X₀ = 1, t = 1 :</p>
                    <p>E[Xₜ] = θ + (X₀ - θ)e^(-κt) = 2 + (1 - 2)e^(-0.5)</p>
                    <p>E[X₁] = 2 - e^(-0.5) = 2 - 0.6065 ≈ <span class="text-red">1.39</span></p>
                    <p>(L'intégrale stochastique a espérance nulle)</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 4 : Lemme d'Itô sur ln(S)</h4>
            <p>Soit dS = μSdt + σSdW. En appliquant le lemme d'Itô à f(S) = ln(S) :</p>
            <p><strong>Question :</strong> Quel est le coefficient de dt dans d(ln S) ? (en fonction de μ et σ)</p>
            <p><em>Répondez sous la forme "μ - 0.5σ²" si c'est μ - ½σ²</em></p>

            <input type="text" class="exercise-calc-input" id="m10-log" placeholder="Coefficient dt = ?">
            <button class="check-btn" onclick="checkM10Log()">Vérifier</button>
            <div id="feedback-m10-log" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Calcul :</strong></p>
                    <p>f(S) = ln(S), f'(S) = 1/S, f''(S) = -1/S²</p>
                    <p>d(ln S) = f'(S)dS + ½f''(S)(σS)²dt</p>
                    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (1/S)(μSdt + σSdW) + ½(-1/S²)(σS)²dt</p>
                    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= μdt + σdW - ½σ²dt</p>
                    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="text-red">(μ - ½σ²)</span>dt + σdW</p>
                    <p>Le coefficient est <span class="text-red">μ - 0.5σ²</span> (ou μ - σ²/2)</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 5 : Condition de Feller pour CIR</h4>
            <p>Le modèle CIR : dr = κ(θ - r)dt + σ√r dW avec κ = 0.3, θ = 0.05, σ = 0.1</p>
            <p><strong>Question :</strong> La condition de Feller (2κθ ≥ σ²) est-elle satisfaite ? Le taux peut-il devenir négatif ?</p>

            <input type="text" class="exercise-calc-input" id="m10-feller" placeholder="2κθ = ? et σ² = ?">
            <button class="check-btn" onclick="checkM10Feller()">Vérifier</button>
            <div id="feedback-m10-feller" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Calcul de la condition de Feller :</strong></p>
                    <p>2κθ = 2 × 0.3 × 0.05 = <span class="text-red">0.03</span></p>
                    <p>σ² = 0.1² = <span class="text-red">0.01</span></p>
                    <p>Comme 0.03 > 0.01, la condition 2κθ ≥ σ² est <span class="text-green">SATISFAITE</span>.</p>
                    <p><strong>Conclusion :</strong> Le taux r reste strictement positif avec probabilité 1.</p>
                </div>
            </details>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             FLASHCARDS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="flashcards-m10">Flashcards</h2>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi (dW)² = dt ?</p></div>
                    <div class="flashcard-back"><p>C'est la propriété de variation quadratique du mouvement brownien. La somme Σ(ΔWᵢ)² converge vers T (et non 0) quand la partition s'affine.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la différence entre les intégrales d'Itô et de Stratonovich ?</p></div>
                    <div class="flashcard-back"><p>Itô évalue au point gauche (non-anticipatif, martingale). Stratonovich évalue au milieu (règles classiques, pas martingale). La finance utilise Itô.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>D'où vient le terme ½σ²∂²f/∂x² dans le lemme d'Itô ?</p></div>
                    <div class="flashcard-back"><p>Du développement de Taylor à l'ordre 2. Le terme en (dX)² n'est pas négligeable car (dW)² = dt, contrairement au calcul classique.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que l'isométrie d'Itô ?</p></div>
                    <div class="flashcard-back"><p>E[(∫f dW)²] = E[∫f² dt]. La variance de l'intégrale stochastique égale l'intégrale des variances.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi E[∫f dWₜ] = 0 ?</p></div>
                    <div class="flashcard-back"><p>L'intégrale d'Itô est une martingale. Pour une martingale M, E[Mₜ] = E[M₀] = 0 (si on part de 0).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la solution du GBM dS = μSdt + σSdW ?</p></div>
                    <div class="flashcard-back"><p>Sₜ = S₀ exp((μ - σ²/2)t + σWₜ). Le drift effectif est μ - σ²/2 (correction d'Itô).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le processus d'Ornstein-Uhlenbeck modélise ?</p></div>
                    <div class="flashcard-back"><p>Le mean-reversion : le processus tend à revenir vers sa moyenne θ avec vitesse κ. Utilisé pour les taux d'intérêt (Vasicek).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la condition de Feller pour le modèle CIR ?</p></div>
                    <div class="flashcard-back"><p>2κθ ≥ σ². Si satisfaite, le taux r reste strictement positif. Sinon, r peut toucher 0.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Comment calcule-t-on ∫₀ᵀ Wₜ dWₜ ?</p></div>
                    <div class="flashcard-back"><p>∫₀ᵀ Wₜ dWₜ = ½W²ₜ - ½T. Ce n'est PAS W²/2 comme en calcul classique à cause de la correction -½T.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le schéma d'Euler-Maruyama ?</p></div>
                    <div class="flashcard-back"><p>Xₜ₊Δₜ = Xₜ + μΔt + σ√Δt×Z. Discrétisation de l'EDS pour simulation numérique. Convergence en O(√Δt).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi le modèle de Heston utilise-t-il deux browniens corrélés ?</p></div>
                    <div class="flashcard-back"><p>Pour capturer l'effet de levier : quand le prix baisse (dW₁ < 0), la volatilité augmente (dW₂ corrélé). Typiquement ρ ≈ -0.7.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Comment Itô a-t-il construit son intégrale ?</p></div>
                    <div class="flashcard-back"><p>Comme limite de sommes de Riemann Σf(tᵢ)(Wₜᵢ₊₁-Wₜᵢ), où f est évalué au point gauche (non-anticipatif).</p></div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module9')">⬅ Précédent : Mouvement Brownien</button>
            <button class="nav-btn" onclick="showModule('module11')">Suivant : Martingales ➡</button>
        </div>
    </section>

    <section id="module11" class="module">
        <header class="module-header">
            <h1>Module 11 : Martingales et Mesures de Probabilité</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>180 minutes</span>
                <span>Prérequis : Modules 7, 9, 10</span>
            </div>
        </header>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             INTRODUCTION ET CONTEXTE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/Joseph_Leo_Doob.jpg/440px-Joseph_Leo_Doob.jpg" alt="Joseph Doob">
            <figcaption>Joseph L. Doob (1910-2004) - Mathématicien américain qui a formalisé la théorie des martingales</figcaption>
        </figure>

        <h4>Objectifs du Module</h4>
        <ul>
            <li>Comprendre le concept fondamental de martingale et ses propriétés</li>
            <li>Maîtriser les filtrations et l'information en finance</li>
            <li>Appliquer le théorème de Girsanov pour le changement de mesure</li>
            <li>Comprendre la mesure risque-neutre et son rôle en pricing</li>
            <li>Maîtriser le théorème fondamental de l'évaluation des actifs (FTAP)</li>
            <li>Utiliser le théorème de représentation des martingales</li>
        </ul>

        <div class="box">
            <h4>Les Martingales : Le Cœur de la Finance Mathématique</h4>
            <p>Le concept de <span class="text-red">martingale</span> est l'un des plus importants en finance mathématique. Intuitivement, une martingale est un "jeu équitable" : la meilleure prédiction de la valeur future est la valeur actuelle.</p>
            <p>En finance, les martingales permettent de formuler le principe fondamental : <span class="text-red">l'absence d'arbitrage équivaut à l'existence d'une mesure de probabilité sous laquelle les prix actualisés sont des martingales</span>. Ce résultat, connu sous le nom de FTAP (Fundamental Theorem of Asset Pricing), est la pierre angulaire du pricing de dérivés.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             TIMELINE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>Chronologie de la Théorie des Martingales</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1654</div>
                <div class="timeline-content">
                    <h4>Pascal et Fermat - Correspondance</h4>
                    <p>Résolution du "problème des points" : comment partager équitablement les mises d'un jeu interrompu ? C'est l'ancêtre conceptuel des martingales.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1906</div>
                <div class="timeline-content">
                    <h4>Andrei Markov - Chaînes de Markov</h4>
                    <p>Introduction des processus à mémoire limitée. Les martingales généralisent cette notion en permettant une dépendance arbitraire au passé.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1934</div>
                <div class="timeline-content">
                    <h4>Paul Lévy - Premier usage du terme "martingale"</h4>
                    <p>Lévy utilise le terme (emprunté aux jeux de hasard) pour décrire des processus où l'espérance conditionnelle du futur égale le présent.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1953</div>
                <div class="timeline-content">
                    <h4>Joseph Doob - Formalisation rigoureuse</h4>
                    <p>Publication de "Stochastic Processes", ouvrage fondateur qui établit la théorie moderne des martingales avec les concepts de filtration et temps d'arrêt.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1965</div>
                <div class="timeline-content">
                    <h4>Paul-André Meyer - École française</h4>
                    <p>Développement de la théorie générale des processus. Meyer et l'école de Strasbourg perfectionnent le calcul stochastique.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1972</div>
                <div class="timeline-content">
                    <h4>Igor Girsanov - Changement de mesure</h4>
                    <p>Théorème de Girsanov permettant de transformer le drift d'un processus en changeant de mesure de probabilité. Outil fondamental pour le pricing.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1979</div>
                <div class="timeline-content">
                    <h4>Harrison & Kreps - Martingales et arbitrage</h4>
                    <p>"Martingales and Arbitrage in Multiperiod Securities Markets" : première démonstration du lien entre absence d'arbitrage et mesure martingale.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1981</div>
                <div class="timeline-content">
                    <h4>Harrison & Pliska - FTAP en temps continu</h4>
                    <p>Extension au cas continu : l'absence d'arbitrage est équivalente à l'existence d'une mesure martingale équivalente. Base de tout le pricing moderne.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1994</div>
                <div class="timeline-content">
                    <h4>Delbaen & Schachermayer - FTAP général</h4>
                    <p>Démonstration complète du FTAP dans le cas le plus général (semimartingales). Résultat définitif pour les marchés à temps continu.</p>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 1: DÉFINITIONS ET CONCEPTS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>1. Définitions Fondamentales</h2>

        <h3>1.1 Filtration et Information</h3>

        <div class="box">
            <h4>Définition : Filtration</h4>
            <p>Une <span class="text-red">filtration</span> {Fₜ}ₜ≥₀ est une famille croissante de σ-algèbres :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                Fₛ ⊆ Fₜ pour tout s ≤ t
            </p>
            <p><strong>Interprétation :</strong> Fₜ représente l'<span class="text-red">information disponible au temps t</span>. Plus le temps avance, plus on a d'information.</p>
        </div>

        <div class="box">
            <h4>Filtration Naturelle du Mouvement Brownien</h4>
            <p>La filtration naturelle de W est :</p>
            <p style="text-align: center; font-family: monospace;">
                Fₜ = σ(Wₛ : 0 ≤ s ≤ t)
            </p>
            <p>C'est la plus petite σ-algèbre qui rend les Wₛ mesurables pour s ≤ t. Elle contient toute l'information générée par l'observation du brownien jusqu'au temps t.</p>
        </div>

        <div class="box">
            <h4>Définition : Processus Adapté</h4>
            <p>Un processus {Xₜ}ₜ≥₀ est <span class="text-red">adapté</span> à la filtration {Fₜ} si :</p>
            <p style="text-align: center; font-family: monospace;">
                Xₜ est Fₜ-mesurable pour tout t
            </p>
            <p><strong>Intuition :</strong> La valeur de Xₜ ne dépend que de l'information disponible au temps t, pas du futur.</p>
        </div>

        <h3>1.2 Définition des Martingales</h3>

        <div class="box">
            <h4>Définition : Martingale</h4>
            <p>Un processus {Mₜ}ₜ≥₀ adapté à {Fₜ} est une <span class="text-red">martingale</span> si :</p>
            <ol>
                <li><strong>Intégrabilité :</strong> E[|Mₜ|] < ∞ pour tout t</li>
                <li><strong>Propriété de martingale :</strong> <span class="text-red">E[Mₜ | Fₛ] = Mₛ</span> pour tout s ≤ t</li>
            </ol>
            <p><strong>Interprétation :</strong> Connaissant l'information jusqu'à s, la meilleure prédiction de Mₜ est simplement Mₛ.</p>
        </div>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Sous-Martingale</h4>
                <p style="font-family: monospace; text-align: center;">E[Mₜ | Fₛ] ≥ Mₛ</p>
                <p>Tendance à <span class="text-green">monter</span> en moyenne</p>
                <p>Exemple : Processus croissant</p>
            </div>
            <div class="grid-item">
                <h4>Sur-Martingale</h4>
                <p style="font-family: monospace; text-align: center;">E[Mₜ | Fₛ] ≤ Mₛ</p>
                <p>Tendance à <span class="text-red">descendre</span> en moyenne</p>
                <p>Exemple : Stratégie perdante au casino</p>
            </div>
        </div>

        <h3>1.3 Exemples Fondamentaux</h3>

        <div class="box">
            <h4>Exemple 1 : Le Mouvement Brownien est une Martingale</h4>
            <p><strong>Vérification :</strong> Pour s < t :</p>
            <p style="font-family: monospace; font-size: 14px;">
                E[Wₜ | Fₛ] = E[Wₛ + (Wₜ - Wₛ) | Fₛ]<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= Wₛ + E[Wₜ - Wₛ | Fₛ]  (Wₛ est Fₛ-mesurable)<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= Wₛ + E[Wₜ - Wₛ]      (indépendance des incréments)<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= Wₛ + 0 = Wₛ           ✓
            </p>
        </div>

        <div class="box">
            <h4>Exemple 2 : Wₜ² - t est une Martingale</h4>
            <p><strong>Vérification :</strong> Soit Mₜ = Wₜ² - t. Pour s < t :</p>
            <p style="font-family: monospace; font-size: 14px;">
                E[Wₜ² | Fₛ] = E[(Wₛ + (Wₜ - Wₛ))² | Fₛ]<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= E[Wₛ² + 2Wₛ(Wₜ-Wₛ) + (Wₜ-Wₛ)² | Fₛ]<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= Wₛ² + 0 + (t-s) = Wₛ² + t - s
            </p>
            <p>Donc E[Wₜ² - t | Fₛ] = Wₛ² + t - s - t = Wₛ² - s = Mₛ ✓</p>
        </div>

        <div class="box">
            <h4>Exemple 3 : Intégrale d'Itô est une Martingale</h4>
            <p>Pour tout processus adapté f avec E[∫f²dt] < ∞ :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                Iₜ = ∫₀ᵗ f(s)dWₛ est une martingale
            </p>
            <p><strong>Conséquence :</strong> E[∫₀ᵀ f(s)dWₛ] = E[I₀] = 0</p>
        </div>

        <div class="box">
            <h4>Exemple 4 : Exponentielle Stochastique</h4>
            <p>Le processus :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                Zₜ = exp(λWₜ - ½λ²t)
            </p>
            <p>est une martingale pour tout λ ∈ ℝ. C'est la <span class="text-red">martingale exponentielle</span>, cruciale pour le théorème de Girsanov.</p>
            <p><strong>Vérification :</strong> E[Zₜ] = E[e^(λWₜ - ½λ²t)] = e^(-½λ²t) × e^(½λ²t) = 1</p>
        </div>

        <h3>1.4 Non-Exemples (Ce qui n'est PAS une martingale)</h3>

        <div class="box">
            <h4>Non-Exemple 1 : GBM sous la mesure physique</h4>
            <p>Sous P, dS = μSdt + σSdW avec μ ≠ r.</p>
            <p>Le prix actualisé e⁻ʳᵗSₜ <span class="text-red">n'est pas</span> une martingale car :</p>
            <p style="font-family: monospace;">
                E[e⁻ʳᵗSₜ] = S₀e^((μ-r)t) ≠ S₀ si μ ≠ r
            </p>
            <p>C'est pour cela qu'on a besoin du changement de mesure !</p>
        </div>

        <div class="box">
            <h4>Non-Exemple 2 : Wₜ² (sans correction)</h4>
            <p>Le processus Wₜ² seul n'est pas une martingale :</p>
            <p style="font-family: monospace;">
                E[Wₜ² | Fₛ] = Wₛ² + (t-s) ≠ Wₛ²
            </p>
            <p>C'est une <span class="text-red">sous-martingale</span> (tendance à augmenter).</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 2: PROPRIÉTÉS DES MARTINGALES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>2. Propriétés Fondamentales des Martingales</h2>

        <h3>2.1 Propriétés de Base</h3>

        <div class="box">
            <h4>Propriété 1 : Espérance Constante</h4>
            <p>Si M est une martingale, alors :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                E[Mₜ] = E[M₀] pour tout t ≥ 0
            </p>
            <p><strong>Preuve :</strong> E[Mₜ] = E[E[Mₜ|F₀]] = E[M₀]</p>
        </div>

        <div class="box">
            <h4>Propriété 2 : Combinaison Linéaire</h4>
            <p>Si M et N sont des martingales et α, β sont des constantes, alors αM + βN est aussi une martingale.</p>
        </div>

        <div class="box">
            <h4>Propriété 3 : Tour de la Loi (Law of Iterated Expectations)</h4>
            <p>Pour s ≤ u ≤ t :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                E[Mₜ | Fₛ] = E[E[Mₜ | Fᵤ] | Fₛ] = E[Mᵤ | Fₛ] = Mₛ
            </p>
            <p>L'information intermédiaire n'aide pas à mieux prédire !</p>
        </div>

        <h3>2.2 Inégalités de Doob</h3>

        <div class="box">
            <h4>Théorème : Inégalité Maximale de Doob</h4>
            <p>Soit M une martingale positive. Pour tout λ > 0 :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                P(max₀≤s≤t Mₛ ≥ λ) ≤ E[Mₜ] / λ
            </p>
            <p><strong>Application :</strong> Contrôler la probabilité que le maximum dépasse un seuil.</p>
        </div>

        <div class="box">
            <h4>Théorème : Inégalité Lᵖ de Doob</h4>
            <p>Pour p > 1 et M martingale :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                E[(max₀≤s≤t |Mₛ|)ᵖ] ≤ (p/(p-1))ᵖ E[|Mₜ|ᵖ]
            </p>
            <p>Le maximum en norme Lᵖ est contrôlé par la valeur finale.</p>
        </div>

        <h3>2.3 Temps d'Arrêt et Théorème d'Arrêt Optionnel</h3>

        <div class="box">
            <h4>Définition : Temps d'Arrêt</h4>
            <p>Une variable aléatoire τ : Ω → [0,∞] est un <span class="text-red">temps d'arrêt</span> si :</p>
            <p style="text-align: center; font-family: monospace;">
                {τ ≤ t} ∈ Fₜ pour tout t ≥ 0
            </p>
            <p><strong>Interprétation :</strong> La décision "τ s'est-il produit avant t ?" ne dépend que de l'information disponible en t.</p>
        </div>

        <div class="box">
            <h4>Exemples de Temps d'Arrêt</h4>
            <ul>
                <li><strong>Temps de premier passage :</strong> τ = inf{t : Wₜ = a}</li>
                <li><strong>Stop-loss :</strong> τ = inf{t : Sₜ ≤ B} (prix touche une barrière)</li>
                <li><strong>Take-profit :</strong> τ = inf{t : Sₜ ≥ H}</li>
            </ul>
        </div>

        <div class="box">
            <h4>Théorème : Arrêt Optionnel (Optional Stopping)</h4>
            <p>Soit M une martingale bornée et τ un temps d'arrêt borné (τ ≤ T p.s.). Alors :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                E[Mᵗ] = E[M₀]
            </p>
            <p><strong>Application financière :</strong> Dans un jeu équitable, aucune stratégie d'arrêt ne peut créer de profit espéré !</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 3: THÉORÈME DE GIRSANOV
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>3. Changement de Mesure : Théorème de Girsanov</h2>

        <h3>3.1 Motivation</h3>

        <div class="box">
            <h4>Le Problème</h4>
            <p>Sous la mesure physique P, un actif suit :</p>
            <p style="text-align: center; font-family: monospace;">dS = μSdt + σSdW^P</p>
            <p>Le prix actualisé e⁻ʳᵗS n'est <span class="text-red">pas</span> une martingale (si μ ≠ r).</p>
            <p><strong>Question :</strong> Peut-on trouver une mesure Q sous laquelle e⁻ʳᵗS <em>est</em> une martingale ?</p>
            <p>Le théorème de Girsanov répond : <span class="text-green">OUI !</span></p>
        </div>

        <h3>3.2 Dérivée de Radon-Nikodym</h3>

        <div class="box">
            <h4>Définition : Densité de Radon-Nikodym</h4>
            <p>Deux mesures P et Q sont <span class="text-red">équivalentes</span> (P ~ Q) si elles ont les mêmes événements de probabilité nulle.</p>
            <p>Dans ce cas, il existe une variable aléatoire Zₜ (la <span class="text-red">dérivée de Radon-Nikodym</span>) telle que :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                E^Q[X] = E^P[ZₜX] pour tout X ∈ Fₜ
            </p>
            <p>On note Zₜ = dQ/dP |_{Fₜ}</p>
        </div>

        <h3>3.3 Énoncé du Théorème de Girsanov</h3>

        <div class="box">
            <h4>Théorème de Girsanov</h4>
            <p>Soit Wₜ^P un mouvement brownien sous P et θ un processus adapté. Définissons :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                Zₜ = exp(-∫₀ᵗ θₛdWₛ^P - ½∫₀ᵗ θₛ²ds)
            </p>
            <p>Si E^P[Zₜ] = 1 (condition de Novikov), alors sous la mesure Q définie par dQ/dP = Zₜ :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Wₜ^Q = Wₜ^P + ∫₀ᵗ θₛds est un mouvement brownien sous Q
            </p>
        </div>

        <div class="box">
            <h4>Condition de Novikov</h4>
            <p>La condition E^P[Zₜ] = 1 est garantie si :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                E^P[exp(½∫₀ᵀ θₛ²ds)] < ∞
            </p>
            <p>C'est la <span class="text-red">condition de Novikov</span>, vérifiée si θ est borné.</p>
        </div>

        <h3>3.4 Application au Pricing</h3>

        <div class="box">
            <h4>Du Monde Physique au Monde Risque-Neutre</h4>
            <p><strong>Sous P :</strong> dS = <span class="text-red">μ</span>Sdt + σSdW^P</p>
            <p>Prenons θ = (μ - r)/σ (le <span class="text-red">prix du risque de marché</span>)</p>
            <p>Par Girsanov, W^Q = W^P + θt est un brownien sous Q.</p>
            <p>Donc dW^P = dW^Q - θdt = dW^Q - ((μ-r)/σ)dt</p>
            <p style="font-family: monospace; font-size: 14px;">
                dS = μSdt + σS(dW^Q - ((μ-r)/σ)dt)<br>
                &nbsp;&nbsp;&nbsp;= μSdt + σSdW^Q - (μ-r)Sdt<br>
                &nbsp;&nbsp;&nbsp;= <span class="text-green">r</span>Sdt + σSdW^Q
            </p>
            <p><strong>Sous Q :</strong> dS = <span class="text-green">r</span>Sdt + σSdW^Q</p>
            <p>Le drift μ a été remplacé par r ! Le prix actualisé est maintenant une martingale sous Q.</p>
        </div>

        <div class="box">
            <h4>La Densité de Girsanov</h4>
            <p>Pour le changement P → Q en finance :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                dQ/dP = exp(-θWₜ^P - ½θ²t) où θ = (μ - r)/σ
            </p>
            <p><strong>Note :</strong> θ est appelé <span class="text-red">prix du risque de marché</span> ou <span class="text-red">ratio de Sharpe</span>.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 4: MESURE RISQUE-NEUTRE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>4. La Mesure Risque-Neutre</h2>

        <h3>4.1 Définition et Propriétés</h3>

        <div class="box">
            <h4>Définition : Mesure Risque-Neutre (ou Mesure Martingale Équivalente)</h4>
            <p>Une mesure Q équivalente à P est <span class="text-red">risque-neutre</span> si les prix actualisés de tous les actifs négociables sont des Q-martingales :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                E^Q[e⁻ʳᵗSₜ | Fₛ] = e⁻ʳˢSₛ pour tout s ≤ t
            </p>
        </div>

        <div class="box">
            <h4>Caractérisation de Q</h4>
            <p>Sous la mesure risque-neutre Q :</p>
            <ol>
                <li><strong>Tous les actifs</strong> ont un rendement espéré égal à r (taux sans risque)</li>
                <li><strong>Les prix actualisés</strong> sont des martingales</li>
                <li><strong>Le drift</strong> de tout actif sous Q est r, pas μ</li>
            </ol>
            <p><strong>Attention :</strong> Q n'est pas la probabilité "réelle" ! C'est un outil de calcul.</p>
        </div>

        <h3>4.2 Formule de Pricing Fondamentale</h3>

        <div class="box">
            <h4>Le Prix comme Espérance</h4>
            <p>Sous Q, le prix au temps t d'un dérivé de payoff h(Sₜ) à maturité T est :</p>
            <p style="text-align: center; font-family: monospace; font-size: 20px; background: var(--bg-hover); padding: 20px; border-radius: 8px;">
                V(t,S) = <span class="text-red">e^(-r(T-t)) E^Q[h(Sₜ) | Fₜ]</span>
            </p>
            <p><strong>Interprétation :</strong> Le prix est la valeur actualisée de l'espérance du payoff, calculée sous Q.</p>
        </div>

        <div class="box">
            <h4>Exemple : Prix d'un Call Européen</h4>
            <p>Pour un call de strike K, maturité T :</p>
            <p style="font-family: monospace; font-size: 14px;">
                C = e^(-rT) E^Q[max(Sₜ - K, 0)]<br>
                &nbsp;&nbsp;= e^(-rT) E^Q[(Sₜ - K)⁺]
            </p>
            <p>Sous Q, Sₜ = S₀exp((r - σ²/2)T + σWₜ^Q), donc :</p>
            <p style="text-align: center; font-family: monospace;">
                C = S₀Φ(d₁) - Ke^(-rT)Φ(d₂)
            </p>
            <p>C'est la formule de Black-Scholes !</p>
        </div>

        <h3>4.3 Pourquoi "Risque-Neutre" ?</h3>

        <div class="box">
            <h4>Un Monde Fictif</h4>
            <p>Sous Q, tous les actifs ont le même rendement espéré r, quels que soient leurs risques. C'est comme si les investisseurs étaient <span class="text-red">indifférents au risque</span> (risk-neutral).</p>
            <p><strong>Mais attention :</strong></p>
            <ul>
                <li>Q n'est <em>pas</em> la vraie probabilité</li>
                <li>Les investisseurs réels <em>sont</em> averses au risque</li>
                <li>Q est un <span class="text-red">outil de calcul</span> qui incorpore implicitement l'aversion au risque via le changement de mesure</li>
            </ul>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 5: FTAP
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>5. Théorème Fondamental de l'Évaluation des Actifs (FTAP)</h2>

        <h3>5.1 Premier Théorème Fondamental</h3>

        <div class="box">
            <h4>Théorème : 1er FTAP (Harrison-Pliska 1981)</h4>
            <p>Dans un marché à temps continu, les deux conditions suivantes sont équivalentes :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                <span class="text-red">Absence d'arbitrage</span> ⟺ ∃ <span class="text-red">mesure martingale équivalente</span> Q
            </p>
            <p><strong>Implications :</strong></p>
            <ul>
                <li>Si Q existe, on ne peut pas faire d'argent sans risque</li>
                <li>Si on peut faire de l'arbitrage, Q n'existe pas</li>
            </ul>
        </div>

        <div class="box">
            <h4>Définition Précise : Arbitrage</h4>
            <p>Une <span class="text-red">opportunité d'arbitrage</span> est une stratégie auto-finançante telle que :</p>
            <ol>
                <li>Valeur initiale V₀ = 0</li>
                <li>Valeur finale Vₜ ≥ 0 p.s.</li>
                <li>P(Vₜ > 0) > 0</li>
            </ol>
            <p>"Démarrer sans rien, ne jamais perdre, parfois gagner" — c'est impossible si Q existe.</p>
        </div>

        <h3>5.2 Deuxième Théorème Fondamental</h3>

        <div class="box">
            <h4>Théorème : 2ème FTAP</h4>
            <p>Dans un marché sans arbitrage :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                <span class="text-red">Marché complet</span> ⟺ <span class="text-red">Q unique</span>
            </p>
            <p><strong>Marché complet :</strong> Tout payoff contingent peut être répliqué par une stratégie de trading.</p>
        </div>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Marché Complet (Q unique)</h4>
                <ul>
                    <li>Exemple : Black-Scholes (1 action, 1 brownien)</li>
                    <li>Tout dérivé peut être répliqué</li>
                    <li>Prix unique (pas d'ambiguïté)</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Marché Incomplet (plusieurs Q)</h4>
                <ul>
                    <li>Exemple : Volatilité stochastique (2 browniens, 1 action)</li>
                    <li>Certains payoffs non réplicables</li>
                    <li>Intervalle de prix possibles</li>
                </ul>
            </div>
        </div>

        <h3>5.3 Conséquences Pratiques</h3>

        <div class="box">
            <h4>Application au Pricing</h4>
            <ol>
                <li><strong>Vérifier l'absence d'arbitrage :</strong> Le modèle doit avoir une mesure Q</li>
                <li><strong>Calculer sous Q :</strong> Prix = e^(-rT) E^Q[payoff]</li>
                <li><strong>Répliquer :</strong> Si Q unique, on peut construire le portefeuille de couverture</li>
            </ol>
        </div>

        <blockquote>
            <p>"Le prix de non-arbitrage d'un dérivé est l'espérance de son payoff actualisé sous la mesure risque-neutre. C'est aussi le coût de la stratégie de réplication."</p>
            <cite>Harrison & Pliska, 1981</cite>
        </blockquote>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 6: THÉORÈME DE REPRÉSENTATION
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>6. Théorème de Représentation des Martingales</h2>

        <div class="box">
            <h4>Théorème de Représentation</h4>
            <p>Si M est une martingale de carré intégrable par rapport à la filtration brownienne, alors il existe un processus adapté φ tel que :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Mₜ = M₀ + ∫₀ᵗ φₛdWₛ
            </p>
            <p><strong>Interprétation :</strong> Toute martingale brownienne peut s'écrire comme une intégrale stochastique !</p>
        </div>

        <div class="box">
            <h4>Application au Hedging</h4>
            <p>Le prix actualisé d'un dérivé V(t,S)e^(-rt) est une Q-martingale. Par le théorème de représentation :</p>
            <p style="font-family: monospace;">
                d(e^(-rt)V) = φₜ dW^Q = φₜ/σS × σSdW^Q
            </p>
            <p>Donc la stratégie de couverture (delta) est :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                Δ = ∂V/∂S
            </p>
            <p>C'est la justification mathématique du <span class="text-red">delta-hedging</span> !</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             GRAPHIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h3>Visualisation : Mesure Physique vs Risque-Neutre</h3>
        <div class="chart-container">
            <canvas id="martingaleCompareChart"></canvas>
        </div>
        <p class="caption">Distribution du prix final Sₜ sous la mesure physique P (μ = 12%) vs mesure risque-neutre Q (drift = r = 5%). Même volatilité σ = 25%.</p>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             EXERCICES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="exercices-m11">Exercices</h2>

        <div class="exercise-box">
            <h4>Exercice 1 : Vérification de Martingale</h4>
            <p>Soit Mₜ = Wₜ³ - 3tWₜ où W est un mouvement brownien standard.</p>
            <p><strong>Question :</strong> Montrez que M est une martingale en vérifiant E[Mₜ | Fₛ] = Mₛ.</p>
            <p><em>Indice : Utilisez E[Wₜ³|Fₛ] = Wₛ³ + 3Wₛ(t-s)</em></p>

            <input type="text" class="exercise-calc-input" id="m11-mart" placeholder="E[Mₜ | Fₛ] = ?">
            <button class="check-btn" onclick="checkM11Mart()">Vérifier</button>
            <div id="feedback-m11-mart" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Calcul :</strong></p>
                    <p>E[Wₜ³|Fₛ] = E[(Wₛ + (Wₜ-Wₛ))³|Fₛ]</p>
                    <p>= Wₛ³ + 3Wₛ²E[Wₜ-Wₛ] + 3WₛE[(Wₜ-Wₛ)²] + E[(Wₜ-Wₛ)³]</p>
                    <p>= Wₛ³ + 0 + 3Wₛ(t-s) + 0 = Wₛ³ + 3Wₛ(t-s)</p>
                    <p>E[3tWₜ|Fₛ] = 3tWₛ</p>
                    <p><strong>Donc :</strong></p>
                    <p>E[Mₜ|Fₛ] = Wₛ³ + 3Wₛ(t-s) - 3tWₛ = Wₛ³ - 3sWₛ = <span class="text-red">Mₛ</span> ✓</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 2 : Prix du Risque de Marché</h4>
            <p>Un actif a μ = 15%, σ = 20%, et le taux sans risque r = 3%.</p>
            <p><strong>Question :</strong> Calculez le prix du risque de marché θ = (μ - r)/σ.</p>

            <input type="text" class="exercise-calc-input" id="m11-theta" placeholder="θ = ?">
            <button class="check-btn" onclick="checkM11Theta()">Vérifier</button>
            <div id="feedback-m11-theta" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>θ = (μ - r)/σ = (0.15 - 0.03)/0.20 = 0.12/0.20 = <span class="text-red">0.6</span></p>
                    <p>Le prix du risque est de 0.6 (60%), ce qui signifie que chaque unité de risque (σ) est compensée par 0.6 unité de prime de risque (μ - r).</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 3 : Pricing Risque-Neutre</h4>
            <p>Sous Q, un actif suit dS = 0.05Sdt + 0.30SdW^Q avec S₀ = 100.</p>
            <p><strong>Question :</strong> Calculez E^Q[S₁], l'espérance du prix à t = 1 sous Q.</p>

            <input type="text" class="exercise-calc-input" id="m11-eq" placeholder="E^Q[S₁] = ?">
            <button class="check-btn" onclick="checkM11EQ()">Vérifier</button>
            <div id="feedback-m11-eq" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Sous Q, le drift est r = 5%. L'espérance est :</p>
                    <p>E^Q[Sₜ] = S₀e^(rt) = 100 × e^(0.05×1) = 100 × 1.0513 ≈ <span class="text-red">105.13</span></p>
                    <p><strong>Note :</strong> Sous Q, tous les actifs ont un rendement espéré égal au taux sans risque !</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 4 : Densité de Girsanov</h4>
            <p>Avec μ = 10%, r = 4%, σ = 25%, T = 1 et W₁^P = 0.5.</p>
            <p><strong>Question :</strong> Calculez la densité de Radon-Nikodym dQ/dP = Z₁.</p>
            <p><em>Formule : Z₁ = exp(-θW₁^P - ½θ²) où θ = (μ-r)/σ</em></p>

            <input type="text" class="exercise-calc-input" id="m11-density" placeholder="Z₁ = ?">
            <button class="check-btn" onclick="checkM11Density()">Vérifier</button>
            <div id="feedback-m11-density" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Étape 1 :</strong> θ = (0.10 - 0.04)/0.25 = 0.24</p>
                    <p><strong>Étape 2 :</strong> Z₁ = exp(-0.24 × 0.5 - ½ × 0.24²)</p>
                    <p>= exp(-0.12 - 0.0288) = exp(-0.1488) ≈ <span class="text-red">0.862</span></p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 5 : Martingale Exponentielle</h4>
            <p>Soit Zₜ = exp(2Wₜ - 2t).</p>
            <p><strong>Question :</strong> Vérifiez que E[Z₁] = Z₀ = 1. Est-ce une martingale ?</p>

            <input type="text" class="exercise-calc-input" id="m11-exp" placeholder="E[Z₁] = ?">
            <button class="check-btn" onclick="checkM11Exp()">Vérifier</button>
            <div id="feedback-m11-exp" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Zₜ = exp(λWₜ - ½λ²t) avec λ = 2.</p>
                    <p>Vérification : λ²/2 = 4/2 = 2 ✓ (le coefficient de t est bien ½λ²)</p>
                    <p>E[Z₁] = E[exp(2W₁ - 2)]</p>
                    <p>= e^(-2) × E[exp(2W₁)]</p>
                    <p>= e^(-2) × exp(½ × 4 × 1) (car E[e^(aW)] = exp(a²t/2))</p>
                    <p>= e^(-2) × e^2 = <span class="text-red">1</span></p>
                    <p><strong>Conclusion :</strong> Oui, c'est une martingale !</p>
                </div>
            </details>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             FLASHCARDS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="flashcards-m11">Flashcards</h2>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce qu'une martingale intuitivement ?</p></div>
                    <div class="flashcard-back"><p>Un "jeu équitable" : connaissant le présent, la meilleure prédiction du futur est la valeur actuelle. Aucune tendance prévisible, E[Mₜ|Fₛ] = Mₛ.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce qu'une filtration ?</p></div>
                    <div class="flashcard-back"><p>Une famille croissante de σ-algèbres {Fₜ} représentant l'information disponible au temps t. Plus le temps avance, plus on sait de choses (Fₛ ⊆ Fₜ pour s ≤ t).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Que fait le théorème de Girsanov ?</p></div>
                    <div class="flashcard-back"><p>Il permet de changer le drift d'un processus en changeant de mesure de probabilité. En finance : transformer le drift μ en r pour passer de P à Q.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le prix du risque de marché θ ?</p></div>
                    <div class="flashcard-back"><p>θ = (μ - r)/σ. C'est l'excès de rendement par unité de risque, aussi appelé ratio de Sharpe. Il détermine le changement de mesure P → Q.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que la mesure risque-neutre Q ?</p></div>
                    <div class="flashcard-back"><p>Une mesure équivalente à P sous laquelle les prix actualisés sont des martingales. Sous Q, tous les actifs ont un rendement espéré égal à r.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la formule de pricing fondamentale ?</p></div>
                    <div class="flashcard-back"><p>Prix = e^(-r(T-t)) E^Q[Payoff]. Le prix d'un dérivé est l'espérance actualisée de son payoff sous la mesure risque-neutre.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'énonce le 1er théorème fondamental (FTAP) ?</p></div>
                    <div class="flashcard-back"><p>Absence d'arbitrage ⟺ ∃ mesure martingale équivalente Q. Si Q existe, on ne peut pas faire d'argent sans risque.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'énonce le 2ème théorème fondamental (FTAP) ?</p></div>
                    <div class="flashcard-back"><p>Marché complet ⟺ Q unique. Si Q est unique, tout payoff peut être répliqué et il y a un prix unique pour chaque dérivé.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi Wₜ² n'est pas une martingale ?</p></div>
                    <div class="flashcard-back"><p>E[Wₜ²|Fₛ] = Wₛ² + (t-s) ≠ Wₛ². La variance du brownien augmente avec le temps. Mais Wₜ² - t EST une martingale.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que la martingale exponentielle ?</p></div>
                    <div class="flashcard-back"><p>Zₜ = exp(λWₜ - ½λ²t) pour tout λ ∈ ℝ. Elle est toujours positive, d'espérance 1, et sert de densité pour le changement de mesure.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le théorème d'arrêt optionnel ?</p></div>
                    <div class="flashcard-back"><p>Pour une martingale M et un temps d'arrêt borné τ : E[Mᵗ] = E[M₀]. Aucune stratégie d'arrêt ne peut créer de profit espéré dans un jeu équitable.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Comment le théorème de représentation justifie-t-il le delta-hedging ?</p></div>
                    <div class="flashcard-back"><p>Toute martingale brownienne s'écrit M = M₀ + ∫φdW. Pour le prix d'un dérivé, φ correspond au delta Δ = ∂V/∂S.</p></div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module10')">⬅ Précédent : Calcul d'Itô</button>
            <button class="nav-btn" onclick="showModule('module12')">Suivant : Applications ➡</button>
        </div>
    </section>

    <section id="module12" class="module">
        <header class="module-header">
            <h1>Module 12 : Applications du Calcul Stochastique</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>180 minutes</span>
                <span>Prérequis : Modules 10-11</span>
            </div>
        </header>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             INTRODUCTION ET CONTEXTE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Myron_Scholes.jpg/440px-Myron_Scholes.jpg" alt="Myron Scholes">
            <figcaption>Myron Scholes (né en 1941) - Co-lauréat du Prix Nobel 1997 pour le modèle Black-Scholes</figcaption>
        </figure>

        <h4>Objectifs du Module</h4>
        <ul>
            <li>Dériver rigoureusement l'équation de Black-Scholes par deux méthodes</li>
            <li>Comprendre et appliquer les équations de Kolmogorov (forward et backward)</li>
            <li>Maîtriser la formule de Feynman-Kac et son lien avec le pricing</li>
            <li>Étendre le modèle aux processus de Poisson et sauts</li>
            <li>Comprendre les modèles à volatilité stochastique (Heston, SABR)</li>
            <li>Appliquer ces concepts au pricing de dérivés complexes</li>
        </ul>

        <div class="box">
            <h4>L'Équation de Black-Scholes : Un Tournant Historique</h4>
            <p>En 1973, Fischer Black, Myron Scholes et Robert Merton publient des travaux qui révolutionnent la finance. Leur formule de pricing d'options, basée sur l'<span class="text-red">argument de non-arbitrage</span> et le <span class="text-red">calcul d'Itô</span>, ouvre la voie à l'industrie des dérivés.</p>
            <p>Ce module présente les applications pratiques du calcul stochastique, du pricing d'options aux modèles avancés à sauts et volatilité stochastique.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             TIMELINE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>Chronologie des Applications en Finance</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1900</div>
                <div class="timeline-content">
                    <h4>Louis Bachelier - Première tentative</h4>
                    <p>Dans sa thèse "Théorie de la Spéculation", Bachelier dérive une formule pour les options mais avec un mouvement brownien arithmétique (prix pouvant être négatif).</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1965</div>
                <div class="timeline-content">
                    <h4>Paul Samuelson - GBM pour les prix</h4>
                    <p>Samuelson propose le mouvement brownien géométrique pour modéliser les prix (toujours positifs). Il obtient une formule de pricing mais avec des paramètres arbitraires.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1973</div>
                <div class="timeline-content">
                    <h4>Black, Scholes, Merton - La Révolution</h4>
                    <p>Publication de "The Pricing of Options and Corporate Liabilities" (Black-Scholes) et "Theory of Rational Option Pricing" (Merton). L'argument de réplication élimine les paramètres arbitraires.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1976</div>
                <div class="timeline-content">
                    <h4>Robert Merton - Modèle à sauts</h4>
                    <p>Merton étend le modèle en ajoutant des sauts (processus de Poisson) pour capturer les mouvements discontinus des prix.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1987</div>
                <div class="timeline-content">
                    <h4>Crash d'octobre - Smile de volatilité</h4>
                    <p>Le krach du "Black Monday" révèle que la volatilité implicite n'est pas constante : apparition du smile de volatilité.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1993</div>
                <div class="timeline-content">
                    <h4>Steven Heston - Volatilité stochastique</h4>
                    <p>Le modèle de Heston permet de capturer le smile de volatilité de manière endogène, avec une formule semi-analytique pour les options européennes.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">2002</div>
                <div class="timeline-content">
                    <h4>Modèle SABR</h4>
                    <p>Hagan et al. introduisent le modèle SABR pour les options sur taux d'intérêt, devenu un standard de l'industrie.</p>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 1: DÉRIVATION DE BLACK-SCHOLES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>1. Dérivation de l'Équation de Black-Scholes</h2>

        <h3>1.1 Les Hypothèses du Modèle</h3>

        <div class="box">
            <h4>Hypothèses de Black-Scholes</h4>
            <ol>
                <li>Le prix du sous-jacent suit un GBM : dS = μSdt + σSdW</li>
                <li>Le taux sans risque r est constant et connu</li>
                <li>La volatilité σ est constante et connue</li>
                <li>Pas de dividendes pendant la vie de l'option</li>
                <li>Pas de coûts de transaction ni de taxes</li>
                <li>Pas de restrictions sur les ventes à découvert</li>
                <li>Trading continu possible (pas de sauts)</li>
                <li>Le marché est sans arbitrage</li>
            </ol>
        </div>

        <h3>1.2 Méthode 1 : Dérivation par Réplication (Delta Hedging)</h3>

        <div class="box">
            <h4>Étape 1 : Construction du portefeuille répliquant</h4>
            <p>Soit V(S,t) le prix d'un dérivé. Construisons un portefeuille :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                Π = V - ΔS
            </p>
            <p>où Δ (le delta) est le nombre d'actions à détenir.</p>
        </div>

        <div class="box">
            <h4>Étape 2 : Application du lemme d'Itô</h4>
            <p>Par le lemme d'Itô, la dynamique de V est :</p>
            <p style="font-family: monospace; font-size: 14px;">
                dV = ∂V/∂t dt + ∂V/∂S dS + ½∂²V/∂S² (dS)²<br>
                &nbsp;&nbsp;&nbsp;= ∂V/∂t dt + ∂V/∂S (μSdt + σSdW) + ½∂²V/∂S² σ²S²dt<br>
                &nbsp;&nbsp;&nbsp;= (∂V/∂t + μS∂V/∂S + ½σ²S²∂²V/∂S²)dt + σS∂V/∂S dW
            </p>
        </div>

        <div class="box">
            <h4>Étape 3 : Élimination du risque</h4>
            <p>La dynamique du portefeuille est :</p>
            <p style="font-family: monospace; font-size: 14px;">
                dΠ = dV - ΔdS<br>
                &nbsp;&nbsp;&nbsp;= (∂V/∂t + μS∂V/∂S + ½σ²S²∂²V/∂S²)dt + σS∂V/∂S dW - Δ(μSdt + σSdW)<br>
                &nbsp;&nbsp;&nbsp;= (∂V/∂t + μS(∂V/∂S - Δ) + ½σ²S²∂²V/∂S²)dt + σS(∂V/∂S - Δ)dW
            </p>
            <p>En choisissant <span class="text-red">Δ = ∂V/∂S</span> (delta-hedging), le terme en dW disparaît :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 10px; border-radius: 8px;">
                dΠ = (∂V/∂t + ½σ²S²∂²V/∂S²)dt
            </p>
            <p>Le portefeuille est maintenant <span class="text-red">sans risque</span> (aucune composante stochastique) !</p>
        </div>

        <div class="box">
            <h4>Étape 4 : Argument de non-arbitrage</h4>
            <p>Un portefeuille sans risque doit rapporter le taux sans risque r :</p>
            <p style="font-family: monospace;">dΠ = rΠdt = r(V - S∂V/∂S)dt</p>
            <p>En égalisant les deux expressions :</p>
            <p style="font-family: monospace;">∂V/∂t + ½σ²S²∂²V/∂S² = r(V - S∂V/∂S)</p>
        </div>

        <div class="box">
            <h4>L'Équation de Black-Scholes</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 20px; border-radius: 8px;">
                <span class="text-red">∂V/∂t + ½σ²S²∂²V/∂S² + rS∂V/∂S - rV = 0</span>
            </p>
            <p><strong>Observation cruciale :</strong> Le paramètre μ (drift physique) n'apparaît pas ! Le prix ne dépend que de σ, r, et de la condition finale (payoff).</p>
        </div>

        <h3>1.3 Méthode 2 : Dérivation par Pricing Risque-Neutre</h3>

        <div class="box">
            <h4>Approche probabiliste</h4>
            <p>Sous la mesure risque-neutre Q, le prix actualisé e⁻ʳᵗV est une martingale :</p>
            <p style="font-family: monospace; font-size: 14px;">
                V(t,S) = e^(-r(T-t)) E^Q[h(Sₜ) | Sₜ = S]
            </p>
            <p>où h(S) est le payoff à maturité (ex: max(S-K, 0) pour un call).</p>
            <p>Sous Q : dS = <span class="text-green">r</span>Sdt + σSdW^Q</p>
            <p>On peut montrer que cette espérance satisfait l'EDP de Black-Scholes.</p>
        </div>

        <h3>1.4 Les Formules Explicites</h3>

        <div class="box">
            <h4>Formule de Black-Scholes pour un Call Européen</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                C = S₀Φ(d₁) - Ke^(-rT)Φ(d₂)
            </p>
            <p>où :</p>
            <p style="font-family: monospace; font-size: 14px;">
                d₁ = [ln(S₀/K) + (r + σ²/2)T] / (σ√T)<br>
                d₂ = d₁ - σ√T
            </p>
            <p>et Φ est la fonction de répartition de la loi normale standard.</p>
        </div>

        <div class="box">
            <h4>Formule de Black-Scholes pour un Put Européen</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                P = Ke^(-rT)Φ(-d₂) - S₀Φ(-d₁)
            </p>
            <p>Vérification par parité Put-Call : P + S₀ = C + Ke^(-rT) ✓</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 2: ÉQUATIONS DE KOLMOGOROV
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>2. Équations de Kolmogorov</h2>

        <h3>2.1 Équation Backward de Kolmogorov</h3>

        <div class="box">
            <h4>Définition</h4>
            <p>Soit X un processus de diffusion : dXₜ = μ(t,X)dt + σ(t,X)dW</p>
            <p>La fonction u(t,x) = E[g(Xₜ) | Xₜ = x] satisfait l'<span class="text-red">équation backward</span> :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                ∂u/∂t + μ∂u/∂x + ½σ²∂²u/∂x² = 0
            </p>
            <p>avec condition finale u(T,x) = g(x).</p>
            <p><strong>Interprétation :</strong> On "remonte" le temps depuis la condition finale.</p>
        </div>

        <h3>2.2 Équation Forward de Kolmogorov (Fokker-Planck)</h3>

        <div class="box">
            <h4>Définition</h4>
            <p>La densité p(t,x) de Xₜ satisfait l'<span class="text-red">équation de Fokker-Planck</span> :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                ∂p/∂t = -∂(μp)/∂x + ½∂²(σ²p)/∂x²
            </p>
            <p>avec condition initiale p(0,x) = δ(x - x₀).</p>
            <p><strong>Interprétation :</strong> Évolution de la distribution de probabilité vers le futur.</p>
        </div>

        <div class="box">
            <h4>Lien entre les deux équations</h4>
            <p>Les deux équations sont <span class="text-red">adjointes</span> l'une de l'autre :</p>
            <ul>
                <li><strong>Backward :</strong> Fixe le point final, remonte dans le temps</li>
                <li><strong>Forward :</strong> Fixe le point initial, propage la densité</li>
            </ul>
            <p>En finance, on utilise principalement l'équation backward pour le pricing.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 3: FORMULE DE FEYNMAN-KAC
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>3. Formule de Feynman-Kac</h2>

        <div class="box">
            <h4>Théorème de Feynman-Kac</h4>
            <p>Soit l'EDP parabolique :</p>
            <p style="text-align: center; font-family: monospace; font-size: 14px;">
                ∂u/∂t + μ(t,x)∂u/∂x + ½σ(t,x)²∂²u/∂x² - r(t,x)u = 0
            </p>
            <p>avec condition finale u(T,x) = g(x).</p>
            <p>Alors la solution est :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                u(t,x) = E[e^(-∫ₜᵀ r(s,Xₛ)ds) g(Xₜ) | Xₜ = x]
            </p>
            <p>où dXₛ = μ(s,Xₛ)ds + σ(s,Xₛ)dWₛ</p>
        </div>

        <div class="box">
            <h4>Application : L'EDP de Black-Scholes</h4>
            <p>Pour l'équation de Black-Scholes (μ = rS, σ = σS, r = constante) :</p>
            <p style="font-family: monospace; font-size: 14px;">
                ∂V/∂t + rS∂V/∂S + ½σ²S²∂²V/∂S² - rV = 0
            </p>
            <p>Par Feynman-Kac :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                V(t,S) = e^(-r(T-t)) E^Q[g(Sₜ) | Sₜ = S]
            </p>
            <p><strong>C'est exactement la formule de pricing risque-neutre !</strong></p>
        </div>

        <div class="box">
            <h4>Signification Profonde</h4>
            <p>Feynman-Kac établit une <span class="text-red">équivalence fondamentale</span> :</p>
            <ul>
                <li><strong>Approche EDP :</strong> Résoudre l'équation de Black-Scholes</li>
                <li><strong>Approche probabiliste :</strong> Calculer une espérance sous Q</li>
            </ul>
            <p>Les deux donnent le même résultat ! Cela justifie le pricing Monte Carlo.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 4: PROCESSUS DE POISSON ET SAUTS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>4. Processus de Poisson et Modèles à Sauts</h2>

        <h3>4.1 Le Processus de Poisson</h3>

        <div class="box">
            <h4>Définition : Processus de Poisson</h4>
            <p>Un processus de Poisson {Nₜ}ₜ≥₀ d'intensité λ satisfait :</p>
            <ol>
                <li>N₀ = 0</li>
                <li>Incréments indépendants : Nₜ - Nₛ indépendant de Fₛ pour s < t</li>
                <li>Incréments stationnaires : Nₜ - Nₛ ~ Poisson(λ(t-s))</li>
            </ol>
            <p><strong>Interprétation :</strong> Nₜ compte le nombre d'événements (sauts) jusqu'au temps t.</p>
        </div>

        <div class="box">
            <h4>Propriétés du Processus de Poisson</h4>
            <ul>
                <li>E[Nₜ] = λt</li>
                <li>Var(Nₜ) = λt</li>
                <li>P(Nₜ₊Δₜ - Nₜ = 1) ≈ λΔt pour petit Δt</li>
                <li>P(Nₜ₊Δₜ - Nₜ ≥ 2) ≈ 0 pour petit Δt</li>
            </ul>
        </div>

        <div class="box">
            <h4>Processus de Poisson Compensé</h4>
            <p>Le processus compensé Ñₜ = Nₜ - λt est une <span class="text-red">martingale</span> :</p>
            <p style="font-family: monospace;">E[Ñₜ | Fₛ] = E[Nₜ - λt | Fₛ] = (Nₛ + λ(t-s)) - λt = Nₛ - λs = Ñₛ</p>
        </div>

        <h3>4.2 Modèle de Merton Jump-Diffusion (1976)</h3>

        <div class="box">
            <h4>Modèle de Merton</h4>
            <p>Le prix suit une diffusion avec des sauts :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                dS/S = (μ - λk)dt + σdW + (J - 1)dN
            </p>
            <p>où :</p>
            <ul>
                <li><strong>N</strong> : Processus de Poisson d'intensité λ</li>
                <li><strong>J</strong> : Taille du saut (ratio multiplicatif), souvent ln(J) ~ N(μⱼ, σⱼ²)</li>
                <li><strong>k</strong> = E[J - 1] : Espérance du saut</li>
            </ul>
        </div>

        <div class="box">
            <h4>Pricing sous Merton</h4>
            <p>Le prix d'un call européen sous le modèle de Merton est :</p>
            <p style="text-align: center; font-family: monospace; font-size: 14px;">
                C = Σₙ₌₀^∞ [e^(-λ'T)(λ'T)ⁿ/n!] × C_BS(S, K, T, rₙ, σₙ)
            </p>
            <p>C'est une somme pondérée de prix Black-Scholes avec différents paramètres !</p>
        </div>

        <h3>4.3 Pourquoi les Sauts ?</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Limites du GBM</h4>
                <ul>
                    <li>Trajectoires continues (pas de gaps)</li>
                    <li>Rendements log-normaux (queues fines)</li>
                    <li>Volatilité constante</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Avantages des Sauts</h4>
                <ul>
                    <li>Captures les krachs et annonces</li>
                    <li>Queues plus épaisses</li>
                    <li>Smile de volatilité court terme</li>
                </ul>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 5: VOLATILITÉ STOCHASTIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>5. Modèles à Volatilité Stochastique</h2>

        <h3>5.1 Motivation : Le Smile de Volatilité</h3>

        <div class="box">
            <h4>Le Problème du Smile</h4>
            <p>Sous Black-Scholes, la volatilité implicite devrait être constante pour toutes les options. En réalité :</p>
            <ul>
                <li>La volatilité implicite varie avec le strike ("smile" ou "skew")</li>
                <li>La volatilité implicite varie avec la maturité ("term structure")</li>
            </ul>
            <p><strong>Conclusion :</strong> La volatilité n'est pas constante. Elle doit être modélisée comme un processus stochastique.</p>
        </div>

        <h3>5.2 Le Modèle de Heston (1993)</h3>

        <div class="box">
            <h4>Dynamique du Modèle de Heston</h4>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                dS = μSdt + √v SdW₁<br>
                dv = κ(θ - v)dt + ξ√v dW₂<br>
                d⟨W₁, W₂⟩ = ρdt
            </p>
            <p>où :</p>
            <ul>
                <li><strong>v</strong> : Variance instantanée (suit un processus CIR)</li>
                <li><strong>κ</strong> : Vitesse de retour à la moyenne</li>
                <li><strong>θ</strong> : Variance long terme</li>
                <li><strong>ξ</strong> : "Volatilité de la volatilité"</li>
                <li><strong>ρ</strong> : Corrélation (typiquement ρ < 0)</li>
            </ul>
        </div>

        <div class="box">
            <h4>Propriétés du Modèle de Heston</h4>
            <ul>
                <li><strong>Condition de Feller :</strong> 2κθ ≥ ξ² assure v > 0</li>
                <li><strong>Effet de levier :</strong> ρ < 0 crée le skew (baisse du prix → hausse de volatilité)</li>
                <li><strong>Formule semi-analytique :</strong> Prix calculable par transformée de Fourier</li>
                <li><strong>Calibration :</strong> Peut être calibré à la surface de volatilité</li>
            </ul>
        </div>

        <h3>5.3 Le Modèle SABR (2002)</h3>

        <div class="box">
            <h4>Dynamique du Modèle SABR</h4>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                dF = σF^β dW₁<br>
                dσ = ασ dW₂<br>
                d⟨W₁, W₂⟩ = ρdt
            </p>
            <p>où F est le forward et β ∈ [0,1] contrôle la backbone (β=1 : lognormal, β=0 : normal).</p>
        </div>

        <div class="box">
            <h4>Formule d'Approximation SABR</h4>
            <p>La volatilité implicite Black-Scholes approchée est :</p>
            <p style="font-family: monospace; font-size: 12px;">
                σ_BS(K) ≈ α/[(FK)^((1-β)/2)] × [1 + termes de correction]
            </p>
            <p><strong>Usage :</strong> Standard pour les options sur taux (caps, swaptions).</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             GRAPHIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h3>Visualisation : Smile de Volatilité</h3>
        <div class="chart-container">
            <canvas id="volatilitySmileChart"></canvas>
        </div>
        <p class="caption">Volatilité implicite en fonction du strike pour différents modèles : Black-Scholes (constante), Heston (skew), et données de marché (smile).</p>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             EXERCICES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="exercices-m12">Exercices</h2>

        <div class="exercise-box">
            <h4>Exercice 1 : Calcul de d₁ et d₂</h4>
            <p>Un call européen a S₀ = 100, K = 105, T = 0.5, r = 5%, σ = 20%.</p>
            <p><strong>Question :</strong> Calculez d₁.</p>

            <input type="text" class="exercise-calc-input" id="m12-d1" placeholder="d₁ = ?">
            <button class="check-btn" onclick="checkM12D1()">Vérifier</button>
            <div id="feedback-m12-d1" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>d₁ = [ln(S/K) + (r + σ²/2)T] / (σ√T)</p>
                    <p>= [ln(100/105) + (0.05 + 0.02)×0.5] / (0.20×√0.5)</p>
                    <p>= [-0.0488 + 0.035] / 0.1414</p>
                    <p>= -0.0138 / 0.1414 ≈ <span class="text-red">-0.098</span></p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 2 : Prix d'un Call</h4>
            <p>Avec les mêmes paramètres : S₀ = 100, K = 105, T = 0.5, r = 5%, σ = 20%.</p>
            <p>On donne : Φ(-0.098) = 0.461, Φ(-0.239) = 0.406</p>
            <p><strong>Question :</strong> Calculez le prix du call européen.</p>

            <input type="text" class="exercise-calc-input" id="m12-call" placeholder="C = ?">
            <button class="check-btn" onclick="checkM12Call()">Vérifier</button>
            <div id="feedback-m12-call" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>C = S₀Φ(d₁) - Ke^(-rT)Φ(d₂)</p>
                    <p>d₂ = d₁ - σ√T = -0.098 - 0.1414 ≈ -0.239</p>
                    <p>C = 100 × 0.461 - 105 × e^(-0.025) × 0.406</p>
                    <p>= 46.1 - 102.4 × 0.406 = 46.1 - 41.6 ≈ <span class="text-red">4.5€</span></p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 3 : Probabilité de Saut</h4>
            <p>Dans un modèle de Merton, l'intensité des sauts est λ = 2 par an.</p>
            <p><strong>Question :</strong> Quelle est la probabilité d'avoir exactement 1 saut sur 3 mois ?</p>

            <input type="text" class="exercise-calc-input" id="m12-poisson" placeholder="P(N=1) = ? (en %)">
            <button class="check-btn" onclick="checkM12Poisson()">Vérifier</button>
            <div id="feedback-m12-poisson" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Sur T = 0.25 an, λT = 2 × 0.25 = 0.5</p>
                    <p>P(N = 1) = e^(-λT) × (λT)¹ / 1!</p>
                    <p>= e^(-0.5) × 0.5 / 1</p>
                    <p>= 0.6065 × 0.5 = 0.303 ≈ <span class="text-red">30.3%</span></p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 4 : Modèle de Heston</h4>
            <p>Un actif suit le modèle de Heston avec κ = 2, θ = 0.04, ξ = 0.3.</p>
            <p><strong>Question :</strong> La condition de Feller est-elle satisfaite ? Le variance peut-elle atteindre zéro ?</p>

            <input type="text" class="exercise-calc-input" id="m12-feller" placeholder="2κθ = ? vs ξ² = ?">
            <button class="check-btn" onclick="checkM12Feller()">Vérifier</button>
            <div id="feedback-m12-feller" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>2κθ = 2 × 2 × 0.04 = <span class="text-red">0.16</span></p>
                    <p>ξ² = 0.3² = <span class="text-red">0.09</span></p>
                    <p>Comme 0.16 > 0.09, la condition 2κθ ≥ ξ² est <span class="text-green">SATISFAITE</span>.</p>
                    <p>La variance reste strictement positive avec probabilité 1.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 5 : Feynman-Kac</h4>
            <p>On veut calculer u(0, 100) = E^Q[e^(-rT)×max(Sₜ - K, 0)] avec T = 1, K = 100, r = 3%.</p>
            <p><strong>Question :</strong> Quelle EDP satisfait u(t,S) ? (donnez les coefficients)</p>

            <input type="text" class="exercise-calc-input" id="m12-fk" placeholder="Coef de ∂²u/∂S² = ?">
            <button class="check-btn" onclick="checkM12FK()">Vérifier</button>
            <div id="feedback-m12-fk" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Par Feynman-Kac, u satisfait l'EDP de Black-Scholes :</p>
                    <p>∂u/∂t + <span class="text-red">½σ²S²</span>∂²u/∂S² + rS∂u/∂S - ru = 0</p>
                    <p>Le coefficient de ∂²u/∂S² est <span class="text-red">½σ²S²</span>.</p>
                    <p>Si σ = 20%, alors ½σ² = ½ × 0.04 = 0.02.</p>
                </div>
            </details>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             FLASHCARDS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="flashcards-m12">Flashcards</h2>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi μ n'apparaît pas dans l'équation de Black-Scholes ?</p></div>
                    <div class="flashcard-back"><p>Par l'argument de non-arbitrage : on peut répliquer l'option par delta-hedging. Le risque μ est éliminé, donc μ n'affecte pas le prix.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Que signifie "delta-hedging" ?</p></div>
                    <div class="flashcard-back"><p>Détenir Δ = ∂V/∂S actions pour éliminer le risque du portefeuille. Le portefeuille V - ΔS devient sans risque et doit rapporter r.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Que dit le théorème de Feynman-Kac ?</p></div>
                    <div class="flashcard-back"><p>Il établit l'équivalence entre l'EDP de pricing et l'espérance risque-neutre. La solution de l'EDP est u(t,x) = E[e^(-r(T-t))g(Xₜ)].</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est l'équation de Black-Scholes ?</p></div>
                    <div class="flashcard-back"><p>∂V/∂t + ½σ²S²∂²V/∂S² + rS∂V/∂S - rV = 0. C'est une EDP parabolique rétrograde avec condition finale V(T,S) = payoff.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce qu'un processus de Poisson ?</p></div>
                    <div class="flashcard-back"><p>Un processus de comptage à incréments indépendants et stationnaires. Nₜ compte les événements (sauts) et Nₜ ~ Poisson(λt).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi ajouter des sauts au modèle Black-Scholes ?</p></div>
                    <div class="flashcard-back"><p>Le GBM a des trajectoires continues, mais les prix réels peuvent sauter (krachs, annonces). Les modèles à sauts capturent ces discontinuités et les fat tails.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le smile de volatilité ?</p></div>
                    <div class="flashcard-back"><p>La volatilité implicite varie avec le strike (en forme de sourire ou skew). Cela contredit Black-Scholes qui suppose σ constant.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quels sont les paramètres du modèle de Heston ?</p></div>
                    <div class="flashcard-back"><p>κ (vitesse retour moyenne), θ (variance long terme), ξ (vol de vol), ρ (corrélation S-v), v₀ (variance initiale). 5 paramètres à calibrer.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la condition de Feller pour Heston ?</p></div>
                    <div class="flashcard-back"><p>2κθ ≥ ξ². Si satisfaite, la variance v reste strictement positive. Sinon, v peut toucher zéro.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi ρ < 0 crée-t-il le skew ?</p></div>
                    <div class="flashcard-back"><p>Effet de levier : quand S baisse (dW₁ < 0), v monte (dW₂ > 0 corrélé négativement). Donc plus de volatilité pour les puts OTM.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le modèle SABR ?</p></div>
                    <div class="flashcard-back"><p>Un modèle de volatilité stochastique avec formule analytique approchée. Standard pour les options sur taux (caps, swaptions). 4 paramètres : α, β, ρ, ν.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la différence entre Kolmogorov backward et forward ?</p></div>
                    <div class="flashcard-back"><p>Backward : fixe condition finale, remonte le temps (pricing). Forward (Fokker-Planck) : fixe condition initiale, propage la densité vers le futur.</p></div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module11')">⬅ Précédent : Martingales</button>
            <button class="nav-btn" onclick="showModule('module13')">Suivant : Rendement et Risque ➡</button>
        </div>
    </section>

    <section id="module13" class="module">
        <header class="module-header">
            <h1>Module 13 : Rendement et Risque</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermédiaire</span>
                <span>150 minutes</span>
                <span>Prérequis : Module 7</span>
            </div>
        </header>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             INTRODUCTION ET CONTEXTE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/en/1/10/Harry_Markowitz.jpg" alt="Harry Markowitz">
            <figcaption>Harry Markowitz (1927-2023) - Prix Nobel 1990 pour la théorie moderne du portefeuille</figcaption>
        </figure>

        <h4>Objectifs du Module</h4>
        <ul>
            <li>Maîtriser les différentes mesures de rendement et leurs propriétés</li>
            <li>Comprendre la volatilité et ses limites comme mesure de risque</li>
            <li>Analyser les distributions réelles des rendements (fat tails, skewness, kurtosis)</li>
            <li>Calculer et interpréter la Value at Risk (VaR) et l'Expected Shortfall (ES)</li>
            <li>Comprendre les mesures de risque cohérentes et leurs propriétés</li>
            <li>Appliquer ces concepts à l'analyse de portefeuilles</li>
        </ul>

        <div class="box">
            <h4>Rendement et Risque : Les Deux Faces de l'Investissement</h4>
            <p>Tout investissement implique un arbitrage entre <span class="text-red">rendement espéré</span> et <span class="text-red">risque</span>. Ce module établit les fondements quantitatifs pour mesurer ces deux dimensions essentielles.</p>
            <p>La question centrale de la finance est : <em>Quel rendement peut-on espérer pour un niveau de risque donné ?</em> La réponse à cette question a valu le Prix Nobel à Harry Markowitz en 1990.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             TIMELINE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>Chronologie des Concepts Rendement-Risque</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1738</div>
                <div class="timeline-content">
                    <h4>Daniel Bernoulli - Paradoxe de Saint-Pétersbourg</h4>
                    <p>Première formalisation de l'aversion au risque : les investisseurs maximisent l'utilité espérée, pas le gain espéré. Naissance de la théorie de l'utilité.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1900</div>
                <div class="timeline-content">
                    <h4>Louis Bachelier - Rendements aléatoires</h4>
                    <p>Dans sa thèse, Bachelier modélise les rendements comme des variables aléatoires suivant une marche aléatoire. Première application des probabilités à la finance.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1952</div>
                <div class="timeline-content">
                    <h4>Harry Markowitz - Théorie Moyenne-Variance</h4>
                    <p>Publication de "Portfolio Selection". Markowitz quantifie le risque par la variance et montre comment la diversification le réduit. Révolution de la gestion de portefeuille.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1963</div>
                <div class="timeline-content">
                    <h4>Benoît Mandelbrot - Distributions à queues épaisses</h4>
                    <p>"The Variation of Certain Speculative Prices" montre que les rendements ont des queues plus épaisses que la normale. Premier défi au modèle gaussien.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1994</div>
                <div class="timeline-content">
                    <h4>JPMorgan - RiskMetrics et VaR</h4>
                    <p>Publication de RiskMetrics, popularisant la Value at Risk (VaR) comme mesure standard du risque dans les banques et les régulateurs.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1999</div>
                <div class="timeline-content">
                    <h4>Artzner et al. - Mesures de Risque Cohérentes</h4>
                    <p>"Coherent Measures of Risk" définit les propriétés qu'une bonne mesure de risque doit satisfaire. La VaR échoue, mais l'Expected Shortfall réussit.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">2007</div>
                <div class="timeline-content">
                    <h4>Nassim Taleb - Le Cygne Noir</h4>
                    <p>Critique radicale des modèles gaussiens. Les événements extrêmes ("black swans") sont sous-estimés par les mesures traditionnelles de risque.</p>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 1: MESURES DE RENDEMENT
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>1. Mesures de Rendement</h2>

        <h3>1.1 Les Trois Types de Rendements</h3>

        <div class="box">
            <h4>Définitions des Rendements</h4>
            <table>
                <thead>
                    <tr><th>Type</th><th>Formule</th><th>Propriété clé</th><th>Usage</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">Simple (arithmétique)</span></td>
                        <td>R = (Pₜ - Pₜ₋₁) / Pₜ₋₁</td>
                        <td>Additif sur les actifs</td>
                        <td>Rendement de portefeuille</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Log (continu)</span></td>
                        <td>r = ln(Pₜ / Pₜ₋₁)</td>
                        <td>Additif sur le temps</td>
                        <td>Modélisation, Black-Scholes</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Géométrique</span></td>
                        <td>(Pₜ/P₀)^(1/T) - 1</td>
                        <td>Taux de croissance moyen</td>
                        <td>Performance long terme</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box">
            <h4>Relation entre Rendements Simple et Log</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                r = ln(1 + R) et R = e^r - 1
            </p>
            <p><strong>Approximation :</strong> Pour |R| < 10%, r ≈ R (erreur < 0.5%)</p>
            <p><strong>Développement de Taylor :</strong> ln(1+R) ≈ R - R²/2 + R³/3 - ...</p>
        </div>

        <h3>1.2 Additivité des Rendements</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Rendements Simples : Additifs sur les Actifs</h4>
                <p>Le rendement d'un portefeuille est :</p>
                <p style="font-family: monospace; text-align: center;">
                    Rₚ = Σᵢ wᵢRᵢ
                </p>
                <p>où wᵢ sont les poids des actifs.</p>
            </div>
            <div class="grid-item">
                <h4>Log-Rendements : Additifs sur le Temps</h4>
                <p>Le rendement sur plusieurs périodes est :</p>
                <p style="font-family: monospace; text-align: center;">
                    rₜₒₜₐₗ = r₁ + r₂ + ... + rₙ
                </p>
                <p>Car ln(Pₙ/P₀) = Σᵢ ln(Pᵢ/Pᵢ₋₁)</p>
            </div>
        </div>

        <div class="box">
            <h4>Attention : Les Log-Rendements ne sont PAS Additifs sur les Actifs !</h4>
            <p style="font-family: monospace; text-align: center; color: #ff6b6b;">
                ln(Pₚ/Pₚ₀) ≠ Σᵢ wᵢ ln(Pᵢ/Pᵢ₀)
            </p>
            <p>C'est une erreur courante. Pour le rendement d'un portefeuille, utilisez les rendements simples.</p>
        </div>

        <h3>1.3 Rendement Moyen : Arithmétique vs Géométrique</h3>

        <div class="box">
            <h4>Le Piège du Rendement Moyen Arithmétique</h4>
            <p><strong>Exemple :</strong> Un investissement fait +100% puis -50%.</p>
            <ul>
                <li>Rendement arithmétique moyen : (100% - 50%) / 2 = <span class="text-green">+25%</span></li>
                <li>Rendement réel : 100€ → 200€ → 100€, soit <span class="text-red">0%</span></li>
            </ul>
            <p><strong>Le rendement arithmétique surestime systématiquement la performance réelle.</strong></p>
        </div>

        <div class="box">
            <h4>Formule de Correction</h4>
            <p>Le rendement géométrique (réel) est approximativement :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                R_géom ≈ R_arith - σ²/2
            </p>
            <p>C'est la <span class="text-red">pénalité de volatilité</span> : plus un actif est volatile, plus l'écart est grand.</p>
        </div>

        <h3>1.4 Annualisation des Rendements</h3>

        <div class="box">
            <h4>Formules d'Annualisation</h4>
            <table>
                <thead>
                    <tr><th>Fréquence</th><th>Rendement annualisé</th><th>Exemple (r = 1%)</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Journalier</td>
                        <td>r × 252</td>
                        <td>252%</td>
                    </tr>
                    <tr>
                        <td>Hebdomadaire</td>
                        <td>r × 52</td>
                        <td>52%</td>
                    </tr>
                    <tr>
                        <td>Mensuel</td>
                        <td>r × 12</td>
                        <td>12%</td>
                    </tr>
                    <tr>
                        <td>Trimestriel</td>
                        <td>r × 4</td>
                        <td>4%</td>
                    </tr>
                </tbody>
            </table>
            <p><strong>Note :</strong> 252 jours de trading par an (hors weekends et jours fériés).</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 2: MESURES DE RISQUE TRADITIONNELLES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>2. Mesures de Risque Traditionnelles</h2>

        <h3>2.1 Volatilité (Écart-Type)</h3>

        <div class="box">
            <h4>Définition : Volatilité</h4>
            <p>La <span class="text-red">volatilité</span> est l'écart-type des rendements :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                σ = √(Var(R)) = √(E[(R - μ)²])
            </p>
            <p><strong>Estimateur :</strong> σ̂ = √[(1/(n-1)) Σᵢ(Rᵢ - R̄)²]</p>
        </div>

        <div class="box">
            <h4>Annualisation de la Volatilité</h4>
            <p>Si les rendements sont i.i.d., la volatilité s'annualise par :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                σ_annuel = σ_journalier × √252 ≈ σ_journalier × 15.87
            </p>
            <p><strong>Exemple :</strong> σ journalier = 1.5% → σ annuel = 1.5% × 15.87 ≈ 24%</p>
        </div>

        <h3>2.2 Limites de la Volatilité</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Problèmes</h4>
                <ul>
                    <li>Traite gains et pertes symétriquement</li>
                    <li>Suppose une distribution normale</li>
                    <li>Ne capture pas les événements extrêmes</li>
                    <li>Pas additive sur les actifs</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Alternatives</h4>
                <ul>
                    <li>Semi-variance (downside risk)</li>
                    <li>VaR et Expected Shortfall</li>
                    <li>Maximum Drawdown</li>
                    <li>Moments supérieurs (skew, kurtosis)</li>
                </ul>
            </div>
        </div>

        <h3>2.3 Semi-Variance et Downside Risk</h3>

        <div class="box">
            <h4>Définition : Semi-Variance</h4>
            <p>La semi-variance ne considère que les rendements inférieurs à un seuil (souvent 0 ou μ) :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                SV = E[min(R - τ, 0)²]
            </p>
            <p>où τ est le seuil de rendement minimum acceptable (MAR).</p>
            <p><strong>Avantage :</strong> Ne pénalise pas les gains élevés, conforme à l'intuition des investisseurs.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 3: VALUE AT RISK
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>3. Value at Risk (VaR)</h2>

        <h3>3.1 Définition et Interprétation</h3>

        <div class="box">
            <h4>Définition : Value at Risk</h4>
            <p>La <span class="text-red">VaR</span> au niveau de confiance (1-α) est la perte maximale qui ne sera pas dépassée avec probabilité (1-α) sur un horizon donné :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                P(Perte > VaR_α) = α
            </p>
            <p>Autrement dit : VaR_α = -Quantile_α(R)</p>
        </div>

        <div class="box">
            <h4>Exemple d'Interprétation</h4>
            <p>"La VaR 99% à 1 jour est de 2.5%"</p>
            <p>Signifie : Il y a 99% de chances que la perte journalière ne dépasse pas 2.5%.<br>
            (Et 1% de chances qu'elle soit supérieure)</p>
        </div>

        <h3>3.2 Méthodes de Calcul de la VaR</h3>

        <div class="box">
            <h4>Méthode 1 : VaR Paramétrique (Variance-Covariance)</h4>
            <p>Hypothèse : Les rendements suivent une loi normale N(μ, σ²)</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                VaR_α = -μ + z_α × σ
            </p>
            <p>où z_α est le quantile de la loi normale standard.</p>
            <table>
                <thead><tr><th>Niveau</th><th>z_α</th></tr></thead>
                <tbody>
                    <tr><td>90%</td><td>1.28</td></tr>
                    <tr><td>95%</td><td>1.645</td></tr>
                    <tr><td>99%</td><td>2.326</td></tr>
                    <tr><td>99.9%</td><td>3.09</td></tr>
                </tbody>
            </table>
        </div>

        <div class="box">
            <h4>Méthode 2 : VaR Historique</h4>
            <p>Pas d'hypothèse sur la distribution. On utilise directement les données historiques :</p>
            <ol>
                <li>Collecter n rendements historiques</li>
                <li>Les trier par ordre croissant</li>
                <li>VaR_α = -R_(⌊α×n⌋)</li>
            </ol>
            <p><strong>Exemple :</strong> Pour 1000 observations et α = 1%, VaR = -10ème plus petit rendement.</p>
        </div>

        <div class="box">
            <h4>Méthode 3 : VaR Monte Carlo</h4>
            <ol>
                <li>Spécifier un modèle de rendement (GBM, GARCH, etc.)</li>
                <li>Simuler N trajectoires futures</li>
                <li>Calculer la distribution des pertes</li>
                <li>Extraire le quantile α</li>
            </ol>
            <p><strong>Avantage :</strong> Flexible, permet de modéliser des dynamiques complexes.</p>
        </div>

        <h3>3.3 VaR d'un Portefeuille</h3>

        <div class="box">
            <h4>VaR Paramétrique d'un Portefeuille</h4>
            <p>Pour un portefeuille de n actifs avec poids w et matrice de covariance Σ :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                σₚ = √(w'Σw)
            </p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                VaR_α = -μₚ + z_α × σₚ
            </p>
        </div>

        <h3>3.4 Limites de la VaR</h3>

        <div class="box">
            <h4>Problèmes de la VaR</h4>
            <ol>
                <li><strong>Ne dit rien sur l'ampleur :</strong> Que se passe-t-il au-delà de la VaR ?</li>
                <li><strong>Pas sous-additive :</strong> VaR(A+B) peut être > VaR(A) + VaR(B)</li>
                <li><strong>Sensible à la distribution :</strong> VaR gaussienne sous-estime le risque réel</li>
                <li><strong>Non convexe :</strong> Problèmes d'optimisation</li>
            </ol>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 4: EXPECTED SHORTFALL
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>4. Expected Shortfall (CVaR)</h2>

        <h3>4.1 Définition</h3>

        <div class="box">
            <h4>Définition : Expected Shortfall</h4>
            <p>L'<span class="text-red">Expected Shortfall</span> (ES) au niveau α est la perte moyenne sachant qu'on dépasse la VaR :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                ES_α = E[Perte | Perte > VaR_α]
            </p>
            <p>Aussi appelé CVaR (Conditional VaR), TVaR (Tail VaR), ou Average VaR.</p>
        </div>

        <div class="box">
            <h4>ES pour une Distribution Normale</h4>
            <p>Si R ~ N(μ, σ²), alors :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                ES_α = -μ + σ × φ(z_α)/α
            </p>
            <p>où φ est la densité de la loi normale standard et z_α = Φ⁻¹(α).</p>
            <table>
                <thead><tr><th>Niveau</th><th>z_α</th><th>φ(z_α)/α</th></tr></thead>
                <tbody>
                    <tr><td>95%</td><td>1.645</td><td>2.06</td></tr>
                    <tr><td>99%</td><td>2.326</td><td>2.67</td></tr>
                </tbody>
            </table>
        </div>

        <h3>4.2 Comparaison VaR vs ES</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>VaR</h4>
                <ul>
                    <li>Quantile (un seul point)</li>
                    <li>Ignore l'ampleur des pertes extrêmes</li>
                    <li>Non sous-additive</li>
                    <li>Standard réglementaire historique</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Expected Shortfall</h4>
                <ul>
                    <li>Moyenne des pertes extrêmes</li>
                    <li>Capture la queue de distribution</li>
                    <li><span class="text-green">Sous-additive</span></li>
                    <li>Nouveau standard Bâle III/IV</li>
                </ul>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 5: DISTRIBUTIONS RÉELLES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>5. Distributions Réelles des Rendements</h2>

        <h3>5.1 Les "Fat Tails" (Queues Épaisses)</h3>

        <div class="box">
            <h4>Faits Stylisés des Rendements Financiers</h4>
            <ol>
                <li><strong>Leptokurtique :</strong> Kurtosis > 3 (plus de valeurs extrêmes que la normale)</li>
                <li><strong>Asymétrie négative :</strong> Skewness < 0 (grandes pertes plus probables)</li>
                <li><strong>Volatility clustering :</strong> Les périodes de forte volatilité se regroupent</li>
                <li><strong>Autocorrélation nulle :</strong> Les rendements sont (presque) imprévisibles</li>
            </ol>
        </div>

        <div class="box">
            <h4>Moments Statistiques</h4>
            <table>
                <thead><tr><th>Moment</th><th>Formule</th><th>Normal</th><th>Typique (actions)</th></tr></thead>
                <tbody>
                    <tr>
                        <td>Moyenne</td>
                        <td>E[R]</td>
                        <td>μ</td>
                        <td>~8%/an</td>
                    </tr>
                    <tr>
                        <td>Variance</td>
                        <td>E[(R-μ)²]</td>
                        <td>σ²</td>
                        <td>~20%²/an</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Skewness</span></td>
                        <td>E[(R-μ)³]/σ³</td>
                        <td>0</td>
                        <td>-0.5 à -1</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Kurtosis</span></td>
                        <td>E[(R-μ)⁴]/σ⁴</td>
                        <td>3</td>
                        <td>5 à 10+</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3>5.2 Conséquences pour la Gestion des Risques</h3>

        <div class="box">
            <h4>Sous-estimation du Risque par les Modèles Gaussiens</h4>
            <p>Sous une loi normale, un événement à 5σ a une probabilité de ~3 × 10⁻⁷ (une fois tous les 7000 ans).</p>
            <p>En réalité, de tels événements arrivent <span class="text-red">tous les quelques années</span> !</p>
            <table>
                <thead><tr><th>Événement</th><th>Prob. Normale</th><th>Réalité approximative</th></tr></thead>
                <tbody>
                    <tr><td>3σ</td><td>0.27%</td><td>~1-2%</td></tr>
                    <tr><td>4σ</td><td>0.006%</td><td>~0.1-0.5%</td></tr>
                    <tr><td>5σ</td><td>0.00006%</td><td>~0.01-0.1%</td></tr>
                </tbody>
            </table>
        </div>

        <blockquote>
            <p>"La distribution normale est très mauvaise pour modéliser les rendements financiers. Les événements à 5 sigmas arrivent tous les quelques années, pas tous les 7000 ans."</p>
            <cite>Nassim Taleb, The Black Swan</cite>
        </blockquote>

        <h3>5.3 Alternatives à la Distribution Normale</h3>

        <div class="box">
            <h4>Distributions à Queues Épaisses</h4>
            <ul>
                <li><strong>Student-t :</strong> Queues plus épaisses, paramètre ν contrôle l'épaisseur</li>
                <li><strong>Distributions stables (Lévy) :</strong> Famille générale incluant la normale</li>
                <li><strong>Valeurs extrêmes (GEV) :</strong> Pour modéliser les queues uniquement</li>
                <li><strong>Mélanges de normales :</strong> Captures les régimes de volatilité</li>
            </ul>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 6: MESURES DE RISQUE COHÉRENTES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>6. Mesures de Risque Cohérentes</h2>

        <div class="box">
            <h4>Définition : Mesure de Risque Cohérente (Artzner et al., 1999)</h4>
            <p>Une mesure de risque ρ est <span class="text-red">cohérente</span> si elle satisfait :</p>
            <ol>
                <li><strong>Monotonie :</strong> Si X ≤ Y p.s., alors ρ(X) ≥ ρ(Y)</li>
                <li><strong>Sous-additivité :</strong> ρ(X + Y) ≤ ρ(X) + ρ(Y)</li>
                <li><strong>Homogénéité positive :</strong> ρ(λX) = λρ(X) pour λ > 0</li>
                <li><strong>Invariance par translation :</strong> ρ(X + c) = ρ(X) - c</li>
            </ol>
        </div>

        <div class="grid-2">
            <div class="grid-item">
                <h4>VaR</h4>
                <ul>
                    <li>✓ Monotonie</li>
                    <li><span class="text-red">✗ Sous-additivité</span></li>
                    <li>✓ Homogénéité</li>
                    <li>✓ Invariance</li>
                </ul>
                <p><strong>Pas cohérente !</strong></p>
            </div>
            <div class="grid-item">
                <h4>Expected Shortfall</h4>
                <ul>
                    <li>✓ Monotonie</li>
                    <li><span class="text-green">✓ Sous-additivité</span></li>
                    <li>✓ Homogénéité</li>
                    <li>✓ Invariance</li>
                </ul>
                <p><strong>Cohérente !</strong></p>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             GRAPHIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h3>Visualisation : Distribution des Rendements et Mesures de Risque</h3>
        <div class="chart-container">
            <canvas id="riskMeasuresChart"></canvas>
        </div>
        <p class="caption">Distribution des rendements d'un portefeuille avec VaR 95% et Expected Shortfall. La zone rouge représente les 5% de pires scénarios.</p>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             EXERCICES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="exercices-m13">Exercices</h2>

        <div class="exercise-box">
            <h4>Exercice 1 : Conversion de Rendements</h4>
            <p>Un actif a un rendement simple de 12% sur l'année.</p>
            <p><strong>Question :</strong> Quel est le log-rendement correspondant ?</p>

            <input type="text" class="exercise-calc-input" id="m13-log" placeholder="r = ? (en %)">
            <button class="check-btn" onclick="checkM13Log()">Vérifier</button>
            <div id="feedback-m13-log" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>r = ln(1 + R) = ln(1.12) = <span class="text-red">0.1133 soit 11.33%</span></p>
                    <p>Le log-rendement est toujours inférieur au rendement simple (pour R > 0).</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 2 : Annualisation de Volatilité</h4>
            <p>La volatilité journalière d'un actif est de 1.8%.</p>
            <p><strong>Question :</strong> Quelle est la volatilité annualisée ?</p>

            <input type="text" class="exercise-calc-input" id="m13-vol" placeholder="σ_annuel = ? (en %)">
            <button class="check-btn" onclick="checkM13Vol()">Vérifier</button>
            <div id="feedback-m13-vol" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>σ_annuel = σ_journalier × √252 = 1.8% × √252 = 1.8% × 15.87</p>
                    <p>σ_annuel ≈ <span class="text-red">28.6%</span></p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 3 : Calcul de VaR Paramétrique</h4>
            <p>Un portefeuille a μ = 0.05%/jour et σ = 1.2%/jour.</p>
            <p><strong>Question :</strong> Calculez la VaR 95% journalière (z₀.₀₅ = 1.645).</p>

            <input type="text" class="exercise-calc-input" id="m13-var" placeholder="VaR 95% = ? (en %)">
            <button class="check-btn" onclick="checkM13VaR()">Vérifier</button>
            <div id="feedback-m13-var" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>VaR_95% = -μ + z × σ = -0.05% + 1.645 × 1.2%</p>
                    <p>VaR_95% = -0.05% + 1.974% ≈ <span class="text-red">1.92%</span></p>
                    <p>Il y a 5% de chances de perdre plus de 1.92% en une journée.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 4 : Pénalité de Volatilité</h4>
            <p>Un actif a un rendement arithmétique moyen de 15% et une volatilité de 30%.</p>
            <p><strong>Question :</strong> Estimez le rendement géométrique (réel) attendu.</p>

            <input type="text" class="exercise-calc-input" id="m13-geom" placeholder="R_géom ≈ ? (en %)">
            <button class="check-btn" onclick="checkM13Geom()">Vérifier</button>
            <div id="feedback-m13-geom" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>R_géom ≈ R_arith - σ²/2 = 15% - (30%)²/2</p>
                    <p>R_géom ≈ 15% - 4.5% = <span class="text-red">10.5%</span></p>
                    <p>La volatilité "coûte" 4.5% de rendement réel !</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 5 : Kurtosis et Fat Tails</h4>
            <p>Un actif a un kurtosis de 6 (contre 3 pour une normale).</p>
            <p><strong>Question :</strong> Que signifie ce kurtosis ? La VaR gaussienne sous-estime-t-elle ou surestime-t-elle le risque ?</p>

            <input type="text" class="exercise-calc-input" id="m13-kurt" placeholder="La VaR gaussienne...">
            <button class="check-btn" onclick="checkM13Kurt()">Vérifier</button>
            <div id="feedback-m13-kurt" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p><strong>Kurtosis > 3</strong> signifie des queues plus épaisses que la normale.</p>
                    <p>Les événements extrêmes sont plus fréquents que prédit par une gaussienne.</p>
                    <p>La VaR gaussienne <span class="text-red">SOUS-ESTIME</span> le risque réel.</p>
                </div>
            </details>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             FLASHCARDS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="flashcards-m13">Flashcards</h2>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi utiliser les log-rendements ?</p></div>
                    <div class="flashcard-back"><p>Ils sont additifs sur le temps : r_total = r₁ + r₂ + ... + rₙ. Pratique pour calculer des rendements multi-périodes et pour la modélisation (GBM).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Comment annualiser la volatilité journalière ?</p></div>
                    <div class="flashcard-back"><p>σ_annuel = σ_jour × √252. La règle √T vient de l'hypothèse de rendements i.i.d. : Var(somme) = n × Var.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la formule de VaR paramétrique ?</p></div>
                    <div class="flashcard-back"><p>VaR_α = -μ + z_α × σ, où z_α est le quantile de la normale standard (z₀.₀₅ = 1.645, z₀.₀₁ = 2.326).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la limite principale de la VaR ?</p></div>
                    <div class="flashcard-back"><p>Elle ne dit rien sur l'ampleur des pertes au-delà du seuil. Un portefeuille peut avoir une faible VaR mais des pertes catastrophiques possibles.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que l'Expected Shortfall ?</p></div>
                    <div class="flashcard-back"><p>ES_α = E[Perte | Perte > VaR_α]. C'est la perte moyenne dans les α% pires cas. Aussi appelé CVaR ou TVaR.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi l'ES est-il préférable à la VaR ?</p></div>
                    <div class="flashcard-back"><p>L'ES est une mesure de risque cohérente (sous-additive). La VaR ne l'est pas : diversifier peut augmenter la VaR d'un portefeuille !</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Que sont les "fat tails" ?</p></div>
                    <div class="flashcard-back"><p>Des queues de distribution plus épaisses que la normale (kurtosis > 3). Les événements extrêmes sont plus fréquents que prédit par le modèle gaussien.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que la sous-additivité ?</p></div>
                    <div class="flashcard-back"><p>ρ(X+Y) ≤ ρ(X) + ρ(Y). Le risque d'un portefeuille ne doit pas dépasser la somme des risques individuels. La diversification réduit le risque.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la pénalité de volatilité ?</p></div>
                    <div class="flashcard-back"><p>R_géom ≈ R_arith - σ²/2. Le rendement réel est inférieur au rendement moyen arithmétique à cause de la volatilité.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le skewness négatif ?</p></div>
                    <div class="flashcard-back"><p>Une asymétrie vers les pertes : les grandes pertes sont plus probables que les grands gains. Typique des rendements d'actions (skew ≈ -0.5 à -1).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelles sont les 4 propriétés d'une mesure cohérente ?</p></div>
                    <div class="flashcard-back"><p>1. Monotonie 2. Sous-additivité 3. Homogénéité positive 4. Invariance par translation. La VaR échoue sur la sous-additivité.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le volatility clustering ?</p></div>
                    <div class="flashcard-back"><p>Les périodes de forte volatilité se regroupent : après un grand mouvement, d'autres grands mouvements sont probables. Capturé par les modèles GARCH.</p></div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module12')">⬅ Précédent : Applications Stochastiques</button>
            <button class="nav-btn" onclick="showModule('module14')">Suivant : Théorie de Markowitz ➡</button>
        </div>
    </section>

    <section id="module14" class="module">
        <header class="module-header">
            <h1>Module 14 : Théorie Moderne du Portefeuille</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermédiaire</span>
                <span>180 minutes</span>
                <span>Prérequis : Modules 5, 7, 13</span>
            </div>
        </header>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             INTRODUCTION ET CONTEXTE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/en/1/10/Harry_Markowitz.jpg" alt="Harry Markowitz">
            <figcaption>Harry Markowitz (1927-2023) - Prix Nobel 1990, père de la théorie moderne du portefeuille</figcaption>
        </figure>

        <h4>Objectifs du Module</h4>
        <ul>
            <li>Comprendre le principe fondamental de la diversification et son effet sur le risque</li>
            <li>Maîtriser la formulation mathématique du problème d'optimisation moyenne-variance</li>
            <li>Construire et interpréter la frontière efficiente de Markowitz</li>
            <li>Calculer le portefeuille à variance minimale globale (GMV)</li>
            <li>Comprendre le rôle de l'actif sans risque et la Capital Market Line (CML)</li>
            <li>Appliquer le théorème de séparation de Tobin</li>
            <li>Analyser les limites pratiques et les solutions modernes</li>
        </ul>

        <div class="box">
            <h4>La Révolution Markowitz : Quantifier la Diversification</h4>
            <p>Avant 1952, la diversification était une intuition. <span class="text-red">Harry Markowitz</span> l'a transformée en science mathématique rigoureuse.</p>
            <p>Son insight fondamental : le risque d'un portefeuille n'est pas la moyenne des risques individuels, mais dépend des <span class="text-red">corrélations</span> entre actifs.</p>
            <p>Cette découverte a révolutionné la gestion d'actifs et valu à Markowitz le Prix Nobel d'économie en 1990.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             TIMELINE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>Chronologie de la Théorie du Portefeuille</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1738</div>
                <div class="timeline-content">
                    <h4>Daniel Bernoulli - Utilité et Aversion au Risque</h4>
                    <p>Le Paradoxe de Saint-Pétersbourg montre que les investisseurs ne maximisent pas le gain espéré mais l'utilité espérée. Première formalisation de l'aversion au risque.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1900</div>
                <div class="timeline-content">
                    <h4>Louis Bachelier - Rendements Aléatoires</h4>
                    <p>Dans "Théorie de la Spéculation", Bachelier modélise les prix comme des marches aléatoires. Première utilisation des probabilités en finance.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1952</div>
                <div class="timeline-content">
                    <h4>Harry Markowitz - "Portfolio Selection"</h4>
                    <p>Article fondateur dans le Journal of Finance. Markowitz montre comment optimiser le couple rendement-risque et introduit la frontière efficiente. <span class="text-red">Naissance de la finance quantitative moderne.</span></p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1958</div>
                <div class="timeline-content">
                    <h4>James Tobin - Théorème de Séparation</h4>
                    <p>"Liquidity Preference as Behavior Towards Risk" : en présence d'un actif sans risque, tous les investisseurs détiennent le même portefeuille risqué. Prix Nobel 1981.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1964</div>
                <div class="timeline-content">
                    <h4>William Sharpe - CAPM</h4>
                    <p>Le Capital Asset Pricing Model lie rendement espéré et risque systématique. Extension logique de Markowitz à l'équilibre de marché. Prix Nobel 1990.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1992</div>
                <div class="timeline-content">
                    <h4>Black-Litterman - Solution aux Limites</h4>
                    <p>Fischer Black et Robert Litterman (Goldman Sachs) proposent une méthode combinant équilibre de marché et vues de l'investisseur pour stabiliser l'optimisation.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">2004</div>
                <div class="timeline-content">
                    <h4>Ledoit-Wolf - Shrinkage de Covariance</h4>
                    <p>Technique de régularisation pour améliorer l'estimation de la matrice de covariance. Devient un standard de l'industrie.</p>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 1: LA DIVERSIFICATION
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>1. Le Principe de Diversification</h2>

        <h3>1.1 L'Intuition : Ne Pas Mettre Tous ses Œufs dans le Même Panier</h3>

        <div class="box">
            <h4>Un Exemple Simple</h4>
            <p>Considérons deux actifs :</p>
            <ul>
                <li><strong>Action pétrole :</strong> +40% si le pétrole monte, -20% si le pétrole baisse</li>
                <li><strong>Action compagnie aérienne :</strong> -20% si le pétrole monte, +40% si le pétrole baisse</li>
            </ul>
            <p>Si on investit 50% dans chaque : <span class="text-green">+10% dans tous les cas !</span></p>
            <p>La diversification a <span class="text-red">éliminé le risque</span> tout en conservant le rendement.</p>
        </div>

        <h3>1.2 Formalisation Mathématique</h3>

        <div class="box">
            <h4>Rendement d'un Portefeuille</h4>
            <p>Pour un portefeuille de n actifs avec poids w = (w₁, ..., wₙ) :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Rₚ = Σᵢ wᵢRᵢ = w'R
            </p>
            <p><strong>Espérance :</strong> E[Rₚ] = Σᵢ wᵢE[Rᵢ] = w'μ</p>
        </div>

        <div class="box">
            <h4>Variance d'un Portefeuille</h4>
            <p>La variance du portefeuille est :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                σ²ₚ = Var(Rₚ) = w'Σw = ΣᵢΣⱼ wᵢwⱼσᵢⱼ
            </p>
            <p>où Σ est la matrice de variance-covariance et σᵢⱼ = Cov(Rᵢ, Rⱼ).</p>
        </div>

        <h3>1.3 Cas de Deux Actifs</h3>

        <div class="box">
            <h4>Formule Fondamentale pour Deux Actifs</h4>
            <p>Pour deux actifs avec poids w₁ et w₂ = 1 - w₁ :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                σ²ₚ = w₁²σ₁² + w₂²σ₂² + 2w₁w₂ρ₁₂σ₁σ₂
            </p>
            <p>où ρ₁₂ = Corr(R₁, R₂) est la corrélation entre les deux actifs.</p>
        </div>

        <div class="box">
            <h4>Impact de la Corrélation</h4>
            <table>
                <thead>
                    <tr><th>Corrélation ρ</th><th>Effet sur le risque</th><th>Interprétation</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ρ = +1</td>
                        <td>σₚ = w₁σ₁ + w₂σ₂</td>
                        <td>Pas de diversification</td>
                    </tr>
                    <tr>
                        <td>ρ = 0</td>
                        <td>σₚ = √(w₁²σ₁² + w₂²σ₂²)</td>
                        <td>Diversification partielle</td>
                    </tr>
                    <tr>
                        <td>ρ = -1</td>
                        <td>σₚ = |w₁σ₁ - w₂σ₂|</td>
                        <td><span class="text-green">Risque éliminable !</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box">
            <h4>Portefeuille sans Risque (ρ = -1)</h4>
            <p>Si ρ = -1, on peut éliminer tout le risque en choisissant :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                w₁* = σ₂ / (σ₁ + σ₂) et w₂* = σ₁ / (σ₁ + σ₂)
            </p>
            <p>Ce portefeuille a une volatilité nulle : σₚ = 0.</p>
        </div>

        <h3>1.4 Risque Systématique vs Spécifique</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Risque Spécifique (Diversifiable)</h4>
                <ul>
                    <li>Propre à chaque entreprise</li>
                    <li>Exemples : scandales, grèves, erreurs de gestion</li>
                    <li><span class="text-green">Éliminé par diversification</span></li>
                    <li>Non rémunéré par le marché</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Risque Systématique (Non Diversifiable)</h4>
                <ul>
                    <li>Affecte tout le marché</li>
                    <li>Exemples : récession, inflation, guerre</li>
                    <li><span class="text-red">Ne peut être éliminé</span></li>
                    <li>Rémunéré par une prime de risque</li>
                </ul>
            </div>
        </div>

        <div class="box">
            <h4>Convergence vers le Risque Systématique</h4>
            <p>Pour n actifs équipondérés avec variance σ² et covariance moyenne σ̄ᵢⱼ :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                σ²ₚ = (1/n)σ² + (1 - 1/n)σ̄ᵢⱼ → σ̄ᵢⱼ quand n → ∞
            </p>
            <p>Le risque converge vers la covariance moyenne : c'est le risque systématique incompressible.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 2: OPTIMISATION MOYENNE-VARIANCE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>2. Optimisation Moyenne-Variance</h2>

        <h3>2.1 Le Problème de Markowitz</h3>

        <div class="box">
            <h4>Formulation du Problème d'Optimisation</h4>
            <p><strong>Objectif :</strong> Minimiser le risque pour un rendement cible</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                min w'Σw<br>
                s.c. w'μ = μ_cible (contrainte de rendement)<br>
                w'𝟙 = 1 (poids somment à 1)
            </p>
        </div>

        <div class="box">
            <h4>Formulation Alternative : Maximisation d'Utilité</h4>
            <p>De manière équivalente, on peut maximiser une fonction d'utilité :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                max U(w) = w'μ - (γ/2)w'Σw
            </p>
            <p>où γ > 0 est le coefficient d'aversion au risque.</p>
            <ul>
                <li>γ petit : investisseur agressif (tolère le risque)</li>
                <li>γ grand : investisseur conservateur (évite le risque)</li>
            </ul>
        </div>

        <h3>2.2 Solution Analytique avec Lagrangien</h3>

        <div class="box">
            <h4>Méthode de Lagrange</h4>
            <p>Le Lagrangien du problème est :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                L = ½w'Σw - λ(w'μ - μ_cible) - δ(w'𝟙 - 1)
            </p>
            <p><strong>Conditions du premier ordre :</strong></p>
            <p style="font-family: monospace; text-align: center;">
                ∂L/∂w = Σw - λμ - δ𝟙 = 0
            </p>
            <p><strong>Solution :</strong></p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                w* = Σ⁻¹(λμ + δ𝟙)
            </p>
        </div>

        <div class="box">
            <h4>Détermination des Multiplicateurs</h4>
            <p>En utilisant les contraintes, on trouve λ et δ. Définissons :</p>
            <ul>
                <li>A = 𝟙'Σ⁻¹𝟙</li>
                <li>B = 𝟙'Σ⁻¹μ = μ'Σ⁻¹𝟙</li>
                <li>C = μ'Σ⁻¹μ</li>
                <li>D = AC - B² > 0</li>
            </ul>
            <p>Alors :</p>
            <p style="font-family: monospace; text-align: center;">
                λ = (Aμ_cible - B) / D et δ = (C - Bμ_cible) / D
            </p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 3: FRONTIÈRE EFFICIENTE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>3. La Frontière Efficiente</h2>

        <h3>3.1 Définition et Propriétés</h3>

        <div class="box">
            <h4>Définition : Frontière Efficiente</h4>
            <p>La <span class="text-red">frontière efficiente</span> est l'ensemble des portefeuilles qui :</p>
            <ol>
                <li>Offrent le rendement <strong>maximum</strong> pour un niveau de risque donné</li>
                <li>Offrent le risque <strong>minimum</strong> pour un niveau de rendement donné</li>
            </ol>
            <p>C'est la partie supérieure de la "bullet" (ensemble des portefeuilles possibles).</p>
        </div>

        <div class="box">
            <h4>Équation de la Frontière (Parabole)</h4>
            <p>La variance minimale pour un rendement μₚ est :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                σ²ₚ = (A/D)(μₚ - B/A)² + 1/A
            </p>
            <p>C'est une parabole dans le plan (σ², μ) ou une hyperbole dans le plan (σ, μ).</p>
        </div>

        <h3>3.2 Portefeuille à Variance Minimale Globale (GMV)</h3>

        <div class="box">
            <h4>Le Portefeuille GMV</h4>
            <p>Le <span class="text-red">Global Minimum Variance</span> portfolio minimise le risque sans contrainte de rendement :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                w_GMV = Σ⁻¹𝟙 / (𝟙'Σ⁻¹𝟙) = Σ⁻¹𝟙 / A
            </p>
            <p><strong>Caractéristiques :</strong></p>
            <ul>
                <li>Rendement : μ_GMV = B/A</li>
                <li>Variance : σ²_GMV = 1/A</li>
                <li>C'est le point le plus à gauche de la frontière efficiente</li>
            </ul>
        </div>

        <h3>3.3 Deux Fonds de Séparation</h3>

        <div class="box">
            <h4>Théorème des Deux Fonds</h4>
            <p>Tout portefeuille efficient peut s'écrire comme combinaison de deux portefeuilles efficients quelconques.</p>
            <p>En pratique, on utilise souvent :</p>
            <ul>
                <li><strong>Portefeuille g :</strong> w_g = Σ⁻¹𝟙 / A (le GMV)</li>
                <li><strong>Portefeuille h :</strong> w_h = Σ⁻¹μ / B</li>
            </ul>
            <p>Tout portefeuille efficient : w = αw_g + (1-α)w_h pour un α ∈ ℝ.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 4: ACTIF SANS RISQUE ET CML
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>4. L'Actif Sans Risque et la CML</h2>

        <h3>4.1 Introduction de l'Actif Sans Risque</h3>

        <div class="box">
            <h4>Nouveau Problème d'Optimisation</h4>
            <p>Avec un actif sans risque de rendement Rᶠ :</p>
            <ul>
                <li>On investit w_f dans l'actif sans risque</li>
                <li>On investit w dans les actifs risqués, avec w'𝟙 = 1 - w_f</li>
            </ul>
            <p>Le rendement du portefeuille devient :</p>
            <p style="font-family: monospace; text-align: center;">
                Rₚ = w_f × Rᶠ + w'R
            </p>
        </div>

        <div class="box">
            <h4>Variance avec Actif Sans Risque</h4>
            <p>L'actif sans risque a une variance nulle et une covariance nulle avec tous les actifs :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                σ²ₚ = w'Σw (inchangée pour la partie risquée)
            </p>
            <p>La volatilité du portefeuille total : σₚ = (1 - w_f) × σ_risqué</p>
        </div>

        <h3>4.2 Le Portefeuille Tangent</h3>

        <div class="box">
            <h4>Définition : Portefeuille Tangent</h4>
            <p>Le <span class="text-red">portefeuille tangent</span> maximise le <strong>ratio de Sharpe</strong> :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                max SR = (E[Rₚ] - Rᶠ) / σₚ
            </p>
            <p>C'est le point où une droite partant de Rᶠ est tangente à la frontière efficiente.</p>
        </div>

        <div class="box">
            <h4>Formule du Portefeuille Tangent</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                w_T = Σ⁻¹(μ - Rᶠ𝟙) / [𝟙'Σ⁻¹(μ - Rᶠ𝟙)]
            </p>
            <p><strong>Propriétés :</strong></p>
            <ul>
                <li>Rendement : μ_T = w'_Tμ</li>
                <li>Volatilité : σ_T = √(w'_TΣw_T)</li>
                <li>Ratio de Sharpe maximal : SR_T = (μ_T - Rᶠ) / σ_T</li>
            </ul>
        </div>

        <h3>4.3 La Capital Market Line (CML)</h3>

        <div class="box">
            <h4>Équation de la CML</h4>
            <p>La <span class="text-red">Capital Market Line</span> relie l'actif sans risque au portefeuille tangent :</p>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                E[Rₚ] = Rᶠ + ((μ_T - Rᶠ) / σ_T) × σₚ
            </p>
            <p>La pente de la CML est le ratio de Sharpe du portefeuille tangent.</p>
        </div>

        <div class="box">
            <h4>Interprétation de la CML</h4>
            <ul>
                <li><strong>Intercept Rᶠ :</strong> Rendement de l'investissement sans risque</li>
                <li><strong>Pente (μ_T - Rᶠ)/σ_T :</strong> Prix du risque (rendement supplémentaire par unité de risque)</li>
                <li>La CML domine la frontière efficiente (même rendement, moins de risque)</li>
            </ul>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 5: THÉORÈME DE SÉPARATION
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>5. Théorème de Séparation de Tobin</h2>

        <div class="box">
            <h4>Énoncé du Théorème</h4>
            <p>Le <span class="text-red">théorème de séparation</span> (Tobin, 1958) stipule que :</p>
            <ol>
                <li>Tous les investisseurs rationnels détiennent le <strong>même portefeuille risqué</strong> : le portefeuille tangent</li>
                <li>Ils ajustent leur niveau de risque en combinant ce portefeuille avec l'actif sans risque</li>
            </ol>
            <p>La décision d'investissement se <strong>sépare</strong> en deux étapes indépendantes.</p>
        </div>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Étape 1 : Choix du Portefeuille Optimal</h4>
                <p>Identique pour tous :</p>
                <ul>
                    <li>Trouver le portefeuille tangent</li>
                    <li>Ne dépend que de μ, Σ, et Rᶠ</li>
                    <li>Indépendant des préférences individuelles</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Étape 2 : Allocation Risqué/Sans Risque</h4>
                <p>Personnalisée selon l'aversion au risque :</p>
                <ul>
                    <li>Investisseur agressif : emprunte pour investir > 100% dans le tangent</li>
                    <li>Investisseur conservateur : < 100% dans le tangent, reste en Rᶠ</li>
                </ul>
            </div>
        </div>

        <div class="box">
            <h4>Implications Pratiques</h4>
            <ul>
                <li><strong>Gestion déléguée :</strong> Un gérant peut créer un seul fonds optimal pour tous</li>
                <li><strong>Simplicité :</strong> Les clients ajustent leur risque via le levier</li>
                <li><strong>Fondement des fonds indiciels :</strong> Si le tangent = marché, tous devraient détenir l'indice</li>
            </ul>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 6: LIMITES ET SOLUTIONS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>6. Limites de l'Approche Markowitz</h2>

        <h3>6.1 Le Problème de l'Estimation</h3>

        <div class="box">
            <h4>L'Erreur d'Estimation Maximisée</h4>
            <p>L'optimisation de Markowitz est un <span class="text-red">"error maximizer"</span> :</p>
            <ul>
                <li>Les rendements espérés sont très difficiles à estimer</li>
                <li>La matrice de covariance est instable</li>
                <li>L'optimisation amplifie les erreurs : elle surpondère les actifs dont on a surestimé le rendement</li>
            </ul>
            <p><strong>Résultat :</strong> Portefeuilles extrêmes et instables dans le temps.</p>
        </div>

        <div class="box">
            <h4>Nombre de Paramètres à Estimer</h4>
            <p>Pour n actifs, il faut estimer :</p>
            <ul>
                <li>n rendements espérés</li>
                <li>n variances</li>
                <li>n(n-1)/2 covariances</li>
            </ul>
            <p><strong>Total :</strong> n + n(n+1)/2 paramètres</p>
            <p>Pour 100 actifs : <span class="text-red">5 150 paramètres !</span></p>
        </div>

        <h3>6.2 Solutions Modernes</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Shrinkage (Ledoit-Wolf)</h4>
                <p>"Rétrécir" la covariance échantillon vers une cible :</p>
                <p style="font-family: monospace;">Σ_shrunk = (1-α)Σ_sample + α×Target</p>
                <p>Target : identité, marché unique, facteurs...</p>
            </div>
            <div class="grid-item">
                <h4>Black-Litterman</h4>
                <p>Combiner l'équilibre de marché avec les vues de l'investisseur.</p>
                <p>Point de départ : rendements d'équilibre (CAPM inversé)</p>
                <p>Ajustements : vues avec confiance</p>
            </div>
        </div>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Contraintes de Poids</h4>
                <ul>
                    <li>Pas de vente à découvert : wᵢ ≥ 0</li>
                    <li>Limites supérieures : wᵢ ≤ w_max</li>
                    <li>Contraintes sectorielles</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Approches Robustes</h4>
                <ul>
                    <li>Resampling (Michaud)</li>
                    <li>Portefeuille 1/N (équipondéré)</li>
                    <li>Risk Parity</li>
                </ul>
            </div>
        </div>

        <div class="box">
            <h4>Le Paradoxe du 1/N</h4>
            <p>DeMiguel, Garlappi et Uppal (2009) ont montré que le portefeuille équipondéré (1/N) surperforme souvent Markowitz en out-of-sample !</p>
            <p><strong>Raison :</strong> L'erreur d'estimation est si grande qu'une allocation naïve peut être meilleure qu'une "optimisation" bruitée.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             GRAPHIQUE INTERACTIF
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h3>Visualisation : Frontière Efficiente et CML</h3>
        <div class="chart-container">
            <canvas id="efficientFrontierChartM14"></canvas>
        </div>
        <p class="caption">La frontière efficiente (en cyan) et la Capital Market Line (en jaune). Le point vert est le portefeuille tangent, le point rouge est le GMV. L'actif sans risque est à l'origine de la CML.</p>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             EXERCICES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="exercices-m14">Exercices</h2>

        <div class="exercise-box">
            <h4>Exercice 1 : Variance d'un Portefeuille à Deux Actifs</h4>
            <p>Deux actifs ont σ₁ = 20%, σ₂ = 30%, et ρ₁₂ = 0.4.</p>
            <p>Un portefeuille contient 60% de l'actif 1 et 40% de l'actif 2.</p>
            <p><strong>Question :</strong> Quelle est la volatilité du portefeuille ?</p>

            <input type="text" class="exercise-calc-input" id="m14-vol" placeholder="σₚ = ? (en %)">
            <button class="check-btn" onclick="checkM14Vol()">Vérifier</button>
            <div id="feedback-m14-vol" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>σ²ₚ = w₁²σ₁² + w₂²σ₂² + 2w₁w₂ρσ₁σ₂</p>
                    <p>σ²ₚ = 0.6² × 0.2² + 0.4² × 0.3² + 2 × 0.6 × 0.4 × 0.4 × 0.2 × 0.3</p>
                    <p>σ²ₚ = 0.0144 + 0.0144 + 0.01152 = 0.04032</p>
                    <p>σₚ = √0.04032 ≈ <span class="text-red">20.1%</span></p>
                    <p>Notez que c'est inférieur à la moyenne pondérée (0.6×20% + 0.4×30% = 24%).</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 2 : Portefeuille sans Risque avec Corrélation -1</h4>
            <p>Deux actifs ont σ₁ = 15%, σ₂ = 25%, et ρ₁₂ = -1.</p>
            <p><strong>Question :</strong> Quel poids donner à l'actif 1 pour avoir un portefeuille sans risque ?</p>

            <input type="text" class="exercise-calc-input" id="m14-zero" placeholder="w₁ = ? (en %)">
            <button class="check-btn" onclick="checkM14Zero()">Vérifier</button>
            <div id="feedback-m14-zero" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Pour ρ = -1, σₚ = |w₁σ₁ - w₂σ₂| = 0 quand w₁σ₁ = w₂σ₂</p>
                    <p>Avec w₂ = 1 - w₁ : w₁ × 15% = (1 - w₁) × 25%</p>
                    <p>15w₁ = 25 - 25w₁ → 40w₁ = 25</p>
                    <p>w₁ = 25/40 = <span class="text-red">62.5%</span></p>
                    <p>Avec 62.5% dans l'actif 1 et 37.5% dans l'actif 2, σₚ = 0.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 3 : Portefeuille GMV</h4>
            <p>On a deux actifs avec μ₁ = 10%, μ₂ = 15%, σ₁ = 20%, σ₂ = 30%, ρ = 0.3.</p>
            <p><strong>Question :</strong> Calculez le poids optimal w₁ du portefeuille GMV.</p>
            <p><em>Hint :</em> Minimisez σ²ₚ par rapport à w₁ (w₂ = 1 - w₁).</p>

            <input type="text" class="exercise-calc-input" id="m14-gmv" placeholder="w₁ GMV = ? (en %)">
            <button class="check-btn" onclick="checkM14GMV()">Vérifier</button>
            <div id="feedback-m14-gmv" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>σ²ₚ = w₁²σ₁² + (1-w₁)²σ₂² + 2w₁(1-w₁)ρσ₁σ₂</p>
                    <p>∂σ²ₚ/∂w₁ = 2w₁σ₁² - 2(1-w₁)σ₂² + 2(1-2w₁)ρσ₁σ₂ = 0</p>
                    <p>w₁(σ₁² + σ₂² - 2ρσ₁σ₂) = σ₂² - ρσ₁σ₂</p>
                    <p>w₁ = (σ₂² - ρσ₁σ₂) / (σ₁² + σ₂² - 2ρσ₁σ₂)</p>
                    <p>w₁ = (0.09 - 0.3×0.2×0.3) / (0.04 + 0.09 - 2×0.3×0.2×0.3)</p>
                    <p>w₁ = (0.09 - 0.018) / (0.13 - 0.036) = 0.072 / 0.094</p>
                    <p>w₁ ≈ <span class="text-red">76.6%</span></p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 4 : Ratio de Sharpe</h4>
            <p>Un portefeuille a μₚ = 12%, σₚ = 18%, avec Rᶠ = 2%.</p>
            <p><strong>Question :</strong> Quel est le ratio de Sharpe de ce portefeuille ?</p>

            <input type="text" class="exercise-calc-input" id="m14-sharpe" placeholder="SR = ?">
            <button class="check-btn" onclick="checkM14Sharpe()">Vérifier</button>
            <div id="feedback-m14-sharpe" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>SR = (μₚ - Rᶠ) / σₚ = (12% - 2%) / 18%</p>
                    <p>SR = 10% / 18% ≈ <span class="text-red">0.56</span></p>
                    <p>Interprétation : Pour chaque 1% de risque pris, on gagne 0.56% de rendement excédentaire.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 5 : CML et Allocation</h4>
            <p>Le portefeuille tangent a μ_T = 14%, σ_T = 20%. Le taux sans risque est Rᶠ = 3%.</p>
            <p>Un investisseur souhaite un rendement espéré de 10%.</p>
            <p><strong>Question :</strong> Quelle part doit-il investir dans le portefeuille tangent ?</p>

            <input type="text" class="exercise-calc-input" id="m14-cml" placeholder="Part tangent = ? (en %)">
            <button class="check-btn" onclick="checkM14CML()">Vérifier</button>
            <div id="feedback-m14-cml" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>μₚ = w × μ_T + (1-w) × Rᶠ</p>
                    <p>10% = w × 14% + (1-w) × 3%</p>
                    <p>10% = 14%w + 3% - 3%w = 11%w + 3%</p>
                    <p>7% = 11%w → w = 7/11 ≈ <span class="text-red">63.6%</span></p>
                    <p>Il doit investir 63.6% dans le tangent et 36.4% dans l'actif sans risque.</p>
                    <p>Sa volatilité sera : σₚ = 0.636 × 20% = 12.7%</p>
                </div>
            </details>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             FLASHCARDS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="flashcards-m14">Flashcards</h2>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que la frontière efficiente ?</p></div>
                    <div class="flashcard-back"><p>L'ensemble des portefeuilles offrant le rendement max pour un risque donné (ou risque min pour un rendement donné). Partie supérieure de la "bullet".</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la formule de variance d'un portefeuille à 2 actifs ?</p></div>
                    <div class="flashcard-back"><p>σ²ₚ = w₁²σ₁² + w₂²σ₂² + 2w₁w₂ρσ₁σ₂. La corrélation ρ détermine le bénéfice de diversification.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le portefeuille GMV ?</p></div>
                    <div class="flashcard-back"><p>Global Minimum Variance : le portefeuille avec le risque le plus faible possible. w_GMV = Σ⁻¹𝟙 / (𝟙'Σ⁻¹𝟙). Point le plus à gauche de la frontière.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le portefeuille tangent ?</p></div>
                    <div class="flashcard-back"><p>Le portefeuille risqué qui maximise le ratio de Sharpe. Point de tangence entre la CML et la frontière efficiente.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est l'équation de la CML ?</p></div>
                    <div class="flashcard-back"><p>E[Rₚ] = Rᶠ + [(μ_T - Rᶠ)/σ_T] × σₚ. La pente est le ratio de Sharpe du portefeuille tangent (prix du risque).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Que dit le théorème de séparation de Tobin ?</p></div>
                    <div class="flashcard-back"><p>Tous les investisseurs détiennent le même portefeuille risqué (tangent). Ils ajustent leur risque uniquement via l'allocation entre actif risqué et sans risque.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi Markowitz est-il un "error maximizer" ?</p></div>
                    <div class="flashcard-back"><p>L'optimisation surpondère les actifs aux rendements surestimés et sous-pondère ceux sous-estimés. Les erreurs d'estimation sont amplifiées.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le shrinkage de Ledoit-Wolf ?</p></div>
                    <div class="flashcard-back"><p>Technique de régularisation : Σ_shrunk = (1-α)Σ_sample + α×Target. Réduit l'instabilité de la matrice de covariance estimée.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que Black-Litterman ?</p></div>
                    <div class="flashcard-back"><p>Modèle combinant les rendements d'équilibre (CAPM) avec les vues de l'investisseur. Produit des portefeuilles plus stables que Markowitz pur.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la différence entre risque spécifique et systématique ?</p></div>
                    <div class="flashcard-back"><p>Spécifique : propre à l'entreprise, diversifiable, non rémunéré. Systématique : affecte le marché, non diversifiable, rémunéré par la prime de risque.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Que se passe-t-il si ρ = -1 ?</p></div>
                    <div class="flashcard-back"><p>On peut créer un portefeuille sans risque ! w₁ = σ₂/(σ₁+σ₂), w₂ = σ₁/(σ₁+σ₂) donne σₚ = 0.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi le portefeuille 1/N peut surperformer Markowitz ?</p></div>
                    <div class="flashcard-back"><p>L'erreur d'estimation est si grande que l'allocation naïve équipondérée peut battre une optimisation bruitée. Paradoxe démontré par DeMiguel et al. (2009).</p></div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module13')">⬅ Précédent : Rendement et Risque</button>
            <button class="nav-btn" onclick="showModule('module15')">Suivant : CAPM et APT ➡</button>
        </div>
    </section>

    <section id="module15" class="module">
        <header class="module-header">
            <h1>Module 15 : Modèles d'Évaluation d'Actifs</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermédiaire</span>
                <span>180 minutes</span>
                <span>Prérequis : Modules 13, 14</span>
            </div>
        </header>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             INTRODUCTION ET CONTEXTE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/90/Nobel_Prize_2013-Press_Conference_KVA-DSC_7398.jpg/800px-Nobel_Prize_2013-Press_Conference_KVA-DSC_7398.jpg" alt="Eugene Fama">
            <figcaption>Eugene Fama (gauche) - Prix Nobel 2013 pour ses travaux sur l'efficience des marchés et les modèles factoriels</figcaption>
        </figure>

        <h4>Objectifs du Module</h4>
        <ul>
            <li>Comprendre et appliquer le Capital Asset Pricing Model (CAPM)</li>
            <li>Maîtriser l'interprétation du bêta comme mesure de risque systématique</li>
            <li>Distinguer la Security Market Line (SML) de la Capital Market Line (CML)</li>
            <li>Comprendre l'Arbitrage Pricing Theory (APT) de Ross</li>
            <li>Appliquer les modèles Fama-French (3 et 5 facteurs)</li>
            <li>Intégrer le facteur momentum de Carhart</li>
            <li>Analyser les anomalies et les limites de ces modèles</li>
        </ul>

        <div class="box">
            <h4>De Markowitz à l'Équilibre de Marché</h4>
            <p>Le CAPM répond à la question : <em>Si tous les investisseurs utilisaient l'approche de Markowitz, quel serait le prix d'équilibre des actifs ?</em></p>
            <p>La réponse révolutionnaire : <span class="text-red">seul le risque systématique (non diversifiable) est rémunéré.</span></p>
            <p>Le risque spécifique peut être éliminé gratuitement par diversification, donc le marché ne le rémunère pas.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             TIMELINE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>Chronologie des Modèles d'Évaluation</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1952</div>
                <div class="timeline-content">
                    <h4>Harry Markowitz - Théorie du Portefeuille</h4>
                    <p>La base : optimisation moyenne-variance. Le CAPM en est la conséquence logique à l'équilibre.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1964</div>
                <div class="timeline-content">
                    <h4>William Sharpe - CAPM</h4>
                    <p>"Capital Asset Prices: A Theory of Market Equilibrium". Le rendement espéré est linéaire en bêta. <span class="text-red">Prix Nobel 1990</span> (avec Markowitz et Miller).</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1965</div>
                <div class="timeline-content">
                    <h4>John Lintner - Extension du CAPM</h4>
                    <p>Développement indépendant du même modèle. Confirmation de la relation linéaire rendement-bêta.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1972</div>
                <div class="timeline-content">
                    <h4>Fischer Black - CAPM sans Actif Sans Risque</h4>
                    <p>Version "Zero-Beta CAPM" quand l'emprunt au taux sans risque n'est pas possible.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1976</div>
                <div class="timeline-content">
                    <h4>Stephen Ross - APT</h4>
                    <p>"The Arbitrage Theory of Capital Asset Pricing". Alternative au CAPM basée sur l'absence d'arbitrage, sans besoin du portefeuille de marché.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1977</div>
                <div class="timeline-content">
                    <h4>Roll - Critique du CAPM</h4>
                    <p>Richard Roll montre que le CAPM est non testable car le vrai portefeuille de marché est inobservable.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1993</div>
                <div class="timeline-content">
                    <h4>Fama-French - Modèle 3 Facteurs</h4>
                    <p>Eugene Fama et Kenneth French ajoutent les facteurs taille (SMB) et value (HML) au marché.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1997</div>
                <div class="timeline-content">
                    <h4>Carhart - Modèle 4 Facteurs</h4>
                    <p>Mark Carhart ajoute le facteur momentum (WML) : les gagnants passés surperforment.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">2015</div>
                <div class="timeline-content">
                    <h4>Fama-French - Modèle 5 Facteurs</h4>
                    <p>Ajout de la profitabilité (RMW) et de l'investissement (CMA). Le HML devient redondant.</p>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 1: CAPM
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>1. Le Capital Asset Pricing Model (CAPM)</h2>

        <h3>1.1 Hypothèses du CAPM</h3>

        <div class="box">
            <h4>Hypothèses du Modèle</h4>
            <ol>
                <li><strong>Investisseurs rationnels :</strong> Optimisent selon Markowitz (moyenne-variance)</li>
                <li><strong>Même horizon :</strong> Tous les investisseurs ont le même horizon d'investissement</li>
                <li><strong>Attentes homogènes :</strong> Tous estiment les mêmes μ et Σ</li>
                <li><strong>Actif sans risque :</strong> Existe un actif sans risque auquel on peut prêter/emprunter</li>
                <li><strong>Pas de frictions :</strong> Pas de taxes, coûts de transaction, restrictions</li>
                <li><strong>Actifs divisibles :</strong> On peut acheter n'importe quelle fraction</li>
            </ol>
        </div>

        <h3>1.2 L'Équation du CAPM</h3>

        <div class="box">
            <h4>Équation Fondamentale du CAPM</h4>
            <p style="text-align: center; font-family: monospace; font-size: 20px; background: var(--bg-hover); padding: 20px; border-radius: 8px;">
                E[Rᵢ] = Rᶠ + βᵢ × (E[Rₘ] - Rᶠ)
            </p>
            <p>où :</p>
            <ul>
                <li>E[Rᵢ] : Rendement espéré de l'actif i</li>
                <li>Rᶠ : Taux sans risque</li>
                <li>E[Rₘ] : Rendement espéré du portefeuille de marché</li>
                <li>E[Rₘ] - Rᶠ : <span class="text-red">Prime de risque de marché</span> (historiquement ~5-7%/an)</li>
                <li>βᵢ : Bêta de l'actif i</li>
            </ul>
        </div>

        <h3>1.3 Le Bêta : Mesure du Risque Systématique</h3>

        <div class="box">
            <h4>Définition du Bêta</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                βᵢ = Cov(Rᵢ, Rₘ) / Var(Rₘ) = ρᵢₘ × (σᵢ / σₘ)
            </p>
            <p>Le bêta mesure la <span class="text-red">sensibilité</span> d'un actif aux mouvements du marché.</p>
        </div>

        <div class="box">
            <h4>Interprétation du Bêta</h4>
            <table>
                <thead>
                    <tr><th>Bêta</th><th>Interprétation</th><th>Exemples typiques</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>β = 0</td>
                        <td>Aucune sensibilité au marché</td>
                        <td>Actif sans risque, or (parfois)</td>
                    </tr>
                    <tr>
                        <td>0 < β < 1</td>
                        <td>Défensif : amplifie moins que le marché</td>
                        <td>Utilities, santé, biens de consommation</td>
                    </tr>
                    <tr>
                        <td>β = 1</td>
                        <td>Suit exactement le marché</td>
                        <td>ETF S&P 500</td>
                    </tr>
                    <tr>
                        <td>β > 1</td>
                        <td>Agressif : amplifie le marché</td>
                        <td>Technologie, banques, small caps</td>
                    </tr>
                    <tr>
                        <td>β < 0</td>
                        <td>Relation inverse avec le marché</td>
                        <td>ETF inverse, certains métaux précieux</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box">
            <h4>Décomposition du Risque</h4>
            <p>Le risque total d'un actif se décompose :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                σ²ᵢ = β²ᵢσ²ₘ + σ²ₑᵢ
            </p>
            <ul>
                <li><span class="text-red">β²ᵢσ²ₘ</span> : Risque systématique (non diversifiable, rémunéré)</li>
                <li><span class="text-red">σ²ₑᵢ</span> : Risque spécifique (diversifiable, non rémunéré)</li>
            </ul>
        </div>

        <h3>1.4 La Security Market Line (SML)</h3>

        <div class="box">
            <h4>SML vs CML</h4>
            <table>
                <thead>
                    <tr><th>Caractéristique</th><th>Capital Market Line (CML)</th><th>Security Market Line (SML)</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Axe X</td>
                        <td>Volatilité totale (σ)</td>
                        <td>Bêta (β)</td>
                    </tr>
                    <tr>
                        <td>Applicable à</td>
                        <td>Portefeuilles efficients uniquement</td>
                        <td>Tous les actifs et portefeuilles</td>
                    </tr>
                    <tr>
                        <td>Pente</td>
                        <td>(E[Rₘ] - Rᶠ) / σₘ (Sharpe du marché)</td>
                        <td>E[Rₘ] - Rᶠ (prime de risque)</td>
                    </tr>
                    <tr>
                        <td>Interprétation</td>
                        <td>Frontière efficiente avec actif sans risque</td>
                        <td>Relation d'équilibre pour tout actif</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box">
            <h4>Alpha : Écart à la SML</h4>
            <p>Si un actif n'est pas sur la SML :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                αᵢ = E[Rᵢ] - [Rᶠ + βᵢ(E[Rₘ] - Rᶠ)]
            </p>
            <ul>
                <li><span class="text-green">α > 0</span> : L'actif est sous-évalué (rendement excédentaire)</li>
                <li><span class="text-red">α < 0</span> : L'actif est surévalué (rendement insuffisant)</li>
                <li>α = 0 : L'actif est correctement évalué (sur la SML)</li>
            </ul>
        </div>

        <h3>1.5 Estimation et Tests du CAPM</h3>

        <div class="box">
            <h4>Régression pour Estimer le Bêta</h4>
            <p>On régresse les rendements excédentaires de l'actif sur ceux du marché :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Rᵢ - Rᶠ = α + β(Rₘ - Rᶠ) + εᵢ
            </p>
            <p><strong>Interprétation :</strong></p>
            <ul>
                <li>β̂ : pente de la régression = bêta estimé</li>
                <li>α̂ : intercept = alpha de Jensen (surperformance ajustée du risque)</li>
                <li>R² : part de variance expliquée par le marché</li>
            </ul>
        </div>

        <h3>1.6 Critiques et Limites du CAPM</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Problèmes Théoriques</h4>
                <ul>
                    <li><strong>Critique de Roll :</strong> Le portefeuille de marché est inobservable</li>
                    <li>Hypothèses irréalistes (attentes homogènes, pas de frictions)</li>
                    <li>Un seul facteur de risque</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Problèmes Empiriques</h4>
                <ul>
                    <li>Relation β-rendement trop plate</li>
                    <li>Anomalies : taille, value, momentum</li>
                    <li>Bêta instable dans le temps</li>
                </ul>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 2: APT
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>2. Arbitrage Pricing Theory (APT)</h2>

        <h3>2.1 Intuition et Hypothèses</h3>

        <div class="box">
            <h4>L'Idée de l'APT</h4>
            <p>Stephen Ross (1976) propose une alternative basée sur <span class="text-red">l'absence d'arbitrage</span> plutôt que sur l'équilibre de marché.</p>
            <p>Si les rendements sont générés par K facteurs, alors en l'absence d'arbitrage, le rendement espéré est linéaire dans les expositions aux facteurs.</p>
        </div>

        <div class="box">
            <h4>Structure Factorielle des Rendements</h4>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Rᵢ = E[Rᵢ] + β₁ᵢF₁ + β₂ᵢF₂ + ... + βₖᵢFₖ + εᵢ
            </p>
            <p>où :</p>
            <ul>
                <li>Fⱼ : Facteur j (innovation, E[Fⱼ] = 0)</li>
                <li>βⱼᵢ : Sensibilité de l'actif i au facteur j</li>
                <li>εᵢ : Risque spécifique (diversifiable)</li>
            </ul>
        </div>

        <h3>2.2 L'Équation de l'APT</h3>

        <div class="box">
            <h4>Relation de Pricing APT</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                E[Rᵢ] = Rᶠ + β₁ᵢλ₁ + β₂ᵢλ₂ + ... + βₖᵢλₖ
            </p>
            <p>où λⱼ est la <span class="text-red">prime de risque</span> du facteur j (rendement excédentaire par unité d'exposition).</p>
        </div>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Avantages de l'APT</h4>
                <ul>
                    <li>Pas besoin du portefeuille de marché</li>
                    <li>Multiple facteurs de risque</li>
                    <li>Basé sur l'arbitrage (plus général)</li>
                    <li>Hypothèses moins restrictives</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Inconvénients</h4>
                <ul>
                    <li>Facteurs non spécifiés par la théorie</li>
                    <li>Nombre de facteurs inconnu</li>
                    <li>Relation approchée (pas exacte)</li>
                </ul>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 3: MODÈLES FAMA-FRENCH
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>3. Modèles Fama-French</h2>

        <h3>3.1 Le Modèle 3 Facteurs (1993)</h3>

        <div class="box">
            <h4>Équation du Modèle 3 Facteurs</h4>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Rᵢ - Rᶠ = αᵢ + β₁ᵢ(Rₘ - Rᶠ) + β₂ᵢ·SMB + β₃ᵢ·HML + εᵢ
            </p>
        </div>

        <div class="box">
            <h4>Les Facteurs Fama-French</h4>
            <table>
                <thead>
                    <tr><th>Facteur</th><th>Nom complet</th><th>Construction</th><th>Prime historique</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">Mkt-Rf</span></td>
                        <td>Market excess return</td>
                        <td>Rendement du marché - Rᶠ</td>
                        <td>~6%/an</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">SMB</span></td>
                        <td>Small Minus Big</td>
                        <td>Small caps - Large caps</td>
                        <td>~2%/an</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">HML</span></td>
                        <td>High Minus Low (B/M)</td>
                        <td>Value stocks - Growth stocks</td>
                        <td>~4%/an</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="box">
            <h4>Construction de SMB et HML</h4>
            <ol>
                <li>Classer les actions par capitalisation (Small/Big) → médiane NYSE</li>
                <li>Classer par Book-to-Market (Low/Medium/High) → terciles</li>
                <li>Former 6 portefeuilles : SL, SM, SH, BL, BM, BH</li>
                <li>SMB = (SL + SM + SH)/3 - (BL + BM + BH)/3</li>
                <li>HML = (SH + BH)/2 - (SL + BL)/2</li>
            </ol>
        </div>

        <h3>3.2 Le Modèle 4 Facteurs de Carhart (1997)</h3>

        <div class="box">
            <h4>Ajout du Momentum</h4>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Rᵢ - Rᶠ = α + β₁(Rₘ - Rᶠ) + β₂·SMB + β₃·HML + β₄·WML + ε
            </p>
            <p><span class="text-red">WML</span> (Winners Minus Losers) : Long top 30% performers des 12 derniers mois, short bottom 30%.</p>
            <p><strong>Prime historique :</strong> ~7%/an (mais très volatile et sujette aux crashs)</p>
        </div>

        <h3>3.3 Le Modèle 5 Facteurs (2015)</h3>

        <div class="box">
            <h4>Équation du Modèle 5 Facteurs</h4>
            <p style="text-align: center; font-family: monospace; font-size: 14px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Rᵢ - Rᶠ = α + β₁(Rₘ-Rᶠ) + β₂·SMB + β₃·HML + β₄·RMW + β₅·CMA + ε
            </p>
        </div>

        <div class="box">
            <h4>Nouveaux Facteurs</h4>
            <table>
                <thead>
                    <tr><th>Facteur</th><th>Nom complet</th><th>Construction</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">RMW</span></td>
                        <td>Robust Minus Weak</td>
                        <td>Entreprises profitables - non profitables</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">CMA</span></td>
                        <td>Conservative Minus Aggressive</td>
                        <td>Faible investissement - Fort investissement</td>
                    </tr>
                </tbody>
            </table>
            <p><strong>Observation importante :</strong> Avec RMW et CMA, le facteur HML devient largement redondant.</p>
        </div>

        <h3>3.4 Interprétation des Facteurs</h3>

        <div class="box">
            <h4>Risque ou Anomalie ?</h4>
            <p>Deux interprétations des primes factorielles :</p>
            <ul>
                <li><strong>Vue "risque" :</strong> Les facteurs capturent des risques macroéconomiques (les small caps souffrent plus en récession)</li>
                <li><strong>Vue "comportementale" :</strong> Les primes viennent de biais comportementaux et persistent car l'arbitrage est limité</li>
            </ul>
            <p>Le débat n'est toujours pas tranché !</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             GRAPHIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h3>Visualisation : La Security Market Line (SML)</h3>
        <div class="chart-container">
            <canvas id="smlChartM15"></canvas>
        </div>
        <p class="caption">La Security Market Line montre la relation linéaire entre le bêta et le rendement espéré selon le CAPM. Les actifs au-dessus ont un alpha positif (sous-évalués), ceux en-dessous ont un alpha négatif (surévalués).</p>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             EXERCICES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="exercices-m15">Exercices</h2>

        <div class="exercise-box">
            <h4>Exercice 1 : Calcul de Bêta</h4>
            <p>Une action a Cov(Rᵢ, Rₘ) = 0.0024 et la variance du marché est Var(Rₘ) = 0.0016.</p>
            <p><strong>Question :</strong> Quel est le bêta de cette action ?</p>

            <input type="text" class="exercise-calc-input" id="m15-beta" placeholder="β = ?">
            <button class="check-btn" onclick="checkM15Beta()">Vérifier</button>
            <div id="feedback-m15-beta" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>β = Cov(Rᵢ, Rₘ) / Var(Rₘ) = 0.0024 / 0.0016 = <span class="text-red">1.5</span></p>
                    <p>Cette action est agressive : quand le marché monte de 1%, elle monte en moyenne de 1.5%.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 2 : Rendement Espéré CAPM</h4>
            <p>Le taux sans risque est 3%, la prime de risque de marché est 6%, et le bêta d'une action est 1.2.</p>
            <p><strong>Question :</strong> Quel est le rendement espéré selon le CAPM ?</p>

            <input type="text" class="exercise-calc-input" id="m15-expected" placeholder="E[R] = ? (en %)">
            <button class="check-btn" onclick="checkM15Expected()">Vérifier</button>
            <div id="feedback-m15-expected" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>E[Rᵢ] = Rᶠ + β(E[Rₘ] - Rᶠ) = 3% + 1.2 × 6%</p>
                    <p>E[Rᵢ] = 3% + 7.2% = <span class="text-red">10.2%</span></p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 3 : Alpha de Jensen</h4>
            <p>Une action a un rendement observé de 12%, un bêta de 0.8, Rᶠ = 2%, et E[Rₘ] = 8%.</p>
            <p><strong>Question :</strong> Quel est l'alpha de Jensen de cette action ?</p>

            <input type="text" class="exercise-calc-input" id="m15-alpha" placeholder="α = ? (en %)">
            <button class="check-btn" onclick="checkM15Alpha()">Vérifier</button>
            <div id="feedback-m15-alpha" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Rendement CAPM = 2% + 0.8 × (8% - 2%) = 2% + 4.8% = 6.8%</p>
                    <p>α = Rᵢ - E[Rᵢ]_CAPM = 12% - 6.8% = <span class="text-red">5.2%</span></p>
                    <p>Alpha positif : l'action a surperformé son benchmark ajusté du risque.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 4 : Bêta d'un Portefeuille</h4>
            <p>Un portefeuille contient 40% d'action A (β=1.5) et 60% d'action B (β=0.8).</p>
            <p><strong>Question :</strong> Quel est le bêta du portefeuille ?</p>

            <input type="text" class="exercise-calc-input" id="m15-betap" placeholder="βₚ = ?">
            <button class="check-btn" onclick="checkM15BetaP()">Vérifier</button>
            <div id="feedback-m15-betap" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>βₚ = w_A × β_A + w_B × β_B</p>
                    <p>βₚ = 0.4 × 1.5 + 0.6 × 0.8 = 0.6 + 0.48 = <span class="text-red">1.08</span></p>
                    <p>Le bêta d'un portefeuille est la moyenne pondérée des bêtas.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 5 : Modèle Fama-French</h4>
            <p>Une action a les expositions suivantes : β_mkt = 1.1, β_SMB = 0.5, β_HML = -0.3.</p>
            <p>Les primes sont : E[Rₘ]-Rᶠ = 6%, SMB = 2%, HML = 4%, et Rᶠ = 2%.</p>
            <p><strong>Question :</strong> Quel est le rendement espéré selon Fama-French 3 facteurs ?</p>

            <input type="text" class="exercise-calc-input" id="m15-ff3" placeholder="E[R] = ? (en %)">
            <button class="check-btn" onclick="checkM15FF3()">Vérifier</button>
            <div id="feedback-m15-ff3" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>E[Rᵢ] = Rᶠ + β_mkt × (E[Rₘ]-Rᶠ) + β_SMB × SMB + β_HML × HML</p>
                    <p>E[Rᵢ] = 2% + 1.1×6% + 0.5×2% + (-0.3)×4%</p>
                    <p>E[Rᵢ] = 2% + 6.6% + 1% - 1.2% = <span class="text-red">8.4%</span></p>
                    <p>L'exposition négative à HML réduit le rendement (c'est une action growth).</p>
                </div>
            </details>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             FLASHCARDS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="flashcards-m15">Flashcards</h2>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est l'équation du CAPM ?</p></div>
                    <div class="flashcard-back"><p>E[Rᵢ] = Rᶠ + βᵢ(E[Rₘ] - Rᶠ). Le rendement espéré = taux sans risque + bêta × prime de risque de marché.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Comment calcule-t-on le bêta ?</p></div>
                    <div class="flashcard-back"><p>β = Cov(Rᵢ, Rₘ) / Var(Rₘ) = ρᵢₘ × (σᵢ/σₘ). C'est la pente de la régression des rendements sur le marché.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la différence entre SML et CML ?</p></div>
                    <div class="flashcard-back"><p>CML : rendement vs volatilité (σ), seulement portefeuilles efficients. SML : rendement vs bêta (β), tous les actifs.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que l'alpha de Jensen ?</p></div>
                    <div class="flashcard-back"><p>α = Rᵢ - [Rᶠ + β(Rₘ - Rᶠ)]. C'est le rendement excédentaire par rapport au CAPM. α > 0 = surperformance.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la critique de Roll sur le CAPM ?</p></div>
                    <div class="flashcard-back"><p>Le vrai portefeuille de marché (tous les actifs) est inobservable. Les tests du CAPM sont donc invalides. Le modèle est non testable.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que l'APT ?</p></div>
                    <div class="flashcard-back"><p>Arbitrage Pricing Theory (Ross 1976). E[Rᵢ] = Rᶠ + Σβⱼλⱼ. Multiple facteurs, basé sur l'absence d'arbitrage, pas besoin du portefeuille de marché.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quels sont les 3 facteurs Fama-French ?</p></div>
                    <div class="flashcard-back"><p>1) Mkt-Rf : marché - taux sans risque. 2) SMB : Small Minus Big (taille). 3) HML : High Minus Low B/M (value).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le facteur momentum ?</p></div>
                    <div class="flashcard-back"><p>WML (Winners Minus Losers) : les actions qui ont bien performé continuent à surperformer. Prime ~7%/an mais très volatile.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quels facteurs ajoute le modèle 5 facteurs ?</p></div>
                    <div class="flashcard-back"><p>RMW (Robust Minus Weak) : profitabilité. CMA (Conservative Minus Aggressive) : investissement. HML devient redondant.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi le risque spécifique n'est-il pas rémunéré ?</p></div>
                    <div class="flashcard-back"><p>Car il peut être éliminé gratuitement par diversification. Seul le risque systématique (non diversifiable) mérite une prime.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Comment interpréter un bêta de 1.5 ?</p></div>
                    <div class="flashcard-back"><p>Action agressive : quand le marché monte de 1%, l'action monte en moyenne de 1.5%. Amplifie les mouvements du marché (à la hausse ET à la baisse).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce qu'une action "value" vs "growth" ?</p></div>
                    <div class="flashcard-back"><p>Value : fort ratio Book/Market (HML exposure positive). Growth : faible B/M (HML exposure négative). Historiquement, value surperforme.</p></div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module14')">⬅ Précédent : Théorie de Markowitz</button>
            <button class="nav-btn" onclick="showModule('module16')">Suivant : Mesures de Performance ➡</button>
        </div>
    </section>

    <section id="module16" class="module">
        <header class="module-header">
            <h1>Module 16 : Mesures de Performance</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermédiaire</span>
                <span>150 minutes</span>
                <span>Prérequis : Modules 13, 14, 15</span>
            </div>
        </header>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             INTRODUCTION ET CONTEXTE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <figure class="image-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/58/William_Sharpe_2007.jpg/220px-William_Sharpe_2007.jpg" alt="William Sharpe">
            <figcaption>William Sharpe (né 1934) - Prix Nobel 1990, créateur du ratio de Sharpe</figcaption>
        </figure>

        <h4>Objectifs du Module</h4>
        <ul>
            <li>Calculer et interpréter le ratio de Sharpe et ses limites</li>
            <li>Comprendre les ratios de Sortino, Treynor et Calmar</li>
            <li>Maîtriser l'alpha de Jensen et l'Information Ratio</li>
            <li>Analyser le Maximum Drawdown et ses implications</li>
            <li>Choisir la mesure appropriée selon le contexte d'investissement</li>
            <li>Comprendre les biais et pièges des mesures de performance</li>
        </ul>

        <div class="box">
            <h4>Pourquoi Mesurer la Performance ?</h4>
            <p>Un rendement élevé ne signifie pas une bonne gestion ! Un gérant qui prend des risques excessifs peut avoir de la chance une année, mais détruira de la valeur à long terme.</p>
            <p>Les mesures de performance <span class="text-red">ajustent le rendement pour le risque pris</span>. Elles répondent à : "Ce rendement justifie-t-il le risque encouru ?"</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             TIMELINE HISTORIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>Chronologie des Mesures de Performance</h2>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-date">1966</div>
                <div class="timeline-content">
                    <h4>William Sharpe - Ratio de Sharpe</h4>
                    <p>"Mutual Fund Performance" - Introduction du ratio rendement/risque. Devient la mesure standard de l'industrie. Prix Nobel 1990.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1966</div>
                <div class="timeline-content">
                    <h4>Jack Treynor - Ratio de Treynor</h4>
                    <p>Alternative au Sharpe utilisant le bêta (risque systématique) au lieu de la volatilité totale.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1968</div>
                <div class="timeline-content">
                    <h4>Michael Jensen - Alpha de Jensen</h4>
                    <p>"The Performance of Mutual Funds" - Mesure la surperformance par rapport au CAPM. Premier test massif de la gestion active.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1991</div>
                <div class="timeline-content">
                    <h4>Frank Sortino - Ratio de Sortino</h4>
                    <p>Ne pénalise que le downside risk. Plus cohérent avec l'aversion des investisseurs aux pertes.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">1994</div>
                <div class="timeline-content">
                    <h4>Information Ratio</h4>
                    <p>Mesure de performance standard pour la gestion active relative à un benchmark. Popularisé par l'industrie des fonds.</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">2002</div>
                <div class="timeline-content">
                    <h4>Andrew Lo - Ajustements pour Autocorrélation</h4>
                    <p>Montre que les Sharpe ratios des hedge funds sont biaisés à la hausse par l'autocorrélation des rendements.</p>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 1: RATIO DE SHARPE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>1. Le Ratio de Sharpe</h2>

        <h3>1.1 Définition et Interprétation</h3>

        <div class="box">
            <h4>Définition : Ratio de Sharpe</h4>
            <p style="text-align: center; font-family: monospace; font-size: 20px; background: var(--bg-hover); padding: 20px; border-radius: 8px;">
                SR = (E[Rₚ] - Rᶠ) / σₚ
            </p>
            <p>où :</p>
            <ul>
                <li>E[Rₚ] : Rendement espéré (ou réalisé) du portefeuille</li>
                <li>Rᶠ : Taux sans risque</li>
                <li>σₚ : Volatilité (écart-type) du portefeuille</li>
            </ul>
            <p><strong>Interprétation :</strong> Rendement excédentaire par unité de risque total.</p>
        </div>

        <div class="box">
            <h4>Interprétation des Valeurs</h4>
            <table>
                <thead>
                    <tr><th>Sharpe Ratio</th><th>Interprétation</th><th>Commentaire</th></tr>
                </thead>
                <tbody>
                    <tr><td>< 0</td><td>Mauvais</td><td>Sous-performe l'actif sans risque</td></tr>
                    <tr><td>0 - 0.5</td><td>Médiocre</td><td>Compensation insuffisante du risque</td></tr>
                    <tr><td>0.5 - 1.0</td><td>Acceptable</td><td>Typique du marché actions</td></tr>
                    <tr><td>1.0 - 2.0</td><td><span class="text-green">Bon</span></td><td>Supérieur à la moyenne</td></tr>
                    <tr><td>> 2.0</td><td><span class="text-green">Excellent</span></td><td>Rare, vérifier la durabilité</td></tr>
                    <tr><td>> 3.0</td><td>Suspect</td><td>Possible fraude ou risque caché</td></tr>
                </tbody>
            </table>
            <p><strong>Attention :</strong> Un Sharpe > 3 sur plusieurs années est statistiquement très improbable. C'était un signal d'alerte pour Madoff !</p>
        </div>

        <h3>1.2 Propriétés du Ratio de Sharpe</h3>

        <div class="box">
            <h4>Propriétés Mathématiques</h4>
            <ul>
                <li><strong>Invariance au levier :</strong> SR(λw) = SR(w) pour λ > 0</li>
                <li><strong>Maximal pour le portefeuille tangent</strong></li>
                <li><strong>Additif en √n pour les rendements i.i.d. :</strong> SR_annuel = SR_mensuel × √12</li>
            </ul>
        </div>

        <h3>1.3 Limites du Ratio de Sharpe</h3>

        <div class="grid-2">
            <div class="grid-item">
                <h4>Problèmes Théoriques</h4>
                <ul>
                    <li>Assume une distribution normale</li>
                    <li>Traite symétriquement gains et pertes</li>
                    <li>Ignore les moments supérieurs (skew, kurtosis)</li>
                </ul>
            </div>
            <div class="grid-item">
                <h4>Problèmes Pratiques</h4>
                <ul>
                    <li>Manipulable (vente d'options)</li>
                    <li>Biaisé par l'autocorrélation</li>
                    <li>Sensible à la période d'observation</li>
                </ul>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 2: RATIO DE SORTINO
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>2. Le Ratio de Sortino</h2>

        <div class="box">
            <h4>Définition : Ratio de Sortino</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Sortino = (E[Rₚ] - MAR) / σ_downside
            </p>
            <p>où :</p>
            <ul>
                <li>MAR : Minimum Acceptable Return (souvent Rᶠ ou 0)</li>
                <li>σ_downside = √[E[min(Rₚ - MAR, 0)²]] : Downside deviation</li>
            </ul>
        </div>

        <div class="box">
            <h4>Avantage sur le Sharpe</h4>
            <p>Le Sortino ne pénalise <span class="text-green">que les rendements inférieurs au seuil</span>.</p>
            <p>Intuitivement correct : les investisseurs ne se plaignent pas des surprises positives !</p>
            <p><strong>Exemple :</strong> Deux stratégies avec même Sharpe mais l'une très asymétrique (beaucoup de petits gains, rares grosses pertes). Le Sortino les distingue.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 3: RATIO DE TREYNOR
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>3. Le Ratio de Treynor</h2>

        <div class="box">
            <h4>Définition : Ratio de Treynor</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                Treynor = (E[Rₚ] - Rᶠ) / βₚ
            </p>
            <p><strong>Interprétation :</strong> Rendement excédentaire par unité de risque <span class="text-red">systématique</span>.</p>
        </div>

        <div class="box">
            <h4>Sharpe vs Treynor : Quand Utiliser Lequel ?</h4>
            <table>
                <thead>
                    <tr><th>Situation</th><th>Mesure recommandée</th><th>Raison</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Portefeuille unique de l'investisseur</td>
                        <td>Sharpe</td>
                        <td>Le risque total compte</td>
                    </tr>
                    <tr>
                        <td>Un parmi plusieurs portefeuilles</td>
                        <td>Treynor</td>
                        <td>Risque spécifique diversifié ailleurs</td>
                    </tr>
                    <tr>
                        <td>Portefeuille bien diversifié</td>
                        <td>Treynor ≈ Sharpe</td>
                        <td>Risque spécifique ≈ 0</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 4: ALPHA DE JENSEN
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>4. Alpha de Jensen</h2>

        <div class="box">
            <h4>Définition : Alpha de Jensen</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                αₚ = Rₚ - [Rᶠ + βₚ(Rₘ - Rᶠ)]
            </p>
            <p><strong>Interprétation :</strong> Rendement en excès de ce que le CAPM prédit pour ce niveau de bêta.</p>
            <ul>
                <li><span class="text-green">α > 0</span> : Le gérant ajoute de la valeur</li>
                <li>α = 0 : Performance conforme au CAPM</li>
                <li><span class="text-red">α < 0</span> : Le gérant détruit de la valeur</li>
            </ul>
        </div>

        <div class="box">
            <h4>Estimation par Régression</h4>
            <p>On estime α en régressant les rendements excédentaires :</p>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">
                Rₚ - Rᶠ = α + β(Rₘ - Rᶠ) + ε
            </p>
            <p>L'intercept de la régression est l'alpha.</p>
            <p><strong>Test de significativité :</strong> On teste H₀: α = 0 avec un t-test.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 5: INFORMATION RATIO
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>5. Information Ratio</h2>

        <div class="box">
            <h4>Définition : Information Ratio</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                IR = (E[Rₚ] - E[Rᵦ]) / TE
            </p>
            <p>où :</p>
            <ul>
                <li>Rᵦ : Rendement du benchmark</li>
                <li>TE = σ(Rₚ - Rᵦ) : Tracking Error (écart-type des rendements relatifs)</li>
            </ul>
        </div>

        <div class="box">
            <h4>Interprétation de l'IR</h4>
            <table>
                <thead>
                    <tr><th>IR</th><th>Qualité</th><th>Commentaire</th></tr>
                </thead>
                <tbody>
                    <tr><td>< 0</td><td>Mauvais</td><td>Sous-performe le benchmark</td></tr>
                    <tr><td>0 - 0.3</td><td>Faible</td><td>Difficile de justifier les frais</td></tr>
                    <tr><td>0.3 - 0.5</td><td>Acceptable</td><td>Bon gérant actif</td></tr>
                    <tr><td>0.5 - 1.0</td><td><span class="text-green">Bon</span></td><td>Excellent gérant</td></tr>
                    <tr><td>> 1.0</td><td>Exceptionnel</td><td>Très rare, vérifier la persistance</td></tr>
                </tbody>
            </table>
            <p><strong>Règle pratique :</strong> IR de 0.5 = top quartile des gérants actifs.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 6: MAXIMUM DRAWDOWN
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>6. Maximum Drawdown (MDD)</h2>

        <div class="box">
            <h4>Définition : Maximum Drawdown</h4>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                MDD = max_t [(max_{s≤t} V_s - V_t) / max_{s≤t} V_s]
            </p>
            <p><strong>En français :</strong> Plus grande chute du pic au creux, en pourcentage.</p>
        </div>

        <div class="box">
            <h4>Exemples de MDD Historiques</h4>
            <table>
                <thead>
                    <tr><th>Événement</th><th>MDD S&P 500</th><th>Durée</th></tr>
                </thead>
                <tbody>
                    <tr><td>Krach 1929</td><td>-86%</td><td>25 ans pour récupérer</td></tr>
                    <tr><td>Dot-com 2000-2002</td><td>-49%</td><td>7 ans</td></tr>
                    <tr><td>Crise 2008</td><td>-57%</td><td>5 ans</td></tr>
                    <tr><td>COVID mars 2020</td><td>-34%</td><td>6 mois</td></tr>
                </tbody>
            </table>
        </div>

        <div class="box">
            <h4>Ratio de Calmar</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">
                Calmar = Rendement annualisé / |MDD|
            </p>
            <p>Combine rendement et pire scénario. Populaire chez les hedge funds.</p>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             SECTION 7: COMPARAISON ET CHOIX
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2>7. Tableau Récapitulatif</h2>

        <div class="box">
            <h4>Comparaison des Mesures</h4>
            <table>
                <thead>
                    <tr><th>Mesure</th><th>Numérateur</th><th>Dénominateur</th><th>Cas d'usage</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="text-red">Sharpe</span></td>
                        <td>Rₚ - Rᶠ</td>
                        <td>σₚ</td>
                        <td>Comparaison générale</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Sortino</span></td>
                        <td>Rₚ - MAR</td>
                        <td>σ_downside</td>
                        <td>Aversion aux pertes</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Treynor</span></td>
                        <td>Rₚ - Rᶠ</td>
                        <td>βₚ</td>
                        <td>Portefeuilles diversifiés</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Alpha</span></td>
                        <td>Rₚ - CAPM</td>
                        <td>-</td>
                        <td>Valeur ajoutée du gérant</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">IR</span></td>
                        <td>Rₚ - Rᵦ</td>
                        <td>TE</td>
                        <td>Gestion active</td>
                    </tr>
                    <tr>
                        <td><span class="text-red">Calmar</span></td>
                        <td>Rendement</td>
                        <td>|MDD|</td>
                        <td>Risque de perte extrême</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             GRAPHIQUE
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h3>Visualisation : Comparaison des Stratégies</h3>
        <div class="chart-container">
            <canvas id="performanceChartM16"></canvas>
        </div>
        <p class="caption">Comparaison de 4 stratégies selon différentes mesures de performance. Un bon Sharpe ne garantit pas un bon Sortino ou un faible drawdown.</p>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             EXERCICES
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="exercices-m16">Exercices</h2>

        <div class="exercise-box">
            <h4>Exercice 1 : Calcul du Ratio de Sharpe</h4>
            <p>Un fonds a un rendement annuel de 15%, une volatilité de 20%, et Rᶠ = 3%.</p>
            <p><strong>Question :</strong> Quel est le ratio de Sharpe ?</p>

            <input type="text" class="exercise-calc-input" id="m16-sharpe" placeholder="SR = ?">
            <button class="check-btn" onclick="checkM16Sharpe()">Vérifier</button>
            <div id="feedback-m16-sharpe" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>SR = (Rₚ - Rᶠ) / σₚ = (15% - 3%) / 20% = 12% / 20%</p>
                    <p>SR = <span class="text-red">0.60</span></p>
                    <p>Un Sharpe de 0.60 est acceptable, typique du marché actions.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 2 : Ratio de Treynor</h4>
            <p>Un portefeuille a un rendement de 12%, un bêta de 0.8, et Rᶠ = 2%.</p>
            <p><strong>Question :</strong> Quel est le ratio de Treynor ?</p>

            <input type="text" class="exercise-calc-input" id="m16-treynor" placeholder="Treynor = ? (en %)">
            <button class="check-btn" onclick="checkM16Treynor()">Vérifier</button>
            <div id="feedback-m16-treynor" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Treynor = (Rₚ - Rᶠ) / βₚ = (12% - 2%) / 0.8 = 10% / 0.8</p>
                    <p>Treynor = <span class="text-red">12.5%</span></p>
                    <p>Pour chaque unité de risque systématique, le portefeuille génère 12.5% de rendement excédentaire.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 3 : Alpha de Jensen</h4>
            <p>Un fonds a un rendement de 14%, un bêta de 1.2, Rᶠ = 2%, et Rₘ = 10%.</p>
            <p><strong>Question :</strong> Quel est l'alpha de Jensen ?</p>

            <input type="text" class="exercise-calc-input" id="m16-alpha" placeholder="α = ? (en %)">
            <button class="check-btn" onclick="checkM16Alpha()">Vérifier</button>
            <div id="feedback-m16-alpha" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Rendement CAPM = Rᶠ + β(Rₘ - Rᶠ) = 2% + 1.2 × (10% - 2%) = 2% + 9.6% = 11.6%</p>
                    <p>α = Rₚ - Rendement CAPM = 14% - 11.6% = <span class="text-red">2.4%</span></p>
                    <p>Alpha positif : le gérant a créé de la valeur au-delà du CAPM.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 4 : Information Ratio</h4>
            <p>Un gérant surperforme son benchmark de 3% par an en moyenne, avec un tracking error de 6%.</p>
            <p><strong>Question :</strong> Quel est l'Information Ratio ?</p>

            <input type="text" class="exercise-calc-input" id="m16-ir" placeholder="IR = ?">
            <button class="check-btn" onclick="checkM16IR()">Vérifier</button>
            <div id="feedback-m16-ir" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>IR = (Rₚ - Rᵦ) / TE = 3% / 6%</p>
                    <p>IR = <span class="text-red">0.50</span></p>
                    <p>Un IR de 0.50 est excellent, dans le top quartile des gérants actifs.</p>
                </div>
            </details>
        </div>

        <div class="exercise-box">
            <h4>Exercice 5 : Ratio de Calmar</h4>
            <p>Une stratégie génère 10% de rendement annuel avec un Maximum Drawdown de -25%.</p>
            <p><strong>Question :</strong> Quel est le ratio de Calmar ?</p>

            <input type="text" class="exercise-calc-input" id="m16-calmar" placeholder="Calmar = ?">
            <button class="check-btn" onclick="checkM16Calmar()">Vérifier</button>
            <div id="feedback-m16-calmar" class="feedback"></div>

            <details>
                <summary>Voir la solution</summary>
                <div class="solution">
                    <p>Calmar = Rendement / |MDD| = 10% / 25%</p>
                    <p>Calmar = <span class="text-red">0.40</span></p>
                    <p>Pour chaque % de drawdown maximum, la stratégie génère 0.4% de rendement.</p>
                </div>
            </details>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             FLASHCARDS
             ═══════════════════════════════════════════════════════════════════════════ -->
        <h2 id="flashcards-m16">Flashcards</h2>

        <div class="flashcards-grid">
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la formule du ratio de Sharpe ?</p></div>
                    <div class="flashcard-back"><p>SR = (Rₚ - Rᶠ) / σₚ. Rendement excédentaire par unité de volatilité totale. > 1 est bon, > 2 excellent.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la différence entre Sharpe et Sortino ?</p></div>
                    <div class="flashcard-back"><p>Sharpe utilise σ totale (pénalise gains et pertes). Sortino utilise σ_downside (pénalise uniquement les pertes).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quelle est la formule du ratio de Treynor ?</p></div>
                    <div class="flashcard-back"><p>Treynor = (Rₚ - Rᶠ) / βₚ. Rendement excédentaire par unité de risque systématique.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Quand utiliser Sharpe vs Treynor ?</p></div>
                    <div class="flashcard-back"><p>Sharpe : portefeuille unique (risque total compte). Treynor : un parmi plusieurs portefeuilles (risque spécifique diversifié ailleurs).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que l'alpha de Jensen ?</p></div>
                    <div class="flashcard-back"><p>α = Rₚ - [Rᶠ + β(Rₘ - Rᶠ)]. Rendement en excès du CAPM. α > 0 = valeur créée par le gérant.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que l'Information Ratio ?</p></div>
                    <div class="flashcard-back"><p>IR = (Rₚ - Rᵦ) / TE. Performance relative au benchmark / tracking error. IR > 0.5 = excellent gérant actif.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le Maximum Drawdown ?</p></div>
                    <div class="flashcard-back"><p>Plus grande chute du pic au creux en %. Mesure le pire scénario historique. Exemple : S&P 500 en 2008 = -57%.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le ratio de Calmar ?</p></div>
                    <div class="flashcard-back"><p>Calmar = Rendement annualisé / |MDD|. Combine performance et risque extrême. Populaire pour hedge funds.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Pourquoi un Sharpe > 3 est-il suspect ?</p></div>
                    <div class="flashcard-back"><p>Statistiquement très improbable sur plusieurs années. Peut indiquer : manipulation, risque caché, ou fraude (signal d'alerte pour Madoff).</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le Tracking Error ?</p></div>
                    <div class="flashcard-back"><p>TE = σ(Rₚ - Rᵦ). Écart-type des rendements relatifs au benchmark. Mesure de risque actif.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Comment annualiser le ratio de Sharpe mensuel ?</p></div>
                    <div class="flashcard-back"><p>SR_annuel = SR_mensuel × √12 ≈ SR_mensuel × 3.46. Valide si rendements i.i.d.</p></div>
                </div>
            </div>
            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                <div class="flashcard-inner">
                    <div class="flashcard-front"><p>Qu'est-ce que le downside risk ?</p></div>
                    <div class="flashcard-back"><p>Volatilité calculée uniquement sur les rendements négatifs (sous le MAR). σ_down = √E[min(R-MAR, 0)²]. Base du ratio de Sortino.</p></div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module15')">⬅ Précédent : CAPM et APT</button>
            <button class="nav-btn" onclick="showModule('module17')">Suivant : Options Fondamentaux ➡</button>
        </div>
    </section>

    <!-- PARTIE V: PRODUITS DERIVES -->
    <section id="module17" class="module">
        <header class="module-header">
            <h1>Options - Fondamentaux</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermédiaire</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 9</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre les calls et puts européens et américains</li>
            <li>Maîtriser la parité put-call</li>
            <li>Analyser les déterminants du prix d'une option</li>
            <li>Construire des stratégies optionnelles (spreads, straddles)</li>
        </ul>

        <h2>Les Options : Définitions</h2>

        <div class="grid-2">
            <div class="grid-item">
                <h4><span class="text-red">Option d'Achat (Call)</span></h4>
                <p>Droit d'<strong>acheter</strong> l'actif sous-jacent au prix K (strike) avant/à l'échéance T.</p>
                <p><strong>Payoff :</strong> max(S-K, 0)</p>
            </div>
            <div class="grid-item">
                <h4><span class="text-red">Option de Vente (Put)</span></h4>
                <p>Droit de <strong>vendre</strong> l'actif sous-jacent au prix K avant/à l'échéance T.</p>
                <p><strong>Payoff :</strong> max(K-S, 0)</p>
            </div>
        </div>

        <div class="box">
            <h4><span class="text-red">Parité Put-Call</span></h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">C - P = S - Ke⁻ʳᵀ</p>
            <p>Relation fondamentale entre call et put de mêmes strike et maturité.</p>
        </div>

        <h2>Les 5 Déterminants du Prix</h2>

        <table>
            <thead><tr><th>Variable</th><th>Effet sur Call</th><th>Effet sur Put</th></tr></thead>
            <tbody>
                <tr><td>Prix sous-jacent S ↑</td><td>↑</td><td>↓</td></tr>
                <tr><td>Strike K ↑</td><td>↓</td><td>↑</td></tr>
                <tr><td>Temps à maturité T ↑</td><td>↑</td><td>↑</td></tr>
                <tr><td><span class="text-red">Volatilité σ ↑</span></td><td>↑</td><td>↑</td></tr>
                <tr><td>Taux sans risque r ↑</td><td>↑</td><td>↓</td></tr>
            </tbody>
        </table>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module16')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module18')">Suivant</button>
        </div>
    </section>

    <section id="module18" class="module">
        <header class="module-header">
            <h1>Le Modèle Binomial</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermédiaire</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 17</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Construire un arbre binomial à une période</li>
            <li>Comprendre l'évaluation risque-neutre</li>
            <li>Étendre à plusieurs périodes</li>
            <li>Évaluer les options américaines avec exercice anticipé</li>
        </ul>

        <h2>Arbre Binomial à Une Période</h2>

        <div class="box">
            <h4>Le Modèle</h4>
            <p>Le prix peut monter (u) ou descendre (d) :</p>
            <ul>
                <li>Sᵤ = S₀ × u (avec probabilité q)</li>
                <li>Sᵈ = S₀ × d (avec probabilité 1-q)</li>
            </ul>
        </div>

        <div class="box">
            <h4><span class="text-red">Probabilité Risque-Neutre</span></h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">q = (eʳᵗ - d) / (u - d)</p>
            <p>Prix de l'option : C = e⁻ʳᵗ[q×Cᵤ + (1-q)×Cᵈ]</p>
        </div>

        <h2>Paramètres CRR (Cox-Ross-Rubinstein)</h2>

        <div class="box">
            <h4>Calibration à la Volatilité</h4>
            <p style="font-family: monospace;">u = e^(σ√Δt), d = e^(-σ√Δt) = 1/u</p>
            <p>Quand n → ∞, le modèle binomial converge vers Black-Scholes.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module17')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module19')">Suivant</button>
        </div>
    </section>

    <section id="module19" class="module">
        <header class="module-header">
            <h1>Le Modèle de Black-Scholes</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>120 minutes</span>
                <span>Prérequis : Modules 10, 18</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre les hypothèses du modèle</li>
            <li>Maîtriser les formules pour calls et puts européens</li>
            <li>Analyser les limites du modèle</li>
        </ul>

        <h2>La Formule de Black-Scholes</h2>

        <div class="box">
            <h4>Prix d'un <span class="text-red">Call Européen</span></h4>
            <p style="text-align: center; font-family: monospace; font-size: 16px; background: var(--bg-hover); padding: 15px; border-radius: 8px;">
                C = S₀N(d₁) - Ke⁻ʳᵀN(d₂)
            </p>
            <p>où :</p>
            <p style="font-family: monospace;">
                d₁ = [ln(S/K) + (r + σ²/2)T] / (σ√T)<br>
                d₂ = d₁ - σ√T
            </p>
        </div>

        <div class="box">
            <h4>Prix d'un <span class="text-red">Put Européen</span></h4>
            <p style="text-align: center; font-family: monospace; font-size: 16px;">P = Ke⁻ʳᵀN(-d₂) - S₀N(-d₁)</p>
        </div>

        <h2>Interprétation</h2>
        <ul>
            <li><span class="text-red">N(d₂)</span> = probabilité risque-neutre d'exercice</li>
            <li><span class="text-red">N(d₁)</span> = Delta du call</li>
            <li>S₀N(d₁) = valeur espérée du sous-jacent si exercice</li>
        </ul>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module18')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module20')">Suivant</button>
        </div>
    </section>

    <section id="module20" class="module">
        <header class="module-header">
            <h1>Les Grecques (Greeks)</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 19</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Calculer et interpréter Delta, Gamma, Theta, Vega, Rho</li>
            <li>Comprendre le delta-hedging</li>
            <li>Gérer les risques d'un book d'options</li>
        </ul>

        <h2>Les Cinq Greeks Principaux</h2>

        <div class="box">
            <h4><span class="text-red">Delta (Δ)</span> = ∂C/∂S</h4>
            <p>Sensibilité au prix du sous-jacent. Pour un call : Δ = N(d₁) ∈ [0,1]</p>
            <p><strong>Usage :</strong> Nombre d'unités de sous-jacent pour couvrir l'option.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Gamma (Γ)</span> = ∂²C/∂S²</h4>
            <p>Convexité, taux de variation du delta. Maximum pour options ATM.</p>
            <p><strong>Risque :</strong> Delta-hedging plus difficile quand Gamma élevé.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Theta (Θ)</span> = ∂C/∂t</h4>
            <p>Decay temporel, généralement négatif (l'option perd de la valeur).</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Vega (ν)</span> = ∂C/∂σ</h4>
            <p>Sensibilité à la volatilité. Toujours positif pour options vanilles.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Rho (ρ)</span> = ∂C/∂r</h4>
            <p>Sensibilité aux taux. Positif pour calls, négatif pour puts.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module19')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module21')">Suivant</button>
        </div>
    </section>

    <section id="module21" class="module">
        <header class="module-header">
            <h1>Volatilité</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 19</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Distinguer volatilité historique et implicite</li>
            <li>Comprendre la surface de volatilité</li>
            <li>Analyser le smile et le skew</li>
            <li>Introduire les modèles de volatilité stochastique</li>
        </ul>

        <h2>Types de Volatilité</h2>

        <div class="grid-2">
            <div class="grid-item">
                <h4><span class="text-red">Volatilité Historique</span></h4>
                <p>Calculée sur les rendements passés.</p>
                <p>σ = √(252) × std(rendements journaliers)</p>
            </div>
            <div class="grid-item">
                <h4><span class="text-red">Volatilité Implicite</span></h4>
                <p>Extraite des prix d'options via Black-Scholes inverse.</p>
                <p>Reflète les anticipations du marché.</p>
            </div>
        </div>

        <h2>Surface de Volatilité</h2>

        <div class="box">
            <h4><span class="text-red">Smile de Volatilité</span></h4>
            <p>La volatilité implicite varie avec le strike : plus élevée pour options OTM.</p>
            <p><strong>Cause :</strong> Fat tails, demande de protection (puts OTM).</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Skew</span></h4>
            <p>Asymétrie du smile : puts OTM plus chers que calls OTM équidistants.</p>
            <p>Reflète la peur des krachs (post-1987).</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module20')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module22')">Suivant</button>
        </div>
    </section>

    <section id="module22" class="module">
        <header class="module-header">
            <h1>Options Exotiques</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>75 minutes</span>
                <span>Prérequis : Module 19</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre les options barrières (knock-in, knock-out)</li>
            <li>Évaluer les options asiatiques (moyenne)</li>
            <li>Analyser les options lookback et digitales</li>
        </ul>

        <h2>Principales Options Exotiques</h2>

        <div class="box">
            <h4><span class="text-red">Options Barrières</span></h4>
            <p>Activées ou désactivées si le sous-jacent franchit un niveau :</p>
            <ul>
                <li><strong>Knock-in</strong> : activée si barrière touchée</li>
                <li><strong>Knock-out</strong> : annulée si barrière touchée</li>
            </ul>
        </div>

        <div class="box">
            <h4><span class="text-red">Options Asiatiques</span></h4>
            <p>Payoff basé sur la moyenne du sous-jacent : max(S̄ - K, 0)</p>
            <p><strong>Avantage :</strong> Moins sensibles aux manipulations, moins chères.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Options Lookback</span></h4>
            <p>Payoff basé sur le max ou min atteint : max(Sₘₐₓ - K, 0)</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Options Digitales (Binaires)</span></h4>
            <p>Payoff fixe si condition remplie : 1 si S > K, 0 sinon.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module21')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module23')">Suivant</button>
        </div>
    </section>

    <!-- PARTIE VI: TAUX ET CREDIT -->
    <section id="module23" class="module">
        <header class="module-header">
            <h1>Marchés de Taux</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermédiaire</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 6</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre les obligations et leurs conventions</li>
            <li>Calculer prix, rendement, duration et convexité</li>
            <li>Construire la courbe des taux (bootstrapping)</li>
        </ul>

        <h2>Obligations</h2>

        <div class="box">
            <h4>Prix d'une Obligation</h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">P = Σ C/(1+y)ᵗ + F/(1+y)ᵀ</p>
            <p>Somme actualisée des coupons C et du principal F.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Duration</span></h4>
            <p>Sensibilité du prix aux taux : ΔP/P ≈ -D × Δy</p>
            <p style="font-family: monospace;">D = Σ t×CFₜ/(1+y)ᵗ / P</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Convexité</span></h4>
            <p>Terme d'ordre 2 : ΔP/P ≈ -D×Δy + ½C×(Δy)²</p>
            <p>La convexité est toujours positive et avantageuse.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module22')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module24')">Suivant</button>
        </div>
    </section>

    <section id="module24" class="module">
        <header class="module-header">
            <h1>Modèles de Taux d'Intérêt</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>90 minutes</span>
                <span>Prérequis : Modules 10, 23</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre les modèles d'équilibre (Vasicek, CIR)</li>
            <li>Maîtriser les modèles sans arbitrage (Ho-Lee, Hull-White)</li>
            <li>Calibrer aux prix de marché</li>
        </ul>

        <h2>Modèles d'Équilibre</h2>

        <div class="box">
            <h4>Modèle de <span class="text-red">Vasicek</span></h4>
            <p style="font-family: monospace;">dr = κ(θ - r)dt + σdW</p>
            <p><span class="text-red">Mean-reversion</span> vers θ. Peut devenir négatif.</p>
        </div>

        <div class="box">
            <h4>Modèle <span class="text-red">CIR</span> (Cox-Ingersoll-Ross)</h4>
            <p style="font-family: monospace;">dr = κ(θ - r)dt + σ√r dW</p>
            <p>Taux toujours positifs si 2κθ > σ² (condition de Feller).</p>
        </div>

        <h2>Modèles Sans Arbitrage</h2>

        <div class="box">
            <h4>Modèle de <span class="text-red">Hull-White</span></h4>
            <p style="font-family: monospace;">dr = (θ(t) - κr)dt + σdW</p>
            <p>θ(t) calibré pour matcher la courbe des taux actuelle.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module23')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module25')">Suivant</button>
        </div>
    </section>

    <section id="module25" class="module">
        <header class="module-header">
            <h1>Dérivés de Taux</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>75 minutes</span>
                <span>Prérequis : Module 24</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre les swaps de taux (IRS)</li>
            <li>Évaluer caps, floors et swaptions</li>
        </ul>

        <h2>Principaux Produits</h2>

        <div class="box">
            <h4><span class="text-red">Swap de Taux (IRS)</span></h4>
            <p>Échange de flux fixes contre flux variables (LIBOR/SOFR).</p>
            <p>Valeur = PV(flux fixes) - PV(flux variables)</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Cap / Floor</span></h4>
            <p>Portefeuille de caplets/floorlets : options sur taux forward.</p>
            <p>Cap = protection contre hausse des taux.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Swaption</span></h4>
            <p>Option d'entrer dans un swap à une date future.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module24')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module26')">Suivant</button>
        </div>
    </section>

    <section id="module26" class="module">
        <header class="module-header">
            <h1>Risque de Crédit</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 23</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre la probabilité de défaut et le taux de recouvrement</li>
            <li>Analyser les modèles structurels (Merton) et à forme réduite</li>
            <li>Évaluer les Credit Default Swaps (CDS)</li>
        </ul>

        <h2>Concepts Fondamentaux</h2>

        <div class="box">
            <h4><span class="text-red">Probabilité de Défaut (PD)</span></h4>
            <p>Probabilité qu'un émetteur ne rembourse pas sa dette.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Loss Given Default (LGD)</span></h4>
            <p>LGD = 1 - Recovery Rate. Perte en cas de défaut.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Modèle de Merton</span></h4>
            <p>L'action = call sur les actifs de l'entreprise, strike = dette.</p>
            <p>Défaut si valeur des actifs < dette à maturité.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Credit Default Swap (CDS)</span></h4>
            <p>Assurance contre le défaut. L'acheteur paie une prime, reçoit le nominal en cas de défaut.</p>
            <p>Le <span class="text-red">spread CDS</span> reflète le risque de crédit perçu.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module25')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module27')">Suivant</button>
        </div>
    </section>

    <!-- PARTIE VII: GESTION DES RISQUES -->
    <section id="module27" class="module">
        <header class="module-header">
            <h1>Value at Risk (VaR)</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermédiaire</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 7</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Calculer la VaR par différentes méthodes</li>
            <li>Comprendre le backtesting</li>
            <li>Analyser les limites de la VaR</li>
        </ul>

        <h2>Méthodes de Calcul</h2>

        <div class="box">
            <h4><span class="text-red">VaR Paramétrique</span></h4>
            <p>Suppose distribution normale : VaR = μ - z_α × σ</p>
            <p>z₀.₀₅ ≈ 1.645, z₀.₀₁ ≈ 2.33</p>
        </div>

        <div class="box">
            <h4><span class="text-red">VaR Historique</span></h4>
            <p>Percentile des rendements historiques. Pas d'hypothèse de distribution.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">VaR Monte Carlo</span></h4>
            <p>Simulation de scénarios selon un modèle. Flexible mais coûteux.</p>
        </div>

        <h2>Backtesting</h2>

        <div class="box">
            <p>Compter les dépassements de VaR. Pour VaR 95%, ~5% de violations attendues.</p>
            <p><strong>Test de Kupiec :</strong> Test binomial sur le nombre de violations.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module26')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module28')">Suivant</button>
        </div>
    </section>

    <section id="module28" class="module">
        <header class="module-header">
            <h1>Expected Shortfall et Mesures Cohérentes</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermédiaire</span>
                <span>60 minutes</span>
                <span>Prérequis : Module 27</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre les propriétés d'une mesure de risque cohérente</li>
            <li>Calculer l'Expected Shortfall</li>
            <li>Comparer VaR et ES</li>
        </ul>

        <div class="box">
            <h4><span class="text-red">Expected Shortfall (ES)</span></h4>
            <p style="text-align: center; font-family: monospace; font-size: 18px;">ES = E[Perte | Perte > VaR]</p>
            <p>Moyenne des pertes au-delà de la VaR. Aussi appelé CVaR ou Tail VaR.</p>
        </div>

        <h2>Mesures Cohérentes (Artzner, 1999)</h2>

        <div class="box">
            <h4>Les 4 Axiomes</h4>
            <ul>
                <li><strong>Monotonicité</strong> : Si X ≤ Y toujours, ρ(X) ≥ ρ(Y)</li>
                <li><strong>Sous-additivité</strong> : ρ(X+Y) ≤ ρ(X) + ρ(Y)</li>
                <li><strong>Homogénéité positive</strong> : ρ(λX) = λρ(X)</li>
                <li><strong>Invariance par translation</strong> : ρ(X+c) = ρ(X) - c</li>
            </ul>
            <p><span class="text-red">La VaR n'est pas cohérente</span> (pas sous-additive).</p>
            <p><span class="text-red">L'ES est cohérente</span>.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module27')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module29')">Suivant</button>
        </div>
    </section>

    <section id="module29" class="module">
        <header class="module-header">
            <h1>Stress Testing et Scénarios</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermédiaire</span>
                <span>60 minutes</span>
                <span>Prérequis : Module 27</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Construire des scénarios de stress historiques et hypothétiques</li>
            <li>Comprendre le reverse stress testing</li>
            <li>Connaître les exigences réglementaires (Bâle III/IV)</li>
        </ul>

        <div class="box">
            <h4><span class="text-red">Scénarios Historiques</span></h4>
            <p>Rejouer des crises passées : 1987, 1998 (LTCM), 2008, 2020 (COVID).</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Scénarios Hypothétiques</span></h4>
            <p>Imaginer des événements plausibles non observés : guerre, pandémie, cyber-attaque.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Reverse Stress Testing</span></h4>
            <p>Partir de la faillite et remonter : "Quels événements nous mettraient en faillite ?"</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module28')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module30')">Suivant</button>
        </div>
    </section>

    <section id="module30" class="module">
        <header class="module-header">
            <h1>Risques Opérationnels et de Modèle</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermédiaire</span>
                <span>60 minutes</span>
                <span>Prérequis : Module 27</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Identifier les sources de risque opérationnel</li>
            <li>Comprendre le risque de modèle et sa gestion</li>
            <li>Analyser le risque de liquidité</li>
        </ul>

        <div class="box">
            <h4><span class="text-red">Risque Opérationnel</span></h4>
            <p>Pertes dues à des défaillances de processus, personnes, systèmes ou événements externes.</p>
            <p>Exemples : fraude, erreur humaine, panne IT.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Risque de Modèle</span></h4>
            <p>Erreurs dues à des modèles incorrects ou mal utilisés.</p>
            <p><em>"Tous les modèles sont faux, mais certains sont utiles."</em> - George Box</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Risque de Liquidité</span></h4>
            <p>Impossibilité de vendre un actif rapidement sans impact sur le prix.</p>
            <p>Deux types : liquidité de financement et liquidité de marché.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module29')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module31')">Suivant</button>
        </div>
    </section>

    <!-- PARTIE VIII: PYTHON -->
    <section id="module31" class="module">
        <header class="module-header">
            <h1>Fondamentaux Python pour la Finance</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Pratique</span>
                <span>120 minutes</span>
                <span>Prérequis : Aucun</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Maîtriser NumPy pour les opérations vectorielles</li>
            <li>Utiliser Pandas pour la manipulation de données</li>
            <li>Créer des visualisations avec Matplotlib</li>
        </ul>

        <h2>NumPy - Calcul Numérique</h2>

        <div class="box">
            <h4>Opérations Vectorielles</h4>
            <p style="font-family: monospace; background: var(--bg-dark); padding: 15px; border-radius: 8px;">
                import numpy as np<br><br>
                rendements = np.array([0.02, -0.01, 0.03])<br>
                moyenne = np.mean(rendements)<br>
                volatilite = np.std(rendements) * np.sqrt(252)
            </p>
        </div>

        <h2>Pandas - Données Financières</h2>

        <div class="box">
            <h4>DataFrames</h4>
            <p style="font-family: monospace; background: var(--bg-dark); padding: 15px; border-radius: 8px;">
                import pandas as pd<br><br>
                df = pd.read_csv('prices.csv', index_col='Date', parse_dates=True)<br>
                returns = df['Close'].pct_change()<br>
                rolling_vol = returns.rolling(20).std() * np.sqrt(252)
            </p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module30')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module32')">Suivant</button>
        </div>
    </section>

    <section id="module32" class="module">
        <header class="module-header">
            <h1>Données Financières</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Pratique</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 31</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Récupérer des données via APIs (Yahoo Finance, Alpha Vantage)</li>
            <li>Nettoyer et préparer les données</li>
            <li>Calculer rendements et métriques</li>
        </ul>

        <div class="box">
            <h4>yfinance</h4>
            <p style="font-family: monospace; background: var(--bg-dark); padding: 15px; border-radius: 8px;">
                import yfinance as yf<br><br>
                ticker = yf.Ticker("AAPL")<br>
                hist = ticker.history(period="1y")<br>
                returns = hist['Close'].pct_change().dropna()
            </p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module31')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module33')">Suivant</button>
        </div>
    </section>

    <section id="module33" class="module">
        <header class="module-header">
            <h1>Séries Temporelles</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>90 minutes</span>
                <span>Prérequis : Modules 8, 31</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Tester la stationnarité (ADF, KPSS)</li>
            <li>Implémenter les modèles ARIMA</li>
            <li>Modéliser la volatilité avec GARCH</li>
        </ul>

        <div class="box">
            <h4>Test de <span class="text-red">Stationnarité</span></h4>
            <p style="font-family: monospace; background: var(--bg-dark); padding: 15px; border-radius: 8px;">
                from statsmodels.tsa.stattools import adfuller<br><br>
                result = adfuller(returns)<br>
                print(f'p-value: {result[1]}')<br>
                # p < 0.05 → stationnaire
            </p>
        </div>

        <div class="box">
            <h4>Modèle <span class="text-red">GARCH</span></h4>
            <p style="font-family: monospace; background: var(--bg-dark); padding: 15px; border-radius: 8px;">
                from arch import arch_model<br><br>
                model = arch_model(returns*100, vol='Garch', p=1, q=1)<br>
                res = model.fit()<br>
                forecast = res.forecast(horizon=5)
            </p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module32')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module34')">Suivant</button>
        </div>
    </section>

    <section id="module34" class="module">
        <header class="module-header">
            <h1>Implémentation Portefeuille</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Pratique</span>
                <span>90 minutes</span>
                <span>Prérequis : Modules 14, 31</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Implémenter l'optimisation de Markowitz avec scipy</li>
            <li>Utiliser cvxpy pour l'optimisation convexe</li>
            <li>Créer un backtest simple</li>
        </ul>

        <div class="box">
            <h4>Optimisation avec <span class="text-red">scipy</span></h4>
            <p style="font-family: monospace; background: var(--bg-dark); padding: 15px; border-radius: 8px;">
                from scipy.optimize import minimize<br><br>
                def neg_sharpe(w, mu, cov, rf):<br>
                &nbsp;&nbsp;ret = w @ mu<br>
                &nbsp;&nbsp;vol = np.sqrt(w @ cov @ w)<br>
                &nbsp;&nbsp;return -(ret - rf) / vol<br><br>
                result = minimize(neg_sharpe, x0, args=(mu, cov, rf),<br>
                &nbsp;&nbsp;constraints={'type': 'eq', 'fun': lambda w: sum(w)-1})
            </p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module33')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module35')">Suivant</button>
        </div>
    </section>

    <!-- PARTIE IX: METHODES NUMERIQUES -->
    <section id="module35" class="module">
        <header class="module-header">
            <h1>Méthodes Monte Carlo</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 9</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Générer des nombres aléatoires et simuler des trajectoires</li>
            <li>Évaluer des options par Monte Carlo</li>
            <li>Réduire la variance (antithétiques, variables de contrôle)</li>
        </ul>

        <div class="box">
            <h4>Pricing Monte Carlo</h4>
            <p style="font-family: monospace; background: var(--bg-dark); padding: 15px; border-radius: 8px;">
                def monte_carlo_call(S0, K, r, sigma, T, n_sims):<br>
                &nbsp;&nbsp;Z = np.random.standard_normal(n_sims)<br>
                &nbsp;&nbsp;ST = S0 * np.exp((r - 0.5*sigma**2)*T + sigma*np.sqrt(T)*Z)<br>
                &nbsp;&nbsp;payoffs = np.maximum(ST - K, 0)<br>
                &nbsp;&nbsp;return np.exp(-r*T) * np.mean(payoffs)
            </p>
        </div>

        <div class="box">
            <h4><span class="text-red">Variables Antithétiques</span></h4>
            <p>Utiliser Z et -Z pour réduire la variance de moitié.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module34')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module36')">Suivant</button>
        </div>
    </section>

    <section id="module36" class="module">
        <header class="module-header">
            <h1>Méthodes de Différences Finies</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 12</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Discrétiser l'EDP de Black-Scholes</li>
            <li>Implémenter les schémas explicite, implicite et Crank-Nicolson</li>
            <li>Traiter les options américaines</li>
        </ul>

        <div class="box">
            <h4>Schéma <span class="text-red">Explicite</span></h4>
            <p>Simple mais conditionnellement stable : Δt < Δx²/(2σ²)</p>
        </div>

        <div class="box">
            <h4>Schéma <span class="text-red">Crank-Nicolson</span></h4>
            <p>Moyenne explicite/implicite. Inconditionnellement stable, ordre 2.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module35')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module37')">Suivant</button>
        </div>
    </section>

    <section id="module37" class="module">
        <header class="module-header">
            <h1>Arbres et Lattices</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Intermédiaire</span>
                <span>75 minutes</span>
                <span>Prérequis : Module 18</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Construire des arbres binomiaux et trinomiaux</li>
            <li>Calibrer à la volatilité</li>
            <li>Évaluer les options path-dependent</li>
        </ul>

        <div class="box">
            <h4>Arbre <span class="text-red">Trinomial</span></h4>
            <p>Trois mouvements : up, down, middle. Plus stable numériquement.</p>
            <p>u = e^(σ√(2Δt)), d = 1/u, m = 1</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module36')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module38')">Suivant</button>
        </div>
    </section>

    <section id="module38" class="module">
        <header class="module-header">
            <h1>Optimisation Numérique</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>75 minutes</span>
                <span>Prérequis : Module 6</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Implémenter les méthodes de gradient</li>
            <li>Utiliser Newton-Raphson</li>
            <li>Résoudre des problèmes de programmation quadratique</li>
        </ul>

        <div class="box">
            <h4><span class="text-red">Newton-Raphson</span></h4>
            <p style="font-family: monospace;">xₙ₊₁ = xₙ - f(xₙ)/f'(xₙ)</p>
            <p>Convergence quadratique près de la solution.</p>
            <p><strong>Application :</strong> Calcul de volatilité implicite.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module37')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module39')">Suivant</button>
        </div>
    </section>

    <!-- PARTIE X: STRATEGIES -->
    <section id="module39" class="module">
        <header class="module-header">
            <h1>Factor Investing</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 15</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre les facteurs académiques (value, momentum, size, quality)</li>
            <li>Construire des portefeuilles factoriels</li>
            <li>Éviter les biais de backtesting</li>
        </ul>

        <h2>Les Facteurs Principaux</h2>

        <table>
            <thead><tr><th>Facteur</th><th>Définition</th><th>Prime historique</th></tr></thead>
            <tbody>
                <tr><td><span class="text-red">Value</span></td><td>Book/Market élevé</td><td>~3% par an</td></tr>
                <tr><td><span class="text-red">Momentum</span></td><td>Rendement 12-1 mois</td><td>~6% par an</td></tr>
                <tr><td><span class="text-red">Size</span></td><td>Small caps</td><td>~2% par an</td></tr>
                <tr><td><span class="text-red">Quality</span></td><td>ROE élevé, faible levier</td><td>~4% par an</td></tr>
            </tbody>
        </table>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module38')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module40')">Suivant</button>
        </div>
    </section>

    <section id="module40" class="module">
        <header class="module-header">
            <h1>Trading Statistique</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 8</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre le mean reversion et le pairs trading</li>
            <li>Tester la coïntégration (Engle-Granger)</li>
            <li>Construire des stratégies de statistical arbitrage</li>
        </ul>

        <div class="box">
            <h4><span class="text-red">Pairs Trading</span></h4>
            <p>Identifier deux actifs coïntégrés. Quand le spread dévie, parier sur la convergence.</p>
            <p><strong>Signal :</strong> Z-score du spread > 2 → short spread. Z-score < -2 → long spread.</p>
        </div>

        <div class="box">
            <h4>Test de <span class="text-red">Coïntégration</span></h4>
            <p>1. Régresser Y sur X : Y = α + βX + ε</p>
            <p>2. Tester si les résidus ε sont stationnaires (ADF)</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module39')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module41')">Suivant</button>
        </div>
    </section>

    <section id="module41" class="module">
        <header class="module-header">
            <h1>Microstructure de Marché</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>75 minutes</span>
                <span>Prérequis : Module 7</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre les carnets d'ordres (order books)</li>
            <li>Analyser le bid-ask spread et l'impact de marché</li>
            <li>Optimiser l'exécution (Almgren-Chriss)</li>
        </ul>

        <div class="box">
            <h4><span class="text-red">Bid-Ask Spread</span></h4>
            <p>Différence entre meilleur prix d'achat et de vente.</p>
            <p>Spread = Ask - Bid. Mesure de la liquidité.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Impact de Marché</span></h4>
            <p>Un ordre important déplace le prix contre lui-même.</p>
            <p>Impact ≈ σ × √(Q/V) (formule de square-root)</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module40')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module42')">Suivant</button>
        </div>
    </section>

    <section id="module42" class="module">
        <header class="module-header">
            <h1>Backtesting et Évaluation</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Pratique</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 16</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Construire un backtest rigoureux</li>
            <li>Éviter les biais (look-ahead, survivorship, overfitting)</li>
            <li>Valider avec walk-forward analysis</li>
        </ul>

        <h2>Les Biais du Backtesting</h2>

        <div class="box">
            <h4><span class="text-red">Look-Ahead Bias</span></h4>
            <p>Utiliser des informations futures dans les décisions passées.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Survivorship Bias</span></h4>
            <p>N'inclure que les actifs qui ont survécu (ignorer les faillites).</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Overfitting</span></h4>
            <p>Optimiser excessivement sur l'historique. La stratégie échoue en live.</p>
            <p><strong>Solution :</strong> Out-of-sample testing, validation croisée.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module41')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module43')">Suivant</button>
        </div>
    </section>

    <!-- PARTIE XI: MACHINE LEARNING -->
    <section id="module43" class="module">
        <header class="module-header">
            <h1>Apprentissage Supervisé</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>120 minutes</span>
                <span>Prérequis : Module 8</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Maîtriser régression Ridge, Lasso, ElasticNet</li>
            <li>Implémenter Random Forest et Gradient Boosting</li>
            <li>Valider avec cross-validation temporelle</li>
        </ul>

        <h2>Régularisation</h2>

        <div class="grid-2">
            <div class="grid-item">
                <h4><span class="text-red">Ridge (L2)</span></h4>
                <p>Pénalise Σβ². Réduit mais ne met pas à zéro.</p>
            </div>
            <div class="grid-item">
                <h4><span class="text-red">Lasso (L1)</span></h4>
                <p>Pénalise Σ|β|. Sélection de variables (sparse).</p>
            </div>
        </div>

        <h2>Ensemble Methods</h2>

        <div class="box">
            <h4><span class="text-red">Random Forest</span></h4>
            <p>Moyenne de nombreux arbres. Robuste à l'overfitting.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">XGBoost / LightGBM</span></h4>
            <p>Gradient boosting. État de l'art pour données tabulaires.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module42')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module44')">Suivant</button>
        </div>
    </section>

    <section id="module44" class="module">
        <header class="module-header">
            <h1>Apprentissage Non-Supervisé</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>90 minutes</span>
                <span>Prérequis : Module 5</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Appliquer K-means et clustering hiérarchique</li>
            <li>Réduire la dimension avec PCA et t-SNE</li>
            <li>Détecter les régimes de marché</li>
        </ul>

        <div class="box">
            <h4><span class="text-red">K-Means</span></h4>
            <p>Partitionne les données en K clusters. Application : regrouper actifs similaires.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Détection de Régimes</span></h4>
            <p>Hidden Markov Models (HMM) pour identifier bull/bear markets.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module43')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module45')">Suivant</button>
        </div>
    </section>

    <section id="module45" class="module">
        <header class="module-header">
            <h1>Réseaux de Neurones</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>120 minutes</span>
                <span>Prérequis : Module 43</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Comprendre le perceptron et la backpropagation</li>
            <li>Implémenter des réseaux récurrents (LSTM)</li>
            <li>Découvrir les Transformers pour la finance</li>
        </ul>

        <div class="box">
            <h4><span class="text-red">LSTM</span> (Long Short-Term Memory)</h4>
            <p>Réseau récurrent avec mémoire longue. Adapté aux séries temporelles.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Transformers</span></h4>
            <p>Architecture attention-based. État de l'art en NLP, prometteuse pour les séries temporelles.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module44')">Précédent</button>
            <button class="nav-btn" onclick="showModule('module46')">Suivant</button>
        </div>
    </section>

    <section id="module46" class="module">
        <header class="module-header">
            <h1>Applications ML en Finance</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Avancé</span>
                <span>90 minutes</span>
                <span>Prérequis : Modules 43-45</span>
            </div>
        </header>

        <h4>Objectifs</h4>
        <ul>
            <li>Prédire les rendements (et comprendre les limites)</li>
            <li>Appliquer le NLP au sentiment analysis</li>
            <li>Découvrir le reinforcement learning pour le trading</li>
        </ul>

        <div class="box">
            <h4><span class="text-red">Sentiment Analysis</span></h4>
            <p>Analyser news, tweets, rapports pour prédire les mouvements.</p>
            <p>Outils : BERT, FinBERT, GPT.</p>
        </div>

        <div class="box">
            <h4><span class="text-red">Reinforcement Learning</span></h4>
            <p>Agent apprend une politique de trading par essai-erreur.</p>
            <p>Défis : non-stationnarité, reward shaping, overfitting.</p>
        </div>

        <div class="box">
            <h4>⚠️ Limites du ML en Finance</h4>
            <ul>
                <li>Signal/bruit très faible</li>
                <li>Non-stationnarité des marchés</li>
                <li>Overfitting facile</li>
                <li>Changement de régime</li>
            </ul>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module45')">Précédent</button>
            <button class="nav-btn" onclick="showModule('projet1')">Suivant : Projets</button>
        </div>
    </section>

    <!-- PARTIE XII: PROJETS CAPSTONE -->
    <section id="projet1" class="module">
        <header class="module-header">
            <h1>Projet 1 : Construction de Portefeuille Quantitatif</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Projet</span>
                <span>2-3 semaines</span>
                <span>Prérequis : Modules 14-16, 31-34</span>
            </div>
        </header>

        <h4>Description</h4>
        <p>Construire un système complet d'allocation de portefeuille, de la collecte de données à l'analyse de performance.</p>

        <h2>Étapes du Projet</h2>

        <ol>
            <li><strong>Collecte de données</strong> : Récupérer les prix de 20+ actifs sur 10 ans</li>
            <li><strong>Analyse exploratoire</strong> : Rendements, volatilité, corrélations</li>
            <li><strong>Implémentation Markowitz</strong> : Frontière efficiente, GMV, portefeuille tangent</li>
            <li><strong>Extensions</strong> : Black-Litterman, contraintes, régularisation</li>
            <li><strong>Backtesting</strong> : Performance out-of-sample, rebalancement périodique</li>
            <li><strong>Rapport</strong> : Résultats, limites, recommandations</li>
        </ol>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('module46')">Précédent</button>
            <button class="nav-btn" onclick="showModule('projet2')">Projet 2</button>
        </div>
    </section>

    <section id="projet2" class="module">
        <header class="module-header">
            <h1>Projet 2 : Pricing de Dérivés</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Projet</span>
                <span>2-3 semaines</span>
                <span>Prérequis : Modules 17-22, 35-37</span>
            </div>
        </header>

        <h4>Description</h4>
        <p>Implémenter un pricer d'options complet avec plusieurs méthodes et calibration.</p>

        <h2>Étapes du Projet</h2>

        <ol>
            <li><strong>Black-Scholes analytique</strong> : Calls, puts, Greeks</li>
            <li><strong>Monte Carlo</strong> : Options vanilles et exotiques</li>
            <li><strong>Arbre binomial</strong> : Options américaines</li>
            <li><strong>Différences finies</strong> : EDP de Black-Scholes</li>
            <li><strong>Calibration</strong> : Extraire la volatilité implicite du marché</li>
            <li><strong>Tests</strong> : Convergence, parité put-call, Greeks numériques</li>
        </ol>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('projet1')">Projet 1</button>
            <button class="nav-btn" onclick="showModule('projet3')">Projet 3</button>
        </div>
    </section>

    <section id="projet3" class="module">
        <header class="module-header">
            <h1>Projet 3 : Stratégie de Trading</h1>
            <div class="module-meta">
                <span><div class="meta-dot"></div> Projet</span>
                <span>2-3 semaines</span>
                <span>Prérequis : Modules 39-42</span>
            </div>
        </header>

        <h4>Description</h4>
        <p>Développer, backtester et analyser une stratégie de trading quantitative.</p>

        <h2>Étapes du Projet</h2>

        <ol>
            <li><strong>Idée de stratégie</strong> : Momentum, mean-reversion, facteurs</li>
            <li><strong>Signal generation</strong> : Définir les règles d'entrée/sortie</li>
            <li><strong>Backtesting rigoureux</strong> : Éviter tous les biais</li>
            <li><strong>Analyse de performance</strong> : Sharpe, drawdown, attribution</li>
            <li><strong>Coûts de transaction</strong> : Impact réaliste</li>
            <li><strong>Walk-forward</strong> : Validation out-of-sample</li>
        </ol>

        <div class="box">
            <h4>⚠️ Rappel Important</h4>
            <p>Un backtest rentable ne garantit PAS la performance future. La plupart des stratégies qui marchent en backtest échouent en live.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="showModule('projet2')">Projet 2</button>
            <button class="nav-btn" onclick="showModule('module1')">Retour au début</button>
        </div>
    </section>

</main>

<script>
    function showModule(moduleId) {
        document.querySelectorAll('.module').forEach(m => m.classList.remove('active'));
        document.getElementById(moduleId).classList.add('active');
        document.querySelectorAll('.sidebar a').forEach(a => a.classList.remove('active'));
        const link = document.querySelector(`a[onclick="showModule('${moduleId}')"]`);
        if (link) link.classList.add('active');
        window.scrollTo(0, 0);
    }

    function toggleSubmenu(element, moduleId) {
        event.preventDefault();
        // Show the module
        document.querySelectorAll('.module').forEach(m => m.classList.remove('active'));
        document.getElementById(moduleId).classList.add('active');
        // Update active states
        document.querySelectorAll('.sidebar a').forEach(a => a.classList.remove('active'));
        element.classList.add('active');
        // Toggle submenu
        const submenu = element.nextElementSibling;
        const isOpen = submenu.classList.contains('open');
        // Close all submenus
        document.querySelectorAll('.submenu').forEach(s => s.classList.remove('open'));
        document.querySelectorAll('.module-link').forEach(l => l.classList.remove('open'));
        // Open this one if it was closed
        if (!isOpen) {
            submenu.classList.add('open');
            element.classList.add('open');
        }
        window.scrollTo(0, 0);
    }

    function scrollToSection(moduleId, sectionId) {
        event.preventDefault();
        // Show the module if not already visible
        const module = document.getElementById(moduleId);
        if (!module.classList.contains('active')) {
            document.querySelectorAll('.module').forEach(m => m.classList.remove('active'));
            module.classList.add('active');
        }
        // Scroll to section
        const section = document.getElementById(sectionId);
        if (section) {
            section.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    }

    // Exercise validation functions
    function checkDéfinitions() {
        const filled = ['def1', 'def2', 'def3', 'def4'].every(id =>
            document.getElementById(id).value.trim().length > 10
        );
        const feedback = document.getElementById('feedback-def');
        if (filled) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Vos réponses ont été enregistrees. Comparez avec la solution ci-dessous.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Veuillez complèter toutes les définitions (min. 10 caractères chacune).';
        }
    }

    function checkChronology() {
        const answers = {
            chrono1: 4, // Bourse Amsterdam
            chrono2: 1, // Hammurabi
            chrono3: 5, // Tulipomanie
            chrono4: 3, // Medicis
            chrono5: 2, // Foires Champagne
            chrono6: 6  // Confusion de Confusiones
        };
        let correct = 0;
        for (let id in answers) {
            const val = parseInt(document.getElementById(id).value);
            if (val === answers[id]) correct++;
        }
        const feedback = document.getElementById('feedback-chrono');
        if (correct === 6) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Parfait ! 6/6 réponses correctes.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = correct + '/6 réponses correctes. Verifiez la solution.';
        }
    }

    function checkVOC() {
        const calcVal = document.getElementById('voc-calc').value.toLowerCase();
        const calcCorrect = calcVal.includes('2.4') && (calcVal.includes('e38') || calcVal.includes('10^38'));

        const r1 = document.getElementById('voc-reason1').checked;
        const r2 = document.getElementById('voc-reason2').checked;
        const r3 = document.getElementById('voc-reason3').checked;
        const r4 = document.getElementById('voc-reason4').checked;
        const r5 = document.getElementById('voc-reason5').checked;
        const reasonsCorrect = r1 && r2 && !r3 && r4 && r5;

        const feedback = document.getElementById('feedback-voc');
        if (calcCorrect && reasonsCorrect) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Excellent ! Calcul et raisonnement corrects.';
        } else if (reasonsCorrect) {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Les raisons sont correctes, mais verifiez le calcul (2.4 x 10^38).';
        } else if (calcCorrect) {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Le calcul est correct. Attention : "taux trop faible" est une mauvaise réponse.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Verifiez vos réponses. Indice : toutes les raisons sont valides SAUF une.';
        }
    }

    function checkTulip() {
        const perte = parseInt(document.getElementById('tulip-perte').value);
        const invest = parseInt(document.getElementById('tulip-invest').value);
        const loss = parseInt(document.getElementById('tulip-loss').value);

        const feedback = document.getElementById('feedback-tulip');
        let score = 0;
        let messages = [];

        if (perte === 90) { score++; } else { messages.push('Perte % incorrecte'); }
        if (invest === 400000) { score++; } else { messages.push('Investissement incorrect'); }
        if (loss === 360000) { score++; } else { messages.push('Perte EUR incorrecte'); }

        if (score === 3) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Parfait ! Tous les calculs sont corrects.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = score + '/3 correct. ' + messages.join(', ') + '.';
        }
    }

    function checkVega() {
        const q1 = document.getElementById('vega-q1').value.toLowerCase();
        const q2 = document.getElementById('vega-q2').value.toLowerCase();
        const q3 = document.getElementById('vega-q3').value.trim();

        const feedback = document.getElementById('feedback-vega');
        let messages = [];

        const q1Ok = q1.includes('moutonne') || q1.includes('herding') || q1.includes('conformisme');
        const q2Ok = q2.includes('prospect') || q2.includes('perspective');
        const q3Ok = q3.length > 20;

        if (!q1Ok) messages.push('Q1: cherchez "moutonne" ou "herding"');
        if (!q2Ok) messages.push('Q2: cherchez "Prospect Theory" ou "Perspectives"');
        if (!q3Ok) messages.push('Q3: donnez un exemple plus détaillé');

        if (q1Ok && q2Ok && q3Ok) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Tres bien ! Vos réponses sont pertinentes.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = messages.join('<br>');
        }
    }

    // MODULE 2 - Exercise validation functions
    function checkM2Match() {
        const m1 = document.getElementById('m2-match1').value;
        const m2 = document.getElementById('m2-match2').value;
        const m3 = document.getElementById('m2-match3').value;
        const feedback = document.getElementById('feedback-m2-match');
        // Correct: Bernoulli=2, Bachelier=3, Pascal=1
        if (m1 === '2' && m2 === '3' && m3 === '1') {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Parfait ! Toutes les associations sont correctes.';
        } else {
            feedback.className = 'feedback incorrect';
            let score = (m1 === '2' ? 1 : 0) + (m2 === '3' ? 1 : 0) + (m3 === '1' ? 1 : 0);
            feedback.innerHTML = score + '/3 correct. Verifiez vos réponses.';
        }
    }

    function checkM2VF() {
        const vf1 = document.getElementById('m2-vf1').checked; // Faux
        const vf2 = document.getElementById('m2-vf2').checked; // Vrai
        const vf3 = document.getElementById('m2-vf3').checked; // Vrai
        const vf4 = document.getElementById('m2-vf4').checked; // Faux
        const feedback = document.getElementById('feedback-m2-vf');
        if (!vf1 && vf2 && vf3 && !vf4) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Excellent ! Toutes les réponses sont correctes.';
        } else {
            feedback.className = 'feedback incorrect';
            let score = (!vf1 ? 1 : 0) + (vf2 ? 1 : 0) + (vf3 ? 1 : 0) + (!vf4 ? 1 : 0);
            feedback.innerHTML = score + '/4 correct. Les affirmations 2 et 3 sont vraies.';
        }
    }

    function checkM2Esperance() {
        const val = parseInt(document.getElementById('m2-esp').value);
        const feedback = document.getElementById('feedback-m2-esp');
        if (val === 400) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! E(X) = 0.6 x 1000 + 0.4 x (-500) = 400 EUR';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Incorrect. Rappel : E(X) = P1 x X1 + P2 x X2';
        }
    }

    function checkM2Partis() {
        const val = parseInt(document.getElementById('m2-partis').value);
        const feedback = document.getElementById('feedback-m2-partis');
        if (val === 75) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! A devrait recevoir 75 EUR (3/4 de la mise).';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Incorrect. Utilisez le raisonnement récursif de Pascal.';
        }
    }

    function checkM2Analyse() {
        const text = document.getElementById('m2-analyse').value.toLowerCase();
        const feedback = document.getElementById('feedback-m2-analyse');
        const hasUtilite = text.includes('utilit') || text.includes('logarithm');
        const hasAversion = text.includes('aversion') || text.includes('risque');
        if (hasUtilite && hasAversion && text.length > 50) {
            feedback.className = 'feedback correct';
            feedback.textContent = 'Bonne analyse ! Vous avez bien compris la theorie de Bernoulli.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.textContent = 'Mentionnez les concepts d\'utilite marginale et d\'aversion au risque.';
        }
    }

    // MODULE 3 - Exercise validation functions
    function checkM3Match() {
        const m1 = document.getElementById('m3-match1').value;
        const m2 = document.getElementById('m3-match2').value;
        const m3 = document.getElementById('m3-match3').value;
        const m4 = document.getElementById('m3-match4').value;
        const feedback = document.getElementById('feedback-m3-match');
        if (m1 === '2' && m2 === '1' && m3 === '3' && m4 === '4') {
            feedback.className = 'feedback correct';
            feedback.textContent = 'Parfait ! Toutes les associations sont correctes.';
        } else {
            feedback.className = 'feedback incorrect';
            let score = (m1 === '2' ? 1 : 0) + (m2 === '1' ? 1 : 0) + (m3 === '3' ? 1 : 0) + (m4 === '4' ? 1 : 0);
            feedback.textContent = score + '/4 correct. Verifiez vos reponses.';
        }
    }

    function checkM3VF() {
        const vf1 = document.getElementById('m3-vf1').checked;
        const vf2 = document.getElementById('m3-vf2').checked;
        const vf3 = document.getElementById('m3-vf3').checked;
        const vf4 = document.getElementById('m3-vf4').checked;
        const feedback = document.getElementById('feedback-m3-vf');
        if (vf1 && !vf2 && vf3 && !vf4) {
            feedback.className = 'feedback correct';
            feedback.textContent = 'Excellent ! Toutes les reponses sont correctes.';
        } else {
            feedback.className = 'feedback incorrect';
            let score = (vf1 ? 1 : 0) + (!vf2 ? 1 : 0) + (vf3 ? 1 : 0) + (!vf4 ? 1 : 0);
            feedback.textContent = score + '/4 correct. Les affirmations 1 et 3 sont vraies.';
        }
    }

    function checkM3CAPM() {
        const val = parseFloat(document.getElementById('m3-capm').value);
        const feedback = document.getElementById('feedback-m3-capm');
        if (val === 12) {
            feedback.className = 'feedback correct';
            feedback.textContent = 'Correct ! E(R) = 3% + 1.5 x 6% = 12%';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.textContent = 'Incorrect. Rappel : E(R) = Rf + beta x (Rm - Rf)';
        }
    }

    function checkM3Div() {
        const val = parseFloat(document.getElementById('m3-div').value);
        const feedback = document.getElementById('feedback-m3-div');
        if (val >= 19 && val <= 20) {
            feedback.className = 'feedback correct';
            feedback.textContent = 'Correct ! sigma_p environ 19.6% (inferieur a la moyenne simple de 25%)';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.textContent = 'Incorrect. Utilisez la formule de variance du portefeuille.';
        }
    }

    function checkM3Analyse() {
        const text = document.getElementById('m3-analyse').value.toLowerCase();
        const feedback = document.getElementById('feedback-m3-analyse');
        const hasAnomalie = text.includes('anomalie') || text.includes('inefficien');
        const hasSurvie = text.includes('survi') || text.includes('biais');
        const hasRisque = text.includes('risque') || text.includes('tail');
        if ((hasAnomalie || hasSurvie || hasRisque) && text.length > 50) {
            feedback.className = 'feedback correct';
            feedback.textContent = 'Bonne analyse ! Vous avez identifie des limites pertinentes de l\'EMH.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.textContent = 'Developpez votre reponse : anomalies, biais de survie, risques caches...';
        }
    }

    // MODULE 4 - Exercise validation functions
    function checkM4Chrono() {
        const c1 = parseInt(document.getElementById('m4-chrono1').value);
        const c2 = parseInt(document.getElementById('m4-chrono2').value);
        const c3 = parseInt(document.getElementById('m4-chrono3').value);
        const c4 = parseInt(document.getElementById('m4-chrono4').value);
        const c5 = parseInt(document.getElementById('m4-chrono5').value);
        const feedback = document.getElementById('feedback-m4-chrono');
        // Correct: Lehman=3, BlackMonday=1, FlashCrash=5, LTCM=2, Bitcoin=4
        if (c1 === 3 && c2 === 1 && c3 === 5 && c4 === 2 && c5 === 4) {
            feedback.className = 'feedback correct';
            feedback.textContent = 'Parfait ! Chronologie correcte.';
        } else {
            feedback.className = 'feedback incorrect';
            let score = (c1===3?1:0) + (c2===1?1:0) + (c3===5?1:0) + (c4===2?1:0) + (c5===4?1:0);
            feedback.textContent = score + '/5 correct. Ordre: 1987, 1998, 2008, 2009, 2010';
        }
    }

    function checkM4VF() {
        const vf1 = document.getElementById('m4-vf1').checked; // Vrai
        const vf2 = document.getElementById('m4-vf2').checked; // Faux
        const vf3 = document.getElementById('m4-vf3').checked; // Vrai
        const vf4 = document.getElementById('m4-vf4').checked; // Faux
        const feedback = document.getElementById('feedback-m4-vf');
        if (vf1 && !vf2 && vf3 && !vf4) {
            feedback.className = 'feedback correct';
            feedback.textContent = 'Excellent ! Toutes les reponses sont correctes.';
        } else {
            feedback.className = 'feedback incorrect';
            let score = (vf1 ? 1 : 0) + (!vf2 ? 1 : 0) + (vf3 ? 1 : 0) + (!vf4 ? 1 : 0);
            feedback.textContent = score + '/4 correct. Affirmations 1 et 3 sont vraies.';
        }
    }

    function checkM4Levier() {
        const levier = parseInt(document.getElementById('m4-levier').value);
        const perte = parseInt(document.getElementById('m4-perte').value);
        const feedback = document.getElementById('feedback-m4-levier');
        let score = 0;
        if (levier === 25) score++;
        if (perte === 250) score++;
        if (score === 2) {
            feedback.className = 'feedback correct';
            feedback.textContent = 'Correct ! Levier 25:1 et perte de 250% du capital.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.textContent = score + '/2 correct. Levier = positions/capital, Perte% = (perte absolue/capital) x 100';
        }
    }

    function checkM4Analyse() {
        const text = document.getElementById('m4-analyse').value.toLowerCase();
        const feedback = document.getElementById('feedback-m4-analyse');
        const hasNormal = text.includes('normal') || text.includes('gauss');
        const hasCorrel = text.includes('correl') || text.includes('dependan');
        const hasLiquid = text.includes('liquid');
        const hasTail = text.includes('tail') || text.includes('queue');
        const count = (hasNormal?1:0) + (hasCorrel?1:0) + (hasLiquid?1:0) + (hasTail?1:0);
        if (count >= 2 && text.length > 80) {
            feedback.className = 'feedback correct';
            feedback.textContent = 'Bonne analyse ! Vous avez identifie les failles des modeles.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.textContent = 'Developpez : distributions normales, correlations, liquidite, fat tails...';
        }
    }

    // MODULE 1 - Niveau 4 Exercise validation functions
    function checkPrimeRisque() {
        const q1 = parseFloat(document.getElementById('prime-q1').value);
        const q2 = parseFloat(document.getElementById('prime-q2').value);
        const q3 = document.getElementById('prime-q3').value.trim();
        const feedback = document.getElementById('feedback-prime');
        let messages = [];
        let score = 0;

        // Q1: Prime = 33 - 20 = 13 points
        if (q1 === 13) {
            score++;
        } else {
            messages.push('Q1: Prime = 33% - 20% = 13 points');
        }

        // Q2: p environ 10% (9.8% exact)
        if (q2 >= 9 && q2 <= 11) {
            score++;
        } else {
            messages.push('Q2: p environ 9.8% (arrondi a 10%)');
        }

        // Q3: Must have some analysis
        if (q3.length > 30) {
            score++;
        } else {
            messages.push('Q3: Analysez plus en detail');
        }

        if (score === 3) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Excellent ! Tous les calculs sont corrects. Vous avez bien compris la prime de risque babylonienne.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = score + '/3 correct. ' + messages.join('<br>');
        }
    }

    function checkVOCValuation() {
        const d1 = parseInt(document.getElementById('voc-d1').value);
        const r = parseFloat(document.getElementById('voc-r').value);
        const v = parseInt(document.getElementById('voc-v').value);
        const ecart = document.getElementById('voc-ecart').value.trim();
        const feedback = document.getElementById('feedback-voc-val');
        let messages = [];
        let score = 0;

        // D1 = 400000 * 1.03 = 412000
        if (d1 >= 410000 && d1 <= 413000) {
            score++;
        } else {
            messages.push('D1 = 400,000 x 1.03 = 412,000');
        }

        // r = 5% + 4% = 9%
        if (r === 9 || r === 9.0) {
            score++;
        } else {
            messages.push('r = rf + ERP = 5% + 4% = 9%');
        }

        // V = 412000 / 0.06 = 6,866,667
        if (v >= 6800000 && v <= 6900000) {
            score++;
        } else {
            messages.push('V = D1 / (r-g) = 412,000 / 0.06');
        }

        // Analysis
        if (ecart.length > 30) {
            score++;
        } else {
            messages.push('Expliquez l\'ecart avec plus de detail');
        }

        if (score === 4) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Parfait ! Vous maitrisez le modèle de Gordon-Shapiro.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = score + '/4 correct. ' + messages.join('<br>');
        }
    }

    function checkIslamic() {
        const a = parseInt(document.getElementById('islamic-a').value);
        const b = parseInt(document.getElementById('islamic-b').value);
        const c = parseInt(document.getElementById('islamic-c').value);
        const d = document.getElementById('islamic-d').value.trim();
        const feedback = document.getElementById('feedback-islamic');
        let messages = [];
        let score = 0;

        // a) Cout A = 10M * 6% = 600,000
        if (a === 600000) {
            score++;
        } else {
            messages.push('Option A = 10M x 6% = 600,000 EUR');
        }

        // b) Cout B = 2M * 30% = 600,000
        if (b === 600000) {
            score++;
        } else {
            messages.push('Option B espèree = 2M x 30% = 600,000 EUR');
        }

        // c) Seuil = 600,000 / 0.30 = 2,000,000
        if (c === 2000000) {
            score++;
        } else {
            messages.push('Seuil: Profit x 30% > 600,000 donc Profit > 2M');
        }

        // d) Analysis
        if (d.length > 30 && (d.toLowerCase().includes('perte') || d.toLowerCase().includes('risque'))) {
            score++;
        } else {
            messages.push('Analysez l\'avantage en cas de pertes');
        }

        if (score === 4) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Excellent ! Vous comprenez les différences fondamentales entre finance conventionnelle et islamique.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = score + '/4 correct. ' + messages.join('<br>');
        }
    }

    // MODULE 2 - Charts
    // Utility function chart
    if (document.getElementById('utilityChart')) {
        const utilityData = [];
        for (let w = 1; w <= 100; w++) {
            utilityData.push({ x: w, y: Math.log(w) });
        }
        new Chart(document.getElementById('utilityChart'), {
            type: 'line',
            data: {
                datasets: [{
                    label: 'U(W) = ln(W)',
                    data: utilityData,
                    borderColor: '#9933ff',
                    backgroundColor: 'rgba(153, 51, 255, 0.1)',
                    fill: true,
                    tension: 0.4,
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false },
                    title: {
                        display: true,
                        text: 'Fonction d\'utilite logarithmique de Bernoulli',
                        color: '#e0e0e0',
                        font: { size: 14 }
                    }
                },
                scales: {
                    x: {
                        type: 'linear',
                        title: { display: true, text: 'Richesse (W)', color: '#e0e0e0' },
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0' }
                    },
                    y: {
                        title: { display: true, text: 'Utilite U(W)', color: '#e0e0e0' },
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0' }
                    }
                }
            }
        });
    }

    // Random walk simulation chart
    if (document.getElementById('randomWalkChart')) {
        function generateRandomWalk(steps) {
            let path = [100];
            for (let i = 1; i < steps; i++) {
                const change = (Math.random() - 0.5) * 4;
                path.push(path[i-1] + change);
            }
            return path;
        }
        const labels = Array.from({length: 100}, (_, i) => i);
        new Chart(document.getElementById('randomWalkChart'), {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    { data: generateRandomWalk(100), borderColor: '#0066ff', borderWidth: 1, pointRadius: 0, tension: 0 },
                    { data: generateRandomWalk(100), borderColor: '#00cc66', borderWidth: 1, pointRadius: 0, tension: 0 },
                    { data: generateRandomWalk(100), borderColor: '#ff9900', borderWidth: 1, pointRadius: 0, tension: 0 }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false },
                    title: {
                        display: true,
                        text: 'Simulation de marchés aléatoires (mouvement brownien)',
                        color: '#e0e0e0',
                        font: { size: 14 }
                    }
                },
                scales: {
                    x: {
                        title: { display: true, text: 'Temps', color: '#e0e0e0' },
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0' }
                    },
                    y: {
                        title: { display: true, text: 'Prix', color: '#e0e0e0' },
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0' }
                    }
                }
            }
        });
    }

    // Normal Distribution Chart (Laplace)
    if (document.getElementById('normalDistChart')) {
        // Generate normal distribution curve
        const normalData = [];
        const normalLabels = [];
        for (let x = -4; x <= 4; x += 0.1) {
            normalLabels.push(x.toFixed(1));
            normalData.push((1 / Math.sqrt(2 * Math.PI)) * Math.exp(-0.5 * x * x));
        }
        new Chart(document.getElementById('normalDistChart'), {
            type: 'line',
            data: {
                labels: normalLabels,
                datasets: [{
                    data: normalData,
                    borderColor: '#0066ff',
                    backgroundColor: 'rgba(0, 102, 255, 0.2)',
                    fill: true,
                    pointRadius: 0,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false },
                    title: {
                        display: true,
                        text: 'Distribution Normale N(0,1) - La courbe en cloche de Gauss-Laplace',
                        color: '#e0e0e0',
                        font: { size: 14 }
                    }
                },
                scales: {
                    x: {
                        title: { display: true, text: 'Écarts-types (σ)', color: '#e0e0e0' },
                        grid: { color: '#222' },
                        ticks: {
                            color: '#e0e0e0',
                            callback: function(value, index) {
                                const label = this.getLabelForValue(value);
                                if (['-3.0', '-2.0', '-1.0', '0.0', '1.0', '2.0', '3.0'].includes(label)) return label;
                                return '';
                            }
                        }
                    },
                    y: {
                        title: { display: true, text: 'Densité', color: '#e0e0e0' },
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0' }
                    }
                }
            }
        });
    }

    // MODULE 3 - Efficient Frontier Chart
    if (document.getElementById('efficientFrontierChart')) {
        // Generate efficient frontier data
        const frontierData = [];
        const individualAssets = [
            { x: 15, y: 8, label: 'Obligations' },
            { x: 20, y: 10, label: 'Actions défensives' },
            { x: 25, y: 12, label: 'Actions cycliques' },
            { x: 35, y: 14, label: 'Actions growth' },
            { x: 40, y: 13, label: 'Emerging Markets' }
        ];
        // Efficient frontier curve
        for (let risk = 12; risk <= 40; risk += 1) {
            const ret = 4 + Math.sqrt(risk - 10) * 3.2;
            frontierData.push({ x: risk, y: ret });
        }
        new Chart(document.getElementById('efficientFrontierChart'), {
            type: 'scatter',
            data: {
                datasets: [
                    {
                        label: 'Frontière efficiente',
                        data: frontierData,
                        borderColor: '#0066ff',
                        backgroundColor: 'transparent',
                        showLine: true,
                        pointRadius: 0,
                        tension: 0.4,
                        borderWidth: 3
                    },
                    {
                        label: 'Actifs individuels',
                        data: individualAssets,
                        borderColor: '#ff9900',
                        backgroundColor: '#ff9900',
                        pointRadius: 8,
                        showLine: false
                    },
                    {
                        label: 'GMV (Variance Minimale)',
                        data: [{ x: 12, y: 6.5 }],
                        borderColor: '#00cc66',
                        backgroundColor: '#00cc66',
                        pointRadius: 10,
                        showLine: false
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: true,
                        labels: { color: '#e0e0e0' }
                    },
                    title: {
                        display: true,
                        text: 'Frontière Efficiente de Markowitz',
                        color: '#e0e0e0',
                        font: { size: 14 }
                    }
                },
                scales: {
                    x: {
                        title: { display: true, text: 'Risque (Volatilité %)', color: '#e0e0e0' },
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0' },
                        min: 5,
                        max: 45
                    },
                    y: {
                        title: { display: true, text: 'Rendement Espéré (%)', color: '#e0e0e0' },
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0' },
                        min: 0,
                        max: 20
                    }
                }
            }
        });
    }

    // MODULE 3 - Security Market Line (SML) Chart
    if (document.getElementById('smlChart')) {
        const smlData = [];
        for (let beta = 0; beta <= 2; beta += 0.1) {
            smlData.push({ x: beta, y: 3 + beta * 6 });
        }
        const assets = [
            { x: 0.5, y: 7, label: 'Utilities (sur SML)' },
            { x: 1.0, y: 9, label: 'Marché (sur SML)' },
            { x: 1.5, y: 14, label: 'Tech (α > 0)' },
            { x: 1.2, y: 8, label: 'Banque (α < 0)' }
        ];
        new Chart(document.getElementById('smlChart'), {
            type: 'scatter',
            data: {
                datasets: [
                    {
                        label: 'Security Market Line',
                        data: smlData,
                        borderColor: '#0066ff',
                        backgroundColor: 'transparent',
                        showLine: true,
                        pointRadius: 0,
                        borderWidth: 2
                    },
                    {
                        label: 'Actifs',
                        data: assets,
                        borderColor: '#ff9900',
                        backgroundColor: '#ff9900',
                        pointRadius: 8,
                        showLine: false
                    },
                    {
                        label: 'Taux sans risque',
                        data: [{ x: 0, y: 3 }],
                        borderColor: '#00cc66',
                        backgroundColor: '#00cc66',
                        pointRadius: 10,
                        showLine: false
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: true,
                        labels: { color: '#e0e0e0' }
                    },
                    title: {
                        display: true,
                        text: 'Security Market Line (CAPM) - Rf=3%, Prime=6%',
                        color: '#e0e0e0',
                        font: { size: 14 }
                    }
                },
                scales: {
                    x: {
                        title: { display: true, text: 'Bêta (β)', color: '#e0e0e0' },
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0' },
                        min: 0,
                        max: 2.2
                    },
                    y: {
                        title: { display: true, text: 'Rendement Espéré (%)', color: '#e0e0e0' },
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0' },
                        min: 0,
                        max: 18
                    }
                }
            }
        });
    }

    // VOC Chart
    new Chart(document.getElementById('vocChart'), {
        type: 'bar',
        data: {
            labels: ['Amsterdam', 'Middelbourg', 'Delft', 'Rotterdam', 'Hoorn', 'Enkhuizen'],
            datasets: [{
                data: [57, 20, 7, 7, 5, 4],
                backgroundColor: '#0066ff',
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            indexAxis: 'y',
            plugins: {
                legend: { display: false },
                title: {
                    display: true,
                    text: 'Repartition du capital VOC par ville - 1602 (%)',
                    color: '#e0e0e0',
                    font: { size: 12, weight: 'normal' }
                }
            },
            scales: {
                x: {
                    grid: { color: '#222' },
                    ticks: { color: '#e0e0e0' }
                },
                y: {
                    grid: { display: false },
                    ticks: { color: '#fff' }
                }
            }
        }
    });

    // Islamic Finance Growth Chart
    new Chart(document.getElementById('islamicFinanceChart'), {
        type: 'line',
        data: {
            labels: ['2010', '2012', '2014', '2016', '2018', '2020', '2022', '2024'],
            datasets: [{
                label: 'Actifs (milliards USD)',
                data: [1000, 1350, 1800, 2100, 2500, 2700, 2900, 3200],
                borderColor: '#00cc66',
                backgroundColor: 'rgba(0, 204, 102, 0.1)',
                fill: true,
                tension: 0.3,
                pointRadius: 4,
                pointBackgroundColor: '#00cc66'
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: false },
                title: {
                    display: true,
                    text: 'Croissance des actifs de finance islamique mondiale',
                    color: '#e0e0e0',
                    font: { size: 12, weight: 'normal' }
                }
            },
            scales: {
                x: {
                    grid: { color: '#222' },
                    ticks: { color: '#e0e0e0' }
                },
                y: {
                    grid: { color: '#222' },
                    ticks: { color: '#e0e0e0' },
                    beginAtZero: false
                }
            }
        }
    });

    // Prime de Risque Historique Chart
    new Chart(document.getElementById('primeRisqueChart'), {
        type: 'bar',
        data: {
            labels: ['Babylone\n(1750 av. J.-C.)', 'Grèce\n(400 av. J.-C.)', 'Rome\n(100 ap. J.-C.)', 'Italie\n(1400)', 'Hollande\n(1650)', 'Moderne\n(2024)'],
            datasets: [{
                label: 'Taux sans risque',
                data: [20, 12, 8, 10, 6, 4],
                backgroundColor: '#00cc66'
            }, {
                label: 'Taux risque',
                data: [33, 28, 24, 18, 18, 10],
                backgroundColor: '#ff3333'
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    labels: { color: '#e0e0e0' }
                },
                title: {
                    display: true,
                    text: 'Primes de risque à travers les ages (% annualise)',
                    color: '#e0e0e0',
                    font: { size: 12, weight: 'normal' }
                }
            },
            scales: {
                x: {
                    grid: { color: '#222' },
                    ticks: { color: '#e0e0e0' }
                },
                y: {
                    grid: { color: '#222' },
                    ticks: { color: '#e0e0e0' },
                    beginAtZero: true,
                    max: 40
                }
            }
        }
    });

    // Tulip Chart
    new Chart(document.getElementById('tulipChart'), {
        type: 'line',
        data: {
            labels: ['1634', '1635', 'Debut 1636', 'Mi-1636', 'Nov 1636', 'Jan 1637', 'Fev 1637', 'Mar 1637'],
            datasets: [{
                label: 'Prix (florins)',
                data: [500, 1000, 2000, 3000, 5000, 8000, 10000, 1000],
                borderColor: '#ff3333',
                backgroundColor: 'rgba(255, 51, 51, 0.1)',
                fill: true,
                tension: 0.4,
                pointRadius: 4,
                pointBackgroundColor: '#ff3333'
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: false },
                title: {
                    display: true,
                    text: 'Evolution du prix du Semper Augustus',
                    color: '#e0e0e0',
                    font: { size: 12, weight: 'normal' }
                }
            },
            scales: {
                x: {
                    grid: { color: '#222' },
                    ticks: { color: '#e0e0e0' }
                },
                y: {
                    grid: { color: '#222' },
                    ticks: { color: '#e0e0e0' },
                    beginAtZero: true
                }
            }
        }
    });

    // Bubble Comparison Chart
    new Chart(document.getElementById('bubbleCompareChart'), {
        type: 'bar',
        data: {
            labels: ['Tulipomanie\n(1637)', 'Compagnie du\nMississippi (1720)', 'Crash de\n1929', 'Bulle Internet\n(2000)', 'Subprimes\n(2008)', 'Bitcoin\n(2022)'],
            datasets: [{
                label: 'Chute maximale (%)',
                data: [-90, -85, -89, -78, -57, -77],
                backgroundColor: ['#ff3333', '#ff6666', '#ff9999', '#ffcccc', '#ff9999', '#ff6666']
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: false },
                title: {
                    display: true,
                    text: 'Amplitude des crashes de bulles spéculatives (% de chute)',
                    color: '#e0e0e0',
                    font: { size: 12, weight: 'normal' }
                }
            },
            scales: {
                x: {
                    grid: { color: '#222' },
                    ticks: { color: '#e0e0e0' }
                },
                y: {
                    grid: { color: '#222' },
                    ticks: { color: '#e0e0e0' },
                    min: -100,
                    max: 0
                }
            }
        }
    });

    // MODULE 5 - Corrélation entre secteurs (bar chart)
    if (document.getElementById('correlationHeatmap')) {
        new Chart(document.getElementById('correlationHeatmap'), {
            type: 'bar',
            data: {
                labels: ['Tech-Finance', 'Tech-Santé', 'Tech-Energie', 'Finance-Industrie', 'Santé-Utilities', 'Or-Actions'],
                datasets: [{
                    label: 'Corrélation',
                    data: [0.78, 0.45, 0.52, 0.71, 0.32, -0.15],
                    backgroundColor: [
                        'rgba(255, 51, 51, 0.7)',
                        'rgba(255, 153, 0, 0.7)',
                        'rgba(255, 153, 0, 0.7)',
                        'rgba(255, 51, 51, 0.7)',
                        'rgba(0, 204, 102, 0.7)',
                        'rgba(0, 102, 255, 0.7)'
                    ],
                    borderColor: [
                        '#ff3333',
                        '#ff9900',
                        '#ff9900',
                        '#ff3333',
                        '#00cc66',
                        '#0066ff'
                    ],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false },
                    title: {
                        display: true,
                        text: 'Corrélations typiques entre secteurs (données historiques)',
                        color: '#e0e0e0',
                        font: { size: 14 }
                    }
                },
                scales: {
                    x: {
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0', font: { size: 11 } }
                    },
                    y: {
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0' },
                        min: -0.5,
                        max: 1,
                        title: {
                            display: true,
                            text: 'Coefficient de corrélation ρ',
                            color: '#e0e0e0'
                        }
                    }
                }
            }
        });
    }

    // MODULE 6 - Graphique Delta (sensibilité au prix du sous-jacent)
    if (document.getElementById('deltaChart')) {
        // Delta du call en fonction du prix du sous-jacent S
        // Pour un call: Delta = N(d1) où d1 = [ln(S/K) + (r + σ²/2)T] / (σ√T)
        // K = 100, r = 5%, σ = 20%, T = 1 an
        const K = 100, r = 0.05, sigma = 0.2, T = 1;
        const sqrtT = Math.sqrt(T);

        function normalCDF(x) {
            const a1 = 0.254829592, a2 = -0.284496736, a3 = 1.421413741;
            const a4 = -1.453152027, a5 = 1.061405429, p = 0.3275911;
            const sign = x < 0 ? -1 : 1;
            x = Math.abs(x) / Math.sqrt(2);
            const t = 1 / (1 + p * x);
            const y = 1 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
            return 0.5 * (1 + sign * y);
        }

        function calculateDelta(S) {
            const d1 = (Math.log(S / K) + (r + sigma * sigma / 2) * T) / (sigma * sqrtT);
            return normalCDF(d1);
        }

        const prices = [];
        const deltas = [];
        const gammas = [];

        for (let S = 60; S <= 140; S += 2) {
            prices.push(S);
            const delta = calculateDelta(S);
            deltas.push(delta);
            // Gamma approximation (derivative of delta)
            const deltaUp = calculateDelta(S + 0.5);
            const deltaDown = calculateDelta(S - 0.5);
            gammas.push((deltaUp - deltaDown) / 1);
        }

        new Chart(document.getElementById('deltaChart'), {
            type: 'line',
            data: {
                labels: prices,
                datasets: [
                    {
                        label: 'Delta (Δ)',
                        data: deltas,
                        borderColor: '#00d4aa',
                        backgroundColor: 'rgba(0, 212, 170, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        borderWidth: 3
                    },
                    {
                        label: 'Gamma (Γ) × 10',
                        data: gammas.map(g => g * 10),
                        borderColor: '#ff6b6b',
                        backgroundColor: 'rgba(255, 107, 107, 0.1)',
                        fill: false,
                        tension: 0.4,
                        pointRadius: 0,
                        borderWidth: 2,
                        borderDash: [5, 5]
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Delta et Gamma d\'un Call (K=100, σ=20%, T=1an)',
                        color: '#e0e0e0',
                        font: { size: 14, weight: 'bold' }
                    },
                    legend: {
                        labels: { color: '#e0e0e0' }
                    },
                    annotation: {
                        annotations: {
                            strike: {
                                type: 'line',
                                xMin: 20,
                                xMax: 20,
                                borderColor: 'rgba(255, 255, 255, 0.3)',
                                borderWidth: 2,
                                borderDash: [6, 6],
                                label: {
                                    display: true,
                                    content: 'K = 100',
                                    position: 'start'
                                }
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0' },
                        title: {
                            display: true,
                            text: 'Prix du sous-jacent S (€)',
                            color: '#e0e0e0'
                        }
                    },
                    y: {
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0' },
                        min: 0,
                        max: 1.2,
                        title: {
                            display: true,
                            text: 'Valeur du Greek',
                            color: '#e0e0e0'
                        }
                    }
                }
            }
        });
    }

    // MODULE 7 - Graphique des distributions (Normale vs Student-t)
    if (document.getElementById('distributionsChart')) {
        // Fonction densité normale N(0,1)
        function normalPDF(x) {
            return Math.exp(-0.5 * x * x) / Math.sqrt(2 * Math.PI);
        }

        // Fonction densité Student-t avec ν degrés de liberté
        function studentPDF(x, nu) {
            const coef = Math.exp(
                lgamma((nu + 1) / 2) - lgamma(nu / 2)
            ) / Math.sqrt(nu * Math.PI);
            return coef * Math.pow(1 + x * x / nu, -(nu + 1) / 2);
        }

        // Approximation de log-gamma (Stirling)
        function lgamma(x) {
            const c = [76.18009172947146, -86.50532032941677, 24.01409824083091,
                -1.231739572450155, 0.1208650973866179e-2, -0.5395239384953e-5];
            let y = x, tmp = x + 5.5;
            tmp -= (x + 0.5) * Math.log(tmp);
            let ser = 1.000000000190015;
            for (let j = 0; j < 6; j++) ser += c[j] / ++y;
            return -tmp + Math.log(2.5066282746310005 * ser / x);
        }

        const xValues = [];
        const normalData = [];
        const student3Data = [];
        const student5Data = [];

        for (let x = -5; x <= 5; x += 0.1) {
            xValues.push(x.toFixed(1));
            normalData.push(normalPDF(x));
            student3Data.push(studentPDF(x, 3));
            student5Data.push(studentPDF(x, 5));
        }

        new Chart(document.getElementById('distributionsChart'), {
            type: 'line',
            data: {
                labels: xValues,
                datasets: [
                    {
                        label: 'Normale N(0,1)',
                        data: normalData,
                        borderColor: '#00d4aa',
                        backgroundColor: 'rgba(0, 212, 170, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        borderWidth: 3
                    },
                    {
                        label: 'Student t(ν=3)',
                        data: student3Data,
                        borderColor: '#ff6b6b',
                        fill: false,
                        tension: 0.4,
                        pointRadius: 0,
                        borderWidth: 2
                    },
                    {
                        label: 'Student t(ν=5)',
                        data: student5Data,
                        borderColor: '#ffd700',
                        fill: false,
                        tension: 0.4,
                        pointRadius: 0,
                        borderWidth: 2,
                        borderDash: [5, 5]
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Comparaison : Normale vs Student-t (queues épaisses)',
                        color: '#e0e0e0',
                        font: { size: 14, weight: 'bold' }
                    },
                    legend: {
                        labels: { color: '#e0e0e0' }
                    }
                },
                scales: {
                    x: {
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0', maxTicksLimit: 11 },
                        title: {
                            display: true,
                            text: 'x (écarts-types)',
                            color: '#e0e0e0'
                        }
                    },
                    y: {
                        grid: { color: '#222' },
                        ticks: { color: '#e0e0e0' },
                        min: 0,
                        max: 0.45,
                        title: {
                            display: true,
                            text: 'Densité f(x)',
                            color: '#e0e0e0'
                        }
                    }
                }
            }
        });
    }

    // MODULE 8 - Graphique Régression CAPM (scatter + ligne de régression)
    if (document.getElementById('capmRegressionChart')) {
        // Données simulées : rendements marché vs actif (Apple-like, β ≈ 1.25)
        const marketReturns = [-8, -6, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 10];
        const assetReturns = marketReturns.map(r => {
            // Y = α + β*X + ε, avec α = 0.8, β = 1.25, ε ~ noise
            const noise = (Math.random() - 0.5) * 4;
            return 0.8 + 1.25 * r + noise;
        });

        // Points du scatter
        const scatterData = marketReturns.map((x, i) => ({ x: x, y: assetReturns[i] }));

        // Ligne de régression : Y = 0.8 + 1.25 * X
        const regressionLine = [
            { x: -10, y: 0.8 + 1.25 * (-10) },
            { x: 12, y: 0.8 + 1.25 * 12 }
        ];

        new Chart(document.getElementById('capmRegressionChart'), {
            type: 'scatter',
            data: {
                datasets: [
                    {
                        label: 'Rendements mensuels',
                        data: scatterData,
                        backgroundColor: 'rgba(0, 212, 170, 0.7)',
                        borderColor: '#00d4aa',
                        pointRadius: 6,
                        pointHoverRadius: 8
                    },
                    {
                        label: 'Ligne de régression (β = 1.25)',
                        data: regressionLine,
                        type: 'line',
                        borderColor: '#ff6b6b',
                        borderWidth: 3,
                        fill: false,
                        pointRadius: 0,
                        borderDash: []
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Régression CAPM : Rendement Actif vs Marché',
                        color: '#e0e0e0',
                        font: { size: 14, weight: 'bold' }
                    },
                    legend: {
                        labels: { color: '#e0e0e0' }
                    }
                },
                scales: {
                    x: {
                        type: 'linear',
                        position: 'center',
                        grid: { color: '#333' },
                        ticks: { color: '#e0e0e0' },
                        min: -12,
                        max: 14,
                        title: {
                            display: true,
                            text: 'Rendement Marché Rₘ - Rᶠ (%)',
                            color: '#e0e0e0'
                        }
                    },
                    y: {
                        type: 'linear',
                        position: 'center',
                        grid: { color: '#333' },
                        ticks: { color: '#e0e0e0' },
                        min: -15,
                        max: 20,
                        title: {
                            display: true,
                            text: 'Rendement Actif Rᵢ - Rᶠ (%)',
                            color: '#e0e0e0'
                        }
                    }
                }
            }
        });
    }

    // ═══════════════════════════════════════════════════════════════════════════
    // GRAPHIQUE MODULE 9 - Simulation GBM
    // ═══════════════════════════════════════════════════════════════════════════
    if (document.getElementById('gbmSimulationChart')) {
        // Paramètres GBM
        const S0 = 100;
        const mu = 0.10;  // drift 10%
        const sigma = 0.25;  // volatilité 25%
        const T = 1;  // 1 an
        const n = 252;  // 252 jours de trading
        const dt = T / n;
        const numTrajectories = 5;

        // Générer les trajectoires
        const trajectories = [];
        const labels = [];

        for (let i = 0; i <= n; i++) {
            labels.push((i * dt).toFixed(3));
        }

        // Générateur de nombres aléatoires normaux (Box-Muller)
        function randn() {
            const u1 = Math.random();
            const u2 = Math.random();
            return Math.sqrt(-2 * Math.log(u1)) * Math.cos(2 * Math.PI * u2);
        }

        // Couleurs pour les trajectoires
        const colors = [
            'rgba(255, 107, 107, 1)',   // Rouge
            'rgba(78, 205, 196, 1)',    // Turquoise
            'rgba(255, 217, 61, 1)',    // Jaune
            'rgba(107, 185, 240, 1)',   // Bleu
            'rgba(200, 140, 255, 1)'    // Violet
        ];

        for (let traj = 0; traj < numTrajectories; traj++) {
            const path = [S0];
            let S = S0;

            for (let i = 1; i <= n; i++) {
                const dW = randn() * Math.sqrt(dt);
                // Schéma d'Euler pour GBM: S(t+dt) = S(t) * exp((μ - σ²/2)dt + σ*dW)
                S = S * Math.exp((mu - 0.5 * sigma * sigma) * dt + sigma * dW);
                path.push(S);
            }

            trajectories.push({
                label: `Trajectoire ${traj + 1}`,
                data: path,
                borderColor: colors[traj],
                backgroundColor: 'transparent',
                borderWidth: 2,
                pointRadius: 0,
                tension: 0.1
            });
        }

        // Ajouter la valeur espérée E[S_t] = S_0 * e^(μt)
        const expectedPath = [];
        for (let i = 0; i <= n; i++) {
            expectedPath.push(S0 * Math.exp(mu * i * dt));
        }
        trajectories.push({
            label: 'E[Sₜ] = S₀e^μt (espérance)',
            data: expectedPath,
            borderColor: 'rgba(255, 255, 255, 0.9)',
            backgroundColor: 'transparent',
            borderWidth: 3,
            borderDash: [10, 5],
            pointRadius: 0,
            tension: 0
        });

        new Chart(document.getElementById('gbmSimulationChart'), {
            type: 'line',
            data: {
                labels: labels,
                datasets: trajectories
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Simulation de Mouvement Brownien Géométrique (5 trajectoires)',
                        color: '#e0e0e0',
                        font: { size: 16 }
                    },
                    legend: {
                        labels: { color: '#e0e0e0' }
                    },
                    tooltip: {
                        callbacks: {
                            title: function(context) {
                                return `t = ${context[0].label} an`;
                            },
                            label: function(context) {
                                return `${context.dataset.label}: ${context.parsed.y.toFixed(2)}€`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        grid: { color: '#333' },
                        ticks: {
                            color: '#e0e0e0',
                            maxTicksLimit: 10,
                            callback: function(value, index) {
                                if (index % 50 === 0) return labels[index] + ' an';
                                return '';
                            }
                        },
                        title: {
                            display: true,
                            text: 'Temps (années)',
                            color: '#e0e0e0'
                        }
                    },
                    y: {
                        grid: { color: '#333' },
                        ticks: {
                            color: '#e0e0e0',
                            callback: function(value) {
                                return value.toFixed(0) + '€';
                            }
                        },
                        title: {
                            display: true,
                            text: 'Prix S(t)',
                            color: '#e0e0e0'
                        }
                    }
                },
                interaction: {
                    mode: 'index',
                    intersect: false
                }
            }
        });
    }

    // ═══════════════════════════════════════════════════════════════════════════
    // GRAPHIQUE MODULE 10 - Comparaison des Schémas de Simulation
    // ═══════════════════════════════════════════════════════════════════════════
    if (document.getElementById('itoSchemasChart')) {
        // Paramètres du GBM
        const S0_ito = 100;
        const mu_ito = 0.10;
        const sigma_ito = 0.30;
        const T_ito = 1;
        const n_ito = 50;  // Moins de points pour bien voir les différences
        const dt_ito = T_ito / n_ito;

        // Générer le même brownien pour tous les schémas
        function randn_ito() {
            const u1 = Math.random();
            const u2 = Math.random();
            return Math.sqrt(-2 * Math.log(u1)) * Math.cos(2 * Math.PI * u2);
        }

        // Seed fixe pour reproductibilité
        Math.seedrandom = function(seed) {
            const x = Math.sin(seed++) * 10000;
            return x - Math.floor(x);
        };

        const Z_values = [];
        const W_values = [0];  // Brownien cumulé
        let W_cumul = 0;

        for (let i = 0; i < n_ito; i++) {
            const z = randn_ito();
            Z_values.push(z);
            W_cumul += z * Math.sqrt(dt_ito);
            W_values.push(W_cumul);
        }

        const labels_ito = [];
        for (let i = 0; i <= n_ito; i++) {
            labels_ito.push((i * dt_ito).toFixed(2));
        }

        // Schéma exact (analytique)
        const exact_path = [S0_ito];
        for (let i = 1; i <= n_ito; i++) {
            const t = i * dt_ito;
            const S = S0_ito * Math.exp((mu_ito - 0.5 * sigma_ito * sigma_ito) * t + sigma_ito * W_values[i]);
            exact_path.push(S);
        }

        // Schéma d'Euler naïf
        const euler_path = [S0_ito];
        let S_euler = S0_ito;
        for (let i = 0; i < n_ito; i++) {
            const dW = Z_values[i] * Math.sqrt(dt_ito);
            S_euler = S_euler * (1 + mu_ito * dt_ito + sigma_ito * dW);
            euler_path.push(S_euler);
        }

        // Schéma Log-Euler (Euler sur ln S)
        const logeuler_path = [S0_ito];
        let S_log = S0_ito;
        for (let i = 0; i < n_ito; i++) {
            const dW = Z_values[i] * Math.sqrt(dt_ito);
            S_log = S_log * Math.exp((mu_ito - 0.5 * sigma_ito * sigma_ito) * dt_ito + sigma_ito * dW);
            logeuler_path.push(S_log);
        }

        // Schéma de Milstein
        const milstein_path = [S0_ito];
        let S_mil = S0_ito;
        for (let i = 0; i < n_ito; i++) {
            const dW = Z_values[i] * Math.sqrt(dt_ito);
            const Z_sq = Z_values[i] * Z_values[i];
            S_mil = S_mil + mu_ito * S_mil * dt_ito + sigma_ito * S_mil * dW
                    + 0.5 * sigma_ito * sigma_ito * S_mil * (Z_sq - 1) * dt_ito;
            milstein_path.push(S_mil);
        }

        new Chart(document.getElementById('itoSchemasChart'), {
            type: 'line',
            data: {
                labels: labels_ito,
                datasets: [
                    {
                        label: 'Exact (analytique)',
                        data: exact_path,
                        borderColor: 'rgba(255, 255, 255, 0.9)',
                        backgroundColor: 'transparent',
                        borderWidth: 3,
                        pointRadius: 0,
                        tension: 0.1
                    },
                    {
                        label: 'Euler naïf',
                        data: euler_path,
                        borderColor: 'rgba(255, 107, 107, 1)',
                        backgroundColor: 'transparent',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        pointRadius: 0,
                        tension: 0.1
                    },
                    {
                        label: 'Log-Euler',
                        data: logeuler_path,
                        borderColor: 'rgba(78, 205, 196, 1)',
                        backgroundColor: 'transparent',
                        borderWidth: 2,
                        pointRadius: 0,
                        tension: 0.1
                    },
                    {
                        label: 'Milstein',
                        data: milstein_path,
                        borderColor: 'rgba(255, 217, 61, 1)',
                        backgroundColor: 'transparent',
                        borderWidth: 2,
                        borderDash: [2, 2],
                        pointRadius: 0,
                        tension: 0.1
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Comparaison des Schémas de Simulation du GBM (S₀=100, μ=10%, σ=30%)',
                        color: '#e0e0e0',
                        font: { size: 14 }
                    },
                    legend: {
                        labels: { color: '#e0e0e0' }
                    },
                    tooltip: {
                        callbacks: {
                            title: function(context) {
                                return `t = ${context[0].label} an`;
                            },
                            label: function(context) {
                                return `${context.dataset.label}: ${context.parsed.y.toFixed(2)}€`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        grid: { color: '#333' },
                        ticks: {
                            color: '#e0e0e0',
                            maxTicksLimit: 10
                        },
                        title: {
                            display: true,
                            text: 'Temps (années)',
                            color: '#e0e0e0'
                        }
                    },
                    y: {
                        grid: { color: '#333' },
                        ticks: {
                            color: '#e0e0e0',
                            callback: function(value) {
                                return value.toFixed(0) + '€';
                            }
                        },
                        title: {
                            display: true,
                            text: 'Prix S(t)',
                            color: '#e0e0e0'
                        }
                    }
                },
                interaction: {
                    mode: 'index',
                    intersect: false
                }
            }
        });
    }

    // ═══════════════════════════════════════════════════════════════════════════
    // GRAPHIQUE MODULE 11 - Comparaison Mesure P vs Q
    // ═══════════════════════════════════════════════════════════════════════════
    if (document.getElementById('martingaleCompareChart')) {
        // Paramètres
        const S0_m = 100;
        const mu_m = 0.12;  // Drift physique
        const r_m = 0.05;   // Drift risque-neutre
        const sigma_m = 0.25;
        const T_m = 1;

        // Générer la distribution de ln(Sₜ/S₀)
        const nPoints = 100;
        const minX = -0.5;
        const maxX = 0.8;
        const step = (maxX - minX) / nPoints;

        const labels_m = [];
        const distP = [];
        const distQ = [];

        // Paramètres des distributions log-normales
        const muP = (mu_m - 0.5 * sigma_m * sigma_m) * T_m;  // (μ - σ²/2)
        const muQ = (r_m - 0.5 * sigma_m * sigma_m) * T_m;   // (r - σ²/2)
        const sigmaT = sigma_m * Math.sqrt(T_m);

        // Fonction densité normale
        function normalPDF(x, mean, std) {
            const z = (x - mean) / std;
            return Math.exp(-0.5 * z * z) / (std * Math.sqrt(2 * Math.PI));
        }

        for (let i = 0; i <= nPoints; i++) {
            const x = minX + i * step;
            labels_m.push(x.toFixed(2));
            distP.push(normalPDF(x, muP, sigmaT));
            distQ.push(normalPDF(x, muQ, sigmaT));
        }

        new Chart(document.getElementById('martingaleCompareChart'), {
            type: 'line',
            data: {
                labels: labels_m,
                datasets: [
                    {
                        label: 'Sous P (μ = 12%)',
                        data: distP,
                        borderColor: 'rgba(255, 107, 107, 1)',
                        backgroundColor: 'rgba(255, 107, 107, 0.2)',
                        fill: true,
                        borderWidth: 2,
                        pointRadius: 0,
                        tension: 0.4
                    },
                    {
                        label: 'Sous Q (drift = r = 5%)',
                        data: distQ,
                        borderColor: 'rgba(78, 205, 196, 1)',
                        backgroundColor: 'rgba(78, 205, 196, 0.2)',
                        fill: true,
                        borderWidth: 2,
                        pointRadius: 0,
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Distribution de ln(Sₜ/S₀) sous P vs Q (σ = 25%, T = 1 an)',
                        color: '#e0e0e0',
                        font: { size: 14 }
                    },
                    legend: {
                        labels: { color: '#e0e0e0' }
                    },
                    annotation: {
                        annotations: {
                            lineP: {
                                type: 'line',
                                xMin: ((muP - minX) / step).toFixed(0),
                                xMax: ((muP - minX) / step).toFixed(0),
                                borderColor: 'rgba(255, 107, 107, 0.5)',
                                borderWidth: 2,
                                borderDash: [5, 5]
                            },
                            lineQ: {
                                type: 'line',
                                xMin: ((muQ - minX) / step).toFixed(0),
                                xMax: ((muQ - minX) / step).toFixed(0),
                                borderColor: 'rgba(78, 205, 196, 0.5)',
                                borderWidth: 2,
                                borderDash: [5, 5]
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        grid: { color: '#333' },
                        ticks: {
                            color: '#e0e0e0',
                            maxTicksLimit: 10
                        },
                        title: {
                            display: true,
                            text: 'Log-rendement ln(Sₜ/S₀)',
                            color: '#e0e0e0'
                        }
                    },
                    y: {
                        grid: { color: '#333' },
                        ticks: { color: '#e0e0e0' },
                        title: {
                            display: true,
                            text: 'Densité de probabilité',
                            color: '#e0e0e0'
                        }
                    }
                }
            }
        });
    }

    // ═══════════════════════════════════════════════════════════════════════════
    // GRAPHIQUE MODULE 12 - Smile de Volatilité
    // ═══════════════════════════════════════════════════════════════════════════
    if (document.getElementById('volatilitySmileChart')) {
        // Strikes relatifs (moneyness K/S)
        const strikes = [0.80, 0.85, 0.90, 0.95, 1.00, 1.05, 1.10, 1.15, 1.20];
        const labels_vol = strikes.map(k => (k * 100).toFixed(0) + '%');

        // Black-Scholes : volatilité constante
        const bsVol = strikes.map(() => 20);

        // Heston : skew (plus de vol pour puts OTM)
        const hestonVol = strikes.map(k => 20 + 8 * (1 - k));

        // Marché réel : smile (puts et calls OTM ont plus de vol)
        const marketVol = strikes.map(k => 18 + 15 * Math.pow(k - 1, 2) + 5 * (1 - k));

        new Chart(document.getElementById('volatilitySmileChart'), {
            type: 'line',
            data: {
                labels: labels_vol,
                datasets: [
                    {
                        label: 'Black-Scholes (σ constant)',
                        data: bsVol,
                        borderColor: 'rgba(150, 150, 150, 0.8)',
                        backgroundColor: 'transparent',
                        borderWidth: 2,
                        borderDash: [10, 5],
                        pointRadius: 0,
                        tension: 0
                    },
                    {
                        label: 'Heston (skew)',
                        data: hestonVol,
                        borderColor: 'rgba(78, 205, 196, 1)',
                        backgroundColor: 'transparent',
                        borderWidth: 2,
                        pointRadius: 3,
                        tension: 0.3
                    },
                    {
                        label: 'Marché (smile)',
                        data: marketVol,
                        borderColor: 'rgba(255, 107, 107, 1)',
                        backgroundColor: 'transparent',
                        borderWidth: 3,
                        pointRadius: 5,
                        tension: 0.3
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Smile de Volatilité : Black-Scholes vs Heston vs Marché',
                        color: '#e0e0e0',
                        font: { size: 14 }
                    },
                    legend: {
                        labels: { color: '#e0e0e0' }
                    }
                },
                scales: {
                    x: {
                        grid: { color: '#333' },
                        ticks: { color: '#e0e0e0' },
                        title: {
                            display: true,
                            text: 'Strike (% du spot)',
                            color: '#e0e0e0'
                        }
                    },
                    y: {
                        grid: { color: '#333' },
                        ticks: {
                            color: '#e0e0e0',
                            callback: function(value) {
                                return value + '%';
                            }
                        },
                        title: {
                            display: true,
                            text: 'Volatilité Implicite',
                            color: '#e0e0e0'
                        },
                        min: 15,
                        max: 35
                    }
                }
            }
        });
    }

    // ═══════════════════════════════════════════════════════════════════════════════
    // MODULE 13 - GRAPHIQUE DES MESURES DE RISQUE
    // ═══════════════════════════════════════════════════════════════════════════════

    if (document.getElementById('riskMeasuresChart')) {
        // Générer une distribution normale
        const normalDensity = (x, mu, sigma) => {
            return (1 / (sigma * Math.sqrt(2 * Math.PI))) * Math.exp(-0.5 * Math.pow((x - mu) / sigma, 2));
        };

        const mu = 0.05; // 5% rendement moyen
        const sigma = 2;  // 2% volatilité journalière
        const alpha = 0.05; // 5% niveau de confiance
        const z_alpha = 1.645; // quantile 95%

        // VaR et ES
        const VaR = -mu + z_alpha * sigma; // VaR 95%
        const phi_z = normalDensity(z_alpha, 0, 1);
        const ES = -mu + sigma * phi_z / alpha; // ES 95%

        // Points pour la distribution
        const points = [];
        for (let x = -8; x <= 8; x += 0.1) {
            points.push({
                x: x.toFixed(1),
                y: normalDensity(x, mu, sigma)
            });
        }

        // Identifier les points dans la queue (perte > VaR)
        const tailStart = -VaR; // VaR est une perte positive, donc point négatif sur le graphe

        new Chart(document.getElementById('riskMeasuresChart'), {
            type: 'line',
            data: {
                labels: points.map(p => p.x),
                datasets: [
                    {
                        label: 'Distribution des rendements',
                        data: points.map(p => p.y),
                        borderColor: 'rgba(78, 205, 196, 1)',
                        backgroundColor: 'rgba(78, 205, 196, 0.1)',
                        borderWidth: 2,
                        pointRadius: 0,
                        fill: true,
                        tension: 0.4
                    },
                    {
                        label: 'Zone de risque (5% pires cas)',
                        data: points.map(p => parseFloat(p.x) < tailStart ? p.y : null),
                        borderColor: 'rgba(255, 107, 107, 1)',
                        backgroundColor: 'rgba(255, 107, 107, 0.4)',
                        borderWidth: 0,
                        pointRadius: 0,
                        fill: true,
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Distribution des Rendements avec VaR et Expected Shortfall',
                        color: '#e0e0e0',
                        font: { size: 14 }
                    },
                    legend: {
                        labels: { color: '#e0e0e0' }
                    },
                    annotation: {
                        annotations: {
                            varLine: {
                                type: 'line',
                                xMin: tailStart.toFixed(1),
                                xMax: tailStart.toFixed(1),
                                borderColor: 'rgba(255, 255, 0, 0.8)',
                                borderWidth: 3,
                                borderDash: [6, 4],
                                label: {
                                    display: true,
                                    content: 'VaR 95% = ' + VaR.toFixed(2) + '%',
                                    position: 'start',
                                    backgroundColor: 'rgba(255, 255, 0, 0.7)',
                                    color: '#000'
                                }
                            },
                            esLine: {
                                type: 'line',
                                xMin: (-ES).toFixed(1),
                                xMax: (-ES).toFixed(1),
                                borderColor: 'rgba(255, 107, 107, 1)',
                                borderWidth: 3,
                                label: {
                                    display: true,
                                    content: 'ES 95% = ' + ES.toFixed(2) + '%',
                                    position: 'start',
                                    backgroundColor: 'rgba(255, 107, 107, 0.8)',
                                    color: '#fff'
                                }
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        grid: { color: '#333' },
                        ticks: {
                            color: '#e0e0e0',
                            callback: function(value, index) {
                                if (index % 20 === 0) return this.getLabelForValue(value) + '%';
                                return '';
                            }
                        },
                        title: {
                            display: true,
                            text: 'Rendement journalier (%)',
                            color: '#e0e0e0'
                        }
                    },
                    y: {
                        grid: { color: '#333' },
                        ticks: { color: '#e0e0e0' },
                        title: {
                            display: true,
                            text: 'Densité de probabilité',
                            color: '#e0e0e0'
                        },
                        beginAtZero: true
                    }
                }
            }
        });
    }

    // ═══════════════════════════════════════════════════════════════════════════════
    // MODULE 14 - FRONTIÈRE EFFICIENTE ET CML
    // ═══════════════════════════════════════════════════════════════════════════════

    if (document.getElementById('efficientFrontierChartM14')) {
        // Paramètres des actifs (exemple à 3 actifs)
        const mu1 = 8, mu2 = 12, mu3 = 16;  // rendements %
        const sig1 = 15, sig2 = 20, sig3 = 30;  // volatilités %
        const Rf = 2;  // taux sans risque

        // Générer la frontière efficiente (simulation numérique simplifiée)
        const frontierPoints = [];
        const bulletPoints = [];

        // Simuler des portefeuilles à 2 actifs avec différentes corrélations
        const rho = 0.3;
        for (let w1 = -0.2; w1 <= 1.2; w1 += 0.02) {
            const w2 = 1 - w1;
            const muP = w1 * mu1 + w2 * mu3;
            const sigP = Math.sqrt(
                w1*w1*sig1*sig1 + w2*w2*sig3*sig3 + 2*w1*w2*rho*sig1*sig3
            );
            bulletPoints.push({ x: sigP, y: muP });
        }

        // Trier par volatilité pour tracer la frontière
        bulletPoints.sort((a, b) => a.x - b.x);

        // Frontière efficiente (partie supérieure)
        const minSigIdx = bulletPoints.reduce((minIdx, p, idx, arr) =>
            p.x < arr[minIdx].x ? idx : minIdx, 0);
        const efficientFrontier = bulletPoints.slice(minSigIdx).filter(p => p.y >= bulletPoints[minSigIdx].y);
        const inefficientFrontier = bulletPoints.slice(0, minSigIdx + 1).reverse();

        // Portefeuille GMV (minimum de volatilité)
        const gmvPoint = bulletPoints[minSigIdx];

        // Portefeuille tangent (approximation - max ratio de Sharpe sur la frontière)
        let maxSR = -Infinity, tangentPoint = null;
        efficientFrontier.forEach(p => {
            const sr = (p.y - Rf) / p.x;
            if (sr > maxSR) {
                maxSR = sr;
                tangentPoint = p;
            }
        });

        // Capital Market Line
        const cmlPoints = [];
        for (let sig = 0; sig <= 35; sig += 1) {
            cmlPoints.push({
                x: sig,
                y: Rf + maxSR * sig
            });
        }

        new Chart(document.getElementById('efficientFrontierChartM14'), {
            type: 'scatter',
            data: {
                datasets: [
                    {
                        label: 'Frontière inefficiente',
                        data: inefficientFrontier,
                        borderColor: 'rgba(150, 150, 150, 0.5)',
                        backgroundColor: 'transparent',
                        showLine: true,
                        borderWidth: 2,
                        borderDash: [5, 5],
                        pointRadius: 0,
                        tension: 0.4
                    },
                    {
                        label: 'Frontière efficiente',
                        data: efficientFrontier,
                        borderColor: 'rgba(78, 205, 196, 1)',
                        backgroundColor: 'transparent',
                        showLine: true,
                        borderWidth: 3,
                        pointRadius: 0,
                        tension: 0.4
                    },
                    {
                        label: 'Capital Market Line (CML)',
                        data: cmlPoints,
                        borderColor: 'rgba(255, 230, 109, 1)',
                        backgroundColor: 'transparent',
                        showLine: true,
                        borderWidth: 3,
                        pointRadius: 0
                    },
                    {
                        label: 'Portefeuille GMV',
                        data: [gmvPoint],
                        backgroundColor: 'rgba(255, 107, 107, 1)',
                        pointRadius: 10,
                        pointStyle: 'circle'
                    },
                    {
                        label: 'Portefeuille Tangent',
                        data: [tangentPoint],
                        backgroundColor: 'rgba(102, 255, 102, 1)',
                        pointRadius: 10,
                        pointStyle: 'triangle'
                    },
                    {
                        label: 'Actif sans risque',
                        data: [{ x: 0, y: Rf }],
                        backgroundColor: 'rgba(255, 255, 255, 1)',
                        pointRadius: 8,
                        pointStyle: 'rect'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Frontière Efficiente de Markowitz et Capital Market Line',
                        color: '#e0e0e0',
                        font: { size: 14 }
                    },
                    legend: {
                        labels: { color: '#e0e0e0' }
                    }
                },
                scales: {
                    x: {
                        type: 'linear',
                        grid: { color: '#333' },
                        ticks: {
                            color: '#e0e0e0',
                            callback: function(value) { return value + '%'; }
                        },
                        title: {
                            display: true,
                            text: 'Volatilité (σ)',
                            color: '#e0e0e0'
                        },
                        min: 0,
                        max: 35
                    },
                    y: {
                        grid: { color: '#333' },
                        ticks: {
                            color: '#e0e0e0',
                            callback: function(value) { return value + '%'; }
                        },
                        title: {
                            display: true,
                            text: 'Rendement espéré (μ)',
                            color: '#e0e0e0'
                        },
                        min: 0,
                        max: 25
                    }
                }
            }
        });
    }

    // ═══════════════════════════════════════════════════════════════════════════════
    // MODULE 15 - SECURITY MARKET LINE (SML)
    // ═══════════════════════════════════════════════════════════════════════════════

    if (document.getElementById('smlChartM15')) {
        const Rf = 3;  // Taux sans risque
        const Rm = 10; // Rendement marché
        const riskPremium = Rm - Rf;

        // Données SML (droite)
        const smlPoints = [];
        for (let beta = 0; beta <= 2; beta += 0.1) {
            smlPoints.push({
                x: beta,
                y: Rf + beta * riskPremium
            });
        }

        // Actions individuelles avec alpha
        const stocks = [
            { name: 'Action A (α > 0)', beta: 0.8, return: 12, color: 'rgba(102, 255, 102, 1)' },
            { name: 'Action B (α < 0)', beta: 1.3, return: 10, color: 'rgba(255, 107, 107, 1)' },
            { name: 'Action C (α = 0)', beta: 1.0, return: 10, color: 'rgba(78, 205, 196, 1)' },
            { name: 'Action D (β faible)', beta: 0.5, return: 6.5, color: 'rgba(255, 230, 109, 1)' },
            { name: 'Action E (β élevé)', beta: 1.8, return: 18, color: 'rgba(200, 150, 255, 1)' }
        ];

        const stockDatasets = stocks.map(s => ({
            label: s.name,
            data: [{ x: s.beta, y: s.return }],
            backgroundColor: s.color,
            borderColor: s.color,
            pointRadius: 10,
            pointStyle: 'circle'
        }));

        new Chart(document.getElementById('smlChartM15'), {
            type: 'scatter',
            data: {
                datasets: [
                    {
                        label: 'Security Market Line (SML)',
                        data: smlPoints,
                        borderColor: 'rgba(255, 255, 255, 0.8)',
                        backgroundColor: 'transparent',
                        showLine: true,
                        borderWidth: 3,
                        pointRadius: 0
                    },
                    {
                        label: 'Marché (β = 1)',
                        data: [{ x: 1, y: Rm }],
                        backgroundColor: 'rgba(255, 255, 255, 1)',
                        borderColor: 'rgba(255, 255, 255, 1)',
                        pointRadius: 12,
                        pointStyle: 'rectRot'
                    },
                    ...stockDatasets
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Security Market Line : Relation entre Bêta et Rendement Espéré',
                        color: '#e0e0e0',
                        font: { size: 14 }
                    },
                    legend: {
                        labels: { color: '#e0e0e0' }
                    }
                },
                scales: {
                    x: {
                        type: 'linear',
                        grid: { color: '#333' },
                        ticks: { color: '#e0e0e0' },
                        title: {
                            display: true,
                            text: 'Bêta (β)',
                            color: '#e0e0e0'
                        },
                        min: 0,
                        max: 2
                    },
                    y: {
                        grid: { color: '#333' },
                        ticks: {
                            color: '#e0e0e0',
                            callback: function(value) { return value + '%'; }
                        },
                        title: {
                            display: true,
                            text: 'Rendement espéré (%)',
                            color: '#e0e0e0'
                        },
                        min: 0,
                        max: 20
                    }
                }
            }
        });
    }

    // ═══════════════════════════════════════════════════════════════════════════════
    // MODULE 16 - COMPARAISON DES STRATÉGIES
    // ═══════════════════════════════════════════════════════════════════════════════

    if (document.getElementById('performanceChartM16')) {
        // Données des 4 stratégies
        const strategies = ['Stratégie A\n(Value)', 'Stratégie B\n(Growth)', 'Stratégie C\n(Hedge Fund)', 'Stratégie D\n(Index)'];

        // Métriques normalisées (0-100 pour visualisation)
        const sharpeData = [65, 55, 80, 50];  // Sharpe ratios
        const sortinoData = [70, 45, 60, 55]; // Sortino (strategy C has tail risk)
        const calmarData = [60, 40, 35, 55];  // Calmar (strategy C has big drawdowns)
        const alphaData = [55, 30, 75, 0];    // Alpha (index has 0 by definition)

        new Chart(document.getElementById('performanceChartM16'), {
            type: 'radar',
            data: {
                labels: ['Sharpe', 'Sortino', 'Calmar', 'Alpha', 'IR'],
                datasets: [
                    {
                        label: 'Value Strategy',
                        data: [65, 70, 60, 55, 45],
                        borderColor: 'rgba(78, 205, 196, 1)',
                        backgroundColor: 'rgba(78, 205, 196, 0.2)',
                        borderWidth: 2
                    },
                    {
                        label: 'Growth Strategy',
                        data: [55, 45, 40, 30, 35],
                        borderColor: 'rgba(255, 107, 107, 1)',
                        backgroundColor: 'rgba(255, 107, 107, 0.2)',
                        borderWidth: 2
                    },
                    {
                        label: 'Hedge Fund',
                        data: [80, 60, 35, 75, 70],
                        borderColor: 'rgba(255, 230, 109, 1)',
                        backgroundColor: 'rgba(255, 230, 109, 0.2)',
                        borderWidth: 2
                    },
                    {
                        label: 'Index Fund',
                        data: [50, 55, 55, 0, 0],
                        borderColor: 'rgba(150, 150, 150, 1)',
                        backgroundColor: 'rgba(150, 150, 150, 0.2)',
                        borderWidth: 2
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Comparaison Multi-Dimensionnelle des Stratégies',
                        color: '#e0e0e0',
                        font: { size: 14 }
                    },
                    legend: {
                        labels: { color: '#e0e0e0' }
                    }
                },
                scales: {
                    r: {
                        grid: { color: '#444' },
                        angleLines: { color: '#444' },
                        pointLabels: { color: '#e0e0e0' },
                        ticks: {
                            color: '#e0e0e0',
                            backdropColor: 'transparent'
                        },
                        suggestedMin: 0,
                        suggestedMax: 100
                    }
                }
            }
        });
    }

    // MODULE 5 - Algèbre Linéaire
    function checkM5Variance() {
        const input = parseFloat(document.getElementById('m5-variance').value);
        const feedback = document.getElementById('feedback-m5-var');
        // σₚ² = 0.6²×0.2² + 0.4²×0.3² + 2×0.6×0.4×0.5×0.2×0.3 = 0.0432
        // σₚ = √0.0432 ≈ 20.78%
        if (input >= 20 && input <= 21.5) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! σₚ = √(0.0144 + 0.0144 + 0.0144) = √0.0432 ≈ 20.8%';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Vérifiez : σₚ² = w₁²σ₁² + w₂²σ₂² + 2w₁w₂ρσ₁σ₂ puis prenez la racine.';
        }
    }

    function checkM5PCA() {
        const input = parseFloat(document.getElementById('m5-pca').value);
        const feedback = document.getElementById('feedback-m5-pca');
        // λ₁/(λ₁+λ₂+λ₃) = 0.04/0.055 ≈ 72.7%
        if (input >= 72 && input <= 73.5) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! 0.04 / (0.04+0.01+0.005) = 0.04/0.055 ≈ 72.7%';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Calculez : λ₁ / (λ₁ + λ₂ + λ₃) = 0.04 / 0.055';
        }
    }

    function checkM5Cov() {
        const input = parseFloat(document.getElementById('m5-cov').value);
        const feedback = document.getElementById('feedback-m5-cov');
        // Cov = ρ × σA × σB = 0.6 × 0.25 × 0.15 = 0.0225
        if (input >= 0.022 && input <= 0.023) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! Cov(A,B) = 0.6 × 0.25 × 0.15 = 0.0225';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Rappel : Cov(A,B) = ρ × σ_A × σ_B = 0.6 × 0.25 × 0.15';
        }
    }

    function checkM5Analyse() {
        const input = document.getElementById('m5-analyse').value.trim();
        const feedback = document.getElementById('feedback-m5-analyse');

        if (input.length < 50) {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Développez davantage votre analyse (calculez les 3 cas).';
        } else if (input.includes('0') || input.toLowerCase().includes('zéro') || input.toLowerCase().includes('elimine')) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Excellent ! Vous avez compris le pouvoir de la diversification. Quand ρ = -1, le risque peut être totalement éliminé.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Indice : Que se passe-t-il quand ρ = -1 ? Calculez σₚ pour chaque cas.';
        }
    }

    // MODULE 6 - Calcul Différentiel
    function checkM6Optim() {
        const input = parseFloat(document.getElementById('m6-optim').value);
        const feedback = document.getElementById('feedback-m6-optim');
        // f'(x) = 2x - 4 = 0 → x* = 2
        if (input === 2) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! f\'(x) = 2x - 4 = 0 ⟹ x* = 2';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Dérivez f(x) et résolvez f\'(x) = 0.';
        }
    }

    function checkM6Lagrange() {
        const input = parseFloat(document.getElementById('m6-lagrange').value);
        const feedback = document.getElementById('feedback-m6-lagrange');
        // L = xy - λ(x+y-10), ∂L/∂x = y - λ = 0, ∂L/∂y = x - λ = 0
        // Donc x = y, et x + y = 10 → x* = 5
        if (input === 5) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! Par symétrie x = y, donc 2x = 10 ⟹ x* = y* = 5';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Utilisez ∂L/∂x = ∂L/∂y = 0 et la contrainte.';
        }
    }

    function checkM6Greek() {
        const input = parseFloat(document.getElementById('m6-greek').value);
        const feedback = document.getElementById('feedback-m6-greek');
        // ΔP = 0.60×3 + ½×0.03×9 + (-0.08)×2 = 1.80 + 0.135 - 0.16 = 1.775
        if (input >= 1.7 && input <= 1.85) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! ΔP = 1.80 + 0.135 - 0.16 ≈ 1.78€';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Vérifiez : Delta×ΔS + ½Gamma×(ΔS)² + Theta×Δt';
        }
    }

    function checkM6Analyse() {
        const input = document.getElementById('m6-analyse').value.trim();
        const feedback = document.getElementById('feedback-m6-analyse');
        if (input.length < 30) {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Développez davantage votre interprétation.';
        } else if (input.toLowerCase().includes('prix') || input.toLowerCase().includes('marginal') || input.toLowerCase().includes('améliorer')) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Excellent ! Vous comprenez l\'interprétation économique du multiplicateur.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Indice : λ mesure l\'effet d\'un relâchement marginal de la contrainte sur l\'objectif.';
        }
    }

    // MODULE 7 - Probabilités
    function checkM7Normal() {
        const input = parseFloat(document.getElementById('m7-normal').value);
        const feedback = document.getElementById('feedback-m7-normal');
        // N(1%, σ=2% car variance=4%), Z = (0-1)/2 = -0.5, P(Z < -0.5) ≈ 30.85%
        if (input >= 30 && input <= 32) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! Z = (0 - 1%)/2% = -0.5, P(Z < -0.5) ≈ 30.85%';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Note : variance = 4% donc σ = 2%. Standardisez : Z = (0-μ)/σ = (0-1)/2 = -0.5';
        }
    }

    function checkM7Esperance() {
        const input = parseFloat(document.getElementById('m7-esperance').value);
        const feedback = document.getElementById('feedback-m7-esperance');
        // E[R] = 0.60×15% + 0.30×5% + 0.10×(-20%) = 9% + 1.5% - 2% = 8.5%
        if (input >= 8 && input <= 9) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! E[R] = 0.60×15% + 0.30×5% + 0.10×(-20%) = 8.5%';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'E[R] = ΣP(i)×R(i) = 0.60×15 + 0.30×5 + 0.10×(-20)';
        }
    }

    function checkM7Variance() {
        const input = parseFloat(document.getElementById('m7-variance').value);
        const feedback = document.getElementById('feedback-m7-variance');
        // σₚ² = 0.7²×0.20² + 0.3²×0.30² + 2×0.7×0.3×0.4×0.20×0.30 = 0.03778
        // σₚ = √0.03778 ≈ 19.4%
        if (input >= 19 && input <= 20) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! σₚ = √(0.0196 + 0.0081 + 0.01008) = √0.03778 ≈ 19.4%';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Utilisez σₚ² = wₐ²σₐ² + wᵦ²σᵦ² + 2wₐwᵦρσₐσᵦ';
        }
    }

    function checkM7Bayes() {
        const input = parseFloat(document.getElementById('m7-bayes').value);
        const feedback = document.getElementById('feedback-m7-bayes');
        // P(T|3S) = P(3S|T)×P(T) / P(3S) = (0.343×0.20) / 0.0902 ≈ 76%
        if (input >= 74 && input <= 78) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! P(T|3S) = (0.7³×0.20) / (0.7³×0.20 + 0.3³×0.80) ≈ 76%';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Utilisez Bayes : P(T|3S) = P(3S|T)×P(T) / [P(3S|T)×P(T) + P(3S|C)×P(C)]';
        }
    }

    // MODULE 8 - Statistiques et Économétrie
    function checkM8Tstat() {
        const input = parseFloat(document.getElementById('m8-tstat').value);
        const feedback = document.getElementById('feedback-m8-tstat');
        // t = (1.85 - 1) / 0.25 = 0.85 / 0.25 = 3.4
        if (input >= 3.3 && input <= 3.5) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! t = (1.85-1)/0.25 = 3.4 > 1.96. Le bêta est significativement différent de 1.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 't = (β̂ - β₀) / se(β̂) = (1.85 - 1) / 0.25';
        }
    }

    function checkM8IC() {
        const lower = parseFloat(document.getElementById('m8-ic-lower').value);
        const upper = parseFloat(document.getElementById('m8-ic-upper').value);
        const feedback = document.getElementById('feedback-m8-ic');
        // IC = 1.85 ± 1.96 × 0.25 = [1.36, 2.34]
        if (lower >= 1.33 && lower <= 1.39 && upper >= 2.31 && upper <= 2.37) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! IC₉₅% = 1.85 ± 0.49 = [1.36, 2.34]';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'IC₉₅% = β̂ ± 1.96 × se(β̂) = 1.85 ± 1.96 × 0.25';
        }
    }

    function checkM8Resid() {
        const input = parseFloat(document.getElementById('m8-resid').value);
        const feedback = document.getElementById('feedback-m8-resid');
        // σ²_resid = 0.0025 × (1 - 0.82) = 0.00045
        if (input >= 0.00043 && input <= 0.00047) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! σ²_résid = 0.0025 × 0.18 = 0.00045';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'σ²_résiduelle = σ²_totale × (1 - R²) = 0.0025 × (1 - 0.82)';
        }
    }

    function checkM8DW() {
        const input = document.getElementById('m8-dw').value.trim().toLowerCase();
        const feedback = document.getElementById('feedback-m8-dw');
        if (input.length < 30) {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Développez votre analyse.';
        } else if (input.includes('positive') || input.includes('autocorr') || input.includes('newey') || input.includes('hac')) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Excellent ! DW = 1.45 < 2 suggère une autocorrélation positive (ρ ≈ 0.275). Il faut utiliser des écarts-types HAC (Newey-West).';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Indice : DW ≈ 2(1-ρ), donc si DW < 2, quelle est le signe de ρ ?';
        }
    }

    function checkM8MLE() {
        const input = parseFloat(document.getElementById('m8-mle').value);
        const feedback = document.getElementById('feedback-m8-mle');
        // MLE pour la moyenne = moyenne empirique = (2+4+3+5+1)/5 = 3
        if (input === 3) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! μ̂_MLE = X̄ = (2+4+3+5+1)/5 = 3%';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Pour une loi normale, le MLE de μ est la moyenne empirique X̄.';
        }
    }

    // MODULE 9 - Mouvement Brownien
    function checkM9Var() {
        const input = parseFloat(document.getElementById('m9-var').value);
        const feedback = document.getElementById('feedback-m9-var');
        // Var(W₃ - W₁) = 3 - 1 = 2
        if (input === 2) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! Var(Wₜ - Wₛ) = t - s = 3 - 1 = 2';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Rappel : Wₜ - Wₛ ~ N(0, t-s) donc Var = t - s';
        }
    }

    function checkM9Esp() {
        const input = parseFloat(document.getElementById('m9-esp').value);
        const feedback = document.getElementById('feedback-m9-esp');
        // E[S₁] = 100 × e^0.1 ≈ 110.52
        if (input >= 110 && input <= 111) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! E[S₁] = 100 × e^0.1 ≈ 110.52';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'E[Sₜ] = S₀e^(μt). Ici : 100 × e^0.1';
        }
    }

    function checkM9Cov() {
        const input = parseFloat(document.getElementById('m9-cov').value);
        const feedback = document.getElementById('feedback-m9-cov');
        // Cov(W₂, W₅) = min(2, 5) = 2
        if (input === 2) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! Cov(Wₛ, Wₜ) = min(s, t) = min(2, 5) = 2';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Rappel : Cov(Wₛ, Wₜ) = min(s, t). Ici s=2, t=5.';
        }
    }

    function checkM9Prob() {
        const input = parseFloat(document.getElementById('m9-prob').value);
        const feedback = document.getElementById('feedback-m9-prob');
        // P(S₁ > 60) ≈ 29.8%
        if (input >= 28 && input <= 32) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! P(S₁ > 60) = P(Z > 0.53) ≈ 29.8%';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Calculez Z = (ln(60/50) - (μ-σ²/2)) / σ puis utilisez 1 - Φ(Z).';
        }
    }

    function checkM9Sim() {
        const inputDt = parseFloat(document.getElementById('m9-dt').value);
        const inputSigma = parseFloat(document.getElementById('m9-sigmasqrt').value);
        const feedback = document.getElementById('feedback-m9-sim');

        // Δt = 1/252 ≈ 0.00397, σ√Δt = 0.30 × √(1/252) ≈ 1.89%
        const dtCorrect = (inputDt >= 0.003 && inputDt <= 0.005) ||
                          (inputDt >= 0.39 && inputDt <= 0.41); // En cas de %
        const sigmaCorrect = (inputSigma >= 1.8 && inputSigma <= 2.0);

        if (dtCorrect && sigmaCorrect) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Excellent ! Δt = 1/252 ≈ 0.00397 et σ√Δt = 30% × 0.063 ≈ 1.89%';
        } else if (dtCorrect) {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Δt est correct ! Pour σ√Δt : 0.30 × √(1/252) = ?';
        } else if (sigmaCorrect) {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'σ√Δt est correct ! Pour Δt : T/n = 1/252 = ?';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Δt = T/n = 1/252. Ensuite calculez σ × √Δt.';
        }
    }

    // MODULE 10 - Calcul d'Itô
    function checkM10Ito() {
        const input = parseFloat(document.getElementById('m10-ito').value);
        const feedback = document.getElementById('feedback-m10-ito');
        // d(S²) = (2μ + σ²)S² dt + 2σS² dW
        // coef = 2×0.1 + 0.2² = 0.24
        if (input >= 0.23 && input <= 0.25) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! Coef = 2μ + σ² = 2×0.1 + 0.04 = 0.24';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'd(S²) = 2S dS + (1/2)×2×(σS)²dt = (2μ + σ²)S² dt + ...';
        }
    }

    function checkM10Iso() {
        const input = parseFloat(document.getElementById('m10-iso').value);
        const feedback = document.getElementById('feedback-m10-iso');
        // E[(∫₀¹ t dWₜ)²] = ∫₀¹ t² dt = 1/3 ≈ 0.333
        if (input >= 0.32 && input <= 0.35) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! E[I²] = ∫₀¹ t² dt = [t³/3]₀¹ = 1/3 ≈ 0.333';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Isométrie d\'Itô : E[(∫f dW)²] = E[∫f² dt]. Ici f(t) = t.';
        }
    }

    function checkM10OU() {
        const input = parseFloat(document.getElementById('m10-ou').value);
        const feedback = document.getElementById('feedback-m10-ou');
        // E[Xₜ] = θ + (X₀ - θ)e^(-κt) = 2 + (1-2)e^(-0.5) ≈ 1.39
        if (input >= 1.37 && input <= 1.42) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! E[X₁] = 2 + (1-2)e^(-0.5) = 2 - 0.6065 ≈ 1.39';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'E[Xₜ] = θ + (X₀ - θ)e^(-κt). L\'intégrale stochastique a espérance 0.';
        }
    }

    function checkM10Log() {
        const input = document.getElementById('m10-log').value.trim().toLowerCase();
        const feedback = document.getElementById('feedback-m10-log');
        // Coefficient de dt dans d(ln S) = μ - σ²/2 = μ - 0.5σ²
        if (input.includes('μ') || input.includes('mu')) {
            if (input.includes('0.5') || input.includes('1/2') || input.includes('σ²/2')) {
                feedback.className = 'feedback correct';
                feedback.innerHTML = 'Correct ! Le coefficient est μ - ½σ² (ou μ - 0.5σ²). C\'est la correction d\'Itô !';
            } else {
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = 'Indice : Il y a un terme de correction en σ² venant de f\'\'(S) = -1/S².';
            }
        } else if (input.includes('-') && input.includes('sigma') || input.includes('0.5')) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! Le coefficient est μ - ½σ². Le terme -½σ² est la correction d\'Itô.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Appliquez le lemme d\'Itô avec f(S)=ln(S), f\'=-1/S, f\'\'=-1/S².';
        }
    }

    function checkM10Feller() {
        const input = document.getElementById('m10-feller').value.trim();
        const feedback = document.getElementById('feedback-m10-feller');
        // 2κθ = 2×0.3×0.05 = 0.03, σ² = 0.01
        // 0.03 > 0.01 donc condition satisfaite
        if (input.includes('0.03') || input.includes('0.01')) {
            if (input.includes('0.03') && input.includes('0.01')) {
                feedback.className = 'feedback correct';
                feedback.innerHTML = 'Correct ! 2κθ = 0.03 > σ² = 0.01. La condition de Feller est satisfaite, r reste positif !';
            } else {
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = 'Calculez les deux valeurs : 2κθ = 2×0.3×0.05 et σ² = 0.1²';
            }
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Calculez 2κθ et σ², puis comparez-les.';
        }
    }

    // MODULE 11 - Martingales
    function checkM11Mart() {
        const input = document.getElementById('m11-mart').value.trim();
        const feedback = document.getElementById('feedback-m11-mart');
        // E[Mₜ|Fₛ] = Wₛ³ - 3sWₛ = Mₛ
        if (input.toLowerCase().includes('ms') || input.toLowerCase().includes('mₛ') ||
            input.includes('W') && input.includes('3') && input.includes('s')) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! E[Mₜ|Fₛ] = Wₛ³ - 3sWₛ = Mₛ. C\'est bien une martingale !';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Calculez E[Wₜ³|Fₛ] = Wₛ³ + 3Wₛ(t-s), puis E[3tWₜ|Fₛ] = 3tWₛ.';
        }
    }

    function checkM11Theta() {
        const input = parseFloat(document.getElementById('m11-theta').value);
        const feedback = document.getElementById('feedback-m11-theta');
        // θ = (0.15 - 0.03)/0.20 = 0.60
        if (input >= 0.58 && input <= 0.62) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! θ = (15% - 3%)/20% = 0.60. C\'est le ratio de Sharpe !';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'θ = (μ - r)/σ = (0.15 - 0.03)/0.20';
        }
    }

    function checkM11EQ() {
        const input = parseFloat(document.getElementById('m11-eq').value);
        const feedback = document.getElementById('feedback-m11-eq');
        // E^Q[S₁] = 100 × e^0.05 ≈ 105.13
        if (input >= 104.5 && input <= 105.5) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! E^Q[Sₜ] = S₀e^(rt) = 100 × e^0.05 ≈ 105.13';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Sous Q, le drift est r = 5%. Donc E^Q[Sₜ] = S₀ × e^(rt).';
        }
    }

    function checkM11Density() {
        const input = parseFloat(document.getElementById('m11-density').value);
        const feedback = document.getElementById('feedback-m11-density');
        // θ = (0.10 - 0.04)/0.25 = 0.24
        // Z₁ = exp(-0.24 × 0.5 - 0.5 × 0.24²) = exp(-0.1488) ≈ 0.862
        if (input >= 0.85 && input <= 0.88) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! θ = 0.24, Z₁ = exp(-0.12 - 0.0288) ≈ 0.862';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'θ = (μ-r)/σ = 0.24. Puis Z₁ = exp(-θW₁^P - ½θ²).';
        }
    }

    function checkM11Exp() {
        const input = parseFloat(document.getElementById('m11-exp').value);
        const feedback = document.getElementById('feedback-m11-exp');
        // E[Z₁] = E[exp(2W₁ - 2)] = e^(-2) × exp(½×4) = 1
        if (input === 1 || (input >= 0.99 && input <= 1.01)) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! E[e^(2W₁-2)] = e^(-2) × e^2 = 1. C\'est une martingale exponentielle !';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Utilisez E[e^(aW)] = exp(a²t/2). Ici a=2, t=1.';
        }
    }

    // MODULE 12 - Applications du Calcul Stochastique
    function checkM12D1() {
        const input = parseFloat(document.getElementById('m12-d1').value);
        const feedback = document.getElementById('feedback-m12-d1');
        // d₁ = [ln(100/105) + (0.05 + 0.02)×0.5] / (0.20×√0.5) ≈ -0.098
        if (input >= -0.15 && input <= -0.05) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! d₁ = (-0.0488 + 0.035) / 0.1414 ≈ -0.098';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'd₁ = [ln(S/K) + (r + σ²/2)T] / (σ√T). Ici ln(100/105) ≈ -0.049.';
        }
    }

    function checkM12Call() {
        const input = parseFloat(document.getElementById('m12-call').value);
        const feedback = document.getElementById('feedback-m12-call');
        // C = 100 × 0.461 - 105 × e^(-0.025) × 0.406 ≈ 4.5
        if (input >= 4 && input <= 5) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! C = 46.1 - 41.6 ≈ 4.5€';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'C = S₀Φ(d₁) - Ke^(-rT)Φ(d₂) = 100×0.461 - 102.4×0.406';
        }
    }

    function checkM12Poisson() {
        const input = parseFloat(document.getElementById('m12-poisson').value);
        const feedback = document.getElementById('feedback-m12-poisson');
        // P(N=1) = e^(-0.5) × 0.5 ≈ 30.3%
        if (input >= 29 && input <= 32) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! P(N=1) = e^(-λT)(λT)¹/1! = e^(-0.5)×0.5 ≈ 30.3%';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'λT = 2 × 0.25 = 0.5. Utilisez P(N=k) = e^(-λT)(λT)^k/k!';
        }
    }

    function checkM12Feller() {
        const input = document.getElementById('m12-feller').value.trim();
        const feedback = document.getElementById('feedback-m12-feller');
        // 2κθ = 0.16, ξ² = 0.09
        if (input.includes('0.16') || input.includes('0.09')) {
            if (input.includes('0.16') && input.includes('0.09')) {
                feedback.className = 'feedback correct';
                feedback.innerHTML = 'Correct ! 2κθ = 0.16 > ξ² = 0.09, condition satisfaite !';
            } else {
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = 'Calculez : 2×2×0.04 = ? et 0.3² = ?';
            }
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = '2κθ = 2×2×0.04 et ξ² = 0.3². Comparez les deux.';
        }
    }

    function checkM12FK() {
        const input = document.getElementById('m12-fk').value.trim().toLowerCase();
        const feedback = document.getElementById('feedback-m12-fk');
        // Coef de ∂²u/∂S² = ½σ²S²
        if (input.includes('σ') || input.includes('sigma') || input.includes('s²') || input.includes('0.02')) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! Le coefficient est ½σ²S². Si σ=20%, alors ½×0.04 = 0.02.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'L\'EDP de BS est ∂V/∂t + (½σ²S²)∂²V/∂S² + ... = 0';
        }
    }

    // ═══════════════════════════════════════════════════════════════════════════════
    // MODULE 13 - RENDEMENT ET RISQUE
    // ═══════════════════════════════════════════════════════════════════════════════

    function checkM13Log() {
        const input = parseFloat(document.getElementById('m13-log').value);
        const feedback = document.getElementById('feedback-m13-log');
        // r = ln(1.12) ≈ 0.1133 soit 11.33%
        if (input >= 11 && input <= 11.5) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! r = ln(1.12) ≈ 11.33%. Le log-rendement est toujours inférieur au rendement simple.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Utilisez r = ln(1 + R) = ln(1.12). Exprimez en pourcentage.';
        }
    }

    function checkM13Vol() {
        const input = parseFloat(document.getElementById('m13-vol').value);
        const feedback = document.getElementById('feedback-m13-vol');
        // σ_annuel = 1.8% × √252 = 1.8 × 15.87 ≈ 28.6%
        if (input >= 28 && input <= 29.5) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! σ_annuel = 1.8% × √252 = 1.8% × 15.87 ≈ 28.6%';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Rappel : σ_annuel = σ_jour × √252. Il y a 252 jours de trading par an.';
        }
    }

    function checkM13VaR() {
        const input = parseFloat(document.getElementById('m13-var').value);
        const feedback = document.getElementById('feedback-m13-var');
        // VaR_95% = -0.05% + 1.645 × 1.2% = -0.05 + 1.974 ≈ 1.92%
        if (input >= 1.85 && input <= 2.0) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! VaR_95% = -μ + z×σ = -0.05% + 1.645×1.2% ≈ 1.92%';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Formule : VaR_α = -μ + z_α × σ. Avec z₀.₀₅ = 1.645.';
        }
    }

    function checkM13Geom() {
        const input = parseFloat(document.getElementById('m13-geom').value);
        const feedback = document.getElementById('feedback-m13-geom');
        // R_géom ≈ 15% - (30%)²/2 = 15% - 4.5% = 10.5%
        if (input >= 10 && input <= 11) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! R_géom ≈ R_arith - σ²/2 = 15% - 4.5% = 10.5%. La volatilité coûte 4.5% !';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Utilisez : R_géom ≈ R_arith - σ²/2. Attention : σ = 30% = 0.30, donc σ² = 0.09.';
        }
    }

    function checkM13Kurt() {
        const input = document.getElementById('m13-kurt').value.trim().toLowerCase();
        const feedback = document.getElementById('feedback-m13-kurt');
        // Kurtosis > 3 = fat tails = VaR gaussienne sous-estime le risque
        if (input.includes('sous') && input.includes('estime')) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! Kurtosis > 3 = queues épaisses = événements extrêmes plus fréquents que prévu par la normale.';
        } else if (input.includes('sur') && input.includes('estime')) {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Non ! Kurtosis > 3 signifie des queues PLUS épaisses que la normale, donc la VaR gaussienne SOUS-estime le risque.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Réfléchissez : si les événements extrêmes sont plus fréquents que prévu, la VaR gaussienne est-elle trop optimiste ou pessimiste ?';
        }
    }

    // ═══════════════════════════════════════════════════════════════════════════════
    // MODULE 14 - THÉORIE DE MARKOWITZ
    // ═══════════════════════════════════════════════════════════════════════════════

    function checkM14Vol() {
        const input = parseFloat(document.getElementById('m14-vol').value);
        const feedback = document.getElementById('feedback-m14-vol');
        // σ²ₚ = 0.36×0.04 + 0.16×0.09 + 2×0.6×0.4×0.4×0.2×0.3 = 0.0144 + 0.0144 + 0.01152 = 0.04032
        // σₚ = √0.04032 ≈ 20.08%
        if (input >= 19.5 && input <= 20.5) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! σₚ = √(0.0144 + 0.0144 + 0.01152) = √0.04032 ≈ 20.1%. Inférieur à la moyenne pondérée (24%) grâce à la diversification.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Utilisez : σ²ₚ = w₁²σ₁² + w₂²σ₂² + 2w₁w₂ρσ₁σ₂, puis prenez la racine carrée.';
        }
    }

    function checkM14Zero() {
        const input = parseFloat(document.getElementById('m14-zero').value);
        const feedback = document.getElementById('feedback-m14-zero');
        // w₁ = σ₂/(σ₁+σ₂) = 25/(15+25) = 62.5%
        if (input >= 62 && input <= 63) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! w₁ = σ₂/(σ₁+σ₂) = 25/40 = 62.5%. Avec cette allocation, σₚ = 0 !';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Pour ρ=-1, utilisez w₁ = σ₂/(σ₁+σ₂). C\'est la formule magique pour annuler le risque.';
        }
    }

    function checkM14GMV() {
        const input = parseFloat(document.getElementById('m14-gmv').value);
        const feedback = document.getElementById('feedback-m14-gmv');
        // w₁ = (σ₂² - ρσ₁σ₂)/(σ₁² + σ₂² - 2ρσ₁σ₂) = (0.09 - 0.018)/(0.13 - 0.036) = 0.072/0.094 ≈ 76.6%
        if (input >= 75 && input <= 78) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! w₁_GMV = (σ₂² - ρσ₁σ₂)/(σ₁² + σ₂² - 2ρσ₁σ₂) = 0.072/0.094 ≈ 76.6%';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Dérivez σ²ₚ par rapport à w₁ et résolvez ∂σ²ₚ/∂w₁ = 0.';
        }
    }

    function checkM14Sharpe() {
        const input = parseFloat(document.getElementById('m14-sharpe').value);
        const feedback = document.getElementById('feedback-m14-sharpe');
        // SR = (12% - 2%) / 18% = 10/18 ≈ 0.556
        if (input >= 0.54 && input <= 0.58) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! SR = (12% - 2%) / 18% ≈ 0.56. Pour chaque 1% de risque, on gagne 0.56% de rendement excédentaire.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Rappel : SR = (μₚ - Rᶠ) / σₚ = Rendement excédentaire / Risque.';
        }
    }

    function checkM14CML() {
        const input = parseFloat(document.getElementById('m14-cml').value);
        const feedback = document.getElementById('feedback-m14-cml');
        // μₚ = w × μ_T + (1-w) × Rᶠ → 10% = w×14% + (1-w)×3% → w = 7/11 ≈ 63.6%
        if (input >= 62 && input <= 65) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! w = (10% - 3%) / (14% - 3%) = 7/11 ≈ 63.6%. Sa volatilité sera 63.6% × 20% = 12.7%.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'μₚ = w×μ_T + (1-w)×Rᶠ → résolvez pour w avec μₚ = 10%.';
        }
    }

    // ═══════════════════════════════════════════════════════════════════════════════
    // MODULE 15 - CAPM ET MODÈLES FACTORIELS
    // ═══════════════════════════════════════════════════════════════════════════════

    function checkM15Beta() {
        const input = parseFloat(document.getElementById('m15-beta').value);
        const feedback = document.getElementById('feedback-m15-beta');
        // β = Cov/Var = 0.0024 / 0.0016 = 1.5
        if (input >= 1.45 && input <= 1.55) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! β = 0.0024 / 0.0016 = 1.5. Action agressive qui amplifie les mouvements du marché.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Rappel : β = Cov(Rᵢ, Rₘ) / Var(Rₘ)';
        }
    }

    function checkM15Expected() {
        const input = parseFloat(document.getElementById('m15-expected').value);
        const feedback = document.getElementById('feedback-m15-expected');
        // E[R] = 3% + 1.2 × 6% = 3% + 7.2% = 10.2%
        if (input >= 10 && input <= 10.5) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! E[R] = 3% + 1.2 × 6% = 10.2%. Le bêta de 1.2 augmente le rendement espéré.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Utilisez E[Rᵢ] = Rᶠ + β × (E[Rₘ] - Rᶠ) avec la prime de risque = 6%.';
        }
    }

    function checkM15Alpha() {
        const input = parseFloat(document.getElementById('m15-alpha').value);
        const feedback = document.getElementById('feedback-m15-alpha');
        // Rendement CAPM = 2% + 0.8 × 6% = 6.8%, Alpha = 12% - 6.8% = 5.2%
        if (input >= 5 && input <= 5.5) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! α = 12% - (2% + 0.8×6%) = 12% - 6.8% = 5.2%. Surperformance par rapport au CAPM !';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'α = Rᵢ - [Rᶠ + β(Rₘ - Rᶠ)]. Calculez d\'abord le rendement CAPM.';
        }
    }

    function checkM15BetaP() {
        const input = parseFloat(document.getElementById('m15-betap').value);
        const feedback = document.getElementById('feedback-m15-betap');
        // βₚ = 0.4×1.5 + 0.6×0.8 = 0.6 + 0.48 = 1.08
        if (input >= 1.05 && input <= 1.1) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! βₚ = 0.4×1.5 + 0.6×0.8 = 1.08. Le bêta du portefeuille est la moyenne pondérée.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Le bêta d\'un portefeuille est la moyenne pondérée : βₚ = Σwᵢβᵢ';
        }
    }

    function checkM15FF3() {
        const input = parseFloat(document.getElementById('m15-ff3').value);
        const feedback = document.getElementById('feedback-m15-ff3');
        // E[R] = 2% + 1.1×6% + 0.5×2% + (-0.3)×4% = 2 + 6.6 + 1 - 1.2 = 8.4%
        if (input >= 8 && input <= 8.8) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! E[R] = 2% + 6.6% + 1% - 1.2% = 8.4%. L\'exposition négative à HML (growth) réduit le rendement.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'E[Rᵢ] = Rᶠ + β_mkt×(Mkt-Rf) + β_SMB×SMB + β_HML×HML. Attention au signe de HML.';
        }
    }

    // ═══════════════════════════════════════════════════════════════════════════════
    // MODULE 16 - MESURES DE PERFORMANCE
    // ═══════════════════════════════════════════════════════════════════════════════

    function checkM16Sharpe() {
        const input = parseFloat(document.getElementById('m16-sharpe').value);
        const feedback = document.getElementById('feedback-m16-sharpe');
        // SR = (15% - 3%) / 20% = 0.60
        if (input >= 0.58 && input <= 0.62) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! SR = 12% / 20% = 0.60. Un Sharpe acceptable, typique du marché actions.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Rappel : SR = (Rₚ - Rᶠ) / σₚ = rendement excédentaire / volatilité.';
        }
    }

    function checkM16Treynor() {
        const input = parseFloat(document.getElementById('m16-treynor').value);
        const feedback = document.getElementById('feedback-m16-treynor');
        // Treynor = (12% - 2%) / 0.8 = 12.5%
        if (input >= 12 && input <= 13) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! Treynor = 10% / 0.8 = 12.5%. Rendement excédentaire par unité de bêta.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Treynor = (Rₚ - Rᶠ) / βₚ. Le dénominateur est le bêta, pas la volatilité.';
        }
    }

    function checkM16Alpha() {
        const input = parseFloat(document.getElementById('m16-alpha').value);
        const feedback = document.getElementById('feedback-m16-alpha');
        // α = 14% - [2% + 1.2 × 8%] = 14% - 11.6% = 2.4%
        if (input >= 2.2 && input <= 2.6) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! α = 14% - (2% + 1.2×8%) = 14% - 11.6% = 2.4%. Le gérant crée de la valeur !';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'α = Rₚ - [Rᶠ + β(Rₘ - Rᶠ)]. Calculez d\'abord le rendement CAPM attendu.';
        }
    }

    function checkM16IR() {
        const input = parseFloat(document.getElementById('m16-ir').value);
        const feedback = document.getElementById('feedback-m16-ir');
        // IR = 3% / 6% = 0.5
        if (input >= 0.48 && input <= 0.52) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! IR = 3% / 6% = 0.50. Excellent, dans le top quartile des gérants actifs.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'IR = (Rₚ - Rᵦ) / TE = Surperformance / Tracking Error.';
        }
    }

    function checkM16Calmar() {
        const input = parseFloat(document.getElementById('m16-calmar').value);
        const feedback = document.getElementById('feedback-m16-calmar');
        // Calmar = 10% / 25% = 0.4
        if (input >= 0.38 && input <= 0.42) {
            feedback.className = 'feedback correct';
            feedback.innerHTML = 'Correct ! Calmar = 10% / 25% = 0.40. Rendement par unité de drawdown maximum.';
        } else {
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = 'Calmar = Rendement annualisé / |MDD|. Utilisez la valeur absolue du drawdown.';
        }
    }
</script>

</body>
</html>
